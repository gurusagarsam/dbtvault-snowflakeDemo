2022-03-01 19:08:59.094764 (MainThread): Running with dbt=1.0.3
2022-03-01 19:08:59.121561 (MainThread): 19:08:59  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-01 19:08:59.121755 (MainThread): 19:08:59  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543c6df0>]}
2022-03-01 19:08:59.121963 (MainThread): 19:08:59  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-01 19:08:59.122083 (MainThread): 19:08:59  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543d7b80>]}
2022-03-01 19:08:59.149618 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-01 19:08:59.163246 (MainThread): Tracking: tracking
2022-03-01 19:08:59.163522 (MainThread): 19:08:59  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543c6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254c80f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543d4070>]}
2022-03-01 19:08:59.163815 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=28
2022-03-01 19:08:59.164013 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-01 19:08:59.164126 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-01 19:09:00.442203 (Thread-13): handling status request
2022-03-01 19:09:00.442542 (Thread-13): 19:09:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543fa340>]}
2022-03-01 19:09:00.443153 (Thread-13): sending response (<Response 361 bytes [200 OK]>) to 10.0.21.173
2022-03-01 19:09:00.599696 (Thread-14): handling status request
2022-03-01 19:09:00.600018 (Thread-14): 19:09:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543fa5e0>]}
2022-03-01 19:09:00.600415 (Thread-14): sending response (<Response 361 bytes [200 OK]>) to 10.0.36.128
2022-03-01 19:09:12.575552 (Thread-15): handling status request
2022-03-01 19:09:12.578037 (Thread-15): 19:09:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543fa910>]}
2022-03-01 19:09:12.578684 (Thread-15): sending response (<Response 361 bytes [200 OK]>) to 10.0.38.245
2022-03-01 19:09:12.920360 (Thread-16): handling status request
2022-03-01 19:09:12.920669 (Thread-16): 19:09:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543fabb0>]}
2022-03-01 19:09:12.921302 (Thread-16): sending response (<Response 361 bytes [200 OK]>) to 10.0.16.157
2022-03-01 19:09:13.228674 (Thread-17): handling deps request
2022-03-01 19:09:13.228974 (Thread-17): 19:09:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543fa9d0>]}
2022-03-01 19:09:13.270844 (Thread-17): sending response (<Response 138 bytes [200 OK]>) to 10.0.33.226
2022-03-01 19:09:14.216128 (Thread-18): handling poll request
2022-03-01 19:09:14.216542 (Thread-18): 19:09:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125439aaf0>]}
2022-03-01 19:09:14.217274 (Thread-18): sending response (<Response 292 bytes [200 OK]>) to 10.0.36.128
2022-03-01 19:09:15.358633 (MainThread): 19:09:15  Set downloads directory='/tmp/dbt-downloads-mi9abd44'
2022-03-01 19:09:15.359131 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-03-01 19:09:15.375721 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-03-01 19:09:15.375970 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
2022-03-01 19:09:15.391932 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
2022-03-01 19:09:15.396149 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json
2022-03-01 19:09:15.413898 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json 200
2022-03-01 19:09:15.414262 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-03-01 19:09:15.429010 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-03-01 19:09:15.450883 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-03-01 19:09:15.465375 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-03-01 19:09:15.465612 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
2022-03-01 19:09:15.483033 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
2022-03-01 19:09:15.487034 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-03-01 19:09:15.500642 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-03-01 19:09:15.522043 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json
2022-03-01 19:09:15.611998 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json 200
2022-03-01 19:09:15.612215 (MainThread): 19:09:15  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-03-01 19:09:15.628006 (MainThread): 19:09:15  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-03-01 19:09:15.628337 (MainThread): 19:09:15  Installing Datavault-UK/dbtvault
2022-03-01 19:09:16.126866 (Thread-19): handling poll request
2022-03-01 19:09:16.127192 (Thread-19): 19:09:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125439ad30>]}
2022-03-01 19:09:16.127855 (Thread-19): sending response (<Response 6875 bytes [200 OK]>) to 10.0.4.64
2022-03-01 19:09:16.622954 (MainThread): 19:09:16    Installed from version 0.7.8
2022-03-01 19:09:16.623112 (MainThread): 19:09:16    Updated version available: 0.8.1
2022-03-01 19:09:16.623269 (MainThread): 19:09:16  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba8c964e-6e65-4813-9d59-7ae0f387a0e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb488cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb48949a0>]}
2022-03-01 19:09:16.623494 (MainThread): 19:09:16  Installing dbt-labs/dbt_utils
2022-03-01 19:09:18.038936 (Thread-20): handling poll request
2022-03-01 19:09:18.039260 (Thread-20): 19:09:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a5610>]}
2022-03-01 19:09:18.039754 (Thread-20): sending response (<Response 1667 bytes [200 OK]>) to 10.0.16.78
2022-03-01 19:09:19.940771 (Thread-21): handling poll request
2022-03-01 19:09:19.941110 (Thread-21): 19:09:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a58e0>]}
2022-03-01 19:09:19.941566 (Thread-21): sending response (<Response 292 bytes [200 OK]>) to 10.0.0.195
2022-03-01 19:09:21.158319 (MainThread): 19:09:21    Installed from version 0.7.6
2022-03-01 19:09:21.158485 (MainThread): 19:09:21    Updated version available: 0.8.1
2022-03-01 19:09:21.158636 (MainThread): 19:09:21  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba8c964e-6e65-4813-9d59-7ae0f387a0e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb48a9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facb48a9f40>]}
2022-03-01 19:09:21.158842 (MainThread): 19:09:21  
2022-03-01 19:09:21.158921 (MainThread): 19:09:21  Updates available for packages: ['Datavault-UK/dbtvault', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-03-01 19:09:21.823710 (Thread-22): handling poll request
2022-03-01 19:09:21.824083 (Thread-22): 19:09:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a5e50>]}
2022-03-01 19:09:21.824574 (Thread-22): sending response (<Response 782 bytes [200 OK]>) to 10.0.4.150
2022-03-01 19:09:23.354272 (Thread-23): handling status request
2022-03-01 19:09:23.354595 (Thread-23): 19:09:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a7790>]}
2022-03-01 19:09:23.355264 (Thread-23): sending response (<Response 10479 bytes [200 OK]>) to 10.0.33.226
2022-03-01 19:09:23.371653 (Thread-24): handling status request
2022-03-01 19:09:23.371863 (Thread-24): 19:09:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125439a610>]}
2022-03-01 19:09:23.372376 (Thread-24): sending response (<Response 10479 bytes [200 OK]>) to 10.0.12.131
2022-03-01 19:09:23.421752 (Thread-25): handling status request
2022-03-01 19:09:23.421966 (Thread-25): 19:09:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543fa9d0>]}
2022-03-01 19:09:23.422475 (Thread-25): sending response (<Response 10479 bytes [200 OK]>) to 10.0.26.118
2022-03-01 19:09:56.967898 (Thread-26): handling status request
2022-03-01 19:09:56.969913 (Thread-26): 19:09:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a5670>]}
2022-03-01 19:09:56.970545 (Thread-26): sending response (<Response 10479 bytes [200 OK]>) to 10.0.16.157
2022-03-01 19:09:57.575878 (Thread-27): handling status request
2022-03-01 19:09:57.576208 (Thread-27): 19:09:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a5d30>]}
2022-03-01 19:09:57.576860 (Thread-27): sending response (<Response 10479 bytes [200 OK]>) to 10.0.42.7
2022-03-01 19:09:57.730743 (Thread-28): handling deps request
2022-03-01 19:09:57.730964 (Thread-28): 19:09:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254392550>]}
2022-03-01 19:09:57.770379 (Thread-28): sending response (<Response 138 bytes [200 OK]>) to 10.0.33.126
2022-03-01 19:09:58.654376 (Thread-29): handling poll request
2022-03-01 19:09:58.654778 (Thread-29): 19:09:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543b4bb0>]}
2022-03-01 19:09:58.655550 (Thread-29): sending response (<Response 311 bytes [200 OK]>) to 10.0.4.64
2022-03-01 19:10:00.569439 (Thread-30): handling poll request
2022-03-01 19:10:00.569801 (Thread-30): 19:10:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543406d0>]}
2022-03-01 19:10:00.570279 (Thread-30): sending response (<Response 311 bytes [200 OK]>) to 10.0.36.128
2022-03-01 19:10:01.225572 (MainThread): 19:10:01  Set downloads directory='/tmp/dbt-downloads-7i7jx7rj'
2022-03-01 19:10:01.226227 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-03-01 19:10:01.334585 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-03-01 19:10:01.334991 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
2022-03-01 19:10:01.430268 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
2022-03-01 19:10:01.437900 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json
2022-03-01 19:10:01.486917 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json 200
2022-03-01 19:10:01.487527 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-03-01 19:10:01.590679 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-03-01 19:10:01.631139 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-03-01 19:10:01.723638 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-03-01 19:10:01.723952 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
2022-03-01 19:10:01.815255 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
2022-03-01 19:10:01.819495 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-03-01 19:10:01.834966 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-03-01 19:10:01.856786 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json
2022-03-01 19:10:01.872562 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.8.json 200
2022-03-01 19:10:01.872905 (MainThread): 19:10:01  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json
2022-03-01 19:10:01.965811 (MainThread): 19:10:01  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.6.json 200
2022-03-01 19:10:01.966216 (MainThread): 19:10:01  Installing Datavault-UK/dbtvault
2022-03-01 19:10:02.500675 (Thread-31): handling poll request
2022-03-01 19:10:02.500987 (Thread-31): 19:10:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a5be0>]}
2022-03-01 19:10:02.501625 (Thread-31): sending response (<Response 6894 bytes [200 OK]>) to 10.0.38.245
2022-03-01 19:10:02.923187 (MainThread): 19:10:02    Installed from version 0.7.8
2022-03-01 19:10:02.923501 (MainThread): 19:10:02    Updated version available: 0.8.1
2022-03-01 19:10:02.923834 (MainThread): 19:10:02  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5e2dd94-89e4-4274-893b-4a16b598b781', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1be2e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1be2e4c0>]}
2022-03-01 19:10:02.924187 (MainThread): 19:10:02  Installing dbt-labs/dbt_utils
2022-03-01 19:10:04.432788 (Thread-32): handling poll request
2022-03-01 19:10:04.433096 (Thread-32): 19:10:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254340a00>]}
2022-03-01 19:10:04.433583 (Thread-32): sending response (<Response 1686 bytes [200 OK]>) to 10.0.4.150
2022-03-01 19:10:06.363933 (Thread-33): handling poll request
2022-03-01 19:10:06.364267 (Thread-33): 19:10:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543404c0>]}
2022-03-01 19:10:06.364751 (Thread-33): sending response (<Response 311 bytes [200 OK]>) to 10.0.36.128
2022-03-01 19:10:07.458655 (MainThread): 19:10:07    Installed from version 0.7.6
2022-03-01 19:10:07.458888 (MainThread): 19:10:07    Updated version available: 0.8.1
2022-03-01 19:10:07.459039 (MainThread): 19:10:07  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5e2dd94-89e4-4274-893b-4a16b598b781', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1be2f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1be2fd30>]}
2022-03-01 19:10:07.459396 (MainThread): 19:10:07  
2022-03-01 19:10:07.459481 (MainThread): 19:10:07  Updates available for packages: ['Datavault-UK/dbtvault', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-03-01 19:10:08.268854 (Thread-34): handling poll request
2022-03-01 19:10:08.269196 (Thread-34): 19:10:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125434dac0>]}
2022-03-01 19:10:08.269715 (Thread-34): sending response (<Response 782 bytes [200 OK]>) to 10.0.21.173
2022-03-01 19:10:09.465288 (Thread-35): handling status request
2022-03-01 19:10:09.465645 (Thread-35): 19:10:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a7040>]}
2022-03-01 19:10:09.466410 (Thread-35): sending response (<Response 10479 bytes [200 OK]>) to 10.0.15.193
2022-03-01 19:10:09.788554 (Thread-36): handling status request
2022-03-01 19:10:09.788868 (Thread-36): 19:10:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a7ac0>]}
2022-03-01 19:10:09.789494 (Thread-36): sending response (<Response 10479 bytes [200 OK]>) to 10.0.4.64
2022-03-01 19:10:09.796022 (Thread-37): handling status request
2022-03-01 19:10:09.796237 (Thread-37): 19:10:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543b4700>]}
2022-03-01 19:10:09.821958 (Thread-37): sending response (<Response 10479 bytes [200 OK]>) to 10.0.21.173
2022-03-01 19:10:28.783994 (MainThread): 19:10:28  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254c80f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543c6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543d7e50>]}
2022-03-01 19:10:28.784329 (MainThread): 19:10:28  Flushing usage events
2022-03-01 19:10:28.806758 (MainThread): Runtime Error
  Invalid config version: 1, expected 2

Error encountered in /usr/src/develop/user-59625/environment-68995/repository-56256/dbt_project.yml
2022-03-01 19:11:01.900147 (MainThread): Running with dbt=1.0.3
2022-03-01 19:11:01.932386 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-01 19:11:01.938239 (MainThread): Tracking: tracking
2022-03-01 19:11:01.938416 (MainThread): 19:11:01  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12543a55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254322e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254322c40>]}
2022-03-01 19:11:01.938633 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=28
2022-03-01 19:11:01.943720 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-01 19:11:01.943892 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-01 19:11:02.761846 (Thread-39): handling status request
2022-03-01 19:11:02.762189 (Thread-39): 19:11:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125435a6a0>]}
2022-03-01 19:11:02.762629 (Thread-39): sending response (<Response 775 bytes [200 OK]>) to 10.0.9.46
2022-03-01 19:11:03.096504 (Thread-40): handling status request
2022-03-01 19:11:03.096855 (Thread-40): 19:11:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125435a1f0>]}
2022-03-01 19:11:03.097262 (Thread-40): sending response (<Response 775 bytes [200 OK]>) to 10.0.0.195
2022-03-01 19:11:10.120285 (Thread-42): handling status request
2022-03-01 19:11:10.120635 (Thread-42): 19:11:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125439a400>]}
2022-03-01 19:11:10.121074 (Thread-42): sending response (<Response 775 bytes [200 OK]>) to 10.0.16.78
2022-03-01 19:11:10.298636 (Thread-43): handling status request
2022-03-01 19:11:10.298933 (Thread-43): 19:11:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125435a5b0>]}
2022-03-01 19:11:10.299451 (Thread-43): sending response (<Response 775 bytes [200 OK]>) to 10.0.33.126
2022-03-01 19:11:22.501631 (MainThread): 19:11:22  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254c80dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f126405b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1254c8c880>]}
2022-03-01 19:11:22.501963 (MainThread): 19:11:22  Flushing usage events
2022-03-01 19:11:22.530142 (MainThread): Runtime Error
  Invalid config version: 3, expected 2

Error encountered in /usr/src/develop/user-59625/environment-68995/repository-56256/dbt_project.yml
2022-03-01 19:11:49.595312 (MainThread): Running with dbt=1.0.3
2022-03-01 19:11:49.623401 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-01 19:11:49.624281 (MainThread): Tracking: tracking
2022-03-01 19:11:49.624438 (MainThread): 19:11:49  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f126404ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12542c4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12542c4d00>]}
2022-03-01 19:11:49.624677 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=28
2022-03-01 19:11:49.625331 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-01 19:11:49.625528 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-01 19:11:50.473241 (Thread-45): handling status request
2022-03-01 19:11:50.473559 (Thread-45): 19:11:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125434ea60>]}
2022-03-01 19:11:50.474015 (Thread-45): sending response (<Response 775 bytes [200 OK]>) to 10.0.46.105
2022-03-01 19:11:50.513008 (Thread-46): handling status request
2022-03-01 19:11:50.513305 (Thread-46): 19:11:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125434ed60>]}
2022-03-01 19:11:50.513735 (Thread-46): sending response (<Response 775 bytes [200 OK]>) to 10.0.0.195
2022-03-01 19:12:09.491617 (Thread-48): handling status request
2022-03-01 19:12:09.491953 (Thread-48): 19:12:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12542c4c40>]}
2022-03-01 19:12:09.492373 (Thread-48): sending response (<Response 775 bytes [200 OK]>) to 10.0.26.118
2022-03-01 19:12:09.806981 (Thread-49): handling status request
2022-03-01 19:12:09.807304 (Thread-49): 19:12:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '249d0c80-f4eb-4978-97a2-97e5de25477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12542c4dc0>]}
2022-03-01 19:12:09.807715 (Thread-49): sending response (<Response 775 bytes [200 OK]>) to 10.0.38.245
2022-03-02 14:25:17.338977 (MainThread): Running with dbt=1.0.3
2022-03-02 14:25:17.544847 (MainThread): 14:25:17  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 14:25:17.545107 (MainThread): 14:25:17  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed269190>]}
2022-03-02 14:25:17.545351 (MainThread): 14:25:17  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 14:25:17.545498 (MainThread): 14:25:17  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed264580>]}
2022-03-02 14:25:17.573052 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-02 14:25:17.576517 (MainThread): Tracking: tracking
2022-03-02 14:25:17.577737 (MainThread): 14:25:17  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2691f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2fece130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed285ee0>]}
2022-03-02 14:25:17.579404 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-03-02 14:25:17.583548 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-02 14:25:17.584586 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-02 14:25:26.603572 (Thread-13): handling status request
2022-03-02 14:25:26.604985 (Thread-13): 14:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed290610>]}
2022-03-02 14:25:26.605615 (Thread-13): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:26.781626 (Thread-14): handling status request
2022-03-02 14:25:26.781995 (Thread-14): 14:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2375b0>]}
2022-03-02 14:25:26.782434 (Thread-14): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:26.784156 (Thread-15): handling status request
2022-03-02 14:25:26.784425 (Thread-15): 14:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed237070>]}
2022-03-02 14:25:26.785051 (Thread-15): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:26.935666 (Thread-16): handling ps request
2022-03-02 14:25:26.936022 (Thread-16): 14:25:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed237130>]}
2022-03-02 14:25:26.936472 (Thread-16): sending response (<Response 105 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:28.205060 (Thread-17): handling status request
2022-03-02 14:25:28.205423 (Thread-17): 14:25:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2375e0>]}
2022-03-02 14:25:28.205846 (Thread-17): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:37.726069 (Thread-19): handling status request
2022-03-02 14:25:37.727517 (Thread-19): 14:25:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed28a8e0>]}
2022-03-02 14:25:37.728057 (Thread-19): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:38.026257 (Thread-20): handling status request
2022-03-02 14:25:38.026627 (Thread-20): 14:25:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2e7ee580>]}
2022-03-02 14:25:38.027066 (Thread-20): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:44.451379 (Thread-22): handling status request
2022-03-02 14:25:44.451798 (Thread-22): 14:25:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1cb5e0>]}
2022-03-02 14:25:44.452236 (Thread-22): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:44.459141 (Thread-23): handling status request
2022-03-02 14:25:44.459443 (Thread-23): 14:25:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1cb100>]}
2022-03-02 14:25:44.459882 (Thread-23): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:50.015796 (Thread-24): handling status request
2022-03-02 14:25:50.016166 (Thread-24): 14:25:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1d4850>]}
2022-03-02 14:25:50.016603 (Thread-24): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:50.333220 (Thread-25): handling status request
2022-03-02 14:25:50.333570 (Thread-25): 14:25:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1d4d60>]}
2022-03-02 14:25:50.333993 (Thread-25): sending response (<Response 775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:50.633315 (Thread-26): handling deps request
2022-03-02 14:25:50.633681 (Thread-26): 14:25:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1d4070>]}
2022-03-02 14:25:50.672983 (Thread-26): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:51.447451 (Thread-27): handling poll request
2022-03-02 14:25:51.447933 (Thread-27): 14:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed237a00>]}
2022-03-02 14:25:51.448710 (Thread-27): sending response (<Response 292 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:53.231885 (Thread-28): handling poll request
2022-03-02 14:25:53.232249 (Thread-28): 14:25:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1cb220>]}
2022-03-02 14:25:53.232723 (Thread-28): sending response (<Response 292 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:54.058744 (MainThread): 14:25:54  Set downloads directory='/tmp/dbt-downloads-23_b4qxc'
2022-03-02 14:25:54.059388 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-03-02 14:25:54.081382 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-03-02 14:25:54.081666 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
2022-03-02 14:25:54.178931 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
2022-03-02 14:25:54.183399 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.9.json
2022-03-02 14:25:54.278823 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.9.json 200
2022-03-02 14:25:54.279311 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-03-02 14:25:54.386871 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-03-02 14:25:54.412423 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.1.json
2022-03-02 14:25:54.431566 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.1.json 200
2022-03-02 14:25:54.431980 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
2022-03-02 14:25:54.450508 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
2022-03-02 14:25:54.456523 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-03-02 14:25:54.472185 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-03-02 14:25:54.493900 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.9.json
2022-03-02 14:25:54.510170 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault/0.7.9.json 200
2022-03-02 14:25:54.510444 (MainThread): 14:25:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.1.json
2022-03-02 14:25:54.525774 (MainThread): 14:25:54  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.1.json 200
2022-03-02 14:25:54.526112 (MainThread): 14:25:54  Installing Datavault-UK/dbtvault
2022-03-02 14:25:55.004453 (Thread-29): handling poll request
2022-03-02 14:25:55.004815 (Thread-29): 14:25:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed28af40>]}
2022-03-02 14:25:55.006071 (Thread-29): sending response (<Response 6875 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:55.580290 (MainThread): 14:25:55    Installed from version 0.7.9
2022-03-02 14:25:55.580452 (MainThread): 14:25:55    Updated version available: 0.8.1
2022-03-02 14:25:55.580613 (MainThread): 14:25:55  Sending event: {'category': 'dbt', 'action': 'package', 'label': '6d3bbe6e-8914-4edb-ae5e-8156c7c38c09', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d598d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d5980d0>]}
2022-03-02 14:25:55.580841 (MainThread): 14:25:55  Installing dbt-labs/dbt_utils
2022-03-02 14:25:56.778434 (Thread-30): handling poll request
2022-03-02 14:25:56.778782 (Thread-30): 14:25:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed230970>]}
2022-03-02 14:25:56.779295 (Thread-30): sending response (<Response 1667 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:58.583340 (Thread-31): handling poll request
2022-03-02 14:25:58.583715 (Thread-31): 14:25:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed230910>]}
2022-03-02 14:25:58.584196 (Thread-31): sending response (<Response 292 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:25:59.801870 (MainThread): 14:25:59    Installed from version 0.8.1
2022-03-02 14:25:59.802132 (MainThread): 14:25:59    Up to date!
2022-03-02 14:25:59.802381 (MainThread): 14:25:59  Sending event: {'category': 'dbt', 'action': 'package', 'label': '6d3bbe6e-8914-4edb-ae5e-8156c7c38c09', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d5b10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d5b1e80>]}
2022-03-02 14:25:59.802842 (MainThread): 14:25:59  
2022-03-02 14:25:59.802947 (MainThread): 14:25:59  Updates available for packages: ['Datavault-UK/dbtvault']                 
Update your versions in packages.yml, then run dbt deps
2022-03-02 14:26:00.016106 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Partial parse save file not found. Starting full parse.
2022-03-02 14:26:00.016425 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed230e20>]}
2022-03-02 14:26:00.366278 (Thread-32): handling poll request
2022-03-02 14:26:00.366650 (Thread-32): 14:26:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec19ac70>]}
2022-03-02 14:26:00.367309 (Thread-32): sending response (<Response 1991 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:00.550983 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters.sql
2022-03-02 14:26:00.588694 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/catalog.sql
2022-03-02 14:26:00.590543 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/table.sql
2022-03-02 14:26:00.593538 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/seed.sql
2022-03-02 14:26:00.598433 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/incremental.sql
2022-03-02 14:26:00.606567 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/merge.sql
2022-03-02 14:26:00.610270 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/snapshot.sql
2022-03-02 14:26:00.611231 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/view.sql
2022-03-02 14:26:00.612586 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/metadata.sql
2022-03-02 14:26:00.619568 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/columns.sql
2022-03-02 14:26:00.629626 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/freshness.sql
2022-03-02 14:26:00.632472 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/persist_docs.sql
2022-03-02 14:26:00.636684 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/relation.sql
2022-03-02 14:26:00.645903 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/schema.sql
2022-03-02 14:26:00.648096 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/adapters/indexes.sql
2022-03-02 14:26:00.650908 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-02 14:26:00.653486 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-02 14:26:00.654926 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-02 14:26:00.656513 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/etc/datetime.sql
2022-03-02 14:26:00.665194 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/etc/statement.sql
2022-03-02 14:26:00.669430 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/generic_test_sql/unique.sql
2022-03-02 14:26:00.670132 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/generic_test_sql/not_null.sql
2022-03-02 14:26:00.670671 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-02 14:26:00.672320 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/generic_test_sql/relationships.sql
2022-03-02 14:26:00.673671 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/configs.sql
2022-03-02 14:26:00.676125 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/hooks.sql
2022-03-02 14:26:00.681335 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/table/table.sql
2022-03-02 14:26:00.688308 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-02 14:26:00.691050 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-02 14:26:00.693596 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/view/helpers.sql
2022-03-02 14:26:00.694858 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-02 14:26:00.697079 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/view/view.sql
2022-03-02 14:26:00.703727 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-02 14:26:00.713170 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-02 14:26:00.727713 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-02 14:26:00.729159 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/incremental/merge.sql
2022-03-02 14:26:00.739925 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-02 14:26:00.744122 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/seeds/helpers.sql
2022-03-02 14:26:00.759561 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/seeds/seed.sql
2022-03-02 14:26:00.765350 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/tests/helpers.sql
2022-03-02 14:26:00.767019 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/tests/test.sql
2022-03-02 14:26:00.771194 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/tests/where_subquery.sql
2022-03-02 14:26:00.772933 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/snapshots/helpers.sql
2022-03-02 14:26:00.783589 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/snapshots/strategies.sql
2022-03-02 14:26:00.801103 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-02 14:26:00.802709 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-02 14:26:00.814747 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing tests/generic/builtin.sql
2022-03-02 14:26:00.817658 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/pivot.sql
2022-03-02 14:26:00.821528 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/star.sql
2022-03-02 14:26:00.825513 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_table_types_sql.sql
2022-03-02 14:26:00.826751 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/surrogate_key.sql
2022-03-02 14:26:00.830080 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-02 14:26:00.832317 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/date_spine.sql
2022-03-02 14:26:00.836307 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_column_values.sql
2022-03-02 14:26:00.841273 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/groupby.sql
2022-03-02 14:26:00.842596 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-02 14:26:00.848464 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/nullcheck_table.sql
2022-03-02 14:26:00.850051 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-02 14:26:00.851658 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-02 14:26:00.854825 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-02 14:26:00.858036 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/safe_add.sql
2022-03-02 14:26:00.859596 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/haversine_distance.sql
2022-03-02 14:26:00.865288 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/unpivot.sql
2022-03-02 14:26:00.872661 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/generate_series.sql
2022-03-02 14:26:00.876709 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/nullcheck.sql
2022-03-02 14:26:00.878294 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/sql/union.sql
2022-03-02 14:26:00.887679 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-02 14:26:00.910081 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-02 14:26:00.911271 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/jinja_helpers/slugify.sql
2022-03-02 14:26:00.912439 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/jinja_helpers/log_info.sql
2022-03-02 14:26:00.913540 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-02 14:26:00.914613 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/web/get_url_parameter.sql
2022-03-02 14:26:00.916125 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/web/get_url_path.sql
2022-03-02 14:26:00.918508 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/web/get_url_host.sql
2022-03-02 14:26:00.920397 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/expression_is_true.sql
2022-03-02 14:26:00.922135 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/not_constant.sql
2022-03-02 14:26:00.923366 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/sequential_values.sql
2022-03-02 14:26:00.926427 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-02 14:26:00.928512 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/at_least_one.sql
2022-03-02 14:26:00.929735 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/equality.sql
2022-03-02 14:26:00.933164 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-02 14:26:00.934536 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-02 14:26:00.936135 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-02 14:26:00.938127 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/test_unique_where.sql
2022-03-02 14:26:00.939495 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-02 14:26:00.947736 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/relationships_where.sql
2022-03-02 14:26:00.958805 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/accepted_range.sql
2022-03-02 14:26:00.961164 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-02 14:26:00.962749 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-02 14:26:00.965459 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/recency.sql
2022-03-02 14:26:00.967127 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-02 14:26:00.969033 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/split_part.sql
2022-03-02 14:26:00.970796 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-02 14:26:00.972601 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/length.sql
2022-03-02 14:26:00.973854 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-02 14:26:00.977252 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/right.sql
2022-03-02 14:26:00.979377 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/hash.sql
2022-03-02 14:26:00.980829 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/any_value.sql
2022-03-02 14:26:00.982068 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/replace.sql
2022-03-02 14:26:00.983287 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-02 14:26:00.984699 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/bool_or.sql
2022-03-02 14:26:00.986384 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/concat.sql
2022-03-02 14:26:00.987379 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-02 14:26:00.988521 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/identifier.sql
2022-03-02 14:26:00.990183 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/datediff.sql
2022-03-02 14:26:00.999333 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:00  Parsing macros/cross_db_utils/dateadd.sql
2022-03-02 14:26:01.002075 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/datatypes.sql
2022-03-02 14:26:01.007931 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/position.sql
2022-03-02 14:26:01.009402 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/literal.sql
2022-03-02 14:26:01.010341 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-02 14:26:01.012197 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-02 14:26:01.017065 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-02 14:26:01.018484 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/except.sql
2022-03-02 14:26:01.019513 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-02 14:26:01.021479 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/last_day.sql
2022-03-02 14:26:01.024786 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/cross_db_utils/intersect.sql
2022-03-02 14:26:01.025831 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-02 14:26:01.030814 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-02 14:26:01.035901 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-02 14:26:01.053171 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-02 14:26:01.070100 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-02 14:26:01.072695 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-02 14:26:01.078850 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-02 14:26:01.081418 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/shared_helpers.sql
2022-03-02 14:26:01.083387 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-02 14:26:01.096951 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/staging/hash_columns.sql
2022-03-02 14:26:01.100522 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/staging/stage.sql
2022-03-02 14:26:01.110488 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/staging/rank_columns.sql
2022-03-02 14:26:01.118516 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/staging/derive_columns.sql
2022-03-02 14:26:01.123989 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/staging/source_columns.sql
2022-03-02 14:26:01.125191 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/alias_all.sql
2022-03-02 14:26:01.127422 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/alias.sql
2022-03-02 14:26:01.130722 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/prepend_generated_by.sql
2022-03-02 14:26:01.131123 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/stage_processing_macros.sql
2022-03-02 14:26:01.140008 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/multikey.sql
2022-03-02 14:26:01.145022 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/is_checks.sql
2022-03-02 14:26:01.147866 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/expand_column_list.sql
2022-03-02 14:26:01.150905 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/as_constant.sql
2022-03-02 14:26:01.152941 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/internal/check_required_parameters.sql
2022-03-02 14:26:01.154489 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/link.sql
2022-03-02 14:26:01.166735 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/sat.sql
2022-03-02 14:26:01.175527 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/eff_sat.sql
2022-03-02 14:26:01.188560 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/xts.sql
2022-03-02 14:26:01.195668 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/hub.sql
2022-03-02 14:26:01.206743 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/ma_sat.sql
2022-03-02 14:26:01.218717 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/pit.sql
2022-03-02 14:26:01.238273 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/bridge.sql
2022-03-02 14:26:01.272159 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/tables/t_link.sql
2022-03-02 14:26:01.277727 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/supporting/max_datetime.sql
2022-03-02 14:26:01.278749 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/supporting/current_timestamp.sql
2022-03-02 14:26:01.280453 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/supporting/prefix.sql
2022-03-02 14:26:01.285639 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/supporting/hash.sql
2022-03-02 14:26:01.292187 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  Parsing macros/supporting/datatypes.sql
2022-03-02 14:26:01.835324 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-02 14:26:01.942767 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-02 14:26:01.944104 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-02 14:26:01.954166 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-02 14:26:01.955561 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1603: static parser failed on stage/v_stg_orders.sql
2022-03-02 14:26:01.983241 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-02 14:26:01.984761 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:01  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-02 14:26:02.049183 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-02 14:26:02.050452 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-02 14:26:02.074770 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-02 14:26:02.075921 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-02 14:26:02.083735 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-02 14:26:02.084850 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-02 14:26:02.090965 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-02 14:26:02.092086 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-02 14:26:02.098816 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-02 14:26:02.099978 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-02 14:26:02.107788 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-02 14:26:02.108916 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-02 14:26:02.115046 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-02 14:26:02.116196 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-02 14:26:02.124627 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-02 14:26:02.125758 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-02 14:26:02.150993 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-02 14:26:02.152548 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-02 14:26:02.154347 (Thread-33): handling poll request
2022-03-02 14:26:02.161308 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-02 14:26:02.161617 (Thread-33): 14:26:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d9910>]}
2022-03-02 14:26:02.162779 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-02 14:26:02.163286 (Thread-33): sending response (<Response 293 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:02.171872 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-02 14:26:02.173305 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-02 14:26:02.180264 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-02 14:26:02.181428 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-02 14:26:02.188191 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-02 14:26:02.189291 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-02 14:26:02.198032 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-02 14:26:02.199129 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-02 14:26:02.205727 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-02 14:26:02.206857 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-02 14:26:02.239300 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-02 14:26:02.240524 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-02 14:26:02.249053 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-02 14:26:02.250209 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-02 14:26:02.262392 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-02 14:26:02.263552 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-02 14:26:02.273186 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-02 14:26:02.274353 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-02 14:26:02.283143 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-02 14:26:02.284335 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-02 14:26:02.293031 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-02 14:26:02.294171 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-02 14:26:02.305304 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-02 14:26:02.306486 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-02 14:26:02.317280 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-02 14:26:02.318480 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 14:26:02.328547 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 14:26:02.329712 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-02 14:26:02.339300 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-02 14:26:02.341392 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-02 14:26:02.345359 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-02 14:26:02.346918 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:26:02.352704 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:26:02.354395 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-02 14:26:02.468818 (32e87689-de15-42cf-b750-d5812b54a5f9-handler-deps): 14:26:02  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67b3550>]}
2022-03-02 14:26:03.956576 (Thread-34): handling poll request
2022-03-02 14:26:03.956949 (Thread-34): 14:26:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec06c460>]}
2022-03-02 14:26:03.957498 (Thread-34): sending response (<Response 365 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:05.051901 (Thread-35): handling status request
2022-03-02 14:26:05.052290 (Thread-35): 14:26:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6782a30>]}
2022-03-02 14:26:05.053031 (Thread-35): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:05.358809 (Thread-36): handling status request
2022-03-02 14:26:05.359170 (Thread-36): 14:26:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be674fd90>]}
2022-03-02 14:26:05.359962 (Thread-36): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:05.370390 (Thread-37): handling status request
2022-03-02 14:26:05.370726 (Thread-37): 14:26:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6743c10>]}
2022-03-02 14:26:05.371428 (Thread-37): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:21.757982 (Thread-38): handling status request
2022-03-02 14:26:21.758351 (Thread-38): 14:26:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec055730>]}
2022-03-02 14:26:21.759057 (Thread-38): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:22.230178 (Thread-39): handling status request
2022-03-02 14:26:22.230549 (Thread-39): 14:26:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66fd850>]}
2022-03-02 14:26:22.253529 (Thread-39): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:22.547777 (Thread-40): handling cli_args request
2022-03-02 14:26:22.548154 (Thread-40): 14:26:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec04b580>]}
2022-03-02 14:26:24.701886 (Thread-40): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:25.190385 (MainThread): 14:26:25  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:26:25.190835 (MainThread): 14:26:25  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:26:25.198283 (MainThread): 14:26:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b804c4c10>]}
2022-03-02 14:26:25.230713 (MainThread): 14:26:25  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b80e1ebe0>]}
2022-03-02 14:26:25.230979 (MainThread): 14:26:25  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:26:25.233130 (MainThread): 14:26:25  
2022-03-02 14:26:25.233431 (MainThread): 14:26:25  Acquiring new snowflake connection "master"
2022-03-02 14:26:25.235397 (ThreadPoolExecutor-0_0): 14:26:25  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:26:25.248077 (ThreadPoolExecutor-0_0): 14:26:25  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:26:25.248185 (ThreadPoolExecutor-0_0): 14:26:25  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:26:25.248268 (ThreadPoolExecutor-0_0): 14:26:25  Opening a new connection, currently in state init
2022-03-02 14:26:25.507952 (Thread-41): handling poll request
2022-03-02 14:26:25.508405 (Thread-41): 14:26:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2307c0>]}
2022-03-02 14:26:25.509297 (Thread-41): sending response (<Response 4125 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:26.501614 (ThreadPoolExecutor-0_0): 14:26:26  SQL status: SUCCESS 6 in 1.25 seconds
2022-03-02 14:26:26.503581 (ThreadPoolExecutor-0_0): 14:26:26  On list_DBT_RAW: Close
2022-03-02 14:26:26.724514 (ThreadPoolExecutor-0_0): 14:26:26  Acquiring new snowflake connection "create_DBT_RAW_DBT_VAULT"
2022-03-02 14:26:26.724953 (ThreadPoolExecutor-0_0): 14:26:26  Acquiring new snowflake connection "create_DBT_RAW_DBT_VAULT"
2022-03-02 14:26:26.725323 (ThreadPoolExecutor-0_0): 14:26:26  Creating schema "_ReferenceKey(database='dbt_raw', schema='dbt_vault', identifier=None)"
2022-03-02 14:26:26.735901 (ThreadPoolExecutor-0_0): 14:26:26  Using snowflake connection "create_DBT_RAW_DBT_VAULT"
2022-03-02 14:26:26.736087 (ThreadPoolExecutor-0_0): 14:26:26  On create_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "create_DBT_RAW_DBT_VAULT"} */
create schema if not exists DBT_RAW.DBT_VAULT
2022-03-02 14:26:26.736263 (ThreadPoolExecutor-0_0): 14:26:26  Opening a new connection, currently in state closed
2022-03-02 14:26:27.333009 (Thread-42): handling poll request
2022-03-02 14:26:27.333428 (Thread-42): 14:26:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be482f2b0>]}
2022-03-02 14:26:27.334026 (Thread-42): sending response (<Response 2955 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:27.697551 (ThreadPoolExecutor-0_0): 14:26:27  SQL status: SUCCESS 1 in 0.96 seconds
2022-03-02 14:26:27.698428 (ThreadPoolExecutor-0_0): 14:26:27  On create_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:26:27.900029 (ThreadPoolExecutor-2_0): 14:26:27  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:26:27.906854 (ThreadPoolExecutor-2_0): 14:26:27  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:26:27.906992 (ThreadPoolExecutor-2_0): 14:26:27  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:26:27.907077 (ThreadPoolExecutor-2_0): 14:26:27  Opening a new connection, currently in state closed
2022-03-02 14:26:28.844347 (ThreadPoolExecutor-2_0): 14:26:28  SQL status: SUCCESS 0 in 0.94 seconds
2022-03-02 14:26:28.845580 (ThreadPoolExecutor-2_0): 14:26:28  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:26:29.099897 (MainThread): 14:26:29  Concurrency: 4 threads (target='default')
2022-03-02 14:26:29.100076 (MainThread): 14:26:29  
2022-03-02 14:26:29.102645 (Thread-4): 14:26:29  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:26:29.102996 (Thread-4): 14:26:29  1 of 31 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:26:29.103267 (Thread-4): 14:26:29  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:26:29.103370 (Thread-4): 14:26:29  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:26:29.103483 (Thread-4): 14:26:29  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:26:29.104256 (Thread-5): 14:26:29  Began running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 14:26:29.104485 (Thread-5): 14:26:29  2 of 31 START table model DBT_VAULT.raw_transactions............................ [RUN]
2022-03-02 14:26:29.104735 (Thread-5): 14:26:29  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 14:26:29.104818 (Thread-5): 14:26:29  Began compiling node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 14:26:29.104898 (Thread-5): 14:26:29  Compiling model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 14:26:29.108152 (Thread-5): 14:26:29  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 14:26:29.113729 (Thread-4): 14:26:29  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:26:29.130734 (Thread-43): handling poll request
2022-03-02 14:26:29.131040 (Thread-43): 14:26:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec051910>]}
2022-03-02 14:26:29.131819 (Thread-43): sending response (<Response 9098 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:29.147422 (Thread-4): 14:26:29  finished collecting timing info
2022-03-02 14:26:29.147625 (Thread-4): 14:26:29  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:26:29.152834 (Thread-5): 14:26:29  finished collecting timing info
2022-03-02 14:26:29.152988 (Thread-5): 14:26:29  Began executing node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 14:26:29.184861 (Thread-4): 14:26:29  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:26:29.185328 (Thread-5): 14:26:29  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 14:26:29.217330 (Thread-5): 14:26:29  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 14:26:29.217467 (Thread-5): 14:26:29  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_transactions  as
      (SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:26:29.217558 (Thread-5): 14:26:29  Opening a new connection, currently in state init
2022-03-02 14:26:29.222378 (Thread-4): 14:26:29  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:26:29.222506 (Thread-4): 14:26:29  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:26:29.222591 (Thread-4): 14:26:29  Opening a new connection, currently in state closed
2022-03-02 14:26:30.941839 (Thread-44): handling poll request
2022-03-02 14:26:30.942197 (Thread-44): 14:26:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec051dc0>]}
2022-03-02 14:26:30.942823 (Thread-44): sending response (<Response 8184 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:32.742208 (Thread-45): handling poll request
2022-03-02 14:26:32.742575 (Thread-45): 14:26:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6749610>]}
2022-03-02 14:26:32.743454 (Thread-45): sending response (<Response 292 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:33.460834 (Thread-5): 14:26:33  SQL status: SUCCESS 1 in 4.24 seconds
2022-03-02 14:26:33.470034 (Thread-5): 14:26:33  finished collecting timing info
2022-03-02 14:26:33.470196 (Thread-5): 14:26:33  On model.dbtvault_snowflake_demo.raw_transactions: Close
2022-03-02 14:26:33.740113 (Thread-5): 14:26:33  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b1ccaf0>]}
2022-03-02 14:26:33.740548 (Thread-5): 14:26:33  2 of 31 OK created table model DBT_VAULT.raw_transactions....................... [SUCCESS 1 in 4.64s]
2022-03-02 14:26:33.740678 (Thread-5): 14:26:33  Finished running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 14:26:33.741499 (Thread-7): 14:26:33  Began running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 14:26:33.741790 (Thread-7): 14:26:33  3 of 31 START table model DBT_VAULT.v_stg_transactions.......................... [RUN]
2022-03-02 14:26:33.742075 (Thread-7): 14:26:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 14:26:33.742169 (Thread-7): 14:26:33  Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 14:26:33.742261 (Thread-7): 14:26:33  Compiling model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 14:26:33.775516 (Thread-7): 14:26:33  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 14:26:33.775658 (Thread-7): 14:26:33  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-02 14:26:33.775746 (Thread-7): 14:26:33  Opening a new connection, currently in state init
2022-03-02 14:26:34.542390 (Thread-46): handling poll request
2022-03-02 14:26:34.542741 (Thread-46): 14:26:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6734a30>]}
2022-03-02 14:26:34.543390 (Thread-46): sending response (<Response 6442 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:34.538594 (Thread-7): 14:26:34  SQL status: SUCCESS 7 in 0.76 seconds
2022-03-02 14:26:34.566986 (Thread-7): 14:26:34  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 14:26:34.567142 (Thread-7): 14:26:34  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-02 14:26:34.948256 (Thread-7): 14:26:34  SQL status: SUCCESS 7 in 0.38 seconds
2022-03-02 14:26:34.980659 (Thread-7): 14:26:34  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 14:26:34.996660 (Thread-7): 14:26:34  finished collecting timing info
2022-03-02 14:26:34.996842 (Thread-7): 14:26:34  Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 14:26:34.999191 (Thread-7): 14:26:34  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 14:26:35.016920 (Thread-7): 14:26:35  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 14:26:35.017050 (Thread-7): 14:26:35  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_transactions  as
      (







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM DBT_RAW.DBT_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
      );
2022-03-02 14:26:36.306704 (Thread-7): 14:26:36  SQL status: SUCCESS 1 in 1.29 seconds
2022-03-02 14:26:36.308177 (Thread-7): 14:26:36  finished collecting timing info
2022-03-02 14:26:36.308341 (Thread-7): 14:26:36  On model.dbtvault_snowflake_demo.v_stg_transactions: Close
2022-03-02 14:26:36.337060 (Thread-47): handling poll request
2022-03-02 14:26:36.337413 (Thread-47): 14:26:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec059c40>]}
2022-03-02 14:26:36.338070 (Thread-47): sending response (<Response 7449 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:36.492038 (Thread-7): 14:26:36  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b804804f0>]}
2022-03-02 14:26:36.492457 (Thread-7): 14:26:36  3 of 31 OK created table model DBT_VAULT.v_stg_transactions..................... [SUCCESS 1 in 2.75s]
2022-03-02 14:26:36.492585 (Thread-7): 14:26:36  Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 14:26:36.493372 (Thread-5): 14:26:36  Began running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 14:26:36.493662 (Thread-5): 14:26:36  4 of 31 START incremental model DBT_VAULT.t_link_transactions................... [RUN]
2022-03-02 14:26:36.493930 (Thread-5): 14:26:36  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 14:26:36.494041 (Thread-5): 14:26:36  Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 14:26:36.494131 (Thread-5): 14:26:36  Compiling model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 14:26:36.554438 (Thread-5): 14:26:36  Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 14:26:36.574907 (Thread-5): 14:26:36  finished collecting timing info
2022-03-02 14:26:36.575098 (Thread-5): 14:26:36  Began executing node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 14:26:36.600015 (Thread-5): 14:26:36  Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 14:26:36.622438 (Thread-5): 14:26:36  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 14:26:36.622587 (Thread-5): 14:26:36  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.t_link_transactions  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:36.622678 (Thread-5): 14:26:36  Opening a new connection, currently in state closed
2022-03-02 14:26:38.105721 (Thread-4): 14:26:38  SQL status: SUCCESS 1 in 8.88 seconds
2022-03-02 14:26:38.107180 (Thread-4): 14:26:38  finished collecting timing info
2022-03-02 14:26:38.107343 (Thread-4): 14:26:38  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:26:38.142584 (Thread-48): handling poll request
2022-03-02 14:26:38.142936 (Thread-48): 14:26:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0509d0>]}
2022-03-02 14:26:38.143665 (Thread-48): sending response (<Response 8780 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:38.325294 (Thread-4): 14:26:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b1ce6d0>]}
2022-03-02 14:26:38.325719 (Thread-4): 14:26:38  1 of 31 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 9.22s]
2022-03-02 14:26:38.325846 (Thread-4): 14:26:38  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:26:38.326606 (Thread-7): 14:26:38  Began running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 14:26:38.326879 (Thread-7): 14:26:38  5 of 31 START table model DBT_VAULT.raw_inventory............................... [RUN]
2022-03-02 14:26:38.327139 (Thread-7): 14:26:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 14:26:38.327268 (Thread-7): 14:26:38  Began compiling node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 14:26:38.327361 (Thread-7): 14:26:38  Compiling model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 14:26:38.332217 (Thread-7): 14:26:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 14:26:38.332802 (Thread-6): 14:26:38  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:26:38.333160 (Thread-6): 14:26:38  6 of 31 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:26:38.333574 (Thread-6): 14:26:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:26:38.333728 (Thread-6): 14:26:38  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:26:38.333875 (Thread-6): 14:26:38  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:26:38.357974 (Thread-7): 14:26:38  finished collecting timing info
2022-03-02 14:26:38.358120 (Thread-7): 14:26:38  Began executing node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 14:26:38.360228 (Thread-7): 14:26:38  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 14:26:38.360489 (Thread-6): 14:26:38  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:26:38.360664 (Thread-6): 14:26:38  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:26:38.360811 (Thread-6): 14:26:38  Opening a new connection, currently in state init
2022-03-02 14:26:38.370852 (Thread-7): 14:26:38  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 14:26:38.370968 (Thread-7): 14:26:38  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_inventory  as
      (SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DBT_RAW.DBT_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
      );
2022-03-02 14:26:38.371049 (Thread-7): 14:26:38  Opening a new connection, currently in state closed
2022-03-02 14:26:38.765096 (Thread-5): 14:26:38  SQL status: SUCCESS 1 in 2.14 seconds
2022-03-02 14:26:38.766583 (Thread-5): 14:26:38  finished collecting timing info
2022-03-02 14:26:38.766751 (Thread-5): 14:26:38  On model.dbtvault_snowflake_demo.t_link_transactions: Close
2022-03-02 14:26:39.002684 (Thread-5): 14:26:39  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b78029190>]}
2022-03-02 14:26:39.003106 (Thread-5): 14:26:39  4 of 31 OK created incremental model DBT_VAULT.t_link_transactions.............. [SUCCESS 1 in 2.51s]
2022-03-02 14:26:39.003234 (Thread-5): 14:26:39  Finished running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 14:26:39.426202 (Thread-6): 14:26:39  SQL status: SUCCESS 36 in 1.07 seconds
2022-03-02 14:26:39.433184 (Thread-6): 14:26:39  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:26:39.433319 (Thread-6): 14:26:39  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:26:39.544586 (Thread-6): 14:26:39  SQL status: SUCCESS 36 in 0.11 seconds
2022-03-02 14:26:39.565054 (Thread-6): 14:26:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:26:39.587214 (Thread-6): 14:26:39  finished collecting timing info
2022-03-02 14:26:39.587402 (Thread-6): 14:26:39  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:26:39.589951 (Thread-6): 14:26:39  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:26:39.618655 (Thread-6): 14:26:39  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:26:39.618792 (Thread-6): 14:26:39  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:26:39.936751 (Thread-49): handling poll request
2022-03-02 14:26:39.937110 (Thread-49): 14:26:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be672eb50>]}
2022-03-02 14:26:39.938059 (Thread-49): sending response (<Response 28821 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:41.537061 (Thread-6): 14:26:41  SQL status: SUCCESS 1 in 1.92 seconds
2022-03-02 14:26:41.538492 (Thread-6): 14:26:41  finished collecting timing info
2022-03-02 14:26:41.538649 (Thread-6): 14:26:41  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:26:41.742427 (Thread-50): handling poll request
2022-03-02 14:26:41.742813 (Thread-50): 14:26:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d1c70>]}
2022-03-02 14:26:41.743349 (Thread-50): sending response (<Response 1456 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:41.992440 (Thread-6): 14:26:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7a99ea90>]}
2022-03-02 14:26:41.992864 (Thread-6): 14:26:41  6 of 31 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.66s]
2022-03-02 14:26:41.992988 (Thread-6): 14:26:41  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:26:41.994055 (Thread-4): 14:26:41  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:26:41.994332 (Thread-4): 14:26:41  7 of 31 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 14:26:41.994600 (Thread-4): 14:26:41  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:26:41.994697 (Thread-4): 14:26:41  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:26:41.994789 (Thread-4): 14:26:41  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:26:41.999121 (Thread-5): 14:26:41  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:26:41.999366 (Thread-5): 14:26:41  8 of 31 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 14:26:41.999652 (Thread-5): 14:26:41  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:26:41.999779 (Thread-5): 14:26:41  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:26:41.999875 (Thread-5): 14:26:41  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:26:42.009260 (Thread-6): 14:26:42  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:26:42.009596 (Thread-6): 14:26:42  9 of 31 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 14:26:42.009842 (Thread-6): 14:26:42  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:26:42.009929 (Thread-6): 14:26:42  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:26:42.010009 (Thread-6): 14:26:42  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:26:42.059700 (Thread-4): 14:26:42  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:26:42.062327 (Thread-5): 14:26:42  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:26:42.064151 (Thread-6): 14:26:42  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:26:42.078634 (Thread-4): 14:26:42  finished collecting timing info
2022-03-02 14:26:42.078845 (Thread-4): 14:26:42  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:26:42.082088 (Thread-4): 14:26:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:26:42.082668 (Thread-5): 14:26:42  finished collecting timing info
2022-03-02 14:26:42.082831 (Thread-5): 14:26:42  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:26:42.085298 (Thread-5): 14:26:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:26:42.086869 (Thread-6): 14:26:42  finished collecting timing info
2022-03-02 14:26:42.087018 (Thread-6): 14:26:42  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:26:42.089631 (Thread-6): 14:26:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:26:42.102019 (Thread-4): 14:26:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:26:42.102153 (Thread-4): 14:26:42  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:42.102243 (Thread-4): 14:26:42  Opening a new connection, currently in state closed
2022-03-02 14:26:42.107765 (Thread-5): 14:26:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:26:42.107899 (Thread-5): 14:26:42  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:42.107994 (Thread-5): 14:26:42  Opening a new connection, currently in state closed
2022-03-02 14:26:42.110573 (Thread-6): 14:26:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:26:42.110692 (Thread-6): 14:26:42  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:42.110773 (Thread-6): 14:26:42  Opening a new connection, currently in state closed
2022-03-02 14:26:43.028164 (Thread-7): 14:26:43  SQL status: SUCCESS 1 in 4.66 seconds
2022-03-02 14:26:43.029623 (Thread-7): 14:26:43  finished collecting timing info
2022-03-02 14:26:43.029802 (Thread-7): 14:26:43  On model.dbtvault_snowflake_demo.raw_inventory: Close
2022-03-02 14:26:43.213541 (Thread-7): 14:26:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56fe1c40>]}
2022-03-02 14:26:43.213964 (Thread-7): 14:26:43  5 of 31 OK created table model DBT_VAULT.raw_inventory.......................... [SUCCESS 1 in 4.89s]
2022-03-02 14:26:43.214093 (Thread-7): 14:26:43  Finished running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 14:26:43.214244 (Thread-7): 14:26:43  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:26:43.214427 (Thread-7): 14:26:43  10 of 31 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 14:26:43.214670 (Thread-7): 14:26:43  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:26:43.214760 (Thread-7): 14:26:43  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:26:43.214848 (Thread-7): 14:26:43  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:26:43.241238 (Thread-7): 14:26:43  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:26:43.256166 (Thread-7): 14:26:43  finished collecting timing info
2022-03-02 14:26:43.256343 (Thread-7): 14:26:43  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:26:43.259311 (Thread-7): 14:26:43  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:26:43.276570 (Thread-7): 14:26:43  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:26:43.276711 (Thread-7): 14:26:43  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:43.276804 (Thread-7): 14:26:43  Opening a new connection, currently in state closed
2022-03-02 14:26:43.542185 (Thread-51): handling poll request
2022-03-02 14:26:43.542543 (Thread-51): 14:26:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66eaf70>]}
2022-03-02 14:26:43.543758 (Thread-51): sending response (<Response 27177 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:44.148163 (Thread-4): 14:26:44  SQL status: SUCCESS 1 in 2.05 seconds
2022-03-02 14:26:44.149694 (Thread-4): 14:26:44  finished collecting timing info
2022-03-02 14:26:44.149877 (Thread-4): 14:26:44  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 14:26:44.263372 (Thread-5): 14:26:44  SQL status: SUCCESS 1 in 2.16 seconds
2022-03-02 14:26:44.265086 (Thread-5): 14:26:44  finished collecting timing info
2022-03-02 14:26:44.265303 (Thread-5): 14:26:44  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 14:26:44.298513 (Thread-6): 14:26:44  SQL status: SUCCESS 1 in 2.19 seconds
2022-03-02 14:26:44.299952 (Thread-6): 14:26:44  finished collecting timing info
2022-03-02 14:26:44.300097 (Thread-6): 14:26:44  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 14:26:44.362715 (Thread-4): 14:26:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f71550>]}
2022-03-02 14:26:44.363118 (Thread-4): 14:26:44  7 of 31 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 2.37s]
2022-03-02 14:26:44.363244 (Thread-4): 14:26:44  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:26:44.363383 (Thread-4): 14:26:44  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:26:44.363561 (Thread-4): 14:26:44  11 of 31 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 14:26:44.363834 (Thread-4): 14:26:44  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:26:44.363926 (Thread-4): 14:26:44  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:26:44.364016 (Thread-4): 14:26:44  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:26:44.371574 (Thread-4): 14:26:44  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:26:44.380437 (Thread-4): 14:26:44  finished collecting timing info
2022-03-02 14:26:44.380583 (Thread-4): 14:26:44  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:26:44.383374 (Thread-4): 14:26:44  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:26:44.393737 (Thread-4): 14:26:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:26:44.393853 (Thread-4): 14:26:44  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:44.393940 (Thread-4): 14:26:44  Opening a new connection, currently in state closed
2022-03-02 14:26:44.481248 (Thread-5): 14:26:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f31610>]}
2022-03-02 14:26:44.481671 (Thread-5): 14:26:44  8 of 31 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 2.48s]
2022-03-02 14:26:44.481804 (Thread-5): 14:26:44  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:26:44.481941 (Thread-5): 14:26:44  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:26:44.482118 (Thread-5): 14:26:44  12 of 31 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 14:26:44.482358 (Thread-5): 14:26:44  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:26:44.482447 (Thread-5): 14:26:44  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:26:44.482536 (Thread-5): 14:26:44  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:26:44.489597 (Thread-5): 14:26:44  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:26:44.494100 (Thread-6): 14:26:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f72190>]}
2022-03-02 14:26:44.494405 (Thread-6): 14:26:44  9 of 31 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 2.48s]
2022-03-02 14:26:44.494516 (Thread-6): 14:26:44  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:26:44.494645 (Thread-6): 14:26:44  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:26:44.494811 (Thread-6): 14:26:44  13 of 31 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 14:26:44.495021 (Thread-6): 14:26:44  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:26:44.495105 (Thread-6): 14:26:44  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:26:44.495187 (Thread-6): 14:26:44  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:26:44.502026 (Thread-6): 14:26:44  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:26:44.507266 (Thread-5): 14:26:44  finished collecting timing info
2022-03-02 14:26:44.507401 (Thread-5): 14:26:44  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:26:44.509994 (Thread-5): 14:26:44  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:26:44.514966 (Thread-6): 14:26:44  finished collecting timing info
2022-03-02 14:26:44.515107 (Thread-6): 14:26:44  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:26:44.518680 (Thread-6): 14:26:44  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:26:44.524426 (Thread-5): 14:26:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:26:44.524542 (Thread-5): 14:26:44  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:44.524630 (Thread-5): 14:26:44  Opening a new connection, currently in state closed
2022-03-02 14:26:44.529807 (Thread-6): 14:26:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:26:44.529921 (Thread-6): 14:26:44  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:44.530004 (Thread-6): 14:26:44  Opening a new connection, currently in state closed
2022-03-02 14:26:45.130266 (Thread-7): 14:26:45  SQL status: SUCCESS 1 in 1.85 seconds
2022-03-02 14:26:45.131827 (Thread-7): 14:26:45  finished collecting timing info
2022-03-02 14:26:45.131984 (Thread-7): 14:26:45  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 14:26:45.340090 (Thread-52): handling poll request
2022-03-02 14:26:45.340462 (Thread-52): 14:26:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6701430>]}
2022-03-02 14:26:45.341502 (Thread-52): sending response (<Response 27244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:45.438053 (Thread-7): 14:26:45  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56e3ecd0>]}
2022-03-02 14:26:45.438482 (Thread-7): 14:26:45  10 of 31 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 2.22s]
2022-03-02 14:26:45.438611 (Thread-7): 14:26:45  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:26:45.438760 (Thread-7): 14:26:45  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:26:45.438969 (Thread-7): 14:26:45  14 of 31 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 14:26:45.439218 (Thread-7): 14:26:45  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:26:45.439305 (Thread-7): 14:26:45  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:26:45.439394 (Thread-7): 14:26:45  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:26:45.473422 (Thread-7): 14:26:45  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:26:45.489451 (Thread-7): 14:26:45  finished collecting timing info
2022-03-02 14:26:45.489633 (Thread-7): 14:26:45  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:26:45.493584 (Thread-7): 14:26:45  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:26:45.537993 (Thread-7): 14:26:45  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:26:45.538167 (Thread-7): 14:26:45  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:45.538264 (Thread-7): 14:26:45  Opening a new connection, currently in state closed
2022-03-02 14:26:46.276997 (Thread-4): 14:26:46  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-02 14:26:46.278522 (Thread-4): 14:26:46  finished collecting timing info
2022-03-02 14:26:46.278681 (Thread-4): 14:26:46  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 14:26:46.495682 (Thread-4): 14:26:46  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56eecc40>]}
2022-03-02 14:26:46.496119 (Thread-4): 14:26:46  11 of 31 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 2.13s]
2022-03-02 14:26:46.496245 (Thread-4): 14:26:46  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:26:46.496452 (Thread-4): 14:26:46  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:26:46.496771 (Thread-4): 14:26:46  15 of 31 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 14:26:46.497030 (Thread-4): 14:26:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:26:46.497132 (Thread-4): 14:26:46  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:26:46.497265 (Thread-4): 14:26:46  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:26:46.508302 (Thread-4): 14:26:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:26:46.518672 (Thread-4): 14:26:46  finished collecting timing info
2022-03-02 14:26:46.518824 (Thread-4): 14:26:46  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:26:46.521612 (Thread-4): 14:26:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:26:46.531080 (Thread-6): 14:26:46  SQL status: SUCCESS 1 in 2.0 seconds
2022-03-02 14:26:46.532530 (Thread-6): 14:26:46  finished collecting timing info
2022-03-02 14:26:46.532691 (Thread-6): 14:26:46  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 14:26:46.555171 (Thread-4): 14:26:46  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:26:46.555333 (Thread-4): 14:26:46  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:46.555428 (Thread-4): 14:26:46  Opening a new connection, currently in state closed
2022-03-02 14:26:46.732181 (Thread-5): 14:26:46  SQL status: SUCCESS 1 in 2.21 seconds
2022-03-02 14:26:46.733711 (Thread-5): 14:26:46  finished collecting timing info
2022-03-02 14:26:46.733872 (Thread-5): 14:26:46  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 14:26:46.749975 (Thread-6): 14:26:46  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56ef7a30>]}
2022-03-02 14:26:46.750359 (Thread-6): 14:26:46  13 of 31 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 2.25s]
2022-03-02 14:26:46.750482 (Thread-6): 14:26:46  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:26:46.750627 (Thread-6): 14:26:46  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:26:46.750816 (Thread-6): 14:26:46  16 of 31 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 14:26:46.751050 (Thread-6): 14:26:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:26:46.751138 (Thread-6): 14:26:46  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:26:46.751227 (Thread-6): 14:26:46  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:26:46.762593 (Thread-6): 14:26:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:26:46.778285 (Thread-6): 14:26:46  finished collecting timing info
2022-03-02 14:26:46.778466 (Thread-6): 14:26:46  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:26:46.868506 (Thread-6): 14:26:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:26:46.925519 (Thread-6): 14:26:46  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:26:46.925692 (Thread-6): 14:26:46  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:46.925785 (Thread-6): 14:26:46  Opening a new connection, currently in state closed
2022-03-02 14:26:47.024453 (Thread-5): 14:26:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56ef8df0>]}
2022-03-02 14:26:47.024860 (Thread-5): 14:26:47  12 of 31 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.54s]
2022-03-02 14:26:47.024989 (Thread-5): 14:26:47  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:26:47.025128 (Thread-5): 14:26:47  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:26:47.025310 (Thread-5): 14:26:47  17 of 31 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 14:26:47.025540 (Thread-5): 14:26:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:26:47.025626 (Thread-5): 14:26:47  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:26:47.025758 (Thread-5): 14:26:47  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:26:47.039246 (Thread-5): 14:26:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:26:47.050671 (Thread-5): 14:26:47  finished collecting timing info
2022-03-02 14:26:47.050850 (Thread-5): 14:26:47  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:26:47.053627 (Thread-5): 14:26:47  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:26:47.068059 (Thread-5): 14:26:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:26:47.068179 (Thread-5): 14:26:47  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:47.068266 (Thread-5): 14:26:47  Opening a new connection, currently in state closed
2022-03-02 14:26:47.121284 (Thread-7): 14:26:47  SQL status: SUCCESS 1 in 1.58 seconds
2022-03-02 14:26:47.122743 (Thread-7): 14:26:47  finished collecting timing info
2022-03-02 14:26:47.122899 (Thread-7): 14:26:47  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 14:26:47.126087 (Thread-53): handling poll request
2022-03-02 14:26:47.126402 (Thread-53): 14:26:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67980a0>]}
2022-03-02 14:26:47.127549 (Thread-53): sending response (<Response 35505 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:47.420052 (Thread-7): 14:26:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f324f0>]}
2022-03-02 14:26:47.420469 (Thread-7): 14:26:47  14 of 31 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 1.98s]
2022-03-02 14:26:47.420597 (Thread-7): 14:26:47  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:26:47.420738 (Thread-7): 14:26:47  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:26:47.420916 (Thread-7): 14:26:47  18 of 31 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 14:26:47.421141 (Thread-7): 14:26:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:26:47.421229 (Thread-7): 14:26:47  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:26:47.421320 (Thread-7): 14:26:47  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:26:47.433351 (Thread-7): 14:26:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:26:47.443207 (Thread-7): 14:26:47  finished collecting timing info
2022-03-02 14:26:47.443352 (Thread-7): 14:26:47  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:26:47.446152 (Thread-7): 14:26:47  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:26:47.456559 (Thread-7): 14:26:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:26:47.456674 (Thread-7): 14:26:47  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:47.456760 (Thread-7): 14:26:47  Opening a new connection, currently in state closed
2022-03-02 14:26:48.202821 (Thread-4): 14:26:48  SQL status: SUCCESS 1 in 1.65 seconds
2022-03-02 14:26:48.204374 (Thread-4): 14:26:48  finished collecting timing info
2022-03-02 14:26:48.204538 (Thread-4): 14:26:48  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 14:26:48.460960 (Thread-4): 14:26:48  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b55e21250>]}
2022-03-02 14:26:48.461388 (Thread-4): 14:26:48  15 of 31 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 1.96s]
2022-03-02 14:26:48.461516 (Thread-4): 14:26:48  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:26:48.461681 (Thread-4): 14:26:48  Began running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 14:26:48.461883 (Thread-4): 14:26:48  19 of 31 START table model DBT_VAULT.v_stg_inventory............................ [RUN]
2022-03-02 14:26:48.462122 (Thread-4): 14:26:48  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 14:26:48.462209 (Thread-4): 14:26:48  Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 14:26:48.462314 (Thread-4): 14:26:48  Compiling model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 14:26:48.474834 (Thread-4): 14:26:48  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 14:26:48.474980 (Thread-4): 14:26:48  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-02 14:26:48.475068 (Thread-4): 14:26:48  Opening a new connection, currently in state closed
2022-03-02 14:26:48.555279 (Thread-5): 14:26:48  SQL status: SUCCESS 1 in 1.49 seconds
2022-03-02 14:26:48.557516 (Thread-5): 14:26:48  finished collecting timing info
2022-03-02 14:26:48.557751 (Thread-5): 14:26:48  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 14:26:48.815362 (Thread-5): 14:26:48  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f48cd0>]}
2022-03-02 14:26:48.815845 (Thread-5): 14:26:48  17 of 31 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 1.79s]
2022-03-02 14:26:48.815989 (Thread-5): 14:26:48  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:26:48.910150 (Thread-6): 14:26:48  SQL status: SUCCESS 1 in 1.98 seconds
2022-03-02 14:26:48.911711 (Thread-6): 14:26:48  finished collecting timing info
2022-03-02 14:26:48.911879 (Thread-6): 14:26:48  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 14:26:48.927502 (Thread-54): handling poll request
2022-03-02 14:26:48.927873 (Thread-54): 14:26:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67786a0>]}
2022-03-02 14:26:48.928688 (Thread-54): sending response (<Response 17861 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:49.149524 (Thread-6): 14:26:49  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56e794c0>]}
2022-03-02 14:26:49.149951 (Thread-6): 14:26:49  16 of 31 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.40s]
2022-03-02 14:26:49.150092 (Thread-6): 14:26:49  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:26:49.227312 (Thread-7): 14:26:49  SQL status: SUCCESS 1 in 1.77 seconds
2022-03-02 14:26:49.228766 (Thread-7): 14:26:49  finished collecting timing info
2022-03-02 14:26:49.228911 (Thread-7): 14:26:49  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 14:26:49.288604 (Thread-4): 14:26:49  SQL status: SUCCESS 24 in 0.81 seconds
2022-03-02 14:26:49.294629 (Thread-4): 14:26:49  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 14:26:49.294747 (Thread-4): 14:26:49  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-02 14:26:49.428404 (Thread-4): 14:26:49  SQL status: SUCCESS 24 in 0.13 seconds
2022-03-02 14:26:49.442420 (Thread-4): 14:26:49  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 14:26:49.450262 (Thread-7): 14:26:49  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f484f0>]}
2022-03-02 14:26:49.450614 (Thread-7): 14:26:49  18 of 31 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 2.03s]
2022-03-02 14:26:49.450733 (Thread-7): 14:26:49  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:26:49.462326 (Thread-4): 14:26:49  finished collecting timing info
2022-03-02 14:26:49.462477 (Thread-4): 14:26:49  Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 14:26:49.465034 (Thread-4): 14:26:49  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 14:26:49.493876 (Thread-4): 14:26:49  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 14:26:49.494013 (Thread-4): 14:26:49  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_inventory  as
      (








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
      );
2022-03-02 14:26:50.739531 (Thread-55): handling poll request
2022-03-02 14:26:50.739947 (Thread-55): 14:26:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6778ca0>]}
2022-03-02 14:26:50.740623 (Thread-55): sending response (<Response 15676 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:51.123264 (Thread-4): 14:26:51  SQL status: SUCCESS 1 in 1.63 seconds
2022-03-02 14:26:51.124772 (Thread-4): 14:26:51  finished collecting timing info
2022-03-02 14:26:51.124932 (Thread-4): 14:26:51  On model.dbtvault_snowflake_demo.v_stg_inventory: Close
2022-03-02 14:26:51.345349 (Thread-4): 14:26:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b1e0ee0>]}
2022-03-02 14:26:51.345759 (Thread-4): 14:26:51  19 of 31 OK created table model DBT_VAULT.v_stg_inventory....................... [SUCCESS 1 in 2.88s]
2022-03-02 14:26:51.345883 (Thread-4): 14:26:51  Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 14:26:51.347059 (Thread-5): 14:26:51  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:26:51.347352 (Thread-5): 14:26:51  20 of 31 START incremental model DBT_VAULT.hub_nation........................... [RUN]
2022-03-02 14:26:51.347646 (Thread-5): 14:26:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:26:51.347750 (Thread-5): 14:26:51  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:26:51.347841 (Thread-5): 14:26:51  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:26:51.352118 (Thread-6): 14:26:51  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:26:51.352344 (Thread-6): 14:26:51  21 of 31 START incremental model DBT_VAULT.hub_part............................. [RUN]
2022-03-02 14:26:51.352581 (Thread-6): 14:26:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:26:51.352669 (Thread-6): 14:26:51  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:26:51.352751 (Thread-6): 14:26:51  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:26:51.362292 (Thread-7): 14:26:51  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:26:51.362502 (Thread-7): 14:26:51  22 of 31 START incremental model DBT_VAULT.hub_region........................... [RUN]
2022-03-02 14:26:51.362731 (Thread-7): 14:26:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:26:51.362815 (Thread-7): 14:26:51  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:26:51.362897 (Thread-7): 14:26:51  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:26:51.371178 (Thread-6): 14:26:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:26:51.375762 (Thread-7): 14:26:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:26:51.376999 (Thread-5): 14:26:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:26:51.377216 (Thread-4): 14:26:51  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:26:51.377442 (Thread-4): 14:26:51  23 of 31 START incremental model DBT_VAULT.hub_supplier......................... [RUN]
2022-03-02 14:26:51.377666 (Thread-4): 14:26:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:26:51.377752 (Thread-4): 14:26:51  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:26:51.377835 (Thread-4): 14:26:51  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:26:51.386205 (Thread-4): 14:26:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:26:51.392752 (Thread-5): 14:26:51  finished collecting timing info
2022-03-02 14:26:51.392942 (Thread-5): 14:26:51  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:26:51.395745 (Thread-5): 14:26:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:26:51.401567 (Thread-7): 14:26:51  finished collecting timing info
2022-03-02 14:26:51.401724 (Thread-7): 14:26:51  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:26:51.405969 (Thread-7): 14:26:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:26:51.406395 (Thread-6): 14:26:51  finished collecting timing info
2022-03-02 14:26:51.406546 (Thread-6): 14:26:51  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:26:51.409289 (Thread-6): 14:26:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:26:51.416952 (Thread-5): 14:26:51  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:26:51.417069 (Thread-5): 14:26:51  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:51.417160 (Thread-5): 14:26:51  Opening a new connection, currently in state closed
2022-03-02 14:26:51.418093 (Thread-4): 14:26:51  finished collecting timing info
2022-03-02 14:26:51.418222 (Thread-4): 14:26:51  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:26:51.420916 (Thread-4): 14:26:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:26:51.422405 (Thread-6): 14:26:51  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:26:51.422512 (Thread-6): 14:26:51  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:51.422594 (Thread-6): 14:26:51  Opening a new connection, currently in state closed
2022-03-02 14:26:51.432778 (Thread-7): 14:26:51  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:26:51.432898 (Thread-7): 14:26:51  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:51.432980 (Thread-7): 14:26:51  Opening a new connection, currently in state closed
2022-03-02 14:26:51.435217 (Thread-4): 14:26:51  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:26:51.435335 (Thread-4): 14:26:51  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:51.435416 (Thread-4): 14:26:51  Opening a new connection, currently in state closed
2022-03-02 14:26:52.564041 (Thread-56): handling poll request
2022-03-02 14:26:52.564396 (Thread-56): 14:26:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d8070>]}
2022-03-02 14:26:52.565466 (Thread-56): sending response (<Response 28540 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:54.194048 (Thread-7): 14:26:54  SQL status: SUCCESS 1 in 2.76 seconds
2022-03-02 14:26:54.195585 (Thread-7): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.195788 (Thread-7): 14:26:54  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 14:26:54.255636 (Thread-5): 14:26:54  SQL status: SUCCESS 1 in 2.84 seconds
2022-03-02 14:26:54.257099 (Thread-5): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.257254 (Thread-5): 14:26:54  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 14:26:54.327533 (Thread-4): 14:26:54  SQL status: SUCCESS 1 in 2.89 seconds
2022-03-02 14:26:54.328920 (Thread-4): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.329065 (Thread-4): 14:26:54  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 14:26:54.382958 (Thread-57): handling poll request
2022-03-02 14:26:54.383336 (Thread-57): 14:26:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d8d00>]}
2022-03-02 14:26:54.383947 (Thread-57): sending response (<Response 3775 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:54.545007 (Thread-4): 14:26:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b67b700>]}
2022-03-02 14:26:54.545426 (Thread-4): 14:26:54  23 of 31 OK created incremental model DBT_VAULT.hub_supplier.................... [SUCCESS 1 in 3.17s]
2022-03-02 14:26:54.545558 (Thread-4): 14:26:54  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:26:54.545702 (Thread-4): 14:26:54  Began running node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 14:26:54.545886 (Thread-4): 14:26:54  24 of 31 START incremental model DBT_VAULT.link_inventory....................... [RUN]
2022-03-02 14:26:54.546130 (Thread-4): 14:26:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 14:26:54.546218 (Thread-4): 14:26:54  Began compiling node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 14:26:54.546305 (Thread-4): 14:26:54  Compiling model.dbtvault_snowflake_demo.link_inventory
2022-03-02 14:26:54.554562 (Thread-4): 14:26:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 14:26:54.555712 (Thread-6): 14:26:54  SQL status: SUCCESS 1 in 3.13 seconds
2022-03-02 14:26:54.557011 (Thread-6): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.557154 (Thread-6): 14:26:54  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 14:26:54.565779 (Thread-4): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.565927 (Thread-4): 14:26:54  Began executing node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 14:26:54.568915 (Thread-4): 14:26:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 14:26:54.579297 (Thread-4): 14:26:54  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 14:26:54.579410 (Thread-4): 14:26:54  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:54.579497 (Thread-4): 14:26:54  Opening a new connection, currently in state closed
2022-03-02 14:26:54.696966 (Thread-7): 14:26:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56ebaa90>]}
2022-03-02 14:26:54.697350 (Thread-7): 14:26:54  22 of 31 OK created incremental model DBT_VAULT.hub_region...................... [SUCCESS 1 in 3.33s]
2022-03-02 14:26:54.697477 (Thread-7): 14:26:54  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:26:54.697615 (Thread-7): 14:26:54  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:26:54.697793 (Thread-7): 14:26:54  25 of 31 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 14:26:54.698034 (Thread-7): 14:26:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:26:54.698120 (Thread-7): 14:26:54  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:26:54.698206 (Thread-7): 14:26:54  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:26:54.707242 (Thread-7): 14:26:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:26:54.717235 (Thread-7): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.717375 (Thread-7): 14:26:54  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:26:54.721416 (Thread-7): 14:26:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:26:54.733139 (Thread-7): 14:26:54  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:26:54.733390 (Thread-7): 14:26:54  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:54.733479 (Thread-7): 14:26:54  Opening a new connection, currently in state closed
2022-03-02 14:26:54.757977 (Thread-5): 14:26:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56e43400>]}
2022-03-02 14:26:54.758321 (Thread-5): 14:26:54  20 of 31 OK created incremental model DBT_VAULT.hub_nation...................... [SUCCESS 1 in 3.41s]
2022-03-02 14:26:54.758438 (Thread-5): 14:26:54  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:26:54.758570 (Thread-5): 14:26:54  Began running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 14:26:54.758741 (Thread-5): 14:26:54  26 of 31 START incremental model DBT_VAULT.link_supplier_nation................. [RUN]
2022-03-02 14:26:54.758962 (Thread-5): 14:26:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 14:26:54.759047 (Thread-5): 14:26:54  Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 14:26:54.759134 (Thread-5): 14:26:54  Compiling model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 14:26:54.768021 (Thread-5): 14:26:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 14:26:54.777444 (Thread-5): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.777583 (Thread-5): 14:26:54  Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 14:26:54.780404 (Thread-5): 14:26:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 14:26:54.792324 (Thread-5): 14:26:54  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 14:26:54.792443 (Thread-5): 14:26:54  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_supplier_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:54.792529 (Thread-5): 14:26:54  Opening a new connection, currently in state closed
2022-03-02 14:26:54.826799 (Thread-6): 14:26:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b804ec850>]}
2022-03-02 14:26:54.827123 (Thread-6): 14:26:54  21 of 31 OK created incremental model DBT_VAULT.hub_part........................ [SUCCESS 1 in 3.47s]
2022-03-02 14:26:54.827238 (Thread-6): 14:26:54  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:26:54.827370 (Thread-6): 14:26:54  Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 14:26:54.827541 (Thread-6): 14:26:54  27 of 31 START incremental model DBT_VAULT.sat_inv_inventory_details............ [RUN]
2022-03-02 14:26:54.827794 (Thread-6): 14:26:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 14:26:54.827884 (Thread-6): 14:26:54  Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 14:26:54.827968 (Thread-6): 14:26:54  Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 14:26:54.849293 (Thread-6): 14:26:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 14:26:54.879452 (Thread-6): 14:26:54  finished collecting timing info
2022-03-02 14:26:54.879648 (Thread-6): 14:26:54  Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 14:26:54.882712 (Thread-6): 14:26:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 14:26:54.915376 (Thread-6): 14:26:54  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 14:26:54.915557 (Thread-6): 14:26:54  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:54.915714 (Thread-6): 14:26:54  Opening a new connection, currently in state closed
2022-03-02 14:26:56.179925 (Thread-4): 14:26:56  SQL status: SUCCESS 1 in 1.6 seconds
2022-03-02 14:26:56.181453 (Thread-4): 14:26:56  finished collecting timing info
2022-03-02 14:26:56.181615 (Thread-4): 14:26:56  On model.dbtvault_snowflake_demo.link_inventory: Close
2022-03-02 14:26:56.199692 (Thread-58): handling poll request
2022-03-02 14:26:56.200029 (Thread-58): 14:26:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d9310>]}
2022-03-02 14:26:56.201129 (Thread-58): sending response (<Response 32650 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:56.403282 (Thread-4): 14:26:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7b1ce8b0>]}
2022-03-02 14:26:56.403746 (Thread-4): 14:26:56  24 of 31 OK created incremental model DBT_VAULT.link_inventory.................. [SUCCESS 1 in 1.86s]
2022-03-02 14:26:56.403880 (Thread-4): 14:26:56  Finished running node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 14:26:56.404020 (Thread-4): 14:26:56  Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 14:26:56.404202 (Thread-4): 14:26:56  28 of 31 START incremental model DBT_VAULT.sat_inv_part_details................. [RUN]
2022-03-02 14:26:56.404476 (Thread-4): 14:26:56  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 14:26:56.404567 (Thread-4): 14:26:56  Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 14:26:56.404655 (Thread-4): 14:26:56  Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 14:26:56.418920 (Thread-4): 14:26:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 14:26:56.429226 (Thread-4): 14:26:56  finished collecting timing info
2022-03-02 14:26:56.429398 (Thread-4): 14:26:56  Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 14:26:56.433151 (Thread-4): 14:26:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 14:26:56.443726 (Thread-4): 14:26:56  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 14:26:56.443865 (Thread-4): 14:26:56  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_part_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:56.443959 (Thread-4): 14:26:56  Opening a new connection, currently in state closed
2022-03-02 14:26:56.625552 (Thread-5): 14:26:56  SQL status: SUCCESS 1 in 1.83 seconds
2022-03-02 14:26:56.627840 (Thread-5): 14:26:56  finished collecting timing info
2022-03-02 14:26:56.628079 (Thread-5): 14:26:56  On model.dbtvault_snowflake_demo.link_supplier_nation: Close
2022-03-02 14:26:56.881523 (Thread-5): 14:26:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7a96bca0>]}
2022-03-02 14:26:56.881942 (Thread-5): 14:26:56  26 of 31 OK created incremental model DBT_VAULT.link_supplier_nation............ [SUCCESS 1 in 2.12s]
2022-03-02 14:26:56.882076 (Thread-5): 14:26:56  Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 14:26:56.882221 (Thread-5): 14:26:56  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 14:26:56.882404 (Thread-5): 14:26:56  29 of 31 START incremental model DBT_VAULT.sat_inv_supp_nation_details.......... [RUN]
2022-03-02 14:26:56.882637 (Thread-5): 14:26:56  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 14:26:56.882726 (Thread-5): 14:26:56  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 14:26:56.882815 (Thread-5): 14:26:56  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 14:26:56.894115 (Thread-5): 14:26:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 14:26:56.904556 (Thread-5): 14:26:56  finished collecting timing info
2022-03-02 14:26:56.904706 (Thread-5): 14:26:56  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 14:26:56.907458 (Thread-5): 14:26:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 14:26:56.918265 (Thread-5): 14:26:56  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 14:26:56.918381 (Thread-5): 14:26:56  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:56.918469 (Thread-5): 14:26:56  Opening a new connection, currently in state closed
2022-03-02 14:26:57.071254 (Thread-7): 14:26:57  SQL status: SUCCESS 1 in 2.34 seconds
2022-03-02 14:26:57.072789 (Thread-7): 14:26:57  finished collecting timing info
2022-03-02 14:26:57.072948 (Thread-7): 14:26:57  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 14:26:57.335121 (Thread-6): 14:26:57  SQL status: SUCCESS 1 in 2.42 seconds
2022-03-02 14:26:57.336684 (Thread-6): 14:26:57  finished collecting timing info
2022-03-02 14:26:57.336846 (Thread-6): 14:26:57  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
2022-03-02 14:26:57.368821 (Thread-7): 14:26:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b780a6940>]}
2022-03-02 14:26:57.369241 (Thread-7): 14:26:57  25 of 31 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 2.67s]
2022-03-02 14:26:57.369369 (Thread-7): 14:26:57  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:26:57.369515 (Thread-7): 14:26:57  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 14:26:57.369698 (Thread-7): 14:26:57  30 of 31 START incremental model DBT_VAULT.sat_inv_supp_region_details.......... [RUN]
2022-03-02 14:26:57.369957 (Thread-7): 14:26:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 14:26:57.370048 (Thread-7): 14:26:57  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 14:26:57.370138 (Thread-7): 14:26:57  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 14:26:57.387133 (Thread-7): 14:26:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 14:26:57.396380 (Thread-7): 14:26:57  finished collecting timing info
2022-03-02 14:26:57.396537 (Thread-7): 14:26:57  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 14:26:57.399474 (Thread-7): 14:26:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 14:26:57.409981 (Thread-7): 14:26:57  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 14:26:57.410158 (Thread-7): 14:26:57  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:57.410294 (Thread-7): 14:26:57  Opening a new connection, currently in state closed
2022-03-02 14:26:57.636197 (Thread-6): 14:26:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56fc0ac0>]}
2022-03-02 14:26:57.636618 (Thread-6): 14:26:57  27 of 31 OK created incremental model DBT_VAULT.sat_inv_inventory_details....... [SUCCESS 1 in 2.81s]
2022-03-02 14:26:57.636748 (Thread-6): 14:26:57  Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 14:26:57.636894 (Thread-6): 14:26:57  Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 14:26:57.637082 (Thread-6): 14:26:57  31 of 31 START incremental model DBT_VAULT.sat_inv_supplier_details............. [RUN]
2022-03-02 14:26:57.637310 (Thread-6): 14:26:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 14:26:57.637398 (Thread-6): 14:26:57  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 14:26:57.637488 (Thread-6): 14:26:57  Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 14:26:57.649890 (Thread-6): 14:26:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 14:26:57.679781 (Thread-6): 14:26:57  finished collecting timing info
2022-03-02 14:26:57.679967 (Thread-6): 14:26:57  Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 14:26:57.683069 (Thread-6): 14:26:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 14:26:57.719866 (Thread-6): 14:26:57  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 14:26:57.720010 (Thread-6): 14:26:57  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:26:57.720101 (Thread-6): 14:26:57  Opening a new connection, currently in state closed
2022-03-02 14:26:58.008096 (Thread-59): handling poll request
2022-03-02 14:26:58.008456 (Thread-59): 14:26:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d9fd0>]}
2022-03-02 14:26:58.009560 (Thread-59): sending response (<Response 33825 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:26:58.410705 (Thread-4): 14:26:58  SQL status: SUCCESS 1 in 1.97 seconds
2022-03-02 14:26:58.412273 (Thread-4): 14:26:58  finished collecting timing info
2022-03-02 14:26:58.412441 (Thread-4): 14:26:58  On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
2022-03-02 14:26:58.610893 (Thread-5): 14:26:58  SQL status: SUCCESS 1 in 1.69 seconds
2022-03-02 14:26:58.612503 (Thread-5): 14:26:58  finished collecting timing info
2022-03-02 14:26:58.612658 (Thread-5): 14:26:58  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
2022-03-02 14:26:58.626003 (Thread-4): 14:26:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56ee41f0>]}
2022-03-02 14:26:58.649062 (Thread-4): 14:26:58  28 of 31 OK created incremental model DBT_VAULT.sat_inv_part_details............ [SUCCESS 1 in 2.22s]
2022-03-02 14:26:58.649229 (Thread-4): 14:26:58  Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 14:26:59.099974 (Thread-7): 14:26:59  SQL status: SUCCESS 1 in 1.69 seconds
2022-03-02 14:26:59.101490 (Thread-7): 14:26:59  finished collecting timing info
2022-03-02 14:26:59.101655 (Thread-7): 14:26:59  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
2022-03-02 14:26:59.130316 (Thread-5): 14:26:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56ebb490>]}
2022-03-02 14:26:59.130720 (Thread-5): 14:26:59  29 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_nation_details..... [SUCCESS 1 in 2.25s]
2022-03-02 14:26:59.130840 (Thread-5): 14:26:59  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 14:26:59.314131 (Thread-7): 14:26:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f793a0>]}
2022-03-02 14:26:59.314550 (Thread-7): 14:26:59  30 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_region_details..... [SUCCESS 1 in 1.94s]
2022-03-02 14:26:59.314677 (Thread-7): 14:26:59  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 14:26:59.357640 (Thread-6): 14:26:59  SQL status: SUCCESS 1 in 1.64 seconds
2022-03-02 14:26:59.359037 (Thread-6): 14:26:59  finished collecting timing info
2022-03-02 14:26:59.359181 (Thread-6): 14:26:59  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
2022-03-02 14:26:59.580279 (Thread-6): 14:26:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd5da9e-0cd2-4416-8535-4c56c4adebde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b56f920d0>]}
2022-03-02 14:26:59.580684 (Thread-6): 14:26:59  31 of 31 OK created incremental model DBT_VAULT.sat_inv_supplier_details........ [SUCCESS 1 in 1.94s]
2022-03-02 14:26:59.580809 (Thread-6): 14:26:59  Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 14:26:59.582652 (MainThread): 14:26:59  Acquiring new snowflake connection "master"
2022-03-02 14:26:59.583079 (MainThread): 14:26:59  
2022-03-02 14:26:59.583183 (MainThread): 14:26:59  Finished running 6 table models, 25 incremental models in 34.35s.
2022-03-02 14:26:59.583268 (MainThread): 14:26:59  Connection 'master' was properly closed.
2022-03-02 14:26:59.583337 (MainThread): 14:26:59  Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
2022-03-02 14:26:59.583403 (MainThread): 14:26:59  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
2022-03-02 14:26:59.583464 (MainThread): 14:26:59  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
2022-03-02 14:26:59.583525 (MainThread): 14:26:59  Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
2022-03-02 14:26:59.649957 (MainThread): 14:26:59  
2022-03-02 14:26:59.650127 (MainThread): 14:26:59  Completed successfully
2022-03-02 14:26:59.650260 (MainThread): 14:26:59  
2022-03-02 14:26:59.650353 (MainThread): 14:26:59  Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
2022-03-02 14:26:59.820202 (Thread-60): handling poll request
2022-03-02 14:26:59.820584 (Thread-60): 14:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4762430>]}
2022-03-02 14:26:59.821435 (Thread-60): sending response (<Response 14906 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:27:01.625768 (Thread-61): handling poll request
2022-03-02 14:27:01.626139 (Thread-61): 14:27:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be47620d0>]}
2022-03-02 14:27:01.629485 (Thread-61): sending response (<Response 143580 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:27:03.025927 (Thread-62): handling status request
2022-03-02 14:27:03.026275 (Thread-62): 14:27:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be46f03d0>]}
2022-03-02 14:27:03.027001 (Thread-62): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:27:03.314517 (Thread-63): handling status request
2022-03-02 14:27:03.314901 (Thread-63): 14:27:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4853490>]}
2022-03-02 14:27:03.315595 (Thread-63): sending response (<Response 9842 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:29:05.943698 (Thread-64): handling status request
2022-03-02 14:29:05.945648 (Thread-64): 14:29:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be670b940>]}
2022-03-02 14:29:05.946331 (Thread-64): sending response (<Response 9820 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:29:05.962036 (Thread-65): handling list request
2022-03-02 14:29:05.962315 (Thread-65): 14:29:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be46f8be0>]}
2022-03-02 14:29:06.002441 (Thread-65): 14:29:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4762df0>]}
2022-03-02 14:29:06.002763 (Thread-65): 14:29:06  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:29:06.012164 (Thread-65): sending response (<Response 5449 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:29:08.525368 (Thread-66): handling status request
2022-03-02 14:29:08.525759 (Thread-66): 14:29:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67ef220>]}
2022-03-02 14:29:08.526438 (Thread-66): sending response (<Response 9820 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:29:08.533285 (Thread-67): handling list request
2022-03-02 14:29:08.533542 (Thread-67): 14:29:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be678e7c0>]}
2022-03-02 14:29:08.566726 (Thread-67): 14:29:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be667eee0>]}
2022-03-02 14:29:08.591599 (Thread-67): 14:29:08  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:29:08.596310 (Thread-67): sending response (<Response 5461 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:29:15.914601 (Thread-68): handling status request
2022-03-02 14:29:15.914968 (Thread-68): 14:29:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67ae790>]}
2022-03-02 14:29:15.915692 (Thread-68): sending response (<Response 9820 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:29:15.922783 (Thread-69): handling list request
2022-03-02 14:29:15.923015 (Thread-69): 14:29:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec059550>]}
2022-03-02 14:29:15.954053 (Thread-69): 14:29:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be667efa0>]}
2022-03-02 14:29:15.954329 (Thread-69): 14:29:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:29:15.961252 (Thread-69): sending response (<Response 16866 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:30:26.781479 (Thread-70): handling status request
2022-03-02 14:30:26.783465 (Thread-70): 14:30:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67347c0>]}
2022-03-02 14:30:26.784171 (Thread-70): sending response (<Response 9820 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:30:26.793313 (Thread-71): handling list request
2022-03-02 14:30:26.793572 (Thread-71): 14:30:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be471d430>]}
2022-03-02 14:30:26.829903 (Thread-71): 14:30:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec059550>]}
2022-03-02 14:30:26.830263 (Thread-71): 14:30:26  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:30:26.838140 (Thread-71): sending response (<Response 16866 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:30:38.015461 (Thread-72): handling status request
2022-03-02 14:30:38.015863 (Thread-72): 14:30:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4688ee0>]}
2022-03-02 14:30:38.016675 (Thread-72): sending response (<Response 9820 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:30:38.023063 (Thread-73): handling list request
2022-03-02 14:30:38.023296 (Thread-73): 14:30:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4688460>]}
2022-03-02 14:30:38.057287 (Thread-73): 14:30:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4639d60>]}
2022-03-02 14:30:38.057585 (Thread-73): 14:30:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:30:38.062546 (Thread-73): sending response (<Response 16866 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:14.323175 (Thread-75): handling status request
2022-03-02 14:31:14.323685 (Thread-75): 14:31:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67a7eb0>]}
2022-03-02 14:31:14.324146 (Thread-75): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:14.340286 (Thread-74): 14:31:14  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:31:14.340866 (Thread-74): 14:31:14  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-02 14:31:14.349476 (Thread-74): 14:31:14  1603: static parser failed on stage/v_stg_orders.sql
2022-03-02 14:31:14.382283 (Thread-74): 14:31:14  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-02 14:31:14.396370 (Thread-76): handling status request
2022-03-02 14:31:14.396729 (Thread-76): 14:31:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be484dfa0>]}
2022-03-02 14:31:14.397162 (Thread-76): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:14.438150 (Thread-74): 14:31:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1ca4f0>]}
2022-03-02 14:31:14.463042 (Thread-77): handling status request
2022-03-02 14:31:14.463424 (Thread-77): 14:31:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6705b20>]}
2022-03-02 14:31:14.463998 (Thread-77): sending response (<Response 1846 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:14.472274 (Thread-78): handling list request
2022-03-02 14:31:14.472611 (Thread-78): 14:31:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6705fa0>]}
2022-03-02 14:31:14.508439 (Thread-78): 14:31:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67057c0>]}
2022-03-02 14:31:14.508819 (Thread-78): 14:31:14  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:31:14.514189 (Thread-78): sending response (<Response 16866 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:14.993239 (Thread-79): handling status request
2022-03-02 14:31:14.993604 (Thread-79): 14:31:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6727790>]}
2022-03-02 14:31:14.994084 (Thread-79): sending response (<Response 1868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:15.003742 (Thread-80): handling status request
2022-03-02 14:31:15.004010 (Thread-80): 14:31:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6727fa0>]}
2022-03-02 14:31:15.004434 (Thread-80): sending response (<Response 1868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:42.070350 (Thread-81): handling status request
2022-03-02 14:31:42.070724 (Thread-81): 14:31:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6727c40>]}
2022-03-02 14:31:42.071213 (Thread-81): sending response (<Response 1868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:42.360580 (Thread-82): handling status request
2022-03-02 14:31:42.360932 (Thread-82): 14:31:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66d9a00>]}
2022-03-02 14:31:42.361410 (Thread-82): sending response (<Response 1868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:42.669857 (Thread-83): handling cli_args request
2022-03-02 14:31:42.670245 (Thread-83): 14:31:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be672e2b0>]}
2022-03-02 14:31:44.901585 (Thread-83): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:45.296259 (MainThread): 14:31:45  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:31:45.296690 (MainThread): 14:31:45  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:31:45.304333 (MainThread): 14:31:45  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1752b7f-7d4b-4879-9556-b3225b3f7784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c4566fa0>]}
2022-03-02 14:31:45.338504 (MainThread): 14:31:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1752b7f-7d4b-4879-9556-b3225b3f7784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c465ab50>]}
2022-03-02 14:31:45.338780 (MainThread): 14:31:45  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:31:45.341011 (MainThread): 14:31:45  
2022-03-02 14:31:45.341327 (MainThread): 14:31:45  Acquiring new snowflake connection "master"
2022-03-02 14:31:45.342876 (ThreadPoolExecutor-0_0): 14:31:45  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:31:45.355724 (ThreadPoolExecutor-0_0): 14:31:45  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:31:45.355829 (ThreadPoolExecutor-0_0): 14:31:45  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:31:45.355913 (ThreadPoolExecutor-0_0): 14:31:45  Opening a new connection, currently in state init
2022-03-02 14:31:45.669923 (Thread-84): handling poll request
2022-03-02 14:31:45.670359 (Thread-84): 14:31:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66f5fd0>]}
2022-03-02 14:31:45.671247 (Thread-84): sending response (<Response 4158 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:46.407290 (ThreadPoolExecutor-0_0): 14:31:46  SQL status: SUCCESS 7 in 1.05 seconds
2022-03-02 14:31:46.409299 (ThreadPoolExecutor-0_0): 14:31:46  On list_DBT_RAW: Close
2022-03-02 14:31:46.673366 (ThreadPoolExecutor-2_0): 14:31:46  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:31:46.681323 (ThreadPoolExecutor-2_0): 14:31:46  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:31:46.681468 (ThreadPoolExecutor-2_0): 14:31:46  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:31:46.681568 (ThreadPoolExecutor-2_0): 14:31:46  Opening a new connection, currently in state closed
2022-03-02 14:31:47.478966 (Thread-85): handling poll request
2022-03-02 14:31:47.479393 (Thread-85): 14:31:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66f5820>]}
2022-03-02 14:31:47.479992 (Thread-85): sending response (<Response 2315 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:47.478008 (ThreadPoolExecutor-2_0): 14:31:47  SQL status: SUCCESS 31 in 0.8 seconds
2022-03-02 14:31:47.480313 (ThreadPoolExecutor-2_0): 14:31:47  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:31:47.739933 (MainThread): 14:31:47  Concurrency: 4 threads (target='default')
2022-03-02 14:31:47.740209 (MainThread): 14:31:47  
2022-03-02 14:31:47.743729 (Thread-3): 14:31:47  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:31:47.744036 (Thread-3): 14:31:47  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:31:47.744304 (Thread-3): 14:31:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:31:47.744407 (Thread-3): 14:31:47  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:31:47.744513 (Thread-3): 14:31:47  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:31:47.750267 (Thread-3): 14:31:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:31:47.764038 (Thread-3): 14:31:47  finished collecting timing info
2022-03-02 14:31:47.764200 (Thread-3): 14:31:47  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:31:47.788255 (Thread-3): 14:31:47  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:31:47.803248 (Thread-3): 14:31:47  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:31:47.803379 (Thread-3): 14:31:47  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:31:47.803469 (Thread-3): 14:31:47  Opening a new connection, currently in state closed
2022-03-02 14:31:49.252125 (Thread-86): handling poll request
2022-03-02 14:31:49.252495 (Thread-86): 14:31:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be672c040>]}
2022-03-02 14:31:49.253194 (Thread-86): sending response (<Response 9096 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:51.028515 (Thread-87): handling poll request
2022-03-02 14:31:51.028877 (Thread-87): 14:31:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be672c880>]}
2022-03-02 14:31:51.029360 (Thread-87): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:52.795858 (Thread-88): handling poll request
2022-03-02 14:31:52.796220 (Thread-88): 14:31:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be672c910>]}
2022-03-02 14:31:52.796724 (Thread-88): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:54.559257 (Thread-89): handling poll request
2022-03-02 14:31:54.559669 (Thread-89): 14:31:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6703a00>]}
2022-03-02 14:31:54.561657 (Thread-89): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:56.321384 (Thread-90): handling poll request
2022-03-02 14:31:56.321754 (Thread-90): 14:31:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be672c340>]}
2022-03-02 14:31:56.322249 (Thread-90): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:57.753913 (Thread-3): 14:31:57  SQL status: SUCCESS 1 in 9.95 seconds
2022-03-02 14:31:57.763402 (Thread-3): 14:31:57  finished collecting timing info
2022-03-02 14:31:57.763584 (Thread-3): 14:31:57  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:31:58.078058 (Thread-3): 14:31:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1752b7f-7d4b-4879-9556-b3225b3f7784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42beec2f40>]}
2022-03-02 14:31:58.078511 (Thread-3): 14:31:58  1 of 19 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 10.33s]
2022-03-02 14:31:58.078639 (Thread-3): 14:31:58  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:31:58.079682 (Thread-5): 14:31:58  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:31:58.079959 (Thread-5): 14:31:58  2 of 19 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:31:58.080246 (Thread-5): 14:31:58  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:31:58.080335 (Thread-5): 14:31:58  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:31:58.080424 (Thread-5): 14:31:58  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:31:58.087224 (Thread-91): handling poll request
2022-03-02 14:31:58.087526 (Thread-91): 14:31:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66f5b80>]}
2022-03-02 14:31:58.088208 (Thread-91): sending response (<Response 5017 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:58.120837 (Thread-5): 14:31:58  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:31:58.120996 (Thread-5): 14:31:58  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:31:58.121092 (Thread-5): 14:31:58  Opening a new connection, currently in state init
2022-03-02 14:31:59.206643 (Thread-5): 14:31:59  SQL status: SUCCESS 36 in 1.09 seconds
2022-03-02 14:31:59.237172 (Thread-5): 14:31:59  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:31:59.237321 (Thread-5): 14:31:59  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:31:59.511352 (Thread-5): 14:31:59  SQL status: SUCCESS 36 in 0.27 seconds
2022-03-02 14:31:59.562864 (Thread-5): 14:31:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:31:59.588705 (Thread-5): 14:31:59  finished collecting timing info
2022-03-02 14:31:59.588922 (Thread-5): 14:31:59  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:31:59.592007 (Thread-5): 14:31:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:31:59.628297 (Thread-5): 14:31:59  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:31:59.628477 (Thread-5): 14:31:59  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC)) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:31:59.877915 (Thread-92): handling poll request
2022-03-02 14:31:59.878288 (Thread-92): 14:31:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6727940>]}
2022-03-02 14:31:59.879026 (Thread-92): sending response (<Response 16033 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:31:59.990235 (Thread-5): 14:31:59  Snowflake adapter: Snowflake query id: 01a2a887-0503-b4d3-0000-0ed503a4b2da
2022-03-02 14:31:59.990406 (Thread-5): 14:31:59  Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 103 at position 4
not enough arguments for function [NVL(LAG(SOURCE_DATA.ORDERDATE) OVER (PARTITION BY SOURCE_DATA.CUSTOMERKEY ORDER BY SOURCE_DATA.ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:31:59.990571 (Thread-5): 14:31:59  finished collecting timing info
2022-03-02 14:31:59.990714 (Thread-5): 14:31:59  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:32:00.283884 (Thread-5): 14:32:00  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  000938 (22023): SQL compilation error: error line 103 at position 4
  not enough arguments for function [NVL(LAG(SOURCE_DATA.ORDERDATE) OVER (PARTITION BY SOURCE_DATA.CUSTOMERKEY ORDER BY SOURCE_DATA.ORDERDATE DESC NULLS FIRST))], expected 2, got 1
  compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-02 14:32:00.284346 (Thread-5): 14:32:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1752b7f-7d4b-4879-9556-b3225b3f7784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42bc17daf0>]}
2022-03-02 14:32:00.284709 (Thread-5): 14:32:00  2 of 19 ERROR creating table model DBT_VAULT.v_stg_orders....................... [ERROR in 2.20s]
2022-03-02 14:32:00.284829 (Thread-5): 14:32:00  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:32:00.286245 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:32:00.286442 (Thread-4): 14:32:00  3 of 19 SKIP relation DBT_VAULT.hub_customer.................................... [SKIP]
2022-03-02 14:32:00.286552 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:32:00.286674 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:32:00.286784 (Thread-4): 14:32:00  4 of 19 SKIP relation DBT_VAULT.hub_lineitem.................................... [SKIP]
2022-03-02 14:32:00.286870 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:32:00.286967 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:32:00.287066 (Thread-4): 14:32:00  5 of 19 SKIP relation DBT_VAULT.hub_nation...................................... [SKIP]
2022-03-02 14:32:00.287155 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:32:00.287253 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:32:00.287350 (Thread-4): 14:32:00  6 of 19 SKIP relation DBT_VAULT.hub_order....................................... [SKIP]
2022-03-02 14:32:00.287433 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:32:00.287527 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:32:00.287656 (Thread-4): 14:32:00  7 of 19 SKIP relation DBT_VAULT.hub_part........................................ [SKIP]
2022-03-02 14:32:00.287745 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:32:00.287839 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:32:00.287935 (Thread-4): 14:32:00  8 of 19 SKIP relation DBT_VAULT.hub_region...................................... [SKIP]
2022-03-02 14:32:00.288014 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:32:00.288108 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:32:00.288201 (Thread-4): 14:32:00  9 of 19 SKIP relation DBT_VAULT.hub_supplier.................................... [SKIP]
2022-03-02 14:32:00.288280 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:32:00.288372 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:32:00.288470 (Thread-4): 14:32:00  10 of 19 SKIP relation DBT_VAULT.link_customer_nation........................... [SKIP]
2022-03-02 14:32:00.288556 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:32:00.288656 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:32:00.288763 (Thread-4): 14:32:00  11 of 19 SKIP relation DBT_VAULT.link_customer_order............................ [SKIP]
2022-03-02 14:32:00.288855 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:32:00.288952 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:32:00.289381 (Thread-4): 14:32:00  12 of 19 SKIP relation DBT_VAULT.link_inventory_allocation...................... [SKIP]
2022-03-02 14:32:00.289531 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:32:00.289641 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:32:00.289759 (Thread-4): 14:32:00  13 of 19 SKIP relation DBT_VAULT.link_nation_region............................. [SKIP]
2022-03-02 14:32:00.289848 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:32:00.289944 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:32:00.290041 (Thread-4): 14:32:00  14 of 19 SKIP relation DBT_VAULT.link_order_lineitem............................ [SKIP]
2022-03-02 14:32:00.290121 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:32:00.290211 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:32:00.290306 (Thread-4): 14:32:00  15 of 19 SKIP relation DBT_VAULT.sat_order_cust_nation_details.................. [SKIP]
2022-03-02 14:32:00.290386 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:32:00.290476 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:32:00.290565 (Thread-4): 14:32:00  16 of 19 SKIP relation DBT_VAULT.sat_order_cust_region_details.................. [SKIP]
2022-03-02 14:32:00.290650 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:32:00.290782 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:32:00.290893 (Thread-4): 14:32:00  17 of 19 SKIP relation DBT_VAULT.sat_order_customer_details..................... [SKIP]
2022-03-02 14:32:00.290976 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:32:00.291068 (Thread-4): 14:32:00  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:32:00.291310 (Thread-3): 14:32:00  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:32:00.291478 (Thread-3): 14:32:00  19 of 19 SKIP relation DBT_VAULT.sat_order_order_details........................ [SKIP]
2022-03-02 14:32:00.291575 (Thread-3): 14:32:00  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:32:00.291731 (Thread-4): 14:32:00  18 of 19 SKIP relation DBT_VAULT.sat_order_lineitem_details..................... [SKIP]
2022-03-02 14:32:00.291844 (Thread-4): 14:32:00  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:32:00.295457 (MainThread): 14:32:00  Acquiring new snowflake connection "master"
2022-03-02 14:32:00.295903 (MainThread): 14:32:00  
2022-03-02 14:32:00.296008 (MainThread): 14:32:00  Finished running 2 table models, 17 incremental models in 14.95s.
2022-03-02 14:32:00.296102 (MainThread): 14:32:00  Connection 'master' was properly closed.
2022-03-02 14:32:00.296170 (MainThread): 14:32:00  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-02 14:32:00.296240 (MainThread): 14:32:00  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-02 14:32:00.381192 (MainThread): 14:32:00  
2022-03-02 14:32:00.381416 (MainThread): 14:32:00  Completed with 1 error and 0 warnings:
2022-03-02 14:32:00.381508 (MainThread): 14:32:00  
2022-03-02 14:32:00.381599 (MainThread): 14:32:00  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
2022-03-02 14:32:00.381676 (MainThread): 14:32:00    000938 (22023): SQL compilation error: error line 103 at position 4
2022-03-02 14:32:00.381745 (MainThread): 14:32:00    not enough arguments for function [NVL(LAG(SOURCE_DATA.ORDERDATE) OVER (PARTITION BY SOURCE_DATA.CUSTOMERKEY ORDER BY SOURCE_DATA.ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:32:00.381811 (MainThread): 14:32:00    compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-02 14:32:00.381902 (MainThread): 14:32:00  
2022-03-02 14:32:00.382012 (MainThread): 14:32:00  Done. PASS=1 WARN=0 ERROR=1 SKIP=17 TOTAL=19
2022-03-02 14:32:02.632136 (Thread-93): handling poll request
2022-03-02 14:32:02.632531 (Thread-93): 14:32:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6703370>]}
2022-03-02 14:32:02.661917 (Thread-93): sending response (<Response 94778 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:03.963187 (Thread-94): handling status request
2022-03-02 14:32:03.963579 (Thread-94): 14:32:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6686100>]}
2022-03-02 14:32:03.964146 (Thread-94): sending response (<Response 1868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:03.976590 (Thread-95): handling status request
2022-03-02 14:32:03.976862 (Thread-95): 14:32:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6717e50>]}
2022-03-02 14:32:03.977295 (Thread-95): sending response (<Response 1868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:05.577269 (Thread-96): handling status request
2022-03-02 14:32:05.577678 (Thread-96): 14:32:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6705fa0>]}
2022-03-02 14:32:05.578170 (Thread-96): sending response (<Response 1846 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:05.585765 (Thread-97): handling list request
2022-03-02 14:32:05.586051 (Thread-97): 14:32:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6705790>]}
2022-03-02 14:32:05.622036 (Thread-97): 14:32:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6734310>]}
2022-03-02 14:32:05.622386 (Thread-97): 14:32:05  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:32:05.627563 (Thread-97): sending response (<Response 16866 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:49.382421 (Thread-98): handling status request
2022-03-02 14:32:49.382781 (Thread-98): 14:32:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6734220>]}
2022-03-02 14:32:49.383260 (Thread-98): sending response (<Response 1846 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:49.392056 (Thread-99): handling list request
2022-03-02 14:32:49.392322 (Thread-99): 14:32:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4639e20>]}
2022-03-02 14:32:49.427694 (Thread-99): 14:32:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6717070>]}
2022-03-02 14:32:49.428055 (Thread-99): 14:32:49  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:32:49.434400 (Thread-99): sending response (<Response 16866 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:57.822282 (Thread-100): 14:32:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:32:57.822811 (Thread-100): 14:32:57  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-02 14:32:57.829255 (Thread-100): 14:32:57  1603: static parser failed on stage/v_stg_orders.sql
2022-03-02 14:32:57.858147 (Thread-100): 14:32:57  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-02 14:32:57.921083 (Thread-100): 14:32:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a8fa0>]}
2022-03-02 14:32:58.045985 (Thread-101): handling status request
2022-03-02 14:32:58.046352 (Thread-101): 14:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0f42b0>]}
2022-03-02 14:32:58.046845 (Thread-101): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:58.054659 (Thread-102): handling list request
2022-03-02 14:32:58.054987 (Thread-102): 14:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4455e20>]}
2022-03-02 14:32:58.091584 (Thread-102): 14:32:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec077550>]}
2022-03-02 14:32:58.092049 (Thread-102): 14:32:58  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:32:58.097924 (Thread-102): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:58.568657 (Thread-103): handling status request
2022-03-02 14:32:58.569040 (Thread-103): 14:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be66aca90>]}
2022-03-02 14:32:58.569543 (Thread-103): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:32:58.614729 (Thread-104): handling status request
2022-03-02 14:32:58.615078 (Thread-104): 14:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be44938b0>]}
2022-03-02 14:32:58.615554 (Thread-104): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:03.141651 (Thread-105): handling status request
2022-03-02 14:33:03.142018 (Thread-105): 14:33:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be44936d0>]}
2022-03-02 14:33:03.142507 (Thread-105): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:03.456994 (Thread-106): handling status request
2022-03-02 14:33:03.457351 (Thread-106): 14:33:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be44934c0>]}
2022-03-02 14:33:03.457826 (Thread-106): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:03.765664 (Thread-107): handling cli_args request
2022-03-02 14:33:03.766033 (Thread-107): 14:33:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be44931c0>]}
2022-03-02 14:33:06.025605 (Thread-107): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:06.419982 (MainThread): 14:33:06  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:33:06.420404 (MainThread): 14:33:06  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:33:06.427864 (MainThread): 14:33:06  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac560ef5-4647-498d-b678-d8e793ebfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c3ae5d90>]}
2022-03-02 14:33:06.488983 (MainThread): 14:33:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac560ef5-4647-498d-b678-d8e793ebfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c3bd9af0>]}
2022-03-02 14:33:06.489334 (MainThread): 14:33:06  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:33:06.491731 (MainThread): 14:33:06  
2022-03-02 14:33:06.492179 (MainThread): 14:33:06  Acquiring new snowflake connection "master"
2022-03-02 14:33:06.494392 (ThreadPoolExecutor-0_0): 14:33:06  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:33:06.507317 (ThreadPoolExecutor-0_0): 14:33:06  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:33:06.507437 (ThreadPoolExecutor-0_0): 14:33:06  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:33:06.507522 (ThreadPoolExecutor-0_0): 14:33:06  Opening a new connection, currently in state init
2022-03-02 14:33:06.810477 (Thread-108): handling poll request
2022-03-02 14:33:06.810957 (Thread-108): 14:33:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be436d580>]}
2022-03-02 14:33:06.811900 (Thread-108): sending response (<Response 4157 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:07.502008 (ThreadPoolExecutor-0_0): 14:33:07  SQL status: SUCCESS 7 in 0.99 seconds
2022-03-02 14:33:07.504014 (ThreadPoolExecutor-0_0): 14:33:07  On list_DBT_RAW: Close
2022-03-02 14:33:07.729678 (ThreadPoolExecutor-2_0): 14:33:07  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:33:07.737638 (ThreadPoolExecutor-2_0): 14:33:07  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:33:07.737797 (ThreadPoolExecutor-2_0): 14:33:07  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:33:07.737899 (ThreadPoolExecutor-2_0): 14:33:07  Opening a new connection, currently in state closed
2022-03-02 14:33:08.604509 (Thread-109): handling poll request
2022-03-02 14:33:08.604908 (Thread-109): 14:33:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec094520>]}
2022-03-02 14:33:08.605479 (Thread-109): sending response (<Response 2314 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:08.803430 (ThreadPoolExecutor-2_0): 14:33:08  SQL status: SUCCESS 31 in 1.07 seconds
2022-03-02 14:33:08.805578 (ThreadPoolExecutor-2_0): 14:33:08  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:33:09.020536 (MainThread): 14:33:09  Concurrency: 4 threads (target='default')
2022-03-02 14:33:09.020728 (MainThread): 14:33:09  
2022-03-02 14:33:09.023641 (Thread-3): 14:33:09  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:33:09.023953 (Thread-3): 14:33:09  1 of 18 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:33:09.024219 (Thread-3): 14:33:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:33:09.024322 (Thread-3): 14:33:09  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:33:09.024429 (Thread-3): 14:33:09  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:33:09.063365 (Thread-3): 14:33:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:33:09.063511 (Thread-3): 14:33:09  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:33:09.063620 (Thread-3): 14:33:09  Opening a new connection, currently in state closed
2022-03-02 14:33:09.781058 (Thread-3): 14:33:09  SQL status: SUCCESS 36 in 0.72 seconds
2022-03-02 14:33:09.812144 (Thread-3): 14:33:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:33:09.812297 (Thread-3): 14:33:09  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:33:09.968472 (Thread-3): 14:33:09  SQL status: SUCCESS 36 in 0.16 seconds
2022-03-02 14:33:10.018030 (Thread-3): 14:33:10  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:33:10.044014 (Thread-3): 14:33:10  finished collecting timing info
2022-03-02 14:33:10.044214 (Thread-3): 14:33:10  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:33:10.068016 (Thread-3): 14:33:10  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:33:10.103123 (Thread-3): 14:33:10  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:33:10.103299 (Thread-3): 14:33:10  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC)) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:33:10.326437 (Thread-3): 14:33:10  Snowflake adapter: Snowflake query id: 01a2a889-0503-b3d2-0000-0ed503a4c162
2022-03-02 14:33:10.326600 (Thread-3): 14:33:10  Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 103 at position 4
not enough arguments for function [NVL(LAG(SOURCE_DATA.ORDERDATE) OVER (PARTITION BY SOURCE_DATA.CUSTOMERKEY ORDER BY SOURCE_DATA.ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:33:10.326762 (Thread-3): 14:33:10  finished collecting timing info
2022-03-02 14:33:10.326901 (Thread-3): 14:33:10  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:33:10.377746 (Thread-110): handling poll request
2022-03-02 14:33:10.378223 (Thread-110): 14:33:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec094c70>]}
2022-03-02 14:33:10.379100 (Thread-110): sending response (<Response 21152 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:10.531804 (Thread-3): 14:33:10  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  000938 (22023): SQL compilation error: error line 103 at position 4
  not enough arguments for function [NVL(LAG(SOURCE_DATA.ORDERDATE) OVER (PARTITION BY SOURCE_DATA.CUSTOMERKEY ORDER BY SOURCE_DATA.ORDERDATE DESC NULLS FIRST))], expected 2, got 1
  compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-02 14:33:10.532246 (Thread-3): 14:33:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac560ef5-4647-498d-b678-d8e793ebfcf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c0777220>]}
2022-03-02 14:33:10.532621 (Thread-3): 14:33:10  1 of 18 ERROR creating table model DBT_VAULT.v_stg_orders....................... [ERROR in 1.51s]
2022-03-02 14:33:10.532744 (Thread-3): 14:33:10  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:33:10.534079 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:33:10.534292 (Thread-5): 14:33:10  2 of 18 SKIP relation DBT_VAULT.hub_customer.................................... [SKIP]
2022-03-02 14:33:10.534410 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:33:10.534538 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:33:10.534644 (Thread-5): 14:33:10  3 of 18 SKIP relation DBT_VAULT.hub_lineitem.................................... [SKIP]
2022-03-02 14:33:10.534731 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:33:10.534836 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:33:10.534933 (Thread-5): 14:33:10  4 of 18 SKIP relation DBT_VAULT.hub_nation...................................... [SKIP]
2022-03-02 14:33:10.535016 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:33:10.535117 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:33:10.535211 (Thread-5): 14:33:10  5 of 18 SKIP relation DBT_VAULT.hub_order....................................... [SKIP]
2022-03-02 14:33:10.535292 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:33:10.535389 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:33:10.535483 (Thread-5): 14:33:10  6 of 18 SKIP relation DBT_VAULT.hub_part........................................ [SKIP]
2022-03-02 14:33:10.535563 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:33:10.535698 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:33:10.535802 (Thread-5): 14:33:10  7 of 18 SKIP relation DBT_VAULT.hub_region...................................... [SKIP]
2022-03-02 14:33:10.535885 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:33:10.535980 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:33:10.536071 (Thread-5): 14:33:10  8 of 18 SKIP relation DBT_VAULT.hub_supplier.................................... [SKIP]
2022-03-02 14:33:10.536151 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:33:10.536576 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:33:10.536701 (Thread-5): 14:33:10  9 of 18 SKIP relation DBT_VAULT.link_customer_nation............................ [SKIP]
2022-03-02 14:33:10.536790 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:33:10.536891 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:33:10.536986 (Thread-5): 14:33:10  10 of 18 SKIP relation DBT_VAULT.link_customer_order............................ [SKIP]
2022-03-02 14:33:10.537069 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:33:10.537162 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:33:10.537257 (Thread-5): 14:33:10  11 of 18 SKIP relation DBT_VAULT.link_inventory_allocation...................... [SKIP]
2022-03-02 14:33:10.537341 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:33:10.537435 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:33:10.537530 (Thread-5): 14:33:10  12 of 18 SKIP relation DBT_VAULT.link_nation_region............................. [SKIP]
2022-03-02 14:33:10.537609 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:33:10.537699 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:33:10.537791 (Thread-5): 14:33:10  13 of 18 SKIP relation DBT_VAULT.link_order_lineitem............................ [SKIP]
2022-03-02 14:33:10.537868 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:33:10.537956 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:33:10.538047 (Thread-5): 14:33:10  14 of 18 SKIP relation DBT_VAULT.sat_order_cust_nation_details.................. [SKIP]
2022-03-02 14:33:10.538128 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:33:10.538220 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:33:10.538311 (Thread-5): 14:33:10  15 of 18 SKIP relation DBT_VAULT.sat_order_cust_region_details.................. [SKIP]
2022-03-02 14:33:10.538391 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:33:10.538482 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:33:10.538578 (Thread-5): 14:33:10  16 of 18 SKIP relation DBT_VAULT.sat_order_customer_details..................... [SKIP]
2022-03-02 14:33:10.538655 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:33:10.538743 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:33:10.538833 (Thread-5): 14:33:10  17 of 18 SKIP relation DBT_VAULT.sat_order_lineitem_details..................... [SKIP]
2022-03-02 14:33:10.538909 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:33:10.539318 (Thread-5): 14:33:10  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:33:10.539434 (Thread-5): 14:33:10  18 of 18 SKIP relation DBT_VAULT.sat_order_order_details........................ [SKIP]
2022-03-02 14:33:10.539518 (Thread-5): 14:33:10  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:33:10.542480 (MainThread): 14:33:10  Acquiring new snowflake connection "master"
2022-03-02 14:33:10.542836 (MainThread): 14:33:10  
2022-03-02 14:33:10.542937 (MainThread): 14:33:10  Finished running 1 table model, 17 incremental models in 4.05s.
2022-03-02 14:33:10.543022 (MainThread): 14:33:10  Connection 'master' was properly closed.
2022-03-02 14:33:10.543092 (MainThread): 14:33:10  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-02 14:33:10.623994 (MainThread): 14:33:10  
2022-03-02 14:33:10.624210 (MainThread): 14:33:10  Completed with 1 error and 0 warnings:
2022-03-02 14:33:10.624303 (MainThread): 14:33:10  
2022-03-02 14:33:10.624394 (MainThread): 14:33:10  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
2022-03-02 14:33:10.624470 (MainThread): 14:33:10    000938 (22023): SQL compilation error: error line 103 at position 4
2022-03-02 14:33:10.624538 (MainThread): 14:33:10    not enough arguments for function [NVL(LAG(SOURCE_DATA.ORDERDATE) OVER (PARTITION BY SOURCE_DATA.CUSTOMERKEY ORDER BY SOURCE_DATA.ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:33:10.624605 (MainThread): 14:33:10    compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-02 14:33:10.624693 (MainThread): 14:33:10  
2022-03-02 14:33:10.624780 (MainThread): 14:33:10  Done. PASS=0 WARN=0 ERROR=1 SKIP=17 TOTAL=18
2022-03-02 14:33:12.155860 (Thread-111): handling poll request
2022-03-02 14:33:12.156242 (Thread-111): 14:33:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4362d90>]}
2022-03-02 14:33:12.158698 (Thread-111): sending response (<Response 85615 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:13.572378 (Thread-112): handling status request
2022-03-02 14:33:13.572740 (Thread-112): 14:33:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4362f10>]}
2022-03-02 14:33:13.573257 (Thread-112): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:13.580704 (Thread-113): handling status request
2022-03-02 14:33:13.580946 (Thread-113): 14:33:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be434a2b0>]}
2022-03-02 14:33:13.581340 (Thread-113): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:42.276176 (Thread-114): handling status request
2022-03-02 14:33:42.276533 (Thread-114): 14:33:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be434a520>]}
2022-03-02 14:33:42.276994 (Thread-114): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:33:42.284259 (Thread-115): handling list request
2022-03-02 14:33:42.284509 (Thread-115): 14:33:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be434a790>]}
2022-03-02 14:33:42.322161 (Thread-115): 14:33:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be434a1c0>]}
2022-03-02 14:33:42.322534 (Thread-115): 14:33:42  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:33:42.328311 (Thread-115): sending response (<Response 23478 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.290438 (Thread-117): handling status request
2022-03-02 14:34:14.290828 (Thread-117): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be42bc250>]}
2022-03-02 14:34:14.291269 (Thread-117): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.359655 (Thread-118): handling status request
2022-03-02 14:34:14.360411 (Thread-118): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be468d040>]}
2022-03-02 14:34:14.360843 (Thread-118): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.428181 (Thread-119): handling status request
2022-03-02 14:34:14.428574 (Thread-119): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4175190>]}
2022-03-02 14:34:14.429049 (Thread-119): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.486284 (Thread-120): handling status request
2022-03-02 14:34:14.486738 (Thread-120): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be42486d0>]}
2022-03-02 14:34:14.513073 (Thread-120): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.577473 (Thread-121): handling status request
2022-03-02 14:34:14.577856 (Thread-121): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4248580>]}
2022-03-02 14:34:14.578268 (Thread-121): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.642701 (Thread-122): handling status request
2022-03-02 14:34:14.643070 (Thread-122): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be428d2b0>]}
2022-03-02 14:34:14.643458 (Thread-122): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.701465 (Thread-123): handling status request
2022-03-02 14:34:14.701857 (Thread-123): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be428df40>]}
2022-03-02 14:34:14.702478 (Thread-123): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.759715 (Thread-124): handling status request
2022-03-02 14:34:14.760146 (Thread-124): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be428da60>]}
2022-03-02 14:34:14.760845 (Thread-124): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.818897 (Thread-125): handling status request
2022-03-02 14:34:14.819149 (Thread-125): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be41daf70>]}
2022-03-02 14:34:14.819486 (Thread-125): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.847893 (Thread-116): 14:34:14  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:34:14.848378 (Thread-116): 14:34:14  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:34:14.858279 (Thread-116): 14:34:14  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:34:14.864740 (Thread-116): 14:34:14  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:34:14.879996 (Thread-126): handling status request
2022-03-02 14:34:14.880271 (Thread-126): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be40cb1c0>]}
2022-03-02 14:34:14.880645 (Thread-126): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.919899 (Thread-116): 14:34:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be40b04f0>]}
2022-03-02 14:34:14.938815 (Thread-127): handling status request
2022-03-02 14:34:14.939078 (Thread-127): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be436d970>]}
2022-03-02 14:34:14.939491 (Thread-127): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:14.946716 (Thread-128): handling list request
2022-03-02 14:34:14.946946 (Thread-128): 14:34:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be41dabe0>]}
2022-03-02 14:34:14.982084 (Thread-128): 14:34:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4385d30>]}
2022-03-02 14:34:14.982361 (Thread-128): 14:34:14  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:14.986928 (Thread-128): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:15.443743 (Thread-129): handling status request
2022-03-02 14:34:15.444327 (Thread-129): 14:34:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be44550a0>]}
2022-03-02 14:34:15.444969 (Thread-129): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:15.451944 (Thread-130): handling list request
2022-03-02 14:34:15.452247 (Thread-130): 14:34:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be428d160>]}
2022-03-02 14:34:15.488208 (Thread-130): 14:34:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be41dad00>]}
2022-03-02 14:34:15.488485 (Thread-130): 14:34:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:15.493013 (Thread-130): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:15.568904 (Thread-131): handling status request
2022-03-02 14:34:15.569161 (Thread-131): 14:34:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4175160>]}
2022-03-02 14:34:15.569576 (Thread-131): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:15.754461 (Thread-132): handling status request
2022-03-02 14:34:15.754819 (Thread-132): 14:34:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4126e80>]}
2022-03-02 14:34:15.755299 (Thread-132): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:18.646779 (Thread-133): handling status request
2022-03-02 14:34:18.647176 (Thread-133): 14:34:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4175910>]}
2022-03-02 14:34:18.647685 (Thread-133): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:18.654601 (Thread-134): handling list request
2022-03-02 14:34:18.654840 (Thread-134): 14:34:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4175ee0>]}
2022-03-02 14:34:18.688509 (Thread-134): 14:34:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67ef7f0>]}
2022-03-02 14:34:18.689055 (Thread-134): 14:34:18  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:18.696881 (Thread-134): sending response (<Response 23478 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:36.144866 (Thread-135): 14:34:36  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:34:36.145356 (Thread-135): 14:34:36  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:34:36.151865 (Thread-135): 14:34:36  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:34:36.158050 (Thread-135): 14:34:36  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:34:36.218376 (Thread-135): 14:34:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c69ea30>]}
2022-03-02 14:34:36.717271 (Thread-136): handling status request
2022-03-02 14:34:36.717641 (Thread-136): 14:34:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c797850>]}
2022-03-02 14:34:36.718135 (Thread-136): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:36.726239 (Thread-137): handling list request
2022-03-02 14:34:36.726491 (Thread-137): 14:34:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c7974c0>]}
2022-03-02 14:34:36.759860 (Thread-137): 14:34:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c797ac0>]}
2022-03-02 14:34:36.760155 (Thread-137): 14:34:36  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:36.765630 (Thread-137): sending response (<Response 23478 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:36.767459 (Thread-138): handling status request
2022-03-02 14:34:36.767729 (Thread-138): 14:34:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be408f280>]}
2022-03-02 14:34:36.768118 (Thread-138): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:36.774686 (Thread-139): handling list request
2022-03-02 14:34:36.774915 (Thread-139): 14:34:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c77f160>]}
2022-03-02 14:34:36.805155 (Thread-139): 14:34:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be40b0310>]}
2022-03-02 14:34:36.805449 (Thread-139): 14:34:36  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:36.810338 (Thread-139): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:37.049639 (Thread-140): handling status request
2022-03-02 14:34:37.050011 (Thread-140): 14:34:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be41da640>]}
2022-03-02 14:34:37.050489 (Thread-140): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:37.052761 (Thread-141): handling status request
2022-03-02 14:34:37.053004 (Thread-141): 14:34:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4248190>]}
2022-03-02 14:34:37.053377 (Thread-141): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:49.723869 (Thread-143): handling status request
2022-03-02 14:34:49.724214 (Thread-143): 14:34:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c60e310>]}
2022-03-02 14:34:49.724628 (Thread-143): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:49.930628 (Thread-144): handling status request
2022-03-02 14:34:49.931640 (Thread-144): 14:34:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be40dba00>]}
2022-03-02 14:34:49.932125 (Thread-144): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:49.997233 (Thread-145): handling status request
2022-03-02 14:34:49.997671 (Thread-145): 14:34:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be41c41f0>]}
2022-03-02 14:34:50.025512 (Thread-145): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.082756 (Thread-146): handling status request
2022-03-02 14:34:50.083159 (Thread-146): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be438aa30>]}
2022-03-02 14:34:50.083574 (Thread-146): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.141690 (Thread-147): handling status request
2022-03-02 14:34:50.142164 (Thread-147): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a3bb0>]}
2022-03-02 14:34:50.142603 (Thread-147): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.200670 (Thread-148): handling status request
2022-03-02 14:34:50.201064 (Thread-148): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43976a0>]}
2022-03-02 14:34:50.201496 (Thread-148): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.258623 (Thread-149): handling status request
2022-03-02 14:34:50.259087 (Thread-149): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a81c0>]}
2022-03-02 14:34:50.259552 (Thread-149): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.265261 (Thread-142): 14:34:50  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:34:50.265776 (Thread-142): 14:34:50  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-02 14:34:50.271418 (Thread-142): 14:34:50  1603: static parser failed on stage/v_stg_orders.sql
2022-03-02 14:34:50.300644 (Thread-142): 14:34:50  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-02 14:34:50.316246 (Thread-150): handling status request
2022-03-02 14:34:50.316557 (Thread-150): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c593940>]}
2022-03-02 14:34:50.316961 (Thread-150): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.357644 (Thread-142): 14:34:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c6832b0>]}
2022-03-02 14:34:50.374596 (Thread-151): handling status request
2022-03-02 14:34:50.374905 (Thread-151): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0f4130>]}
2022-03-02 14:34:50.375341 (Thread-151): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:50.382389 (Thread-152): handling list request
2022-03-02 14:34:50.382638 (Thread-152): 14:34:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67dcd30>]}
2022-03-02 14:34:50.418904 (Thread-152): 14:34:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0f4490>]}
2022-03-02 14:34:50.419259 (Thread-152): 14:34:50  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:50.424288 (Thread-152): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:51.155083 (Thread-153): handling status request
2022-03-02 14:34:51.155438 (Thread-153): 14:34:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a3790>]}
2022-03-02 14:34:51.155957 (Thread-153): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:51.162904 (Thread-154): handling list request
2022-03-02 14:34:51.163200 (Thread-154): 14:34:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0f4130>]}
2022-03-02 14:34:51.201701 (Thread-154): 14:34:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a3520>]}
2022-03-02 14:34:51.202031 (Thread-154): 14:34:51  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:51.206719 (Thread-154): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:51.614657 (Thread-155): handling status request
2022-03-02 14:34:51.615021 (Thread-155): 14:34:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4445bb0>]}
2022-03-02 14:34:51.615519 (Thread-155): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:51.633405 (Thread-156): handling status request
2022-03-02 14:34:51.633658 (Thread-156): 14:34:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4445910>]}
2022-03-02 14:34:51.634069 (Thread-156): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:54.519564 (Thread-157): handling status request
2022-03-02 14:34:54.519972 (Thread-157): 14:34:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be438a6d0>]}
2022-03-02 14:34:54.520444 (Thread-157): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:54.526661 (Thread-158): handling list request
2022-03-02 14:34:54.526921 (Thread-158): 14:34:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be438a280>]}
2022-03-02 14:34:54.593075 (Thread-158): 14:34:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a3e50>]}
2022-03-02 14:34:54.593445 (Thread-158): 14:34:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:54.597104 (Thread-158): sending response (<Response 5463 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:56.107386 (Thread-159): handling status request
2022-03-02 14:34:56.107775 (Thread-159): 14:34:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4331670>]}
2022-03-02 14:34:56.108262 (Thread-159): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:34:56.116283 (Thread-160): handling list request
2022-03-02 14:34:56.116627 (Thread-160): 14:34:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4445eb0>]}
2022-03-02 14:34:56.155012 (Thread-160): 14:34:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be438a490>]}
2022-03-02 14:34:56.155282 (Thread-160): 14:34:56  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:34:56.161873 (Thread-160): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:03.956747 (Thread-161): handling status request
2022-03-02 14:35:03.957107 (Thread-161): 14:35:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a3bb0>]}
2022-03-02 14:35:03.957593 (Thread-161): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:04.745388 (Thread-162): handling cli_args request
2022-03-02 14:35:04.745743 (Thread-162): 14:35:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be433e970>]}
2022-03-02 14:35:04.755866 (Thread-163): handling status request
2022-03-02 14:35:04.756357 (Thread-163): 14:35:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a4d30>]}
2022-03-02 14:35:04.756891 (Thread-163): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:06.953866 (Thread-162): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:07.345578 (MainThread): 14:35:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:35:07.345994 (MainThread): 14:35:07  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:35:07.353493 (MainThread): 14:35:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3862f954-6f3a-4191-a0bb-327a38e5da26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a9126d90>]}
2022-03-02 14:35:07.388471 (MainThread): 14:35:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3862f954-6f3a-4191-a0bb-327a38e5da26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a9219af0>]}
2022-03-02 14:35:07.388714 (MainThread): 14:35:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:35:07.390778 (MainThread): 14:35:07  
2022-03-02 14:35:07.391063 (MainThread): 14:35:07  Acquiring new snowflake connection "master"
2022-03-02 14:35:07.392586 (ThreadPoolExecutor-0_0): 14:35:07  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:35:07.405405 (ThreadPoolExecutor-0_0): 14:35:07  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:35:07.405508 (ThreadPoolExecutor-0_0): 14:35:07  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:35:07.405589 (ThreadPoolExecutor-0_0): 14:35:07  Opening a new connection, currently in state init
2022-03-02 14:35:07.741052 (Thread-164): handling poll request
2022-03-02 14:35:07.741559 (Thread-164): 14:35:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c69c1f0>]}
2022-03-02 14:35:07.742475 (Thread-164): sending response (<Response 4157 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:08.331105 (ThreadPoolExecutor-0_0): 14:35:08  SQL status: SUCCESS 7 in 0.93 seconds
2022-03-02 14:35:08.333110 (ThreadPoolExecutor-0_0): 14:35:08  On list_DBT_RAW: Close
2022-03-02 14:35:08.534974 (ThreadPoolExecutor-2_0): 14:35:08  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:35:08.543008 (ThreadPoolExecutor-2_0): 14:35:08  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:35:08.543153 (ThreadPoolExecutor-2_0): 14:35:08  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:35:08.543249 (ThreadPoolExecutor-2_0): 14:35:08  Opening a new connection, currently in state closed
2022-03-02 14:35:09.373176 (ThreadPoolExecutor-2_0): 14:35:09  SQL status: SUCCESS 31 in 0.83 seconds
2022-03-02 14:35:09.375298 (ThreadPoolExecutor-2_0): 14:35:09  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:35:09.505833 (Thread-165): handling poll request
2022-03-02 14:35:09.506197 (Thread-165): 14:35:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c5fff10>]}
2022-03-02 14:35:09.506765 (Thread-165): sending response (<Response 2897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:09.592985 (MainThread): 14:35:09  Concurrency: 4 threads (target='default')
2022-03-02 14:35:09.593156 (MainThread): 14:35:09  
2022-03-02 14:35:09.595943 (Thread-3): 14:35:09  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:35:09.596259 (Thread-3): 14:35:09  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:35:09.596525 (Thread-3): 14:35:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:35:09.596627 (Thread-3): 14:35:09  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:35:09.596732 (Thread-3): 14:35:09  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:35:09.602500 (Thread-3): 14:35:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:35:09.615510 (Thread-3): 14:35:09  finished collecting timing info
2022-03-02 14:35:09.615701 (Thread-3): 14:35:09  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:35:09.639552 (Thread-3): 14:35:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:35:09.657152 (Thread-3): 14:35:09  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:35:09.657319 (Thread-3): 14:35:09  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(b.O_ORDERDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY b.O_ORDERDATE DESC)) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:35:09.657415 (Thread-3): 14:35:09  Opening a new connection, currently in state closed
2022-03-02 14:35:10.533803 (Thread-3): 14:35:10  Snowflake adapter: Snowflake query id: 01a2a88b-0503-b3d2-0000-0ed503a4c202
2022-03-02 14:35:10.534044 (Thread-3): 14:35:10  Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 39 at position 4
not enough arguments for function [NVL(LAG(B.O_ORDERDATE) OVER (PARTITION BY B.O_CUSTKEY ORDER BY B.O_ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:35:10.534290 (Thread-3): 14:35:10  finished collecting timing info
2022-03-02 14:35:10.534496 (Thread-3): 14:35:10  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:35:10.734368 (Thread-3): 14:35:10  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  000938 (22023): SQL compilation error: error line 39 at position 4
  not enough arguments for function [NVL(LAG(B.O_ORDERDATE) OVER (PARTITION BY B.O_CUSTKEY ORDER BY B.O_ORDERDATE DESC NULLS FIRST))], expected 2, got 1
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-02 14:35:10.734817 (Thread-3): 14:35:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3862f954-6f3a-4191-a0bb-327a38e5da26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa99857e820>]}
2022-03-02 14:35:10.735189 (Thread-3): 14:35:10  1 of 19 ERROR creating table model DBT_VAULT.raw_orders......................... [ERROR in 1.14s]
2022-03-02 14:35:10.735309 (Thread-3): 14:35:10  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:35:10.736357 (Thread-5): 14:35:10  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:35:10.736577 (Thread-5): 14:35:10  2 of 19 SKIP relation DBT_VAULT.v_stg_orders.................................... [SKIP]
2022-03-02 14:35:10.736696 (Thread-5): 14:35:10  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:35:10.737708 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:35:10.737853 (Thread-4): 14:35:10  3 of 19 SKIP relation DBT_VAULT.hub_customer.................................... [SKIP]
2022-03-02 14:35:10.737953 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:35:10.738071 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:35:10.738175 (Thread-4): 14:35:10  4 of 19 SKIP relation DBT_VAULT.hub_lineitem.................................... [SKIP]
2022-03-02 14:35:10.738261 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:35:10.738357 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:35:10.738456 (Thread-4): 14:35:10  5 of 19 SKIP relation DBT_VAULT.hub_nation...................................... [SKIP]
2022-03-02 14:35:10.738540 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:35:10.738637 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:35:10.738739 (Thread-4): 14:35:10  6 of 19 SKIP relation DBT_VAULT.hub_order....................................... [SKIP]
2022-03-02 14:35:10.738824 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:35:10.738921 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:35:10.739018 (Thread-4): 14:35:10  7 of 19 SKIP relation DBT_VAULT.hub_part........................................ [SKIP]
2022-03-02 14:35:10.739101 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:35:10.739195 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:35:10.739295 (Thread-4): 14:35:10  8 of 19 SKIP relation DBT_VAULT.hub_region...................................... [SKIP]
2022-03-02 14:35:10.739377 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:35:10.739469 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:35:10.739563 (Thread-4): 14:35:10  9 of 19 SKIP relation DBT_VAULT.hub_supplier.................................... [SKIP]
2022-03-02 14:35:10.739681 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:35:10.739793 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:35:10.739897 (Thread-4): 14:35:10  10 of 19 SKIP relation DBT_VAULT.link_customer_nation........................... [SKIP]
2022-03-02 14:35:10.739985 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:35:10.740077 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:35:10.740169 (Thread-4): 14:35:10  11 of 19 SKIP relation DBT_VAULT.link_customer_order............................ [SKIP]
2022-03-02 14:35:10.740252 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:35:10.740403 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:35:10.740534 (Thread-4): 14:35:10  12 of 19 SKIP relation DBT_VAULT.link_inventory_allocation...................... [SKIP]
2022-03-02 14:35:10.740621 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:35:10.740717 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:35:10.740808 (Thread-4): 14:35:10  13 of 19 SKIP relation DBT_VAULT.link_nation_region............................. [SKIP]
2022-03-02 14:35:10.740891 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:35:10.740981 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:35:10.741069 (Thread-4): 14:35:10  14 of 19 SKIP relation DBT_VAULT.link_order_lineitem............................ [SKIP]
2022-03-02 14:35:10.741152 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:35:10.741242 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:35:10.741334 (Thread-4): 14:35:10  15 of 19 SKIP relation DBT_VAULT.sat_order_cust_nation_details.................. [SKIP]
2022-03-02 14:35:10.741415 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:35:10.741529 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:35:10.741639 (Thread-4): 14:35:10  16 of 19 SKIP relation DBT_VAULT.sat_order_cust_region_details.................. [SKIP]
2022-03-02 14:35:10.741727 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:35:10.741820 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:35:10.741910 (Thread-4): 14:35:10  17 of 19 SKIP relation DBT_VAULT.sat_order_customer_details..................... [SKIP]
2022-03-02 14:35:10.741991 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:35:10.742079 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:35:10.742169 (Thread-4): 14:35:10  18 of 19 SKIP relation DBT_VAULT.sat_order_lineitem_details..................... [SKIP]
2022-03-02 14:35:10.742251 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:35:10.742344 (Thread-4): 14:35:10  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:35:10.742435 (Thread-4): 14:35:10  19 of 19 SKIP relation DBT_VAULT.sat_order_order_details........................ [SKIP]
2022-03-02 14:35:10.742514 (Thread-4): 14:35:10  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:35:10.745723 (MainThread): 14:35:10  Acquiring new snowflake connection "master"
2022-03-02 14:35:10.746096 (MainThread): 14:35:10  
2022-03-02 14:35:10.746199 (MainThread): 14:35:10  Finished running 2 table models, 17 incremental models in 3.36s.
2022-03-02 14:35:10.746288 (MainThread): 14:35:10  Connection 'master' was properly closed.
2022-03-02 14:35:10.746356 (MainThread): 14:35:10  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-02 14:35:10.832942 (MainThread): 14:35:10  
2022-03-02 14:35:10.833170 (MainThread): 14:35:10  Completed with 1 error and 0 warnings:
2022-03-02 14:35:10.833263 (MainThread): 14:35:10  
2022-03-02 14:35:10.833353 (MainThread): 14:35:10  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
2022-03-02 14:35:10.833430 (MainThread): 14:35:10    000938 (22023): SQL compilation error: error line 39 at position 4
2022-03-02 14:35:10.833501 (MainThread): 14:35:10    not enough arguments for function [NVL(LAG(B.O_ORDERDATE) OVER (PARTITION BY B.O_CUSTKEY ORDER BY B.O_ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:35:10.833567 (MainThread): 14:35:10    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-02 14:35:10.833657 (MainThread): 14:35:10  
2022-03-02 14:35:10.833744 (MainThread): 14:35:10  Done. PASS=0 WARN=0 ERROR=1 SKIP=18 TOTAL=19
2022-03-02 14:35:12.245217 (Thread-166): handling poll request
2022-03-02 14:35:12.245591 (Thread-166): 14:35:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4d4670>]}
2022-03-02 14:35:12.248505 (Thread-166): sending response (<Response 93356 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:13.503416 (Thread-167): handling status request
2022-03-02 14:35:13.503820 (Thread-167): 14:35:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4d4820>]}
2022-03-02 14:35:13.504389 (Thread-167): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:13.614225 (Thread-168): handling status request
2022-03-02 14:35:13.614601 (Thread-168): 14:35:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4d4c10>]}
2022-03-02 14:35:13.615095 (Thread-168): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:14.906347 (Thread-169): handling status request
2022-03-02 14:35:14.906707 (Thread-169): 14:35:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4d4e50>]}
2022-03-02 14:35:14.907194 (Thread-169): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:35:14.913631 (Thread-170): handling list request
2022-03-02 14:35:14.913890 (Thread-170): 14:35:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4e2070>]}
2022-03-02 14:35:14.975677 (Thread-170): 14:35:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6782d60>]}
2022-03-02 14:35:14.976076 (Thread-170): 14:35:14  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:35:14.983544 (Thread-170): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:41:53.687753 (Thread-171): handling status request
2022-03-02 14:41:53.689327 (Thread-171): 14:41:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c480790>]}
2022-03-02 14:41:53.689828 (Thread-171): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:41:53.700874 (Thread-172): handling list request
2022-03-02 14:41:53.701125 (Thread-172): 14:41:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c480bb0>]}
2022-03-02 14:41:53.742444 (Thread-172): 14:41:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4805b0>]}
2022-03-02 14:41:53.742787 (Thread-172): 14:41:53  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:41:53.751921 (Thread-172): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:03.774586 (Thread-173): handling status request
2022-03-02 14:42:03.774962 (Thread-173): 14:42:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c448490>]}
2022-03-02 14:42:03.775445 (Thread-173): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:04.244243 (Thread-174): handling status request
2022-03-02 14:42:04.244628 (Thread-174): 14:42:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c448790>]}
2022-03-02 14:42:04.245279 (Thread-174): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:04.430901 (Thread-175): handling cli_args request
2022-03-02 14:42:04.431266 (Thread-175): 14:42:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c47a670>]}
2022-03-02 14:42:06.680411 (Thread-175): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:07.214396 (MainThread): 14:42:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:42:07.214824 (MainThread): 14:42:07  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:42:07.222294 (MainThread): 14:42:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3402de77-dc1a-4460-aaf1-f3acbc46dbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955f7e6130>]}
2022-03-02 14:42:07.255302 (MainThread): 14:42:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3402de77-dc1a-4460-aaf1-f3acbc46dbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955f8deb80>]}
2022-03-02 14:42:07.255545 (MainThread): 14:42:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:42:07.257712 (MainThread): 14:42:07  
2022-03-02 14:42:07.257995 (MainThread): 14:42:07  Acquiring new snowflake connection "master"
2022-03-02 14:42:07.259508 (ThreadPoolExecutor-0_0): 14:42:07  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:42:07.272269 (ThreadPoolExecutor-0_0): 14:42:07  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:42:07.272371 (ThreadPoolExecutor-0_0): 14:42:07  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:42:07.272453 (ThreadPoolExecutor-0_0): 14:42:07  Opening a new connection, currently in state init
2022-03-02 14:42:07.470045 (Thread-176): handling poll request
2022-03-02 14:42:07.470459 (Thread-176): 14:42:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c45c430>]}
2022-03-02 14:42:07.471292 (Thread-176): sending response (<Response 4158 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:08.212259 (ThreadPoolExecutor-0_0): 14:42:08  SQL status: SUCCESS 7 in 0.94 seconds
2022-03-02 14:42:08.214299 (ThreadPoolExecutor-0_0): 14:42:08  On list_DBT_RAW: Close
2022-03-02 14:42:08.435454 (ThreadPoolExecutor-2_0): 14:42:08  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:42:08.443461 (ThreadPoolExecutor-2_0): 14:42:08  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:42:08.443626 (ThreadPoolExecutor-2_0): 14:42:08  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:42:08.443762 (ThreadPoolExecutor-2_0): 14:42:08  Opening a new connection, currently in state closed
2022-03-02 14:42:09.292245 (ThreadPoolExecutor-2_0): 14:42:09  SQL status: SUCCESS 31 in 0.85 seconds
2022-03-02 14:42:09.294347 (ThreadPoolExecutor-2_0): 14:42:09  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:42:09.299674 (Thread-177): handling poll request
2022-03-02 14:42:09.299990 (Thread-177): 14:42:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c463610>]}
2022-03-02 14:42:09.300523 (Thread-177): sending response (<Response 2897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:09.498282 (MainThread): 14:42:09  Concurrency: 4 threads (target='default')
2022-03-02 14:42:09.498458 (MainThread): 14:42:09  
2022-03-02 14:42:09.501340 (Thread-3): 14:42:09  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:42:09.501652 (Thread-3): 14:42:09  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:42:09.501920 (Thread-3): 14:42:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:42:09.502027 (Thread-3): 14:42:09  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:42:09.502133 (Thread-3): 14:42:09  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:42:09.507754 (Thread-3): 14:42:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:42:09.524381 (Thread-3): 14:42:09  finished collecting timing info
2022-03-02 14:42:09.524546 (Thread-3): 14:42:09  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:42:09.558171 (Thread-3): 14:42:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:42:09.578875 (Thread-3): 14:42:09  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:42:09.579022 (Thread-3): 14:42:09  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(b.O_ORDERDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY b.O_ORDERDATE DESC)) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:42:09.579115 (Thread-3): 14:42:09  Opening a new connection, currently in state closed
2022-03-02 14:42:10.977982 (Thread-3): 14:42:10  Snowflake adapter: Snowflake query id: 01a2a892-0503-b3d2-0000-0ed503a4c302
2022-03-02 14:42:10.978153 (Thread-3): 14:42:10  Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 39 at position 4
not enough arguments for function [NVL(LAG(B.O_ORDERDATE) OVER (PARTITION BY B.O_CUSTKEY ORDER BY B.O_ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:42:10.978320 (Thread-3): 14:42:10  finished collecting timing info
2022-03-02 14:42:10.978459 (Thread-3): 14:42:10  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:42:11.102188 (Thread-178): handling poll request
2022-03-02 14:42:11.102551 (Thread-178): 14:42:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c3fc310>]}
2022-03-02 14:42:11.103224 (Thread-178): sending response (<Response 10370 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:11.221637 (Thread-3): 14:42:11  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  000938 (22023): SQL compilation error: error line 39 at position 4
  not enough arguments for function [NVL(LAG(B.O_ORDERDATE) OVER (PARTITION BY B.O_CUSTKEY ORDER BY B.O_ORDERDATE DESC NULLS FIRST))], expected 2, got 1
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-02 14:42:11.222087 (Thread-3): 14:42:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3402de77-dc1a-4460-aaf1-f3acbc46dbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955d4a2f10>]}
2022-03-02 14:42:11.222461 (Thread-3): 14:42:11  1 of 19 ERROR creating table model DBT_VAULT.raw_orders......................... [ERROR in 1.72s]
2022-03-02 14:42:11.222580 (Thread-3): 14:42:11  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:42:11.223573 (Thread-5): 14:42:11  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:42:11.223793 (Thread-5): 14:42:11  2 of 19 SKIP relation DBT_VAULT.v_stg_orders.................................... [SKIP]
2022-03-02 14:42:11.223902 (Thread-5): 14:42:11  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:42:11.225092 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:42:11.225339 (Thread-4): 14:42:11  3 of 19 SKIP relation DBT_VAULT.hub_customer.................................... [SKIP]
2022-03-02 14:42:11.225515 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:42:11.225718 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:42:11.225915 (Thread-4): 14:42:11  4 of 19 SKIP relation DBT_VAULT.hub_lineitem.................................... [SKIP]
2022-03-02 14:42:11.226091 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:42:11.226214 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:42:11.226334 (Thread-4): 14:42:11  5 of 19 SKIP relation DBT_VAULT.hub_nation...................................... [SKIP]
2022-03-02 14:42:11.226439 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:42:11.226547 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:42:11.226669 (Thread-4): 14:42:11  6 of 19 SKIP relation DBT_VAULT.hub_order....................................... [SKIP]
2022-03-02 14:42:11.226766 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:42:11.226881 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:42:11.226998 (Thread-4): 14:42:11  7 of 19 SKIP relation DBT_VAULT.hub_part........................................ [SKIP]
2022-03-02 14:42:11.227087 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:42:11.227185 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:42:11.227293 (Thread-4): 14:42:11  8 of 19 SKIP relation DBT_VAULT.hub_region...................................... [SKIP]
2022-03-02 14:42:11.227384 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:42:11.227490 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:42:11.227643 (Thread-4): 14:42:11  9 of 19 SKIP relation DBT_VAULT.hub_supplier.................................... [SKIP]
2022-03-02 14:42:11.227755 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:42:11.227858 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:42:11.227966 (Thread-4): 14:42:11  10 of 19 SKIP relation DBT_VAULT.link_customer_nation........................... [SKIP]
2022-03-02 14:42:11.228096 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:42:11.228208 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:42:11.228306 (Thread-4): 14:42:11  11 of 19 SKIP relation DBT_VAULT.link_customer_order............................ [SKIP]
2022-03-02 14:42:11.228400 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:42:11.228504 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:42:11.228604 (Thread-4): 14:42:11  12 of 19 SKIP relation DBT_VAULT.link_inventory_allocation...................... [SKIP]
2022-03-02 14:42:11.228695 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:42:11.228802 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:42:11.228900 (Thread-4): 14:42:11  13 of 19 SKIP relation DBT_VAULT.link_nation_region............................. [SKIP]
2022-03-02 14:42:11.228997 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:42:11.229115 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:42:11.229214 (Thread-4): 14:42:11  14 of 19 SKIP relation DBT_VAULT.link_order_lineitem............................ [SKIP]
2022-03-02 14:42:11.229322 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:42:11.229424 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:42:11.229529 (Thread-4): 14:42:11  15 of 19 SKIP relation DBT_VAULT.sat_order_cust_nation_details.................. [SKIP]
2022-03-02 14:42:11.229666 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:42:11.229848 (Thread-4): 14:42:11  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:42:11.230156 (Thread-3): 14:42:11  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:42:11.230329 (Thread-3): 14:42:11  17 of 19 SKIP relation DBT_VAULT.sat_order_customer_details..................... [SKIP]
2022-03-02 14:42:11.230436 (Thread-3): 14:42:11  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:42:11.230543 (Thread-3): 14:42:11  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:42:11.230642 (Thread-3): 14:42:11  18 of 19 SKIP relation DBT_VAULT.sat_order_lineitem_details..................... [SKIP]
2022-03-02 14:42:11.230727 (Thread-3): 14:42:11  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:42:11.230847 (Thread-3): 14:42:11  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:42:11.230973 (Thread-3): 14:42:11  19 of 19 SKIP relation DBT_VAULT.sat_order_order_details........................ [SKIP]
2022-03-02 14:42:11.231810 (Thread-4): 14:42:11  16 of 19 SKIP relation DBT_VAULT.sat_order_cust_region_details.................. [SKIP]
2022-03-02 14:42:11.231973 (Thread-4): 14:42:11  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:42:11.232712 (Thread-3): 14:42:11  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:42:11.234538 (MainThread): 14:42:11  Acquiring new snowflake connection "master"
2022-03-02 14:42:11.234907 (MainThread): 14:42:11  
2022-03-02 14:42:11.235011 (MainThread): 14:42:11  Finished running 2 table models, 17 incremental models in 3.98s.
2022-03-02 14:42:11.235099 (MainThread): 14:42:11  Connection 'master' was properly closed.
2022-03-02 14:42:11.235167 (MainThread): 14:42:11  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-02 14:42:11.314323 (MainThread): 14:42:11  
2022-03-02 14:42:11.314553 (MainThread): 14:42:11  Completed with 1 error and 0 warnings:
2022-03-02 14:42:11.314665 (MainThread): 14:42:11  
2022-03-02 14:42:11.314757 (MainThread): 14:42:11  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
2022-03-02 14:42:11.314834 (MainThread): 14:42:11    000938 (22023): SQL compilation error: error line 39 at position 4
2022-03-02 14:42:11.314903 (MainThread): 14:42:11    not enough arguments for function [NVL(LAG(B.O_ORDERDATE) OVER (PARTITION BY B.O_CUSTKEY ORDER BY B.O_ORDERDATE DESC NULLS FIRST))], expected 2, got 1
2022-03-02 14:42:11.314967 (MainThread): 14:42:11    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-02 14:42:11.315056 (MainThread): 14:42:11  
2022-03-02 14:42:11.315144 (MainThread): 14:42:11  Done. PASS=0 WARN=0 ERROR=1 SKIP=18 TOTAL=19
2022-03-02 14:42:12.920195 (Thread-179): handling poll request
2022-03-02 14:42:12.920569 (Thread-179): 14:42:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c476550>]}
2022-03-02 14:42:12.923148 (Thread-179): sending response (<Response 83307 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:14.383067 (Thread-180): handling status request
2022-03-02 14:42:14.383460 (Thread-180): 14:42:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c45c4c0>]}
2022-03-02 14:42:14.384049 (Thread-180): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:14.678209 (Thread-181): handling status request
2022-03-02 14:42:14.678604 (Thread-181): 14:42:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c45cc40>]}
2022-03-02 14:42:14.679113 (Thread-181): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:33.875547 (Thread-182): handling status request
2022-03-02 14:42:33.875930 (Thread-182): 14:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c45c670>]}
2022-03-02 14:42:33.876397 (Thread-182): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:42:33.883433 (Thread-183): handling list request
2022-03-02 14:42:33.883722 (Thread-183): 14:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c45c490>]}
2022-03-02 14:42:33.921667 (Thread-183): 14:42:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c45c9a0>]}
2022-03-02 14:42:33.921949 (Thread-183): 14:42:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:42:33.928013 (Thread-183): sending response (<Response 23478 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:00.810271 (Thread-184): 14:43:00  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:43:00.810802 (Thread-184): 14:43:00  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:43:00.817326 (Thread-184): 14:43:00  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:43:00.824064 (Thread-184): 14:43:00  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:43:00.876082 (Thread-184): 14:43:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c235f70>]}
2022-03-02 14:43:01.309627 (Thread-185): handling status request
2022-03-02 14:43:01.310048 (Thread-185): 14:43:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be433e400>]}
2022-03-02 14:43:01.310608 (Thread-185): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:01.329891 (Thread-186): handling list request
2022-03-02 14:43:01.330207 (Thread-186): 14:43:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c436550>]}
2022-03-02 14:43:01.367378 (Thread-186): 14:43:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c476ee0>]}
2022-03-02 14:43:01.367786 (Thread-186): 14:43:01  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:43:01.373672 (Thread-186): sending response (<Response 23478 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:01.828365 (Thread-187): handling status request
2022-03-02 14:43:01.832797 (Thread-187): 14:43:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4d4250>]}
2022-03-02 14:43:01.833327 (Thread-187): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:01.995046 (Thread-188): handling status request
2022-03-02 14:43:01.995420 (Thread-188): 14:43:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4b3730>]}
2022-03-02 14:43:01.995961 (Thread-188): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:09.825563 (Thread-189): handling status request
2022-03-02 14:43:09.825931 (Thread-189): 14:43:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c491b50>]}
2022-03-02 14:43:09.826417 (Thread-189): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:09.843922 (Thread-190): handling list request
2022-03-02 14:43:09.844259 (Thread-190): 14:43:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4919d0>]}
2022-03-02 14:43:09.878640 (Thread-190): 14:43:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67dcd30>]}
2022-03-02 14:43:09.879006 (Thread-190): 14:43:09  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:43:09.884455 (Thread-190): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:13.980782 (Thread-191): handling status request
2022-03-02 14:43:13.981132 (Thread-191): 14:43:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c47a520>]}
2022-03-02 14:43:13.981615 (Thread-191): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:13.988494 (Thread-192): handling list request
2022-03-02 14:43:13.988759 (Thread-192): 14:43:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c22f6a0>]}
2022-03-02 14:43:14.022171 (Thread-192): 14:43:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c60ee80>]}
2022-03-02 14:43:14.022484 (Thread-192): 14:43:14  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:43:14.025884 (Thread-192): sending response (<Response 5463 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:32.870929 (Thread-193): handling status request
2022-03-02 14:43:32.871557 (Thread-193): 14:43:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c46a1c0>]}
2022-03-02 14:43:32.872062 (Thread-193): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:32.879161 (Thread-194): handling list request
2022-03-02 14:43:32.879405 (Thread-194): 14:43:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c234e50>]}
2022-03-02 14:43:32.934653 (Thread-194): 14:43:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c2113a0>]}
2022-03-02 14:43:32.935005 (Thread-194): 14:43:32  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:43:32.939896 (Thread-194): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:37.794542 (Thread-195): handling status request
2022-03-02 14:43:37.794913 (Thread-195): 14:43:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c211c10>]}
2022-03-02 14:43:37.795398 (Thread-195): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:37.802551 (Thread-196): handling list request
2022-03-02 14:43:37.802837 (Thread-196): 14:43:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c4e2f40>]}
2022-03-02 14:43:37.841882 (Thread-196): 14:43:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c234f70>]}
2022-03-02 14:43:37.842207 (Thread-196): 14:43:37  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:43:37.845642 (Thread-196): sending response (<Response 5463 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:49.640039 (Thread-197): handling status request
2022-03-02 14:43:49.640436 (Thread-197): 14:43:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c21b2b0>]}
2022-03-02 14:43:49.640929 (Thread-197): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:43:49.659328 (Thread-198): handling list request
2022-03-02 14:43:49.659585 (Thread-198): 14:43:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c21bdc0>]}
2022-03-02 14:43:49.693823 (Thread-198): 14:43:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c234fa0>]}
2022-03-02 14:43:49.694281 (Thread-198): 14:43:49  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:43:49.699714 (Thread-198): sending response (<Response 16868 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:12.912954 (Thread-199): handling status request
2022-03-02 14:44:12.913321 (Thread-199): 14:44:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c234af0>]}
2022-03-02 14:44:12.913798 (Thread-199): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:12.920971 (Thread-200): handling list request
2022-03-02 14:44:12.921222 (Thread-200): 14:44:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c21bdf0>]}
2022-03-02 14:44:12.958460 (Thread-200): 14:44:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c1e0790>]}
2022-03-02 14:44:12.958792 (Thread-200): 14:44:12  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:44:12.966659 (Thread-200): sending response (<Response 5463 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:17.782183 (Thread-201): 14:44:17  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:44:17.782689 (Thread-201): 14:44:17  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 14:44:17.788973 (Thread-201): 14:44:17  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 14:44:17.800191 (Thread-201): 14:44:17  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 14:44:17.854412 (Thread-201): 14:44:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7876af70>]}
2022-03-02 14:44:18.075277 (Thread-202): handling status request
2022-03-02 14:44:18.075769 (Thread-202): 14:44:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c182c10>]}
2022-03-02 14:44:18.076305 (Thread-202): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:18.084747 (Thread-203): handling list request
2022-03-02 14:44:18.085053 (Thread-203): 14:44:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c18ff40>]}
2022-03-02 14:44:18.121796 (Thread-203): 14:44:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c179f40>]}
2022-03-02 14:44:18.122184 (Thread-203): 14:44:18  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:44:18.126107 (Thread-203): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:18.605933 (Thread-204): handling status request
2022-03-02 14:44:18.606295 (Thread-204): 14:44:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c179b80>]}
2022-03-02 14:44:18.607098 (Thread-204): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:18.741181 (Thread-205): handling status request
2022-03-02 14:44:18.741596 (Thread-205): 14:44:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c18fca0>]}
2022-03-02 14:44:18.742095 (Thread-205): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:24.229225 (Thread-206): handling status request
2022-03-02 14:44:24.229618 (Thread-206): 14:44:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7873b850>]}
2022-03-02 14:44:24.230142 (Thread-206): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:24.237286 (Thread-207): handling list request
2022-03-02 14:44:24.237543 (Thread-207): 14:44:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c211be0>]}
2022-03-02 14:44:24.272356 (Thread-207): 14:44:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7873be50>]}
2022-03-02 14:44:24.272627 (Thread-207): 14:44:24  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:44:24.277023 (Thread-207): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:27.114635 (Thread-208): handling status request
2022-03-02 14:44:27.114994 (Thread-208): 14:44:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c1967f0>]}
2022-03-02 14:44:27.115471 (Thread-208): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:27.413528 (Thread-209): handling status request
2022-03-02 14:44:27.413906 (Thread-209): 14:44:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c196760>]}
2022-03-02 14:44:27.414390 (Thread-209): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:27.728954 (Thread-210): handling cli_args request
2022-03-02 14:44:27.729313 (Thread-210): 14:44:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c196070>]}
2022-03-02 14:44:29.914345 (Thread-210): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:30.304974 (MainThread): 14:44:30  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:44:30.305409 (MainThread): 14:44:30  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:44:30.312880 (MainThread): 14:44:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce61c2bd90>]}
2022-03-02 14:44:30.346265 (MainThread): 14:44:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce61d03af0>]}
2022-03-02 14:44:30.346712 (MainThread): 14:44:30  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:44:30.350169 (MainThread): 14:44:30  
2022-03-02 14:44:30.350631 (MainThread): 14:44:30  Acquiring new snowflake connection "master"
2022-03-02 14:44:30.353270 (ThreadPoolExecutor-0_0): 14:44:30  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:44:30.370159 (ThreadPoolExecutor-0_0): 14:44:30  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:44:30.370299 (ThreadPoolExecutor-0_0): 14:44:30  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:44:30.370385 (ThreadPoolExecutor-0_0): 14:44:30  Opening a new connection, currently in state init
2022-03-02 14:44:30.719859 (Thread-211): handling poll request
2022-03-02 14:44:30.720302 (Thread-211): 14:44:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c1795b0>]}
2022-03-02 14:44:30.721197 (Thread-211): sending response (<Response 4158 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:31.384906 (ThreadPoolExecutor-0_0): 14:44:31  SQL status: SUCCESS 7 in 1.01 seconds
2022-03-02 14:44:31.387363 (ThreadPoolExecutor-0_0): 14:44:31  On list_DBT_RAW: Close
2022-03-02 14:44:31.699116 (ThreadPoolExecutor-2_0): 14:44:31  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:44:31.707139 (ThreadPoolExecutor-2_0): 14:44:31  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:44:31.707285 (ThreadPoolExecutor-2_0): 14:44:31  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:44:31.707384 (ThreadPoolExecutor-2_0): 14:44:31  Opening a new connection, currently in state closed
2022-03-02 14:44:32.827412 (ThreadPoolExecutor-2_0): 14:44:32  SQL status: SUCCESS 31 in 1.12 seconds
2022-03-02 14:44:32.829733 (ThreadPoolExecutor-2_0): 14:44:32  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:44:33.103721 (MainThread): 14:44:33  Concurrency: 4 threads (target='default')
2022-03-02 14:44:33.103897 (MainThread): 14:44:33  
2022-03-02 14:44:33.106637 (Thread-3): 14:44:33  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:44:33.106949 (Thread-3): 14:44:33  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:44:33.107214 (Thread-3): 14:44:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:44:33.107316 (Thread-3): 14:44:33  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:44:33.107424 (Thread-3): 14:44:33  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:44:33.113369 (Thread-3): 14:44:33  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:44:33.127359 (Thread-3): 14:44:33  finished collecting timing info
2022-03-02 14:44:33.127523 (Thread-3): 14:44:33  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:44:33.151513 (Thread-3): 14:44:33  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:44:33.167385 (Thread-3): 14:44:33  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:44:33.167532 (Thread-3): 14:44:33  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(b.O_ORDERDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY b.O_ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:44:33.167660 (Thread-3): 14:44:33  Opening a new connection, currently in state closed
2022-03-02 14:44:33.443107 (Thread-212): handling poll request
2022-03-02 14:44:33.443491 (Thread-212): 14:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7875f100>]}
2022-03-02 14:44:33.444291 (Thread-212): sending response (<Response 11218 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:35.223901 (Thread-213): handling poll request
2022-03-02 14:44:35.224261 (Thread-213): 14:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7875f730>]}
2022-03-02 14:44:35.224766 (Thread-213): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:37.005054 (Thread-214): handling poll request
2022-03-02 14:44:37.005421 (Thread-214): 14:44:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c146100>]}
2022-03-02 14:44:37.005907 (Thread-214): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:38.774911 (Thread-215): handling poll request
2022-03-02 14:44:38.775276 (Thread-215): 14:44:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c146940>]}
2022-03-02 14:44:38.775789 (Thread-215): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:40.541973 (Thread-216): handling poll request
2022-03-02 14:44:40.542347 (Thread-216): 14:44:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c0aed00>]}
2022-03-02 14:44:40.542838 (Thread-216): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:42.752812 (Thread-3): 14:44:42  SQL status: SUCCESS 1 in 9.59 seconds
2022-03-02 14:44:42.762029 (Thread-3): 14:44:42  finished collecting timing info
2022-03-02 14:44:42.762202 (Thread-3): 14:44:42  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:44:43.011942 (Thread-3): 14:44:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce600bfbb0>]}
2022-03-02 14:44:43.012374 (Thread-3): 14:44:43  1 of 19 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 9.90s]
2022-03-02 14:44:43.012501 (Thread-3): 14:44:43  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:44:43.013523 (Thread-5): 14:44:43  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:44:43.013789 (Thread-5): 14:44:43  2 of 19 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:44:43.014074 (Thread-5): 14:44:43  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:44:43.014167 (Thread-5): 14:44:43  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:44:43.014258 (Thread-5): 14:44:43  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:44:43.053565 (Thread-5): 14:44:43  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:44:43.053728 (Thread-5): 14:44:43  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:44:43.053821 (Thread-5): 14:44:43  Opening a new connection, currently in state init
2022-03-02 14:44:43.255845 (Thread-217): handling poll request
2022-03-02 14:44:43.256236 (Thread-217): 14:44:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c0ae6a0>]}
2022-03-02 14:44:43.256905 (Thread-217): sending response (<Response 6307 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:44.015788 (Thread-5): 14:44:44  SQL status: SUCCESS 37 in 0.96 seconds
2022-03-02 14:44:44.046374 (Thread-5): 14:44:44  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:44:44.046531 (Thread-5): 14:44:44  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:44:44.211033 (Thread-5): 14:44:44  SQL status: SUCCESS 37 in 0.16 seconds
2022-03-02 14:44:44.280009 (Thread-5): 14:44:44  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:44:44.306955 (Thread-5): 14:44:44  finished collecting timing info
2022-03-02 14:44:44.307164 (Thread-5): 14:44:44  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:44:44.310087 (Thread-5): 14:44:44  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:44:44.345705 (Thread-5): 14:44:44  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:44:44.345871 (Thread-5): 14:44:44  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:44:45.027698 (Thread-218): handling poll request
2022-03-02 14:44:45.028081 (Thread-218): 14:44:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c0ae5e0>]}
2022-03-02 14:44:45.055098 (Thread-218): sending response (<Response 14698 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:46.505171 (Thread-5): 14:44:46  SQL status: SUCCESS 1 in 2.16 seconds
2022-03-02 14:44:46.506600 (Thread-5): 14:44:46  finished collecting timing info
2022-03-02 14:44:46.506762 (Thread-5): 14:44:46  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:44:46.734726 (Thread-5): 14:44:46  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce507dcdc0>]}
2022-03-02 14:44:46.735149 (Thread-5): 14:44:46  2 of 19 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.72s]
2022-03-02 14:44:46.735276 (Thread-5): 14:44:46  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:44:46.736620 (Thread-4): 14:44:46  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:44:46.736892 (Thread-4): 14:44:46  3 of 19 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 14:44:46.816987 (Thread-219): handling poll request
2022-03-02 14:44:46.817294 (Thread-219): 14:44:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78772d90>]}
2022-03-02 14:44:46.817891 (Thread-219): sending response (<Response 3953 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:46.737174 (Thread-4): 14:44:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:44:46.737269 (Thread-4): 14:44:46  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:44:46.737360 (Thread-4): 14:44:46  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:44:46.741698 (Thread-3): 14:44:46  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:44:46.741922 (Thread-3): 14:44:46  4 of 19 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 14:44:46.742162 (Thread-3): 14:44:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:44:46.742270 (Thread-3): 14:44:46  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:44:46.742358 (Thread-3): 14:44:46  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:44:46.746783 (Thread-6): 14:44:46  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:44:46.747018 (Thread-6): 14:44:46  5 of 19 START incremental model DBT_VAULT.hub_nation............................ [RUN]
2022-03-02 14:44:46.747273 (Thread-6): 14:44:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:44:46.747361 (Thread-6): 14:44:46  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:44:46.747444 (Thread-6): 14:44:46  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:44:46.751801 (Thread-5): 14:44:46  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:44:46.751997 (Thread-5): 14:44:46  6 of 19 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 14:44:46.752215 (Thread-5): 14:44:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:44:46.752300 (Thread-5): 14:44:46  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:44:46.752381 (Thread-5): 14:44:46  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:44:46.927528 (Thread-4): 14:44:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:44:46.930689 (Thread-3): 14:44:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:44:46.933453 (Thread-6): 14:44:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:44:46.938574 (Thread-5): 14:44:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:44:46.943358 (Thread-4): 14:44:46  finished collecting timing info
2022-03-02 14:44:46.943511 (Thread-4): 14:44:46  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:44:46.968218 (Thread-4): 14:44:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:44:46.968491 (Thread-6): 14:44:46  finished collecting timing info
2022-03-02 14:44:46.968647 (Thread-6): 14:44:46  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:44:46.971690 (Thread-6): 14:44:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:44:46.972052 (Thread-5): 14:44:46  finished collecting timing info
2022-03-02 14:44:46.972194 (Thread-5): 14:44:46  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:44:46.975925 (Thread-5): 14:44:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:44:46.976277 (Thread-3): 14:44:46  finished collecting timing info
2022-03-02 14:44:46.976417 (Thread-3): 14:44:46  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:44:46.979070 (Thread-3): 14:44:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:44:46.985903 (Thread-4): 14:44:46  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:44:46.986029 (Thread-4): 14:44:46  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:46.986120 (Thread-4): 14:44:46  Opening a new connection, currently in state init
2022-03-02 14:44:47.004521 (Thread-6): 14:44:47  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:44:47.004678 (Thread-6): 14:44:47  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:47.004769 (Thread-6): 14:44:47  Opening a new connection, currently in state init
2022-03-02 14:44:47.006528 (Thread-3): 14:44:47  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:44:47.006651 (Thread-3): 14:44:47  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:47.006733 (Thread-3): 14:44:47  Opening a new connection, currently in state closed
2022-03-02 14:44:47.008314 (Thread-5): 14:44:47  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:44:47.008430 (Thread-5): 14:44:47  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:47.008511 (Thread-5): 14:44:47  Opening a new connection, currently in state closed
2022-03-02 14:44:48.569994 (Thread-220): handling poll request
2022-03-02 14:44:48.570359 (Thread-220): 14:44:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c047610>]}
2022-03-02 14:44:48.571317 (Thread-220): sending response (<Response 22602 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:49.244563 (Thread-4): 14:44:49  SQL status: SUCCESS 1 in 2.26 seconds
2022-03-02 14:44:49.246609 (Thread-4): 14:44:49  finished collecting timing info
2022-03-02 14:44:49.246829 (Thread-4): 14:44:49  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 14:44:49.342634 (Thread-3): 14:44:49  SQL status: SUCCESS 1 in 2.34 seconds
2022-03-02 14:44:49.343982 (Thread-3): 14:44:49  finished collecting timing info
2022-03-02 14:44:49.344130 (Thread-3): 14:44:49  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 14:44:49.437765 (Thread-5): 14:44:49  SQL status: SUCCESS 1 in 2.43 seconds
2022-03-02 14:44:49.439187 (Thread-5): 14:44:49  finished collecting timing info
2022-03-02 14:44:49.439341 (Thread-5): 14:44:49  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 14:44:49.483714 (Thread-4): 14:44:49  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5073fd90>]}
2022-03-02 14:44:49.484105 (Thread-4): 14:44:49  3 of 19 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 2.75s]
2022-03-02 14:44:49.484229 (Thread-4): 14:44:49  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:44:49.484369 (Thread-4): 14:44:49  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:44:49.484550 (Thread-4): 14:44:49  7 of 19 START incremental model DBT_VAULT.hub_part.............................. [RUN]
2022-03-02 14:44:49.484788 (Thread-4): 14:44:49  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:44:49.484879 (Thread-4): 14:44:49  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:44:49.484966 (Thread-4): 14:44:49  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:44:49.494771 (Thread-4): 14:44:49  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:44:49.507340 (Thread-4): 14:44:49  finished collecting timing info
2022-03-02 14:44:49.507481 (Thread-4): 14:44:49  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:44:49.510204 (Thread-4): 14:44:49  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:44:49.524328 (Thread-4): 14:44:49  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:44:49.524449 (Thread-4): 14:44:49  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:49.524537 (Thread-4): 14:44:49  Opening a new connection, currently in state closed
2022-03-02 14:44:49.582476 (Thread-3): 14:44:49  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce507f4430>]}
2022-03-02 14:44:49.582869 (Thread-3): 14:44:49  4 of 19 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 2.84s]
2022-03-02 14:44:49.582992 (Thread-3): 14:44:49  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:44:49.583138 (Thread-3): 14:44:49  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:44:49.583314 (Thread-3): 14:44:49  8 of 19 START incremental model DBT_VAULT.hub_region............................ [RUN]
2022-03-02 14:44:49.583546 (Thread-3): 14:44:49  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:44:49.583671 (Thread-3): 14:44:49  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:44:49.583761 (Thread-3): 14:44:49  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:44:49.594249 (Thread-3): 14:44:49  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:44:49.606783 (Thread-3): 14:44:49  finished collecting timing info
2022-03-02 14:44:49.606930 (Thread-3): 14:44:49  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:44:49.609898 (Thread-3): 14:44:49  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:44:49.623659 (Thread-3): 14:44:49  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:44:49.623779 (Thread-3): 14:44:49  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:49.623867 (Thread-3): 14:44:49  Opening a new connection, currently in state closed
2022-03-02 14:44:49.678203 (Thread-5): 14:44:49  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce507ef340>]}
2022-03-02 14:44:49.678640 (Thread-5): 14:44:49  6 of 19 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 2.93s]
2022-03-02 14:44:49.678767 (Thread-5): 14:44:49  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:44:49.678908 (Thread-5): 14:44:49  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:44:49.679085 (Thread-5): 14:44:49  9 of 19 START incremental model DBT_VAULT.hub_supplier.......................... [RUN]
2022-03-02 14:44:49.679328 (Thread-5): 14:44:49  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:44:49.679417 (Thread-5): 14:44:49  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:44:49.679505 (Thread-5): 14:44:49  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:44:49.688801 (Thread-5): 14:44:49  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:44:49.703247 (Thread-5): 14:44:49  finished collecting timing info
2022-03-02 14:44:49.703418 (Thread-5): 14:44:49  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:44:49.706539 (Thread-5): 14:44:49  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:44:49.720856 (Thread-5): 14:44:49  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:44:49.720991 (Thread-5): 14:44:49  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:49.721081 (Thread-5): 14:44:49  Opening a new connection, currently in state closed
2022-03-02 14:44:50.010042 (Thread-6): 14:44:50  SQL status: SUCCESS 1 in 3.01 seconds
2022-03-02 14:44:50.011543 (Thread-6): 14:44:50  finished collecting timing info
2022-03-02 14:44:50.011747 (Thread-6): 14:44:50  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 14:44:50.363997 (Thread-221): handling poll request
2022-03-02 14:44:50.364352 (Thread-221): 14:44:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7875a3d0>]}
2022-03-02 14:44:50.365440 (Thread-221): sending response (<Response 28302 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:50.409405 (Thread-6): 14:44:50  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce50789730>]}
2022-03-02 14:44:50.409824 (Thread-6): 14:44:50  5 of 19 OK created incremental model DBT_VAULT.hub_nation....................... [SUCCESS 1 in 3.66s]
2022-03-02 14:44:50.409959 (Thread-6): 14:44:50  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:44:50.410105 (Thread-6): 14:44:50  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:44:50.410285 (Thread-6): 14:44:50  10 of 19 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 14:44:50.410535 (Thread-6): 14:44:50  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:44:50.410623 (Thread-6): 14:44:50  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:44:50.410711 (Thread-6): 14:44:50  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:44:50.436593 (Thread-6): 14:44:50  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:44:50.449842 (Thread-6): 14:44:50  finished collecting timing info
2022-03-02 14:44:50.449989 (Thread-6): 14:44:50  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:44:50.452919 (Thread-6): 14:44:50  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:44:50.466547 (Thread-6): 14:44:50  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:44:50.466661 (Thread-6): 14:44:50  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:50.466747 (Thread-6): 14:44:50  Opening a new connection, currently in state closed
2022-03-02 14:44:51.464142 (Thread-4): 14:44:51  SQL status: SUCCESS 1 in 1.94 seconds
2022-03-02 14:44:51.465696 (Thread-4): 14:44:51  finished collecting timing info
2022-03-02 14:44:51.465864 (Thread-4): 14:44:51  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 14:44:51.716568 (Thread-4): 14:44:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce506c9a30>]}
2022-03-02 14:44:51.717004 (Thread-4): 14:44:51  7 of 19 OK created incremental model DBT_VAULT.hub_part......................... [SUCCESS 1 in 2.23s]
2022-03-02 14:44:51.717136 (Thread-4): 14:44:51  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:44:51.717281 (Thread-4): 14:44:51  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:44:51.717464 (Thread-4): 14:44:51  11 of 19 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 14:44:51.717705 (Thread-4): 14:44:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:44:51.717795 (Thread-4): 14:44:51  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:44:51.717886 (Thread-4): 14:44:51  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:44:51.726211 (Thread-4): 14:44:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:44:51.727461 (Thread-5): 14:44:51  SQL status: SUCCESS 1 in 2.01 seconds
2022-03-02 14:44:51.728834 (Thread-5): 14:44:51  finished collecting timing info
2022-03-02 14:44:51.728977 (Thread-5): 14:44:51  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 14:44:51.739632 (Thread-4): 14:44:51  finished collecting timing info
2022-03-02 14:44:51.739799 (Thread-4): 14:44:51  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:44:51.743900 (Thread-4): 14:44:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:44:51.757827 (Thread-4): 14:44:51  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:44:51.757950 (Thread-4): 14:44:51  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:51.758037 (Thread-4): 14:44:51  Opening a new connection, currently in state closed
2022-03-02 14:44:51.942717 (Thread-5): 14:44:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5069f760>]}
2022-03-02 14:44:51.943135 (Thread-5): 14:44:51  9 of 19 OK created incremental model DBT_VAULT.hub_supplier..................... [SUCCESS 1 in 2.26s]
2022-03-02 14:44:51.943262 (Thread-5): 14:44:51  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:44:51.943402 (Thread-5): 14:44:51  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:44:51.943582 (Thread-5): 14:44:51  12 of 19 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 14:44:51.943874 (Thread-5): 14:44:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:44:51.943966 (Thread-5): 14:44:51  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:44:51.944056 (Thread-5): 14:44:51  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:44:51.951770 (Thread-5): 14:44:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:44:51.965393 (Thread-5): 14:44:51  finished collecting timing info
2022-03-02 14:44:51.965538 (Thread-5): 14:44:51  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:44:51.968652 (Thread-5): 14:44:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:44:51.972850 (Thread-3): 14:44:51  SQL status: SUCCESS 1 in 2.35 seconds
2022-03-02 14:44:51.974174 (Thread-3): 14:44:51  finished collecting timing info
2022-03-02 14:44:51.974314 (Thread-3): 14:44:51  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 14:44:51.998548 (Thread-5): 14:44:51  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:44:51.998696 (Thread-5): 14:44:51  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:51.998787 (Thread-5): 14:44:51  Opening a new connection, currently in state closed
2022-03-02 14:44:52.172335 (Thread-6): 14:44:52  SQL status: SUCCESS 1 in 1.71 seconds
2022-03-02 14:44:52.173843 (Thread-6): 14:44:52  finished collecting timing info
2022-03-02 14:44:52.174005 (Thread-6): 14:44:52  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 14:44:52.220323 (Thread-3): 14:44:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce506ccdf0>]}
2022-03-02 14:44:52.220727 (Thread-3): 14:44:52  8 of 19 OK created incremental model DBT_VAULT.hub_region....................... [SUCCESS 1 in 2.64s]
2022-03-02 14:44:52.220852 (Thread-3): 14:44:52  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:44:52.221002 (Thread-3): 14:44:52  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:44:52.221182 (Thread-3): 14:44:52  13 of 19 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 14:44:52.221415 (Thread-3): 14:44:52  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:44:52.221505 (Thread-3): 14:44:52  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:44:52.221594 (Thread-3): 14:44:52  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:44:52.231053 (Thread-3): 14:44:52  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:44:52.243430 (Thread-3): 14:44:52  finished collecting timing info
2022-03-02 14:44:52.243588 (Thread-3): 14:44:52  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:44:52.247685 (Thread-3): 14:44:52  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:44:52.261749 (Thread-3): 14:44:52  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:44:52.261867 (Thread-3): 14:44:52  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:52.261953 (Thread-3): 14:44:52  Opening a new connection, currently in state closed
2022-03-02 14:44:52.425557 (Thread-6): 14:44:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce505f9430>]}
2022-03-02 14:44:52.425971 (Thread-6): 14:44:52  10 of 19 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 2.02s]
2022-03-02 14:44:52.426104 (Thread-6): 14:44:52  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:44:52.426244 (Thread-6): 14:44:52  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:44:52.426426 (Thread-6): 14:44:52  14 of 19 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 14:44:52.426664 (Thread-6): 14:44:52  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:44:52.426753 (Thread-6): 14:44:52  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:44:52.426841 (Thread-6): 14:44:52  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:44:52.434467 (Thread-6): 14:44:52  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:44:52.447234 (Thread-6): 14:44:52  finished collecting timing info
2022-03-02 14:44:52.447401 (Thread-6): 14:44:52  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:44:52.450565 (Thread-6): 14:44:52  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:44:52.463038 (Thread-6): 14:44:52  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:44:52.463163 (Thread-6): 14:44:52  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:52.463254 (Thread-6): 14:44:52  Opening a new connection, currently in state closed
2022-03-02 14:44:53.156380 (Thread-222): handling poll request
2022-03-02 14:44:53.156777 (Thread-222): 14:44:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7875a220>]}
2022-03-02 14:44:53.158025 (Thread-222): sending response (<Response 42744 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:53.307738 (Thread-4): 14:44:53  SQL status: SUCCESS 1 in 1.55 seconds
2022-03-02 14:44:53.309298 (Thread-4): 14:44:53  finished collecting timing info
2022-03-02 14:44:53.309467 (Thread-4): 14:44:53  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 14:44:53.517724 (Thread-4): 14:44:53  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce506256d0>]}
2022-03-02 14:44:53.518152 (Thread-4): 14:44:53  11 of 19 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 1.80s]
2022-03-02 14:44:53.518280 (Thread-4): 14:44:53  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:44:53.518421 (Thread-4): 14:44:53  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:44:53.518599 (Thread-4): 14:44:53  15 of 19 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 14:44:53.518841 (Thread-4): 14:44:53  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:44:53.518931 (Thread-4): 14:44:53  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:44:53.519022 (Thread-4): 14:44:53  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:44:53.554727 (Thread-4): 14:44:53  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:44:53.566868 (Thread-4): 14:44:53  finished collecting timing info
2022-03-02 14:44:53.567042 (Thread-4): 14:44:53  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:44:53.570156 (Thread-4): 14:44:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:44:53.582836 (Thread-4): 14:44:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:44:53.582963 (Thread-4): 14:44:53  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:53.583051 (Thread-4): 14:44:53  Opening a new connection, currently in state closed
2022-03-02 14:44:53.756229 (Thread-5): 14:44:53  SQL status: SUCCESS 1 in 1.76 seconds
2022-03-02 14:44:53.757731 (Thread-5): 14:44:53  finished collecting timing info
2022-03-02 14:44:53.757898 (Thread-5): 14:44:53  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 14:44:53.994107 (Thread-5): 14:44:53  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce505bcdc0>]}
2022-03-02 14:44:53.994671 (Thread-5): 14:44:53  12 of 19 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.05s]
2022-03-02 14:44:53.994858 (Thread-5): 14:44:53  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:44:53.995066 (Thread-5): 14:44:53  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:44:53.995337 (Thread-5): 14:44:53  16 of 19 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 14:44:53.995712 (Thread-5): 14:44:53  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:44:53.995853 (Thread-5): 14:44:53  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:44:53.995990 (Thread-5): 14:44:53  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:44:54.008833 (Thread-5): 14:44:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:44:54.021421 (Thread-5): 14:44:54  finished collecting timing info
2022-03-02 14:44:54.021571 (Thread-5): 14:44:54  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:44:54.024639 (Thread-5): 14:44:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:44:54.038169 (Thread-5): 14:44:54  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:44:54.038286 (Thread-5): 14:44:54  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:54.038371 (Thread-5): 14:44:54  Opening a new connection, currently in state closed
2022-03-02 14:44:54.141939 (Thread-3): 14:44:54  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-02 14:44:54.143448 (Thread-3): 14:44:54  finished collecting timing info
2022-03-02 14:44:54.143647 (Thread-3): 14:44:54  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 14:44:54.251360 (Thread-6): 14:44:54  SQL status: SUCCESS 1 in 1.79 seconds
2022-03-02 14:44:54.252891 (Thread-6): 14:44:54  finished collecting timing info
2022-03-02 14:44:54.253051 (Thread-6): 14:44:54  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 14:44:54.377236 (Thread-3): 14:44:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce505f1130>]}
2022-03-02 14:44:54.377648 (Thread-3): 14:44:54  13 of 19 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 2.16s]
2022-03-02 14:44:54.377776 (Thread-3): 14:44:54  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:44:54.377919 (Thread-3): 14:44:54  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:44:54.378097 (Thread-3): 14:44:54  17 of 19 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 14:44:54.378338 (Thread-3): 14:44:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:44:54.378427 (Thread-3): 14:44:54  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:44:54.378516 (Thread-3): 14:44:54  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:44:54.443226 (Thread-3): 14:44:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:44:54.464761 (Thread-3): 14:44:54  finished collecting timing info
2022-03-02 14:44:54.464927 (Thread-3): 14:44:54  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:44:54.467738 (Thread-3): 14:44:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:44:54.493366 (Thread-3): 14:44:54  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:44:54.493493 (Thread-3): 14:44:54  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:54.493581 (Thread-3): 14:44:54  Opening a new connection, currently in state closed
2022-03-02 14:44:54.494569 (Thread-6): 14:44:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5059efd0>]}
2022-03-02 14:44:54.495457 (Thread-6): 14:44:54  14 of 19 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 2.07s]
2022-03-02 14:44:54.495583 (Thread-6): 14:44:54  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:44:54.495767 (Thread-6): 14:44:54  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:44:54.495951 (Thread-6): 14:44:54  18 of 19 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 14:44:54.496174 (Thread-6): 14:44:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:44:54.496261 (Thread-6): 14:44:54  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:44:54.496344 (Thread-6): 14:44:54  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:44:54.510748 (Thread-6): 14:44:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:44:54.523357 (Thread-6): 14:44:54  finished collecting timing info
2022-03-02 14:44:54.523495 (Thread-6): 14:44:54  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:44:54.526255 (Thread-6): 14:44:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:44:54.541019 (Thread-6): 14:44:54  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:44:54.541132 (Thread-6): 14:44:54  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:54.541215 (Thread-6): 14:44:54  Opening a new connection, currently in state closed
2022-03-02 14:44:55.000976 (Thread-223): handling poll request
2022-03-02 14:44:55.001339 (Thread-223): 14:44:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7875f0a0>]}
2022-03-02 14:44:55.002548 (Thread-223): sending response (<Response 35487 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:55.203238 (Thread-4): 14:44:55  SQL status: SUCCESS 1 in 1.62 seconds
2022-03-02 14:44:55.204825 (Thread-4): 14:44:55  finished collecting timing info
2022-03-02 14:44:55.204995 (Thread-4): 14:44:55  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 14:44:55.447032 (Thread-4): 14:44:55  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5069f670>]}
2022-03-02 14:44:55.447633 (Thread-4): 14:44:55  15 of 19 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 1.93s]
2022-03-02 14:44:55.447779 (Thread-4): 14:44:55  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:44:55.447919 (Thread-4): 14:44:55  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:44:55.448105 (Thread-4): 14:44:55  19 of 19 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 14:44:55.448380 (Thread-4): 14:44:55  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:44:55.448474 (Thread-4): 14:44:55  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:44:55.448562 (Thread-4): 14:44:55  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:44:55.462321 (Thread-4): 14:44:55  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:44:55.476180 (Thread-4): 14:44:55  finished collecting timing info
2022-03-02 14:44:55.476340 (Thread-4): 14:44:55  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:44:55.479447 (Thread-4): 14:44:55  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:44:55.494388 (Thread-4): 14:44:55  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:44:55.494509 (Thread-4): 14:44:55  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:44:55.494610 (Thread-4): 14:44:55  Opening a new connection, currently in state closed
2022-03-02 14:44:55.850562 (Thread-5): 14:44:55  SQL status: SUCCESS 1 in 1.81 seconds
2022-03-02 14:44:55.853485 (Thread-5): 14:44:55  finished collecting timing info
2022-03-02 14:44:55.853668 (Thread-5): 14:44:55  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 14:44:56.075843 (Thread-5): 14:44:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce506d0c10>]}
2022-03-02 14:44:56.076253 (Thread-5): 14:44:56  16 of 19 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 2.08s]
2022-03-02 14:44:56.076385 (Thread-5): 14:44:56  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:44:56.154664 (Thread-3): 14:44:56  SQL status: SUCCESS 1 in 1.66 seconds
2022-03-02 14:44:56.156194 (Thread-3): 14:44:56  finished collecting timing info
2022-03-02 14:44:56.156357 (Thread-3): 14:44:56  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 14:44:56.376345 (Thread-3): 14:44:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce505a26d0>]}
2022-03-02 14:44:56.376766 (Thread-3): 14:44:56  17 of 19 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.00s]
2022-03-02 14:44:56.376892 (Thread-3): 14:44:56  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:44:56.738112 (Thread-6): 14:44:56  SQL status: SUCCESS 1 in 2.2 seconds
2022-03-02 14:44:56.739696 (Thread-6): 14:44:56  finished collecting timing info
2022-03-02 14:44:56.739875 (Thread-6): 14:44:56  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 14:44:56.816288 (Thread-224): handling poll request
2022-03-02 14:44:56.816726 (Thread-224): 14:44:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c146df0>]}
2022-03-02 14:44:56.817581 (Thread-224): sending response (<Response 15589 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:44:56.979298 (Thread-6): 14:44:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce50523be0>]}
2022-03-02 14:44:56.979972 (Thread-6): 14:44:56  18 of 19 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 2.48s]
2022-03-02 14:44:56.980125 (Thread-6): 14:44:56  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:44:57.041163 (Thread-4): 14:44:57  SQL status: SUCCESS 1 in 1.55 seconds
2022-03-02 14:44:57.042690 (Thread-4): 14:44:57  finished collecting timing info
2022-03-02 14:44:57.042857 (Thread-4): 14:44:57  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 14:44:57.266737 (Thread-4): 14:44:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a47d4f-50ae-410a-961a-90d0a1b670a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce506ae5b0>]}
2022-03-02 14:44:57.267150 (Thread-4): 14:44:57  19 of 19 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 1.82s]
2022-03-02 14:44:57.267272 (Thread-4): 14:44:57  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:44:57.269055 (MainThread): 14:44:57  Acquiring new snowflake connection "master"
2022-03-02 14:44:57.269459 (MainThread): 14:44:57  
2022-03-02 14:44:57.269563 (MainThread): 14:44:57  Finished running 2 table models, 17 incremental models in 26.92s.
2022-03-02 14:44:57.269650 (MainThread): 14:44:57  Connection 'master' was properly closed.
2022-03-02 14:44:57.269719 (MainThread): 14:44:57  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 14:44:57.269798 (MainThread): 14:44:57  Connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details' was properly closed.
2022-03-02 14:44:57.269864 (MainThread): 14:44:57  Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
2022-03-02 14:44:57.269926 (MainThread): 14:44:57  Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
2022-03-02 14:44:57.349169 (MainThread): 14:44:57  
2022-03-02 14:44:57.349393 (MainThread): 14:44:57  Completed successfully
2022-03-02 14:44:57.349514 (MainThread): 14:44:57  
2022-03-02 14:44:57.349609 (MainThread): 14:44:57  Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
2022-03-02 14:44:58.635036 (Thread-225): handling poll request
2022-03-02 14:44:58.635418 (Thread-225): 14:44:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c146640>]}
2022-03-02 14:44:58.638067 (Thread-225): sending response (<Response 96806 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:45:00.199849 (Thread-226): handling status request
2022-03-02 14:45:00.200231 (Thread-226): 14:45:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b787202b0>]}
2022-03-02 14:45:00.200779 (Thread-226): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:45:00.207694 (Thread-227): handling status request
2022-03-02 14:45:00.207943 (Thread-227): 14:45:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78724e50>]}
2022-03-02 14:45:00.208346 (Thread-227): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:45:02.540587 (Thread-228): handling status request
2022-03-02 14:45:02.540951 (Thread-228): 14:45:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78729c10>]}
2022-03-02 14:45:02.541425 (Thread-228): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:45:02.548007 (Thread-229): handling list request
2022-03-02 14:45:02.548310 (Thread-229): 14:45:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78707700>]}
2022-03-02 14:45:02.595687 (Thread-229): 14:45:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78724af0>]}
2022-03-02 14:45:02.596052 (Thread-229): 14:45:02  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:45:02.600251 (Thread-229): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:46:29.604961 (Thread-230): handling status request
2022-03-02 14:46:29.606423 (Thread-230): 14:46:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78724f70>]}
2022-03-02 14:46:29.606910 (Thread-230): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:46:29.614539 (Thread-231): handling list request
2022-03-02 14:46:29.614787 (Thread-231): 14:46:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b786dd190>]}
2022-03-02 14:46:29.652185 (Thread-231): 14:46:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78730af0>]}
2022-03-02 14:46:29.652499 (Thread-231): 14:46:29  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:46:29.660049 (Thread-231): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:46:33.020385 (Thread-232): handling status request
2022-03-02 14:46:33.020754 (Thread-232): 14:46:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c196ee0>]}
2022-03-02 14:46:33.021231 (Thread-232): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:46:33.028460 (Thread-233): handling list request
2022-03-02 14:46:33.028708 (Thread-233): 14:46:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b786f1550>]}
2022-03-02 14:46:33.060871 (Thread-233): 14:46:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b786f1fa0>]}
2022-03-02 14:46:33.061245 (Thread-233): 14:46:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:46:33.069211 (Thread-233): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:46:38.424627 (Thread-234): handling status request
2022-03-02 14:46:38.424975 (Thread-234): 14:46:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78689400>]}
2022-03-02 14:46:38.425449 (Thread-234): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:46:38.433041 (Thread-235): handling list request
2022-03-02 14:46:38.433286 (Thread-235): 14:46:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78694130>]}
2022-03-02 14:46:38.468015 (Thread-235): 14:46:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b786f1820>]}
2022-03-02 14:46:38.468333 (Thread-235): 14:46:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:46:38.475806 (Thread-235): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:01.688693 (Thread-236): 14:47:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:47:01.689222 (Thread-236): 14:47:01  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:47:01.696334 (Thread-236): 14:47:01  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:47:01.705524 (Thread-236): 14:47:01  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:47:01.771486 (Thread-236): 14:47:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78459e20>]}
2022-03-02 14:47:02.114746 (Thread-237): handling status request
2022-03-02 14:47:02.115166 (Thread-237): 14:47:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b786a60d0>]}
2022-03-02 14:47:02.115769 (Thread-237): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:02.145657 (Thread-238): handling list request
2022-03-02 14:47:02.145960 (Thread-238): 14:47:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78465eb0>]}
2022-03-02 14:47:02.183043 (Thread-238): 14:47:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78645a30>]}
2022-03-02 14:47:02.183395 (Thread-238): 14:47:02  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:47:02.190065 (Thread-238): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:02.433124 (Thread-239): handling status request
2022-03-02 14:47:02.433493 (Thread-239): 14:47:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b785786d0>]}
2022-03-02 14:47:02.433987 (Thread-239): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:02.443701 (Thread-240): handling status request
2022-03-02 14:47:02.443982 (Thread-240): 14:47:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7843cd00>]}
2022-03-02 14:47:02.444424 (Thread-240): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:07.881839 (Thread-241): handling status request
2022-03-02 14:47:07.882223 (Thread-241): 14:47:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7843ca30>]}
2022-03-02 14:47:07.882714 (Thread-241): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:07.890191 (Thread-242): handling list request
2022-03-02 14:47:07.890449 (Thread-242): 14:47:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7843c7c0>]}
2022-03-02 14:47:07.924844 (Thread-242): 14:47:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7869c1c0>]}
2022-03-02 14:47:07.947310 (Thread-242): 14:47:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:47:07.950900 (Thread-242): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:26.001258 (Thread-243): handling status request
2022-03-02 14:47:26.001632 (Thread-243): 14:47:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7863b190>]}
2022-03-02 14:47:26.002116 (Thread-243): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:26.009528 (Thread-244): handling list request
2022-03-02 14:47:26.009804 (Thread-244): 14:47:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7863b700>]}
2022-03-02 14:47:26.046605 (Thread-244): 14:47:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78645400>]}
2022-03-02 14:47:26.046921 (Thread-244): 14:47:26  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:47:26.051753 (Thread-244): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:32.309458 (Thread-245): handling status request
2022-03-02 14:47:32.309839 (Thread-245): 14:47:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78578f70>]}
2022-03-02 14:47:32.310362 (Thread-245): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:32.317360 (Thread-246): handling list request
2022-03-02 14:47:32.317606 (Thread-246): 14:47:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c0ae2e0>]}
2022-03-02 14:47:32.348928 (Thread-246): 14:47:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78459d60>]}
2022-03-02 14:47:32.349232 (Thread-246): 14:47:32  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:47:32.354028 (Thread-246): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:57.096378 (Thread-247): handling status request
2022-03-02 14:47:57.096753 (Thread-247): 14:47:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7860cd60>]}
2022-03-02 14:47:57.097245 (Thread-247): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:47:57.116117 (Thread-248): handling list request
2022-03-02 14:47:57.116382 (Thread-248): 14:47:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7845b6a0>]}
2022-03-02 14:47:57.153315 (Thread-248): 14:47:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7869c550>]}
2022-03-02 14:47:57.153611 (Thread-248): 14:47:57  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:47:57.158180 (Thread-248): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:48:07.285353 (Thread-249): handling status request
2022-03-02 14:48:07.285736 (Thread-249): 14:48:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78435bb0>]}
2022-03-02 14:48:07.286241 (Thread-249): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:48:07.302885 (Thread-250): handling list request
2022-03-02 14:48:07.303229 (Thread-250): 14:48:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7845b520>]}
2022-03-02 14:48:07.341288 (Thread-250): 14:48:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b783cf550>]}
2022-03-02 14:48:07.341688 (Thread-250): 14:48:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:48:07.351058 (Thread-250): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:49:54.082750 (Thread-251): handling status request
2022-03-02 14:49:54.084189 (Thread-251): 14:49:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b783cfe20>]}
2022-03-02 14:49:54.084680 (Thread-251): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:49:54.095919 (Thread-252): handling list request
2022-03-02 14:49:54.096197 (Thread-252): 14:49:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b783f8730>]}
2022-03-02 14:49:54.132120 (Thread-252): 14:49:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7860c400>]}
2022-03-02 14:49:54.132490 (Thread-252): 14:49:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:49:54.140721 (Thread-252): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:50:13.208069 (Thread-253): handling status request
2022-03-02 14:50:13.208429 (Thread-253): 14:50:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78347280>]}
2022-03-02 14:50:13.209184 (Thread-253): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:50:13.216283 (Thread-254): handling list request
2022-03-02 14:50:13.216528 (Thread-254): 14:50:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7837f160>]}
2022-03-02 14:50:13.251184 (Thread-254): 14:50:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78347be0>]}
2022-03-02 14:50:13.251514 (Thread-254): 14:50:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:50:13.256333 (Thread-254): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:50:15.139049 (Thread-255): handling status request
2022-03-02 14:50:15.139399 (Thread-255): 14:50:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78347f70>]}
2022-03-02 14:50:15.139953 (Thread-255): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:50:15.147185 (Thread-256): handling list request
2022-03-02 14:50:15.147424 (Thread-256): 14:50:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78395c10>]}
2022-03-02 14:50:15.211139 (Thread-256): 14:50:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7837f7c0>]}
2022-03-02 14:50:15.211451 (Thread-256): 14:50:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:50:15.216949 (Thread-256): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:50:19.488760 (Thread-257): handling status request
2022-03-02 14:50:19.489125 (Thread-257): 14:50:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78350460>]}
2022-03-02 14:50:19.489610 (Thread-257): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:50:19.495667 (Thread-258): handling list request
2022-03-02 14:50:19.495926 (Thread-258): 14:50:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b783951c0>]}
2022-03-02 14:50:19.530936 (Thread-258): 14:50:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78578550>]}
2022-03-02 14:50:19.531246 (Thread-258): 14:50:19  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:50:19.536116 (Thread-258): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:51:00.282571 (Thread-259): handling status request
2022-03-02 14:51:00.282943 (Thread-259): 14:51:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78371d90>]}
2022-03-02 14:51:00.283430 (Thread-259): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:51:00.291136 (Thread-260): handling list request
2022-03-02 14:51:00.291390 (Thread-260): 14:51:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7842a3d0>]}
2022-03-02 14:51:00.330129 (Thread-260): 14:51:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78395580>]}
2022-03-02 14:51:00.330429 (Thread-260): 14:51:00  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:51:00.338176 (Thread-260): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:51:05.034892 (Thread-261): handling status request
2022-03-02 14:51:05.035262 (Thread-261): 14:51:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78368ee0>]}
2022-03-02 14:51:05.035775 (Thread-261): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:51:05.043540 (Thread-262): handling list request
2022-03-02 14:51:05.043849 (Thread-262): 14:51:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78368340>]}
2022-03-02 14:51:05.074509 (Thread-262): 14:51:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782bec10>]}
2022-03-02 14:51:05.097385 (Thread-262): 14:51:05  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:51:05.102119 (Thread-262): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:06.027463 (Thread-263): handling status request
2022-03-02 14:52:06.029050 (Thread-263): 14:52:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78368880>]}
2022-03-02 14:52:06.029547 (Thread-263): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:06.052097 (Thread-264): handling list request
2022-03-02 14:52:06.052356 (Thread-264): 14:52:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782e80d0>]}
2022-03-02 14:52:06.090273 (Thread-264): 14:52:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b786413d0>]}
2022-03-02 14:52:06.090583 (Thread-264): 14:52:06  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:52:06.097971 (Thread-264): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:13.607777 (Thread-265): handling status request
2022-03-02 14:52:13.608158 (Thread-265): 14:52:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782efb80>]}
2022-03-02 14:52:13.608636 (Thread-265): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:13.634932 (Thread-266): handling list request
2022-03-02 14:52:13.635216 (Thread-266): 14:52:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7849b550>]}
2022-03-02 14:52:13.671880 (Thread-266): 14:52:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782e88b0>]}
2022-03-02 14:52:13.672179 (Thread-266): 14:52:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:52:13.677683 (Thread-266): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:21.497870 (Thread-267): handling status request
2022-03-02 14:52:21.498257 (Thread-267): 14:52:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782b2df0>]}
2022-03-02 14:52:21.498768 (Thread-267): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:21.824686 (Thread-268): handling status request
2022-03-02 14:52:21.825039 (Thread-268): 14:52:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7827f220>]}
2022-03-02 14:52:21.825541 (Thread-268): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:22.114593 (Thread-269): handling cli_args request
2022-03-02 14:52:22.114960 (Thread-269): 14:52:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7827f4f0>]}
2022-03-02 14:52:24.291599 (Thread-269): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:24.855897 (MainThread): 14:52:24  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:52:24.856318 (MainThread): 14:52:24  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:52:24.863750 (MainThread): 14:52:24  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd08bc0b8-db05-44d7-b3cf-19e87e3fc31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2175829100>]}
2022-03-02 14:52:24.901456 (MainThread): 14:52:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd08bc0b8-db05-44d7-b3cf-19e87e3fc31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2175908c40>]}
2022-03-02 14:52:24.901746 (MainThread): 14:52:24  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:52:24.904041 (MainThread): 14:52:24  
2022-03-02 14:52:24.904373 (MainThread): 14:52:24  Acquiring new snowflake connection "master"
2022-03-02 14:52:24.905924 (ThreadPoolExecutor-0_0): 14:52:24  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:52:24.918907 (ThreadPoolExecutor-0_0): 14:52:24  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:52:24.919019 (ThreadPoolExecutor-0_0): 14:52:24  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:52:24.919103 (ThreadPoolExecutor-0_0): 14:52:24  Opening a new connection, currently in state init
2022-03-02 14:52:25.157438 (Thread-270): handling poll request
2022-03-02 14:52:25.157865 (Thread-270): 14:52:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782f9670>]}
2022-03-02 14:52:25.158720 (Thread-270): sending response (<Response 4168 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:25.868137 (ThreadPoolExecutor-0_0): 14:52:25  SQL status: SUCCESS 7 in 0.95 seconds
2022-03-02 14:52:25.870144 (ThreadPoolExecutor-0_0): 14:52:25  On list_DBT_RAW: Close
2022-03-02 14:52:26.108323 (ThreadPoolExecutor-2_0): 14:52:26  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:52:26.116261 (ThreadPoolExecutor-2_0): 14:52:26  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:52:26.116396 (ThreadPoolExecutor-2_0): 14:52:26  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:52:26.116493 (ThreadPoolExecutor-2_0): 14:52:26  Opening a new connection, currently in state closed
2022-03-02 14:52:27.027143 (ThreadPoolExecutor-2_0): 14:52:27  SQL status: SUCCESS 31 in 0.91 seconds
2022-03-02 14:52:27.029327 (ThreadPoolExecutor-2_0): 14:52:27  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:52:27.247377 (MainThread): 14:52:27  Concurrency: 4 threads (target='default')
2022-03-02 14:52:27.247531 (MainThread): 14:52:27  
2022-03-02 14:52:27.250275 (Thread-3): 14:52:27  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:52:27.250578 (Thread-3): 14:52:27  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:52:27.250846 (Thread-3): 14:52:27  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:52:27.250948 (Thread-3): 14:52:27  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:52:27.251051 (Thread-3): 14:52:27  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:52:27.256605 (Thread-3): 14:52:27  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:52:27.272820 (Thread-3): 14:52:27  finished collecting timing info
2022-03-02 14:52:27.272970 (Thread-3): 14:52:27  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:52:27.296440 (Thread-3): 14:52:27  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:52:27.315305 (Thread-3): 14:52:27  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:52:27.315420 (Thread-3): 14:52:27  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(b.RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY b.RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:52:27.315506 (Thread-3): 14:52:27  Opening a new connection, currently in state closed
2022-03-02 14:52:27.511517 (Thread-271): handling poll request
2022-03-02 14:52:27.511941 (Thread-271): 14:52:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78359820>]}
2022-03-02 14:52:27.512702 (Thread-271): sending response (<Response 11240 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:28.343980 (Thread-3): 14:52:28  Snowflake adapter: Snowflake query id: 01a2a89c-0503-b4d3-0000-0ed503a4b496
2022-03-02 14:52:28.344143 (Thread-3): 14:52:28  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 39 at position 12
invalid identifier 'B.RECEIPTDATE'
2022-03-02 14:52:28.344307 (Thread-3): 14:52:28  finished collecting timing info
2022-03-02 14:52:28.344444 (Thread-3): 14:52:28  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:52:28.572569 (Thread-3): 14:52:28  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  000904 (42000): SQL compilation error: error line 39 at position 12
  invalid identifier 'B.RECEIPTDATE'
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-02 14:52:28.573037 (Thread-3): 14:52:28  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08bc0b8-db05-44d7-b3cf-19e87e3fc31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21740e9130>]}
2022-03-02 14:52:28.573414 (Thread-3): 14:52:28  1 of 19 ERROR creating table model DBT_VAULT.raw_orders......................... [ERROR in 1.32s]
2022-03-02 14:52:28.573536 (Thread-3): 14:52:28  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:52:28.574489 (Thread-5): 14:52:28  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:52:28.574668 (Thread-5): 14:52:28  2 of 19 SKIP relation DBT_VAULT.v_stg_orders.................................... [SKIP]
2022-03-02 14:52:28.574774 (Thread-5): 14:52:28  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:52:28.575834 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:52:28.576004 (Thread-4): 14:52:28  3 of 19 SKIP relation DBT_VAULT.hub_customer.................................... [SKIP]
2022-03-02 14:52:28.576110 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:52:28.576256 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:52:28.576366 (Thread-4): 14:52:28  4 of 19 SKIP relation DBT_VAULT.hub_lineitem.................................... [SKIP]
2022-03-02 14:52:28.576464 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:52:28.576564 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:52:28.576673 (Thread-4): 14:52:28  5 of 19 SKIP relation DBT_VAULT.hub_nation...................................... [SKIP]
2022-03-02 14:52:28.576756 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:52:28.576850 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:52:28.576950 (Thread-4): 14:52:28  6 of 19 SKIP relation DBT_VAULT.hub_order....................................... [SKIP]
2022-03-02 14:52:28.577032 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:52:28.577127 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:52:28.577220 (Thread-4): 14:52:28  7 of 19 SKIP relation DBT_VAULT.hub_part........................................ [SKIP]
2022-03-02 14:52:28.577302 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:52:28.577393 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:52:28.577482 (Thread-4): 14:52:28  8 of 19 SKIP relation DBT_VAULT.hub_region...................................... [SKIP]
2022-03-02 14:52:28.577564 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:52:28.577659 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:52:28.577750 (Thread-4): 14:52:28  9 of 19 SKIP relation DBT_VAULT.hub_supplier.................................... [SKIP]
2022-03-02 14:52:28.577831 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:52:28.577926 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:52:28.578022 (Thread-4): 14:52:28  10 of 19 SKIP relation DBT_VAULT.link_customer_nation........................... [SKIP]
2022-03-02 14:52:28.578103 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:52:28.578191 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:52:28.578279 (Thread-4): 14:52:28  11 of 19 SKIP relation DBT_VAULT.link_customer_order............................ [SKIP]
2022-03-02 14:52:28.578358 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:52:28.578447 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:52:28.578533 (Thread-4): 14:52:28  12 of 19 SKIP relation DBT_VAULT.link_inventory_allocation...................... [SKIP]
2022-03-02 14:52:28.578616 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:52:28.578704 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:52:28.578791 (Thread-4): 14:52:28  13 of 19 SKIP relation DBT_VAULT.link_nation_region............................. [SKIP]
2022-03-02 14:52:28.578871 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:52:28.578988 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:52:28.579095 (Thread-4): 14:52:28  14 of 19 SKIP relation DBT_VAULT.link_order_lineitem............................ [SKIP]
2022-03-02 14:52:28.579176 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:52:28.579267 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:52:28.579354 (Thread-4): 14:52:28  15 of 19 SKIP relation DBT_VAULT.sat_order_cust_nation_details.................. [SKIP]
2022-03-02 14:52:28.579428 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:52:28.579521 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:52:28.579640 (Thread-4): 14:52:28  16 of 19 SKIP relation DBT_VAULT.sat_order_cust_region_details.................. [SKIP]
2022-03-02 14:52:28.579728 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:52:28.579843 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:52:28.579937 (Thread-4): 14:52:28  17 of 19 SKIP relation DBT_VAULT.sat_order_customer_details..................... [SKIP]
2022-03-02 14:52:28.580015 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:52:28.580107 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:52:28.580193 (Thread-4): 14:52:28  18 of 19 SKIP relation DBT_VAULT.sat_order_lineitem_details..................... [SKIP]
2022-03-02 14:52:28.580268 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:52:28.580363 (Thread-4): 14:52:28  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:52:28.580451 (Thread-4): 14:52:28  19 of 19 SKIP relation DBT_VAULT.sat_order_order_details........................ [SKIP]
2022-03-02 14:52:28.580526 (Thread-4): 14:52:28  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:52:28.582533 (MainThread): 14:52:28  Acquiring new snowflake connection "master"
2022-03-02 14:52:28.582889 (MainThread): 14:52:28  
2022-03-02 14:52:28.582988 (MainThread): 14:52:28  Finished running 2 table models, 17 incremental models in 3.68s.
2022-03-02 14:52:28.583074 (MainThread): 14:52:28  Connection 'master' was properly closed.
2022-03-02 14:52:28.583139 (MainThread): 14:52:28  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-02 14:52:28.678688 (MainThread): 14:52:28  
2022-03-02 14:52:28.678993 (MainThread): 14:52:28  Completed with 1 error and 0 warnings:
2022-03-02 14:52:28.679167 (MainThread): 14:52:28  
2022-03-02 14:52:28.679333 (MainThread): 14:52:28  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
2022-03-02 14:52:28.679473 (MainThread): 14:52:28    000904 (42000): SQL compilation error: error line 39 at position 12
2022-03-02 14:52:28.679632 (MainThread): 14:52:28    invalid identifier 'B.RECEIPTDATE'
2022-03-02 14:52:28.679781 (MainThread): 14:52:28    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-02 14:52:28.679921 (MainThread): 14:52:28  
2022-03-02 14:52:28.680022 (MainThread): 14:52:28  Done. PASS=0 WARN=0 ERROR=1 SKIP=18 TOTAL=19
2022-03-02 14:52:29.919269 (Thread-272): handling poll request
2022-03-02 14:52:29.919716 (Thread-272): 14:52:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7825fe50>]}
2022-03-02 14:52:29.922458 (Thread-272): sending response (<Response 84760 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:31.389554 (Thread-273): handling status request
2022-03-02 14:52:31.389945 (Thread-273): 14:52:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7826f100>]}
2022-03-02 14:52:31.390504 (Thread-273): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:31.397392 (Thread-274): handling status request
2022-03-02 14:52:31.397639 (Thread-274): 14:52:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7826f400>]}
2022-03-02 14:52:31.398005 (Thread-274): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:33.830776 (Thread-275): handling status request
2022-03-02 14:52:33.831142 (Thread-275): 14:52:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7826f670>]}
2022-03-02 14:52:33.831703 (Thread-275): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:52:33.839724 (Thread-276): handling list request
2022-03-02 14:52:33.839985 (Thread-276): 14:52:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7826f8e0>]}
2022-03-02 14:52:33.876913 (Thread-276): 14:52:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7826f340>]}
2022-03-02 14:52:33.877276 (Thread-276): 14:52:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:52:33.882286 (Thread-276): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:22.523477 (Thread-277): handling status request
2022-03-02 14:53:22.523881 (Thread-277): 14:53:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78273850>]}
2022-03-02 14:53:22.524361 (Thread-277): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:22.531162 (Thread-278): handling list request
2022-03-02 14:53:22.531408 (Thread-278): 14:53:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78273fd0>]}
2022-03-02 14:53:22.571225 (Thread-278): 14:53:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b782ef760>]}
2022-03-02 14:53:22.571518 (Thread-278): 14:53:22  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:53:22.577257 (Thread-278): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:34.941427 (Thread-279): handling status request
2022-03-02 14:53:34.941804 (Thread-279): 14:53:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78238850>]}
2022-03-02 14:53:34.942285 (Thread-279): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:34.949874 (Thread-280): handling list request
2022-03-02 14:53:34.950138 (Thread-280): 14:53:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78238b50>]}
2022-03-02 14:53:34.985909 (Thread-280): 14:53:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b781ec1f0>]}
2022-03-02 14:53:34.986194 (Thread-280): 14:53:34  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:53:34.994352 (Thread-280): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:54.658274 (Thread-282): handling status request
2022-03-02 14:53:54.658724 (Thread-282): 14:53:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4857b20>]}
2022-03-02 14:53:54.659152 (Thread-282): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:54.732470 (Thread-283): handling status request
2022-03-02 14:53:54.732893 (Thread-283): 14:53:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0ec4c0>]}
2022-03-02 14:53:54.733340 (Thread-283): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:54.737694 (Thread-281): 14:53:54  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:53:54.739193 (Thread-281): 14:53:54  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:53:54.745523 (Thread-281): 14:53:54  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:53:54.752290 (Thread-281): 14:53:54  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:53:54.796006 (Thread-284): handling status request
2022-03-02 14:53:54.796349 (Thread-284): 14:53:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b780f5ca0>]}
2022-03-02 14:53:54.796764 (Thread-284): sending response (<Response 163 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:54.810895 (Thread-281): 14:53:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b780bdb20>]}
2022-03-02 14:53:54.856045 (Thread-285): handling status request
2022-03-02 14:53:54.856399 (Thread-285): 14:53:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0cb190>]}
2022-03-02 14:53:54.856870 (Thread-285): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:54.874346 (Thread-286): handling list request
2022-03-02 14:53:54.874730 (Thread-286): 14:53:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0d3dc0>]}
2022-03-02 14:53:54.912549 (Thread-286): 14:53:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec113fd0>]}
2022-03-02 14:53:54.940044 (Thread-286): 14:53:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:53:54.945966 (Thread-286): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:55.315983 (Thread-287): handling status request
2022-03-02 14:53:55.316370 (Thread-287): 14:53:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed230f40>]}
2022-03-02 14:53:55.316859 (Thread-287): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:55.324295 (Thread-288): handling status request
2022-03-02 14:53:55.324569 (Thread-288): 14:53:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0e59d0>]}
2022-03-02 14:53:55.324939 (Thread-288): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:58.255937 (Thread-289): handling status request
2022-03-02 14:53:58.256309 (Thread-289): 14:53:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0e50d0>]}
2022-03-02 14:53:58.256791 (Thread-289): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:58.574153 (Thread-290): handling status request
2022-03-02 14:53:58.574507 (Thread-290): 14:53:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0e51c0>]}
2022-03-02 14:53:58.574985 (Thread-290): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:53:58.721662 (Thread-291): handling cli_args request
2022-03-02 14:53:58.722020 (Thread-291): 14:53:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed290070>]}
2022-03-02 14:54:00.929937 (Thread-291): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:01.319332 (MainThread): 14:54:01  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:54:01.319786 (MainThread): 14:54:01  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:54:01.327310 (MainThread): 14:54:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3486be90a0>]}
2022-03-02 14:54:01.362621 (MainThread): 14:54:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3486ccfbe0>]}
2022-03-02 14:54:01.362903 (MainThread): 14:54:01  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:54:01.365104 (MainThread): 14:54:01  
2022-03-02 14:54:01.365427 (MainThread): 14:54:01  Acquiring new snowflake connection "master"
2022-03-02 14:54:01.366958 (ThreadPoolExecutor-0_0): 14:54:01  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:54:01.379797 (ThreadPoolExecutor-0_0): 14:54:01  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:54:01.379905 (ThreadPoolExecutor-0_0): 14:54:01  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:54:01.379990 (ThreadPoolExecutor-0_0): 14:54:01  Opening a new connection, currently in state init
2022-03-02 14:54:01.736880 (Thread-292): handling poll request
2022-03-02 14:54:01.737369 (Thread-292): 14:54:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec0fd340>]}
2022-03-02 14:54:01.738271 (Thread-292): sending response (<Response 4169 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:02.340910 (ThreadPoolExecutor-0_0): 14:54:02  SQL status: SUCCESS 7 in 0.96 seconds
2022-03-02 14:54:02.342890 (ThreadPoolExecutor-0_0): 14:54:02  On list_DBT_RAW: Close
2022-03-02 14:54:02.606978 (ThreadPoolExecutor-2_0): 14:54:02  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:54:02.614852 (ThreadPoolExecutor-2_0): 14:54:02  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:54:02.614996 (ThreadPoolExecutor-2_0): 14:54:02  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:54:02.615096 (ThreadPoolExecutor-2_0): 14:54:02  Opening a new connection, currently in state closed
2022-03-02 14:54:03.382970 (ThreadPoolExecutor-2_0): 14:54:03  SQL status: SUCCESS 31 in 0.77 seconds
2022-03-02 14:54:03.385194 (ThreadPoolExecutor-2_0): 14:54:03  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:54:03.598453 (MainThread): 14:54:03  Concurrency: 4 threads (target='default')
2022-03-02 14:54:03.598625 (MainThread): 14:54:03  
2022-03-02 14:54:03.601494 (Thread-3): 14:54:03  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:54:03.601811 (Thread-3): 14:54:03  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:54:03.602078 (Thread-3): 14:54:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:54:03.602181 (Thread-3): 14:54:03  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:54:03.602291 (Thread-3): 14:54:03  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:54:03.607961 (Thread-3): 14:54:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:54:03.621103 (Thread-3): 14:54:03  finished collecting timing info
2022-03-02 14:54:03.621270 (Thread-3): 14:54:03  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:54:03.644976 (Thread-3): 14:54:03  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:54:03.660021 (Thread-3): 14:54:03  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:54:03.660198 (Thread-3): 14:54:03  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:54:03.660294 (Thread-3): 14:54:03  Opening a new connection, currently in state closed
2022-03-02 14:54:04.647885 (Thread-293): handling poll request
2022-03-02 14:54:04.648257 (Thread-293): 14:54:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67ba730>]}
2022-03-02 14:54:04.649331 (Thread-293): sending response (<Response 11244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:06.443700 (Thread-294): handling poll request
2022-03-02 14:54:06.444079 (Thread-294): 14:54:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec074430>]}
2022-03-02 14:54:06.444577 (Thread-294): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:08.227895 (Thread-295): handling poll request
2022-03-02 14:54:08.228265 (Thread-295): 14:54:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec062340>]}
2022-03-02 14:54:08.228751 (Thread-295): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:10.017288 (Thread-296): handling poll request
2022-03-02 14:54:10.017660 (Thread-296): 14:54:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec1cfe20>]}
2022-03-02 14:54:10.018136 (Thread-296): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:11.820700 (Thread-297): handling poll request
2022-03-02 14:54:11.821075 (Thread-297): 14:54:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed230c40>]}
2022-03-02 14:54:11.821567 (Thread-297): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:12.669402 (Thread-3): 14:54:12  SQL status: SUCCESS 1 in 9.01 seconds
2022-03-02 14:54:12.678752 (Thread-3): 14:54:12  finished collecting timing info
2022-03-02 14:54:12.678930 (Thread-3): 14:54:12  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:54:12.977968 (Thread-3): 14:54:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3486bc0f70>]}
2022-03-02 14:54:12.978409 (Thread-3): 14:54:12  1 of 19 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 9.38s]
2022-03-02 14:54:12.978543 (Thread-3): 14:54:12  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:54:12.979564 (Thread-5): 14:54:12  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:54:12.979891 (Thread-5): 14:54:12  2 of 19 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:54:12.980180 (Thread-5): 14:54:12  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:54:12.980273 (Thread-5): 14:54:12  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:54:12.980364 (Thread-5): 14:54:12  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:54:13.020005 (Thread-5): 14:54:13  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:54:13.020153 (Thread-5): 14:54:13  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:54:13.020242 (Thread-5): 14:54:13  Opening a new connection, currently in state init
2022-03-02 14:54:13.617485 (Thread-298): handling poll request
2022-03-02 14:54:13.617863 (Thread-298): 14:54:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be44b1f70>]}
2022-03-02 14:54:13.618534 (Thread-298): sending response (<Response 6321 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:13.689645 (Thread-5): 14:54:13  SQL status: SUCCESS 37 in 0.67 seconds
2022-03-02 14:54:13.719690 (Thread-5): 14:54:13  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:54:13.719863 (Thread-5): 14:54:13  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:54:13.847163 (Thread-5): 14:54:13  SQL status: SUCCESS 37 in 0.13 seconds
2022-03-02 14:54:13.897122 (Thread-5): 14:54:13  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:54:13.923410 (Thread-5): 14:54:13  finished collecting timing info
2022-03-02 14:54:13.923678 (Thread-5): 14:54:13  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:54:13.926534 (Thread-5): 14:54:13  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:54:13.931326 (Thread-299): handling status request
2022-03-02 14:54:13.931683 (Thread-299): 14:54:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2600d0>]}
2022-03-02 14:54:13.932212 (Thread-299): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:13.938906 (Thread-300): handling list request
2022-03-02 14:54:13.939168 (Thread-300): 14:54:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec077820>]}
2022-03-02 14:54:13.961076 (Thread-5): 14:54:13  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:54:13.961250 (Thread-5): 14:54:13  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:54:13.977894 (Thread-300): 14:54:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed260790>]}
2022-03-02 14:54:13.978250 (Thread-300): 14:54:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:54:13.985812 (Thread-300): sending response (<Response 34878 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:15.729449 (Thread-5): 14:54:15  SQL status: SUCCESS 1 in 1.77 seconds
2022-03-02 14:54:15.730891 (Thread-5): 14:54:15  finished collecting timing info
2022-03-02 14:54:15.731057 (Thread-5): 14:54:15  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:54:16.352688 (Thread-5): 14:54:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3484064f40>]}
2022-03-02 14:54:16.353101 (Thread-5): 14:54:16  2 of 19 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.37s]
2022-03-02 14:54:16.353230 (Thread-5): 14:54:16  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:54:16.354462 (Thread-4): 14:54:16  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:54:16.354741 (Thread-4): 14:54:16  3 of 19 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 14:54:16.355029 (Thread-4): 14:54:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:54:16.355128 (Thread-4): 14:54:16  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:54:16.355218 (Thread-4): 14:54:16  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:54:16.359541 (Thread-3): 14:54:16  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:54:16.359832 (Thread-3): 14:54:16  4 of 19 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 14:54:16.360083 (Thread-3): 14:54:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:54:16.360192 (Thread-3): 14:54:16  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:54:16.360279 (Thread-3): 14:54:16  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:54:16.364649 (Thread-6): 14:54:16  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:54:16.364890 (Thread-6): 14:54:16  5 of 19 START incremental model DBT_VAULT.hub_nation............................ [RUN]
2022-03-02 14:54:16.365149 (Thread-6): 14:54:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:54:16.365239 (Thread-6): 14:54:16  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:54:16.365320 (Thread-6): 14:54:16  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:54:16.369682 (Thread-5): 14:54:16  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:54:16.369906 (Thread-5): 14:54:16  6 of 19 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 14:54:16.370137 (Thread-5): 14:54:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:54:16.370223 (Thread-5): 14:54:16  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:54:16.370302 (Thread-5): 14:54:16  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:54:16.538083 (Thread-5): 14:54:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:54:16.543123 (Thread-4): 14:54:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:54:16.545394 (Thread-6): 14:54:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:54:16.550100 (Thread-3): 14:54:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:54:16.559333 (Thread-5): 14:54:16  finished collecting timing info
2022-03-02 14:54:16.559493 (Thread-5): 14:54:16  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:54:16.569877 (Thread-3): 14:54:16  finished collecting timing info
2022-03-02 14:54:16.570029 (Thread-3): 14:54:16  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:54:16.580398 (Thread-4): 14:54:16  finished collecting timing info
2022-03-02 14:54:16.580538 (Thread-4): 14:54:16  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:54:16.601273 (Thread-3): 14:54:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:54:16.603944 (Thread-5): 14:54:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:54:16.605351 (Thread-4): 14:54:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:54:16.605656 (Thread-6): 14:54:16  finished collecting timing info
2022-03-02 14:54:16.605802 (Thread-6): 14:54:16  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:54:16.608666 (Thread-6): 14:54:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:54:16.621802 (Thread-3): 14:54:16  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:54:16.621937 (Thread-3): 14:54:16  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:16.622029 (Thread-3): 14:54:16  Opening a new connection, currently in state closed
2022-03-02 14:54:16.624183 (Thread-6): 14:54:16  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:54:16.624286 (Thread-6): 14:54:16  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:16.624365 (Thread-6): 14:54:16  Opening a new connection, currently in state init
2022-03-02 14:54:16.625759 (Thread-5): 14:54:16  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:54:16.625864 (Thread-5): 14:54:16  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:16.625945 (Thread-5): 14:54:16  Opening a new connection, currently in state closed
2022-03-02 14:54:16.629256 (Thread-4): 14:54:16  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:54:16.629360 (Thread-4): 14:54:16  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:16.629442 (Thread-4): 14:54:16  Opening a new connection, currently in state init
2022-03-02 14:54:18.770604 (Thread-301): handling poll request
2022-03-02 14:54:18.770978 (Thread-301): 14:54:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be4857be0>]}
2022-03-02 14:54:18.772161 (Thread-301): sending response (<Response 29505 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:19.024992 (Thread-4): 14:54:19  SQL status: SUCCESS 1 in 2.4 seconds
2022-03-02 14:54:19.026573 (Thread-4): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.026754 (Thread-4): 14:54:19  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 14:54:19.061766 (Thread-3): 14:54:19  SQL status: SUCCESS 1 in 2.44 seconds
2022-03-02 14:54:19.063230 (Thread-3): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.063391 (Thread-3): 14:54:19  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 14:54:19.230882 (Thread-4): 14:54:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d732370>]}
2022-03-02 14:54:19.231319 (Thread-4): 14:54:19  3 of 19 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 2.88s]
2022-03-02 14:54:19.231467 (Thread-4): 14:54:19  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:54:19.231656 (Thread-4): 14:54:19  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:54:19.231865 (Thread-4): 14:54:19  7 of 19 START incremental model DBT_VAULT.hub_part.............................. [RUN]
2022-03-02 14:54:19.232121 (Thread-4): 14:54:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:54:19.232215 (Thread-4): 14:54:19  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:54:19.232307 (Thread-4): 14:54:19  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:54:19.234995 (Thread-5): 14:54:19  SQL status: SUCCESS 1 in 2.61 seconds
2022-03-02 14:54:19.236574 (Thread-5): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.236713 (Thread-5): 14:54:19  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 14:54:19.246954 (Thread-4): 14:54:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:54:19.259649 (Thread-4): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.259862 (Thread-4): 14:54:19  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:54:19.263016 (Thread-4): 14:54:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:54:19.265317 (Thread-3): 14:54:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d7ec190>]}
2022-03-02 14:54:19.265661 (Thread-3): 14:54:19  4 of 19 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 2.91s]
2022-03-02 14:54:19.265783 (Thread-3): 14:54:19  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:54:19.265925 (Thread-3): 14:54:19  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:54:19.266103 (Thread-3): 14:54:19  8 of 19 START incremental model DBT_VAULT.hub_region............................ [RUN]
2022-03-02 14:54:19.266327 (Thread-3): 14:54:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:54:19.266416 (Thread-3): 14:54:19  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:54:19.266502 (Thread-3): 14:54:19  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:54:19.276096 (Thread-3): 14:54:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:54:19.282480 (Thread-4): 14:54:19  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:54:19.282603 (Thread-4): 14:54:19  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:19.282690 (Thread-4): 14:54:19  Opening a new connection, currently in state closed
2022-03-02 14:54:19.289367 (Thread-3): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.289516 (Thread-3): 14:54:19  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:54:19.292424 (Thread-3): 14:54:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:54:19.301467 (Thread-6): 14:54:19  SQL status: SUCCESS 1 in 2.68 seconds
2022-03-02 14:54:19.302760 (Thread-6): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.302901 (Thread-6): 14:54:19  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 14:54:19.306465 (Thread-3): 14:54:19  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:54:19.306579 (Thread-3): 14:54:19  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:19.306664 (Thread-3): 14:54:19  Opening a new connection, currently in state closed
2022-03-02 14:54:19.456229 (Thread-5): 14:54:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34848abe20>]}
2022-03-02 14:54:19.456658 (Thread-5): 14:54:19  6 of 19 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 3.09s]
2022-03-02 14:54:19.456793 (Thread-5): 14:54:19  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:54:19.456940 (Thread-5): 14:54:19  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:54:19.457130 (Thread-5): 14:54:19  9 of 19 START incremental model DBT_VAULT.hub_supplier.......................... [RUN]
2022-03-02 14:54:19.457376 (Thread-5): 14:54:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:54:19.457467 (Thread-5): 14:54:19  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:54:19.457557 (Thread-5): 14:54:19  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:54:19.467475 (Thread-5): 14:54:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:54:19.482496 (Thread-5): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.482675 (Thread-5): 14:54:19  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:54:19.485721 (Thread-5): 14:54:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:54:19.499283 (Thread-5): 14:54:19  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:54:19.499409 (Thread-5): 14:54:19  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:19.499499 (Thread-5): 14:54:19  Opening a new connection, currently in state closed
2022-03-02 14:54:19.503596 (Thread-6): 14:54:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d7849a0>]}
2022-03-02 14:54:19.504000 (Thread-6): 14:54:19  5 of 19 OK created incremental model DBT_VAULT.hub_nation....................... [SUCCESS 1 in 3.14s]
2022-03-02 14:54:19.504122 (Thread-6): 14:54:19  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:54:19.504268 (Thread-6): 14:54:19  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:54:19.504452 (Thread-6): 14:54:19  10 of 19 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 14:54:19.504677 (Thread-6): 14:54:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:54:19.504765 (Thread-6): 14:54:19  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:54:19.504854 (Thread-6): 14:54:19  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:54:19.532646 (Thread-6): 14:54:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:54:19.564588 (Thread-6): 14:54:19  finished collecting timing info
2022-03-02 14:54:19.564775 (Thread-6): 14:54:19  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:54:19.567725 (Thread-6): 14:54:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:54:19.610165 (Thread-6): 14:54:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:54:19.610320 (Thread-6): 14:54:19  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:19.610413 (Thread-6): 14:54:19  Opening a new connection, currently in state closed
2022-03-02 14:54:21.230497 (Thread-302): handling status request
2022-03-02 14:54:21.230875 (Thread-302): 14:54:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7843f4f0>]}
2022-03-02 14:54:21.231378 (Thread-302): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:21.250396 (Thread-303): handling list request
2022-03-02 14:54:21.250697 (Thread-303): 14:54:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7843f340>]}
2022-03-02 14:54:21.257720 (Thread-304): handling poll request
2022-03-02 14:54:21.258112 (Thread-304): 14:54:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bec062e80>]}
2022-03-02 14:54:21.259345 (Thread-304): sending response (<Response 35756 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:21.285576 (Thread-303): 14:54:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67ba040>]}
2022-03-02 14:54:21.285871 (Thread-303): 14:54:21  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:54:21.291853 (Thread-303): sending response (<Response 24834 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:21.598272 (Thread-3): 14:54:21  SQL status: SUCCESS 1 in 2.29 seconds
2022-03-02 14:54:21.599852 (Thread-3): 14:54:21  finished collecting timing info
2022-03-02 14:54:21.600017 (Thread-3): 14:54:21  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 14:54:21.649969 (Thread-6): 14:54:21  SQL status: SUCCESS 1 in 2.04 seconds
2022-03-02 14:54:21.651314 (Thread-6): 14:54:21  finished collecting timing info
2022-03-02 14:54:21.651467 (Thread-6): 14:54:21  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 14:54:21.827746 (Thread-4): 14:54:21  SQL status: SUCCESS 1 in 2.54 seconds
2022-03-02 14:54:21.829247 (Thread-4): 14:54:21  finished collecting timing info
2022-03-02 14:54:21.829414 (Thread-4): 14:54:21  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 14:54:21.862084 (Thread-6): 14:54:21  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d657f40>]}
2022-03-02 14:54:21.862500 (Thread-6): 14:54:21  10 of 19 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 2.36s]
2022-03-02 14:54:21.862628 (Thread-6): 14:54:21  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:54:21.862776 (Thread-6): 14:54:21  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:54:21.862959 (Thread-6): 14:54:21  11 of 19 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 14:54:21.863199 (Thread-6): 14:54:21  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:54:21.863290 (Thread-6): 14:54:21  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:54:21.863381 (Thread-6): 14:54:21  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:54:21.872121 (Thread-6): 14:54:21  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:54:21.885482 (Thread-6): 14:54:21  finished collecting timing info
2022-03-02 14:54:21.885693 (Thread-6): 14:54:21  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:54:21.889080 (Thread-6): 14:54:21  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:54:21.902077 (Thread-6): 14:54:21  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:54:21.902219 (Thread-6): 14:54:21  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:21.902311 (Thread-6): 14:54:21  Opening a new connection, currently in state closed
2022-03-02 14:54:22.025545 (Thread-3): 14:54:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d6c6be0>]}
2022-03-02 14:54:22.025962 (Thread-3): 14:54:22  8 of 19 OK created incremental model DBT_VAULT.hub_region....................... [SUCCESS 1 in 2.76s]
2022-03-02 14:54:22.026089 (Thread-3): 14:54:22  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:54:22.026230 (Thread-3): 14:54:22  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:54:22.026415 (Thread-3): 14:54:22  12 of 19 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 14:54:22.026654 (Thread-3): 14:54:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:54:22.026743 (Thread-3): 14:54:22  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:54:22.026833 (Thread-3): 14:54:22  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:54:22.034580 (Thread-3): 14:54:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:54:22.047366 (Thread-3): 14:54:22  finished collecting timing info
2022-03-02 14:54:22.047512 (Thread-3): 14:54:22  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:54:22.050383 (Thread-3): 14:54:22  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:54:22.064519 (Thread-3): 14:54:22  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:54:22.064636 (Thread-3): 14:54:22  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:22.064723 (Thread-3): 14:54:22  Opening a new connection, currently in state closed
2022-03-02 14:54:22.075728 (Thread-5): 14:54:22  SQL status: SUCCESS 1 in 2.58 seconds
2022-03-02 14:54:22.077051 (Thread-5): 14:54:22  finished collecting timing info
2022-03-02 14:54:22.077192 (Thread-5): 14:54:22  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 14:54:22.082002 (Thread-4): 14:54:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d6f0f40>]}
2022-03-02 14:54:22.082328 (Thread-4): 14:54:22  7 of 19 OK created incremental model DBT_VAULT.hub_part......................... [SUCCESS 1 in 2.85s]
2022-03-02 14:54:22.082447 (Thread-4): 14:54:22  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:54:22.082584 (Thread-4): 14:54:22  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:54:22.082763 (Thread-4): 14:54:22  13 of 19 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 14:54:22.082982 (Thread-4): 14:54:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:54:22.083069 (Thread-4): 14:54:22  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:54:22.083155 (Thread-4): 14:54:22  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:54:22.093271 (Thread-4): 14:54:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:54:22.105640 (Thread-4): 14:54:22  finished collecting timing info
2022-03-02 14:54:22.105788 (Thread-4): 14:54:22  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:54:22.108788 (Thread-4): 14:54:22  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:54:22.123088 (Thread-4): 14:54:22  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:54:22.123209 (Thread-4): 14:54:22  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:22.123297 (Thread-4): 14:54:22  Opening a new connection, currently in state closed
2022-03-02 14:54:22.314353 (Thread-5): 14:54:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d6c51f0>]}
2022-03-02 14:54:22.314762 (Thread-5): 14:54:22  9 of 19 OK created incremental model DBT_VAULT.hub_supplier..................... [SUCCESS 1 in 2.86s]
2022-03-02 14:54:22.314888 (Thread-5): 14:54:22  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:54:22.315041 (Thread-5): 14:54:22  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:54:22.315233 (Thread-5): 14:54:22  14 of 19 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 14:54:22.315470 (Thread-5): 14:54:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:54:22.315560 (Thread-5): 14:54:22  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:54:22.315696 (Thread-5): 14:54:22  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:54:22.323458 (Thread-5): 14:54:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:54:22.337840 (Thread-5): 14:54:22  finished collecting timing info
2022-03-02 14:54:22.337987 (Thread-5): 14:54:22  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:54:22.340942 (Thread-5): 14:54:22  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:54:22.355727 (Thread-5): 14:54:22  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:54:22.355846 (Thread-5): 14:54:22  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:22.355935 (Thread-5): 14:54:22  Opening a new connection, currently in state closed
2022-03-02 14:54:23.599508 (Thread-6): 14:54:23  SQL status: SUCCESS 1 in 1.7 seconds
2022-03-02 14:54:23.601130 (Thread-6): 14:54:23  finished collecting timing info
2022-03-02 14:54:23.601300 (Thread-6): 14:54:23  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 14:54:23.800803 (Thread-6): 14:54:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346c579ca0>]}
2022-03-02 14:54:23.801227 (Thread-6): 14:54:23  11 of 19 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 1.94s]
2022-03-02 14:54:23.801357 (Thread-6): 14:54:23  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:54:23.801513 (Thread-6): 14:54:23  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:54:23.801698 (Thread-6): 14:54:23  15 of 19 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 14:54:23.801934 (Thread-6): 14:54:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:54:23.802022 (Thread-6): 14:54:23  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:54:23.802110 (Thread-6): 14:54:23  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:54:23.839453 (Thread-6): 14:54:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:54:23.853917 (Thread-6): 14:54:23  finished collecting timing info
2022-03-02 14:54:23.854114 (Thread-6): 14:54:23  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:54:23.857325 (Thread-6): 14:54:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:54:23.876052 (Thread-6): 14:54:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:54:23.876209 (Thread-6): 14:54:23  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:23.876304 (Thread-6): 14:54:23  Opening a new connection, currently in state closed
2022-03-02 14:54:24.057290 (Thread-3): 14:54:24  SQL status: SUCCESS 1 in 1.99 seconds
2022-03-02 14:54:24.059675 (Thread-3): 14:54:24  finished collecting timing info
2022-03-02 14:54:24.059948 (Thread-3): 14:54:24  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 14:54:24.212162 (Thread-5): 14:54:24  SQL status: SUCCESS 1 in 1.86 seconds
2022-03-02 14:54:24.213676 (Thread-5): 14:54:24  finished collecting timing info
2022-03-02 14:54:24.213845 (Thread-5): 14:54:24  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 14:54:24.296049 (Thread-4): 14:54:24  SQL status: SUCCESS 1 in 2.17 seconds
2022-03-02 14:54:24.297559 (Thread-4): 14:54:24  finished collecting timing info
2022-03-02 14:54:24.297722 (Thread-4): 14:54:24  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 14:54:24.395841 (Thread-3): 14:54:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346c5a1b20>]}
2022-03-02 14:54:24.396281 (Thread-3): 14:54:24  12 of 19 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.37s]
2022-03-02 14:54:24.396419 (Thread-3): 14:54:24  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:54:24.396577 (Thread-3): 14:54:24  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:54:24.396766 (Thread-3): 14:54:24  16 of 19 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 14:54:24.397011 (Thread-3): 14:54:24  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:54:24.397101 (Thread-3): 14:54:24  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:54:24.397190 (Thread-3): 14:54:24  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:54:24.468979 (Thread-5): 14:54:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346c5997f0>]}
2022-03-02 14:54:24.472022 (Thread-3): 14:54:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:54:24.472419 (Thread-5): 14:54:24  14 of 19 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 2.15s]
2022-03-02 14:54:24.472568 (Thread-5): 14:54:24  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:54:24.472708 (Thread-5): 14:54:24  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:54:24.472884 (Thread-5): 14:54:24  17 of 19 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 14:54:24.473115 (Thread-5): 14:54:24  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:54:24.473203 (Thread-5): 14:54:24  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:54:24.473290 (Thread-5): 14:54:24  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:54:24.486271 (Thread-5): 14:54:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:54:24.492859 (Thread-3): 14:54:24  finished collecting timing info
2022-03-02 14:54:24.493022 (Thread-3): 14:54:24  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:54:24.495862 (Thread-3): 14:54:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:54:24.501600 (Thread-5): 14:54:24  finished collecting timing info
2022-03-02 14:54:24.501761 (Thread-5): 14:54:24  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:54:24.504572 (Thread-5): 14:54:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:54:24.506730 (Thread-4): 14:54:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d6c6a60>]}
2022-03-02 14:54:24.507061 (Thread-4): 14:54:24  13 of 19 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 2.42s]
2022-03-02 14:54:24.507177 (Thread-4): 14:54:24  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:54:24.507314 (Thread-4): 14:54:24  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:54:24.507489 (Thread-4): 14:54:24  18 of 19 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 14:54:24.507749 (Thread-4): 14:54:24  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:54:24.507845 (Thread-4): 14:54:24  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:54:24.507931 (Thread-4): 14:54:24  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:54:24.512959 (Thread-3): 14:54:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:54:24.513070 (Thread-3): 14:54:24  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:24.513158 (Thread-3): 14:54:24  Opening a new connection, currently in state closed
2022-03-02 14:54:24.524153 (Thread-4): 14:54:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:54:24.531076 (Thread-5): 14:54:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:54:24.531197 (Thread-5): 14:54:24  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:24.531281 (Thread-5): 14:54:24  Opening a new connection, currently in state closed
2022-03-02 14:54:24.538158 (Thread-4): 14:54:24  finished collecting timing info
2022-03-02 14:54:24.538314 (Thread-4): 14:54:24  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:54:24.541087 (Thread-4): 14:54:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:54:24.554309 (Thread-4): 14:54:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:54:24.554429 (Thread-4): 14:54:24  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:24.554513 (Thread-4): 14:54:24  Opening a new connection, currently in state closed
2022-03-02 14:54:25.762239 (Thread-6): 14:54:25  SQL status: SUCCESS 1 in 1.89 seconds
2022-03-02 14:54:25.763906 (Thread-6): 14:54:25  finished collecting timing info
2022-03-02 14:54:25.764143 (Thread-6): 14:54:25  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 14:54:25.986377 (Thread-6): 14:54:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34848c6b50>]}
2022-03-02 14:54:25.986803 (Thread-6): 14:54:25  15 of 19 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 2.18s]
2022-03-02 14:54:25.986934 (Thread-6): 14:54:25  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:54:25.987079 (Thread-6): 14:54:25  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:54:25.987264 (Thread-6): 14:54:25  19 of 19 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 14:54:25.987506 (Thread-6): 14:54:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:54:25.987596 (Thread-6): 14:54:25  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:54:25.987732 (Thread-6): 14:54:25  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:54:26.000898 (Thread-6): 14:54:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:54:26.014211 (Thread-6): 14:54:26  finished collecting timing info
2022-03-02 14:54:26.014364 (Thread-6): 14:54:26  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:54:26.017279 (Thread-6): 14:54:26  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:54:26.029938 (Thread-6): 14:54:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:54:26.030057 (Thread-6): 14:54:26  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:54:26.030145 (Thread-6): 14:54:26  Opening a new connection, currently in state closed
2022-03-02 14:54:26.378942 (Thread-3): 14:54:26  SQL status: SUCCESS 1 in 1.87 seconds
2022-03-02 14:54:26.380456 (Thread-3): 14:54:26  finished collecting timing info
2022-03-02 14:54:26.380623 (Thread-3): 14:54:26  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 14:54:26.528320 (Thread-305): handling status request
2022-03-02 14:54:26.528771 (Thread-305): 14:54:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78071b20>]}
2022-03-02 14:54:26.529303 (Thread-305): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:26.536868 (Thread-306): handling list request
2022-03-02 14:54:26.537548 (Thread-307): handling poll request
2022-03-02 14:54:26.537901 (Thread-306): 14:54:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78077340>]}
2022-03-02 14:54:26.538163 (Thread-307): 14:54:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b78077ac0>]}
2022-03-02 14:54:26.540911 (Thread-307): sending response (<Response 80672 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:26.566517 (Thread-4): 14:54:26  SQL status: SUCCESS 1 in 2.01 seconds
2022-03-02 14:54:26.568727 (Thread-4): 14:54:26  finished collecting timing info
2022-03-02 14:54:26.568954 (Thread-4): 14:54:26  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 14:54:26.574497 (Thread-306): 14:54:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b780773d0>]}
2022-03-02 14:54:26.574825 (Thread-306): 14:54:26  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:54:26.581958 (Thread-306): sending response (<Response 25039 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:26.596628 (Thread-3): 14:54:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d6a9ee0>]}
2022-03-02 14:54:26.596994 (Thread-3): 14:54:26  16 of 19 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 2.20s]
2022-03-02 14:54:26.597122 (Thread-3): 14:54:26  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:54:26.741582 (Thread-5): 14:54:26  SQL status: SUCCESS 1 in 2.21 seconds
2022-03-02 14:54:26.742968 (Thread-5): 14:54:26  finished collecting timing info
2022-03-02 14:54:26.743120 (Thread-5): 14:54:26  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 14:54:26.780613 (Thread-4): 14:54:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d7a6dc0>]}
2022-03-02 14:54:26.781114 (Thread-4): 14:54:26  18 of 19 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 2.27s]
2022-03-02 14:54:26.781316 (Thread-4): 14:54:26  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:54:26.959417 (Thread-5): 14:54:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d5f80d0>]}
2022-03-02 14:54:26.959887 (Thread-5): 14:54:26  17 of 19 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.49s]
2022-03-02 14:54:26.960026 (Thread-5): 14:54:26  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:54:27.624445 (Thread-6): 14:54:27  SQL status: SUCCESS 1 in 1.59 seconds
2022-03-02 14:54:27.625997 (Thread-6): 14:54:27  finished collecting timing info
2022-03-02 14:54:27.626166 (Thread-6): 14:54:27  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 14:54:27.864008 (Thread-6): 14:54:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e7522a-e962-47fc-9351-08773b78d914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34855e1d30>]}
2022-03-02 14:54:27.864583 (Thread-6): 14:54:27  19 of 19 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 1.88s]
2022-03-02 14:54:27.864732 (Thread-6): 14:54:27  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:54:27.866296 (MainThread): 14:54:27  Acquiring new snowflake connection "master"
2022-03-02 14:54:27.866697 (MainThread): 14:54:27  
2022-03-02 14:54:27.866804 (MainThread): 14:54:27  Finished running 2 table models, 17 incremental models in 26.50s.
2022-03-02 14:54:27.866894 (MainThread): 14:54:27  Connection 'master' was properly closed.
2022-03-02 14:54:27.866963 (MainThread): 14:54:27  Connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details' was properly closed.
2022-03-02 14:54:27.867028 (MainThread): 14:54:27  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 14:54:27.867090 (MainThread): 14:54:27  Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
2022-03-02 14:54:27.867150 (MainThread): 14:54:27  Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
2022-03-02 14:54:27.947337 (MainThread): 14:54:27  
2022-03-02 14:54:27.947527 (MainThread): 14:54:27  Completed successfully
2022-03-02 14:54:27.947679 (MainThread): 14:54:27  
2022-03-02 14:54:27.947781 (MainThread): 14:54:27  Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
2022-03-02 14:54:29.729001 (Thread-308): handling poll request
2022-03-02 14:54:29.729377 (Thread-308): 14:54:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5877f8b0>]}
2022-03-02 14:54:29.732022 (Thread-308): sending response (<Response 100902 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:31.159850 (Thread-309): handling status request
2022-03-02 14:54:31.160216 (Thread-309): 14:54:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58785460>]}
2022-03-02 14:54:31.160701 (Thread-309): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:31.409199 (Thread-310): handling status request
2022-03-02 14:54:31.409593 (Thread-310): 14:54:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58789f10>]}
2022-03-02 14:54:31.410137 (Thread-310): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:33.380784 (Thread-311): handling status request
2022-03-02 14:54:33.381261 (Thread-311): 14:54:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5878ef70>]}
2022-03-02 14:54:33.381902 (Thread-311): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:54:33.392327 (Thread-312): handling list request
2022-03-02 14:54:33.392795 (Thread-312): 14:54:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58793f10>]}
2022-03-02 14:54:33.432892 (Thread-312): 14:54:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58789490>]}
2022-03-02 14:54:33.459021 (Thread-312): 14:54:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:54:33.464520 (Thread-312): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:04.562536 (Thread-313): handling status request
2022-03-02 14:56:04.564008 (Thread-313): 14:56:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587aecd0>]}
2022-03-02 14:56:04.564564 (Thread-313): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:04.581052 (Thread-314): handling list request
2022-03-02 14:56:04.581430 (Thread-314): 14:56:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587aed90>]}
2022-03-02 14:56:04.619824 (Thread-314): 14:56:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5877f220>]}
2022-03-02 14:56:04.620191 (Thread-314): 14:56:04  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:56:04.629620 (Thread-314): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:22.000856 (Thread-315): handling status request
2022-03-02 14:56:22.001233 (Thread-315): 14:56:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587aefd0>]}
2022-03-02 14:56:22.001716 (Thread-315): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:22.009252 (Thread-316): handling list request
2022-03-02 14:56:22.009581 (Thread-316): 14:56:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587ae550>]}
2022-03-02 14:56:22.046065 (Thread-316): 14:56:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587aeee0>]}
2022-03-02 14:56:22.046376 (Thread-316): 14:56:22  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:56:22.052252 (Thread-316): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:39.139059 (Thread-317): handling status request
2022-03-02 14:56:39.139420 (Thread-317): 14:56:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58771610>]}
2022-03-02 14:56:39.139985 (Thread-317): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:39.147779 (Thread-318): handling list request
2022-03-02 14:56:39.148023 (Thread-318): 14:56:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5871d2e0>]}
2022-03-02 14:56:39.185896 (Thread-318): 14:56:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587aefd0>]}
2022-03-02 14:56:39.186511 (Thread-318): 14:56:39  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:56:39.191040 (Thread-318): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:39.947052 (Thread-319): handling status request
2022-03-02 14:56:39.947428 (Thread-319): 14:56:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586c3af0>]}
2022-03-02 14:56:39.947954 (Thread-319): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:40.302698 (Thread-320): handling ps request
2022-03-02 14:56:40.303234 (Thread-320): 14:56:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5879aca0>]}
2022-03-02 14:56:40.305528 (Thread-320): sending response (<Response 21447 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:42.648811 (Thread-321): handling status request
2022-03-02 14:56:42.649176 (Thread-321): 14:56:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586c3100>]}
2022-03-02 14:56:42.649656 (Thread-321): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:43.556363 (Thread-322): handling status request
2022-03-02 14:56:43.556746 (Thread-322): 14:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5871deb0>]}
2022-03-02 14:56:43.557238 (Thread-322): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:43.565315 (Thread-323): handling list request
2022-03-02 14:56:43.565620 (Thread-323): 14:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586f6070>]}
2022-03-02 14:56:43.598157 (Thread-323): 14:56:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586c3c40>]}
2022-03-02 14:56:43.598513 (Thread-323): 14:56:43  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:56:43.601952 (Thread-323): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:43.878022 (Thread-324): handling status request
2022-03-02 14:56:43.878387 (Thread-324): 14:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586a2310>]}
2022-03-02 14:56:43.878871 (Thread-324): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:43.885567 (Thread-325): handling list request
2022-03-02 14:56:43.885815 (Thread-325): 14:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586a2640>]}
2022-03-02 14:56:43.887208 (Thread-326): handling status request
2022-03-02 14:56:43.960571 (Thread-328): sending response (<Response 214 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:44.066840 (Thread-330): handling poll request
2022-03-02 14:56:44.067167 (Thread-330): 14:56:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586a2d00>]}
2022-03-02 14:56:44.073021 (Thread-330): sending response (<Response 266633 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:45.504692 (Thread-331): handling status request
2022-03-02 14:56:45.505108 (Thread-331): 14:56:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58793400>]}
2022-03-02 14:56:45.505588 (Thread-331): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:45.512885 (Thread-332): handling list request
2022-03-02 14:56:45.513175 (Thread-332): 14:56:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5871dee0>]}
2022-03-02 14:56:45.518557 (Thread-333): handling status request
2022-03-02 14:56:45.518941 (Thread-333): 14:56:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5864dee0>]}
2022-03-02 14:56:45.519512 (Thread-333): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:45.549257 (Thread-332): 14:56:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586f61f0>]}
2022-03-02 14:56:45.549574 (Thread-332): 14:56:45  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:56:45.554851 (Thread-332): sending response (<Response 18225 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:45.679558 (Thread-334): handling status request
2022-03-02 14:56:45.679978 (Thread-334): 14:56:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5864dd60>]}
2022-03-02 14:56:45.704681 (Thread-334): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:47.545995 (Thread-335): handling status request
2022-03-02 14:56:47.546365 (Thread-335): 14:56:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586cbd30>]}
2022-03-02 14:56:47.546841 (Thread-335): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:48.010619 (Thread-336): handling status request
2022-03-02 14:56:48.010982 (Thread-336): 14:56:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586cbc40>]}
2022-03-02 14:56:48.011466 (Thread-336): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:48.333594 (Thread-337): handling cli_args request
2022-03-02 14:56:48.333943 (Thread-337): 14:56:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5872e4f0>]}
2022-03-02 14:56:50.510023 (Thread-337): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:50.886870 (MainThread): 14:56:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:56:50.887324 (MainThread): 14:56:50  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:56:50.895087 (MainThread): 14:56:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc85690a0>]}
2022-03-02 14:56:50.929338 (MainThread): 14:56:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc864fbe0>]}
2022-03-02 14:56:50.929626 (MainThread): 14:56:50  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:56:50.931862 (MainThread): 14:56:50  
2022-03-02 14:56:50.932180 (MainThread): 14:56:50  Acquiring new snowflake connection "master"
2022-03-02 14:56:50.933695 (ThreadPoolExecutor-0_0): 14:56:50  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:56:50.946553 (ThreadPoolExecutor-0_0): 14:56:50  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:56:50.946662 (ThreadPoolExecutor-0_0): 14:56:50  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:56:50.946746 (ThreadPoolExecutor-0_0): 14:56:50  Opening a new connection, currently in state init
2022-03-02 14:56:51.311075 (Thread-338): handling poll request
2022-03-02 14:56:51.311511 (Thread-338): 14:56:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586740d0>]}
2022-03-02 14:56:51.312368 (Thread-338): sending response (<Response 4169 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:52.246032 (ThreadPoolExecutor-0_0): 14:56:52  SQL status: SUCCESS 7 in 1.3 seconds
2022-03-02 14:56:52.248043 (ThreadPoolExecutor-0_0): 14:56:52  On list_DBT_RAW: Close
2022-03-02 14:56:52.504148 (ThreadPoolExecutor-2_0): 14:56:52  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:56:52.512026 (ThreadPoolExecutor-2_0): 14:56:52  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:56:52.512173 (ThreadPoolExecutor-2_0): 14:56:52  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:56:52.512269 (ThreadPoolExecutor-2_0): 14:56:52  Opening a new connection, currently in state closed
2022-03-02 14:56:53.113125 (Thread-339): handling poll request
2022-03-02 14:56:53.113532 (Thread-339): 14:56:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58674e50>]}
2022-03-02 14:56:53.114079 (Thread-339): sending response (<Response 2320 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:53.712985 (ThreadPoolExecutor-2_0): 14:56:53  SQL status: SUCCESS 31 in 1.2 seconds
2022-03-02 14:56:53.715186 (ThreadPoolExecutor-2_0): 14:56:53  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:56:53.946554 (MainThread): 14:56:53  Concurrency: 4 threads (target='default')
2022-03-02 14:56:53.946725 (MainThread): 14:56:53  
2022-03-02 14:56:53.949725 (Thread-3): 14:56:53  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:56:53.950053 (Thread-3): 14:56:53  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:56:53.950327 (Thread-3): 14:56:53  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:56:53.950429 (Thread-3): 14:56:53  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:56:53.950536 (Thread-3): 14:56:53  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:56:53.956192 (Thread-3): 14:56:53  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:56:53.970656 (Thread-3): 14:56:53  finished collecting timing info
2022-03-02 14:56:53.970810 (Thread-3): 14:56:53  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:56:53.994511 (Thread-3): 14:56:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:56:54.011348 (Thread-3): 14:56:54  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:56:54.011478 (Thread-3): 14:56:54  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_orders  as
      (SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:56:54.011563 (Thread-3): 14:56:54  Opening a new connection, currently in state closed
2022-03-02 14:56:55.886307 (Thread-340): handling poll request
2022-03-02 14:56:55.886672 (Thread-340): 14:56:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b586946d0>]}
2022-03-02 14:56:55.887329 (Thread-340): sending response (<Response 9244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:57.694827 (Thread-341): handling poll request
2022-03-02 14:56:57.695175 (Thread-341): 14:56:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58694880>]}
2022-03-02 14:56:57.695702 (Thread-341): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:56:59.490596 (Thread-342): handling poll request
2022-03-02 14:56:59.490959 (Thread-342): 14:56:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58694af0>]}
2022-03-02 14:56:59.491438 (Thread-342): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:01.277912 (Thread-343): handling poll request
2022-03-02 14:57:01.278568 (Thread-343): 14:57:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58694d60>]}
2022-03-02 14:57:01.279059 (Thread-343): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:02.253641 (Thread-3): 14:57:02  SQL status: SUCCESS 1 in 8.24 seconds
2022-03-02 14:57:02.263179 (Thread-3): 14:57:02  finished collecting timing info
2022-03-02 14:57:02.263357 (Thread-3): 14:57:02  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:57:02.482816 (Thread-3): 14:57:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc21e6f40>]}
2022-03-02 14:57:02.483265 (Thread-3): 14:57:02  1 of 19 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 8.53s]
2022-03-02 14:57:02.483394 (Thread-3): 14:57:02  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:57:02.484521 (Thread-5): 14:57:02  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:57:02.484801 (Thread-5): 14:57:02  2 of 19 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:57:02.485091 (Thread-5): 14:57:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:57:02.485183 (Thread-5): 14:57:02  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:57:02.485272 (Thread-5): 14:57:02  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:57:02.524399 (Thread-5): 14:57:02  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:57:02.524553 (Thread-5): 14:57:02  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:57:02.524661 (Thread-5): 14:57:02  Opening a new connection, currently in state init
2022-03-02 14:57:03.063975 (Thread-344): handling poll request
2022-03-02 14:57:03.064363 (Thread-344): 14:57:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58674c70>]}
2022-03-02 14:57:03.065010 (Thread-344): sending response (<Response 6320 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:03.167725 (Thread-5): 14:57:03  SQL status: SUCCESS 37 in 0.64 seconds
2022-03-02 14:57:03.198492 (Thread-5): 14:57:03  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:57:03.198650 (Thread-5): 14:57:03  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:57:03.335116 (Thread-5): 14:57:03  SQL status: SUCCESS 37 in 0.14 seconds
2022-03-02 14:57:03.386644 (Thread-5): 14:57:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:57:03.413725 (Thread-5): 14:57:03  finished collecting timing info
2022-03-02 14:57:03.413934 (Thread-5): 14:57:03  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:57:03.417067 (Thread-5): 14:57:03  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:57:03.453327 (Thread-5): 14:57:03  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:57:03.453504 (Thread-5): 14:57:03  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:57:05.530162 (Thread-5): 14:57:05  SQL status: SUCCESS 1 in 2.08 seconds
2022-03-02 14:57:05.531665 (Thread-5): 14:57:05  finished collecting timing info
2022-03-02 14:57:05.531832 (Thread-5): 14:57:05  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:57:05.734895 (Thread-5): 14:57:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc01ac9d0>]}
2022-03-02 14:57:05.735328 (Thread-5): 14:57:05  2 of 19 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.25s]
2022-03-02 14:57:05.735464 (Thread-5): 14:57:05  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:57:05.736886 (Thread-4): 14:57:05  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:57:05.737165 (Thread-4): 14:57:05  3 of 19 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 14:57:05.737449 (Thread-4): 14:57:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:57:05.737542 (Thread-4): 14:57:05  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:57:05.737631 (Thread-4): 14:57:05  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:57:05.741946 (Thread-3): 14:57:05  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:57:05.742170 (Thread-3): 14:57:05  4 of 19 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 14:57:05.742415 (Thread-3): 14:57:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:57:05.742522 (Thread-3): 14:57:05  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:57:05.870990 (Thread-345): handling poll request
2022-03-02 14:57:05.871351 (Thread-345): 14:57:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587338e0>]}
2022-03-02 14:57:05.872165 (Thread-345): sending response (<Response 21299 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:05.742605 (Thread-3): 14:57:05  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:57:05.752304 (Thread-6): 14:57:05  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:57:05.752524 (Thread-6): 14:57:05  5 of 19 START incremental model DBT_VAULT.hub_nation............................ [RUN]
2022-03-02 14:57:05.752773 (Thread-6): 14:57:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:57:05.752859 (Thread-6): 14:57:05  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:57:05.752938 (Thread-6): 14:57:05  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:57:05.767743 (Thread-5): 14:57:05  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:57:05.767954 (Thread-5): 14:57:05  6 of 19 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 14:57:05.768173 (Thread-5): 14:57:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:57:05.768257 (Thread-5): 14:57:05  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:57:05.768345 (Thread-5): 14:57:05  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:57:05.902353 (Thread-5): 14:57:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:57:05.904371 (Thread-3): 14:57:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:57:05.916396 (Thread-4): 14:57:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:57:05.920660 (Thread-6): 14:57:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:57:05.925628 (Thread-3): 14:57:05  finished collecting timing info
2022-03-02 14:57:05.925781 (Thread-3): 14:57:05  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:57:05.930960 (Thread-5): 14:57:05  finished collecting timing info
2022-03-02 14:57:05.931091 (Thread-5): 14:57:05  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:57:05.961208 (Thread-4): 14:57:05  finished collecting timing info
2022-03-02 14:57:05.961379 (Thread-4): 14:57:05  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:57:05.970747 (Thread-3): 14:57:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:57:05.972621 (Thread-5): 14:57:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:57:05.972833 (Thread-6): 14:57:05  finished collecting timing info
2022-03-02 14:57:05.972976 (Thread-6): 14:57:05  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:57:05.975796 (Thread-6): 14:57:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:57:05.976533 (Thread-4): 14:57:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:57:05.989985 (Thread-3): 14:57:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:57:05.990103 (Thread-3): 14:57:05  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:05.990190 (Thread-3): 14:57:05  Opening a new connection, currently in state closed
2022-03-02 14:57:05.991914 (Thread-6): 14:57:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:57:05.992018 (Thread-6): 14:57:05  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:05.992097 (Thread-6): 14:57:05  Opening a new connection, currently in state init
2022-03-02 14:57:05.994069 (Thread-4): 14:57:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:57:05.994176 (Thread-4): 14:57:05  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:05.994255 (Thread-4): 14:57:05  Opening a new connection, currently in state init
2022-03-02 14:57:05.996498 (Thread-5): 14:57:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:57:05.996604 (Thread-5): 14:57:05  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:05.996682 (Thread-5): 14:57:05  Opening a new connection, currently in state closed
2022-03-02 14:57:07.632447 (Thread-346): handling poll request
2022-03-02 14:57:07.632801 (Thread-346): 14:57:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585837c0>]}
2022-03-02 14:57:07.633647 (Thread-346): sending response (<Response 19696 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:08.421654 (Thread-4): 14:57:08  SQL status: SUCCESS 1 in 2.43 seconds
2022-03-02 14:57:08.423196 (Thread-4): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.423360 (Thread-4): 14:57:08  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 14:57:08.493388 (Thread-6): 14:57:08  SQL status: SUCCESS 1 in 2.5 seconds
2022-03-02 14:57:08.494867 (Thread-6): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.495018 (Thread-6): 14:57:08  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 14:57:08.499066 (Thread-5): 14:57:08  SQL status: SUCCESS 1 in 2.5 seconds
2022-03-02 14:57:08.500383 (Thread-5): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.500522 (Thread-5): 14:57:08  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 14:57:08.572366 (Thread-3): 14:57:08  SQL status: SUCCESS 1 in 2.58 seconds
2022-03-02 14:57:08.573830 (Thread-3): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.573985 (Thread-3): 14:57:08  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 14:57:08.622887 (Thread-4): 14:57:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc2204ca0>]}
2022-03-02 14:57:08.623510 (Thread-4): 14:57:08  3 of 19 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 2.89s]
2022-03-02 14:57:08.623702 (Thread-4): 14:57:08  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:57:08.623860 (Thread-4): 14:57:08  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:57:08.624062 (Thread-4): 14:57:08  7 of 19 START incremental model DBT_VAULT.hub_part.............................. [RUN]
2022-03-02 14:57:08.624323 (Thread-4): 14:57:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:57:08.624416 (Thread-4): 14:57:08  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:57:08.624506 (Thread-4): 14:57:08  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:57:08.634341 (Thread-4): 14:57:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:57:08.646293 (Thread-4): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.646440 (Thread-4): 14:57:08  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:57:08.649201 (Thread-4): 14:57:08  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:57:08.663739 (Thread-4): 14:57:08  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:57:08.663864 (Thread-4): 14:57:08  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:08.663952 (Thread-4): 14:57:08  Opening a new connection, currently in state closed
2022-03-02 14:57:08.727414 (Thread-6): 14:57:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc00b0fd0>]}
2022-03-02 14:57:08.727859 (Thread-6): 14:57:08  5 of 19 OK created incremental model DBT_VAULT.hub_nation....................... [SUCCESS 1 in 2.97s]
2022-03-02 14:57:08.727990 (Thread-6): 14:57:08  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:57:08.728130 (Thread-6): 14:57:08  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:57:08.728312 (Thread-6): 14:57:08  8 of 19 START incremental model DBT_VAULT.hub_region............................ [RUN]
2022-03-02 14:57:08.728560 (Thread-6): 14:57:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:57:08.728648 (Thread-6): 14:57:08  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:57:08.728732 (Thread-6): 14:57:08  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:57:08.738289 (Thread-6): 14:57:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:57:08.748984 (Thread-5): 14:57:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc0127fd0>]}
2022-03-02 14:57:08.749297 (Thread-5): 14:57:08  6 of 19 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 2.98s]
2022-03-02 14:57:08.749412 (Thread-5): 14:57:08  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:57:08.749548 (Thread-5): 14:57:08  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:57:08.749715 (Thread-5): 14:57:08  9 of 19 START incremental model DBT_VAULT.hub_supplier.......................... [RUN]
2022-03-02 14:57:08.749945 (Thread-5): 14:57:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:57:08.750033 (Thread-5): 14:57:08  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:57:08.750113 (Thread-5): 14:57:08  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:57:08.754347 (Thread-6): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.754484 (Thread-6): 14:57:08  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:57:08.757293 (Thread-6): 14:57:08  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:57:08.762074 (Thread-5): 14:57:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:57:08.775830 (Thread-5): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.775981 (Thread-5): 14:57:08  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:57:08.778584 (Thread-5): 14:57:08  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:57:08.780112 (Thread-6): 14:57:08  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:57:08.780215 (Thread-6): 14:57:08  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:08.780299 (Thread-6): 14:57:08  Opening a new connection, currently in state closed
2022-03-02 14:57:08.794950 (Thread-5): 14:57:08  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:57:08.795244 (Thread-5): 14:57:08  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:08.795338 (Thread-5): 14:57:08  Opening a new connection, currently in state closed
2022-03-02 14:57:08.816730 (Thread-3): 14:57:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc017dc10>]}
2022-03-02 14:57:08.817085 (Thread-3): 14:57:08  4 of 19 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 3.07s]
2022-03-02 14:57:08.817205 (Thread-3): 14:57:08  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:57:08.817347 (Thread-3): 14:57:08  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:57:08.817522 (Thread-3): 14:57:08  10 of 19 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 14:57:08.817749 (Thread-3): 14:57:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:57:08.817836 (Thread-3): 14:57:08  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:57:08.817919 (Thread-3): 14:57:08  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:57:08.844815 (Thread-3): 14:57:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:57:08.858347 (Thread-3): 14:57:08  finished collecting timing info
2022-03-02 14:57:08.858550 (Thread-3): 14:57:08  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:57:08.863010 (Thread-3): 14:57:08  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:57:08.876738 (Thread-3): 14:57:08  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:57:08.876889 (Thread-3): 14:57:08  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:08.876978 (Thread-3): 14:57:08  Opening a new connection, currently in state closed
2022-03-02 14:57:09.500956 (Thread-347): handling poll request
2022-03-02 14:57:09.501341 (Thread-347): 14:57:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5859b640>]}
2022-03-02 14:57:09.502600 (Thread-347): sending response (<Response 35755 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:10.883510 (Thread-6): 14:57:10  SQL status: SUCCESS 1 in 2.1 seconds
2022-03-02 14:57:10.885107 (Thread-6): 14:57:10  finished collecting timing info
2022-03-02 14:57:10.885274 (Thread-6): 14:57:10  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 14:57:10.927741 (Thread-3): 14:57:10  SQL status: SUCCESS 1 in 2.05 seconds
2022-03-02 14:57:10.928997 (Thread-3): 14:57:10  finished collecting timing info
2022-03-02 14:57:10.929132 (Thread-3): 14:57:10  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 14:57:10.955653 (Thread-4): 14:57:10  SQL status: SUCCESS 1 in 2.29 seconds
2022-03-02 14:57:10.956882 (Thread-4): 14:57:10  finished collecting timing info
2022-03-02 14:57:10.957011 (Thread-4): 14:57:10  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 14:57:10.960604 (Thread-5): 14:57:10  SQL status: SUCCESS 1 in 2.17 seconds
2022-03-02 14:57:10.961776 (Thread-5): 14:57:10  finished collecting timing info
2022-03-02 14:57:10.961902 (Thread-5): 14:57:10  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 14:57:11.077942 (Thread-6): 14:57:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca2fd9ac0>]}
2022-03-02 14:57:11.078294 (Thread-6): 14:57:11  8 of 19 OK created incremental model DBT_VAULT.hub_region....................... [SUCCESS 1 in 2.35s]
2022-03-02 14:57:11.078414 (Thread-6): 14:57:11  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:57:11.078554 (Thread-6): 14:57:11  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:57:11.078736 (Thread-6): 14:57:11  11 of 19 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 14:57:11.078968 (Thread-6): 14:57:11  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:57:11.079059 (Thread-6): 14:57:11  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:57:11.079145 (Thread-6): 14:57:11  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:57:11.087754 (Thread-6): 14:57:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:57:11.099939 (Thread-6): 14:57:11  finished collecting timing info
2022-03-02 14:57:11.100083 (Thread-6): 14:57:11  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:57:11.102938 (Thread-6): 14:57:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:57:11.116620 (Thread-6): 14:57:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:57:11.116735 (Thread-6): 14:57:11  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:11.116820 (Thread-6): 14:57:11  Opening a new connection, currently in state closed
2022-03-02 14:57:11.146721 (Thread-4): 14:57:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca2fb85b0>]}
2022-03-02 14:57:11.147061 (Thread-4): 14:57:11  7 of 19 OK created incremental model DBT_VAULT.hub_part......................... [SUCCESS 1 in 2.52s]
2022-03-02 14:57:11.147178 (Thread-4): 14:57:11  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:57:11.147315 (Thread-4): 14:57:11  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:57:11.147491 (Thread-4): 14:57:11  12 of 19 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 14:57:11.147754 (Thread-4): 14:57:11  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:57:11.147846 (Thread-4): 14:57:11  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:57:11.147934 (Thread-4): 14:57:11  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:57:11.155508 (Thread-4): 14:57:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:57:11.157958 (Thread-3): 14:57:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc00bff70>]}
2022-03-02 14:57:11.158263 (Thread-3): 14:57:11  10 of 19 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 2.34s]
2022-03-02 14:57:11.158375 (Thread-3): 14:57:11  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:57:11.158503 (Thread-3): 14:57:11  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:57:11.158670 (Thread-3): 14:57:11  13 of 19 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 14:57:11.158879 (Thread-3): 14:57:11  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:57:11.158965 (Thread-3): 14:57:11  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:57:11.159044 (Thread-3): 14:57:11  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:57:11.167330 (Thread-3): 14:57:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:57:11.169292 (Thread-5): 14:57:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca1680790>]}
2022-03-02 14:57:11.169585 (Thread-5): 14:57:11  9 of 19 OK created incremental model DBT_VAULT.hub_supplier..................... [SUCCESS 1 in 2.42s]
2022-03-02 14:57:11.169694 (Thread-5): 14:57:11  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:57:11.169831 (Thread-5): 14:57:11  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:57:11.169997 (Thread-5): 14:57:11  14 of 19 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 14:57:11.170200 (Thread-5): 14:57:11  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:57:11.170280 (Thread-5): 14:57:11  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:57:11.170358 (Thread-5): 14:57:11  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:57:11.174633 (Thread-4): 14:57:11  finished collecting timing info
2022-03-02 14:57:11.174801 (Thread-4): 14:57:11  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:57:11.177481 (Thread-4): 14:57:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:57:11.181533 (Thread-5): 14:57:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:57:11.187011 (Thread-3): 14:57:11  finished collecting timing info
2022-03-02 14:57:11.187153 (Thread-3): 14:57:11  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:57:11.189717 (Thread-3): 14:57:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:57:11.196174 (Thread-4): 14:57:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:57:11.196293 (Thread-4): 14:57:11  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:11.196378 (Thread-4): 14:57:11  Opening a new connection, currently in state closed
2022-03-02 14:57:11.197188 (Thread-5): 14:57:11  finished collecting timing info
2022-03-02 14:57:11.197318 (Thread-5): 14:57:11  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:57:11.199930 (Thread-5): 14:57:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:57:11.207139 (Thread-3): 14:57:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:57:11.207259 (Thread-3): 14:57:11  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:11.207342 (Thread-3): 14:57:11  Opening a new connection, currently in state closed
2022-03-02 14:57:11.213562 (Thread-5): 14:57:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 14:57:11.213680 (Thread-5): 14:57:11  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:11.213761 (Thread-5): 14:57:11  Opening a new connection, currently in state closed
2022-03-02 14:57:11.503466 (Thread-348): handling poll request
2022-03-02 14:57:11.503874 (Thread-348): 14:57:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585ace80>]}
2022-03-02 14:57:11.504978 (Thread-348): sending response (<Response 35432 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:12.606214 (Thread-6): 14:57:12  SQL status: SUCCESS 1 in 1.49 seconds
2022-03-02 14:57:12.607808 (Thread-6): 14:57:12  finished collecting timing info
2022-03-02 14:57:12.607979 (Thread-6): 14:57:12  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 14:57:12.813258 (Thread-6): 14:57:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca2fc0af0>]}
2022-03-02 14:57:12.813686 (Thread-6): 14:57:12  11 of 19 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 1.73s]
2022-03-02 14:57:12.813813 (Thread-6): 14:57:12  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:57:12.813965 (Thread-6): 14:57:12  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:57:12.814149 (Thread-6): 14:57:12  15 of 19 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 14:57:12.814387 (Thread-6): 14:57:12  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:57:12.814476 (Thread-6): 14:57:12  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:57:12.814564 (Thread-6): 14:57:12  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:57:12.849992 (Thread-6): 14:57:12  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:57:12.863332 (Thread-6): 14:57:12  finished collecting timing info
2022-03-02 14:57:12.863506 (Thread-6): 14:57:12  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:57:12.866309 (Thread-6): 14:57:12  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:57:12.878446 (Thread-6): 14:57:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 14:57:12.878568 (Thread-6): 14:57:12  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:12.878656 (Thread-6): 14:57:12  Opening a new connection, currently in state closed
2022-03-02 14:57:13.420994 (Thread-4): 14:57:13  SQL status: SUCCESS 1 in 2.22 seconds
2022-03-02 14:57:13.423167 (Thread-4): 14:57:13  finished collecting timing info
2022-03-02 14:57:13.423398 (Thread-4): 14:57:13  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 14:57:13.513665 (Thread-349): handling poll request
2022-03-02 14:57:13.514017 (Thread-349): 14:57:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585b3910>]}
2022-03-02 14:57:13.514664 (Thread-349): sending response (<Response 10296 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:13.523121 (Thread-5): 14:57:13  SQL status: SUCCESS 1 in 2.31 seconds
2022-03-02 14:57:13.524638 (Thread-5): 14:57:13  finished collecting timing info
2022-03-02 14:57:13.524791 (Thread-5): 14:57:13  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 14:57:13.577474 (Thread-3): 14:57:13  SQL status: SUCCESS 1 in 2.37 seconds
2022-03-02 14:57:13.578930 (Thread-3): 14:57:13  finished collecting timing info
2022-03-02 14:57:13.579083 (Thread-3): 14:57:13  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 14:57:13.657439 (Thread-4): 14:57:13  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc005c640>]}
2022-03-02 14:57:13.657857 (Thread-4): 14:57:13  12 of 19 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.51s]
2022-03-02 14:57:13.657985 (Thread-4): 14:57:13  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:57:13.658138 (Thread-4): 14:57:13  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:57:13.658324 (Thread-4): 14:57:13  16 of 19 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 14:57:13.658565 (Thread-4): 14:57:13  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:57:13.658655 (Thread-4): 14:57:13  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:57:13.658744 (Thread-4): 14:57:13  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:57:13.674020 (Thread-4): 14:57:13  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:57:13.687273 (Thread-4): 14:57:13  finished collecting timing info
2022-03-02 14:57:13.687455 (Thread-4): 14:57:13  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:57:13.750732 (Thread-4): 14:57:13  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:57:13.752392 (Thread-5): 14:57:13  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca168ceb0>]}
2022-03-02 14:57:13.752742 (Thread-5): 14:57:13  14 of 19 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 2.58s]
2022-03-02 14:57:13.752862 (Thread-5): 14:57:13  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 14:57:13.752995 (Thread-5): 14:57:13  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:57:13.753167 (Thread-5): 14:57:13  17 of 19 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 14:57:13.753391 (Thread-5): 14:57:13  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:57:13.753477 (Thread-5): 14:57:13  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:57:13.753560 (Thread-5): 14:57:13  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:57:13.765829 (Thread-5): 14:57:13  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:57:13.771506 (Thread-4): 14:57:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 14:57:13.771651 (Thread-4): 14:57:13  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:13.771740 (Thread-4): 14:57:13  Opening a new connection, currently in state closed
2022-03-02 14:57:13.779351 (Thread-5): 14:57:13  finished collecting timing info
2022-03-02 14:57:13.779514 (Thread-5): 14:57:13  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:57:13.782421 (Thread-5): 14:57:13  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:57:13.798258 (Thread-5): 14:57:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 14:57:13.798383 (Thread-5): 14:57:13  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:13.798471 (Thread-5): 14:57:13  Opening a new connection, currently in state closed
2022-03-02 14:57:13.805791 (Thread-3): 14:57:13  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca16bf9d0>]}
2022-03-02 14:57:13.806139 (Thread-3): 14:57:13  13 of 19 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 2.65s]
2022-03-02 14:57:13.806259 (Thread-3): 14:57:13  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:57:13.806395 (Thread-3): 14:57:13  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:57:13.806570 (Thread-3): 14:57:13  18 of 19 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 14:57:13.806800 (Thread-3): 14:57:13  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:57:13.806885 (Thread-3): 14:57:13  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:57:13.806970 (Thread-3): 14:57:13  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:57:13.820821 (Thread-3): 14:57:13  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:57:13.835706 (Thread-3): 14:57:13  finished collecting timing info
2022-03-02 14:57:13.835930 (Thread-3): 14:57:13  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:57:13.841261 (Thread-3): 14:57:13  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:57:13.856080 (Thread-3): 14:57:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 14:57:13.856225 (Thread-3): 14:57:13  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:13.856315 (Thread-3): 14:57:13  Opening a new connection, currently in state closed
2022-03-02 14:57:14.417196 (Thread-6): 14:57:14  SQL status: SUCCESS 1 in 1.54 seconds
2022-03-02 14:57:14.418691 (Thread-6): 14:57:14  finished collecting timing info
2022-03-02 14:57:14.418851 (Thread-6): 14:57:14  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 14:57:14.616958 (Thread-6): 14:57:14  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca16ffa30>]}
2022-03-02 14:57:14.617369 (Thread-6): 14:57:14  15 of 19 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 1.80s]
2022-03-02 14:57:14.617499 (Thread-6): 14:57:14  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 14:57:14.617640 (Thread-6): 14:57:14  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:57:14.617817 (Thread-6): 14:57:14  19 of 19 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 14:57:14.618058 (Thread-6): 14:57:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:57:14.618144 (Thread-6): 14:57:14  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:57:14.618231 (Thread-6): 14:57:14  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:57:14.633709 (Thread-6): 14:57:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:57:14.647093 (Thread-6): 14:57:14  finished collecting timing info
2022-03-02 14:57:14.647241 (Thread-6): 14:57:14  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:57:14.650083 (Thread-6): 14:57:14  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:57:14.664156 (Thread-6): 14:57:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 14:57:14.664269 (Thread-6): 14:57:14  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:57:14.664354 (Thread-6): 14:57:14  Opening a new connection, currently in state closed
2022-03-02 14:57:15.582472 (Thread-4): 14:57:15  SQL status: SUCCESS 1 in 1.81 seconds
2022-03-02 14:57:15.584076 (Thread-4): 14:57:15  finished collecting timing info
2022-03-02 14:57:15.584242 (Thread-4): 14:57:15  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 14:57:15.794869 (Thread-4): 14:57:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc00f1a30>]}
2022-03-02 14:57:15.795239 (Thread-4): 14:57:15  16 of 19 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 2.14s]
2022-03-02 14:57:15.795365 (Thread-4): 14:57:15  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 14:57:15.832058 (Thread-5): 14:57:15  SQL status: SUCCESS 1 in 2.03 seconds
2022-03-02 14:57:15.833400 (Thread-5): 14:57:15  finished collecting timing info
2022-03-02 14:57:15.833538 (Thread-5): 14:57:15  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 14:57:15.983786 (Thread-3): 14:57:15  SQL status: SUCCESS 1 in 2.13 seconds
2022-03-02 14:57:15.985096 (Thread-3): 14:57:15  finished collecting timing info
2022-03-02 14:57:15.985236 (Thread-3): 14:57:15  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 14:57:16.050153 (Thread-5): 14:57:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc00ddaf0>]}
2022-03-02 14:57:16.050619 (Thread-5): 14:57:16  17 of 19 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.30s]
2022-03-02 14:57:16.050785 (Thread-5): 14:57:16  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 14:57:16.218011 (Thread-6): 14:57:16  SQL status: SUCCESS 1 in 1.55 seconds
2022-03-02 14:57:16.219536 (Thread-6): 14:57:16  finished collecting timing info
2022-03-02 14:57:16.219737 (Thread-6): 14:57:16  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 14:57:16.223473 (Thread-3): 14:57:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca2fc59d0>]}
2022-03-02 14:57:16.223875 (Thread-3): 14:57:16  18 of 19 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 2.42s]
2022-03-02 14:57:16.224000 (Thread-3): 14:57:16  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 14:57:16.415360 (Thread-6): 14:57:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6dea50a-df09-48cf-9c62-cfc87f5ec470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc003caf0>]}
2022-03-02 14:57:16.415805 (Thread-6): 14:57:16  19 of 19 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 1.80s]
2022-03-02 14:57:16.415940 (Thread-6): 14:57:16  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 14:57:16.417541 (MainThread): 14:57:16  Acquiring new snowflake connection "master"
2022-03-02 14:57:16.417927 (MainThread): 14:57:16  
2022-03-02 14:57:16.418030 (MainThread): 14:57:16  Finished running 2 table models, 17 incremental models in 25.49s.
2022-03-02 14:57:16.418115 (MainThread): 14:57:16  Connection 'master' was properly closed.
2022-03-02 14:57:16.418182 (MainThread): 14:57:16  Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
2022-03-02 14:57:16.418248 (MainThread): 14:57:16  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 14:57:16.418308 (MainThread): 14:57:16  Connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details' was properly closed.
2022-03-02 14:57:16.418367 (MainThread): 14:57:16  Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
2022-03-02 14:57:16.496290 (MainThread): 14:57:16  
2022-03-02 14:57:16.496509 (MainThread): 14:57:16  Completed successfully
2022-03-02 14:57:16.496630 (MainThread): 14:57:16  
2022-03-02 14:57:16.496722 (MainThread): 14:57:16  Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
2022-03-02 14:57:16.506223 (Thread-350): handling poll request
2022-03-02 14:57:16.506526 (Thread-350): 14:57:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5862c0d0>]}
2022-03-02 14:57:16.507992 (Thread-350): sending response (<Response 49058 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:18.571834 (Thread-351): handling poll request
2022-03-02 14:57:18.572225 (Thread-351): 14:57:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5862cac0>]}
2022-03-02 14:57:18.574473 (Thread-351): sending response (<Response 88661 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:20.483010 (Thread-352): handling status request
2022-03-02 14:57:20.483389 (Thread-352): 14:57:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58632700>]}
2022-03-02 14:57:20.483981 (Thread-352): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:20.492668 (Thread-353): handling status request
2022-03-02 14:57:20.492910 (Thread-353): 14:57:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585bcd30>]}
2022-03-02 14:57:20.493284 (Thread-353): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:50.161812 (Thread-354): handling status request
2022-03-02 14:57:50.162184 (Thread-354): 14:57:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585c35e0>]}
2022-03-02 14:57:50.162656 (Thread-354): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:57:50.189965 (Thread-355): handling list request
2022-03-02 14:57:50.190298 (Thread-355): 14:57:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585c3e80>]}
2022-03-02 14:57:50.224108 (Thread-355): 14:57:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585bc2b0>]}
2022-03-02 14:57:50.224495 (Thread-355): 14:57:50  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:57:50.229707 (Thread-355): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:17.366368 (Thread-356): handling status request
2022-03-02 14:58:17.366733 (Thread-356): 14:58:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585c3760>]}
2022-03-02 14:58:17.367214 (Thread-356): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:17.374469 (Thread-357): handling list request
2022-03-02 14:58:17.374787 (Thread-357): 14:58:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585bc670>]}
2022-03-02 14:58:17.408631 (Thread-357): 14:58:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5861d910>]}
2022-03-02 14:58:17.408974 (Thread-357): 14:58:17  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:17.414991 (Thread-357): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:17.993579 (Thread-358): 14:58:17  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:58:17.994111 (Thread-358): 14:58:17  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-02 14:58:18.000071 (Thread-358): 14:58:17  1603: static parser failed on stage/v_stg_orders.sql
2022-03-02 14:58:18.029704 (Thread-358): 14:58:18  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-02 14:58:18.095483 (Thread-358): 14:58:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58372fd0>]}
2022-03-02 14:58:18.946184 (Thread-359): handling status request
2022-03-02 14:58:18.946563 (Thread-359): 14:58:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585455e0>]}
2022-03-02 14:58:18.947085 (Thread-359): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:18.954553 (Thread-360): handling list request
2022-03-02 14:58:18.954816 (Thread-360): 14:58:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b587be520>]}
2022-03-02 14:58:18.989970 (Thread-360): 14:58:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b585451f0>]}
2022-03-02 14:58:18.990286 (Thread-360): 14:58:18  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:18.995195 (Thread-360): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:19.495180 (Thread-361): handling status request
2022-03-02 14:58:19.495575 (Thread-361): 14:58:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58727130>]}
2022-03-02 14:58:19.520547 (Thread-361): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:19.587326 (Thread-362): handling status request
2022-03-02 14:58:19.587688 (Thread-362): 14:58:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5850b070>]}
2022-03-02 14:58:19.588153 (Thread-362): sending response (<Response 1873 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:23.344555 (Thread-363): handling status request
2022-03-02 14:58:23.344928 (Thread-363): 14:58:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5854f310>]}
2022-03-02 14:58:23.345420 (Thread-363): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:23.352192 (Thread-364): handling list request
2022-03-02 14:58:23.352439 (Thread-364): 14:58:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5854f850>]}
2022-03-02 14:58:23.386211 (Thread-364): 14:58:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58590d90>]}
2022-03-02 14:58:23.386557 (Thread-364): 14:58:23  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:23.392278 (Thread-364): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:26.458489 (Thread-365): handling status request
2022-03-02 14:58:26.458855 (Thread-365): 14:58:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5836db50>]}
2022-03-02 14:58:26.459341 (Thread-365): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:26.467180 (Thread-366): handling list request
2022-03-02 14:58:26.467458 (Thread-366): 14:58:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5836deb0>]}
2022-03-02 14:58:26.503683 (Thread-366): 14:58:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5854fa90>]}
2022-03-02 14:58:26.504193 (Thread-366): 14:58:26  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:26.509456 (Thread-366): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:28.577215 (Thread-367): handling status request
2022-03-02 14:58:28.577597 (Thread-367): 14:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58378ee0>]}
2022-03-02 14:58:28.578099 (Thread-367): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:28.585672 (Thread-368): handling list request
2022-03-02 14:58:28.585933 (Thread-368): 14:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b583b77f0>]}
2022-03-02 14:58:28.623819 (Thread-368): 14:58:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5836da30>]}
2022-03-02 14:58:28.624131 (Thread-368): 14:58:28  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:28.627433 (Thread-368): sending response (<Response 5492 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:30.583504 (Thread-369): handling status request
2022-03-02 14:58:30.583894 (Thread-369): 14:58:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b582e4280>]}
2022-03-02 14:58:30.584370 (Thread-369): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:30.591768 (Thread-370): handling list request
2022-03-02 14:58:30.592032 (Thread-370): 14:58:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b582e4c10>]}
2022-03-02 14:58:30.631163 (Thread-370): 14:58:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5836d6a0>]}
2022-03-02 14:58:30.631539 (Thread-370): 14:58:30  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:30.637328 (Thread-370): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:34.782868 (Thread-371): handling status request
2022-03-02 14:58:34.783237 (Thread-371): 14:58:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58316070>]}
2022-03-02 14:58:34.783764 (Thread-371): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:34.791900 (Thread-372): handling list request
2022-03-02 14:58:34.792166 (Thread-372): 14:58:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58316d60>]}
2022-03-02 14:58:34.831851 (Thread-372): 14:58:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b582e48e0>]}
2022-03-02 14:58:34.832144 (Thread-372): 14:58:34  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:34.837313 (Thread-372): sending response (<Response 16897 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:37.514493 (Thread-373): handling status request
2022-03-02 14:58:37.514877 (Thread-373): 14:58:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5828a8b0>]}
2022-03-02 14:58:37.515420 (Thread-373): sending response (<Response 1851 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:37.521776 (Thread-374): handling list request
2022-03-02 14:58:37.522207 (Thread-374): 14:58:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b583b7610>]}
2022-03-02 14:58:37.561178 (Thread-374): 14:58:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5823a250>]}
2022-03-02 14:58:37.561468 (Thread-374): 14:58:37  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:37.566903 (Thread-374): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:49.141160 (Thread-375): 14:58:49  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:58:49.141661 (Thread-375): 14:58:49  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:58:49.148295 (Thread-375): 14:58:49  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:58:49.154698 (Thread-375): 14:58:49  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:58:49.206719 (Thread-375): 14:58:49  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38796e80>]}
2022-03-02 14:58:49.726287 (Thread-376): handling status request
2022-03-02 14:58:49.726722 (Thread-376): 14:58:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5828af40>]}
2022-03-02 14:58:49.727248 (Thread-376): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:49.734023 (Thread-377): handling list request
2022-03-02 14:58:49.734309 (Thread-377): 14:58:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58203310>]}
2022-03-02 14:58:49.768547 (Thread-377): 14:58:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5820a850>]}
2022-03-02 14:58:49.768886 (Thread-377): 14:58:49  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:58:49.774606 (Thread-377): sending response (<Response 23507 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:50.037656 (Thread-378): handling status request
2022-03-02 14:58:50.038022 (Thread-378): 14:58:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5803a250>]}
2022-03-02 14:58:50.038511 (Thread-378): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:58:50.384560 (Thread-379): handling status request
2022-03-02 14:58:50.384912 (Thread-379): 14:58:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b581544c0>]}
2022-03-02 14:58:50.385386 (Thread-379): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:09.476626 (Thread-380): 14:59:09  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 14:59:09.477440 (Thread-380): 14:59:09  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-02 14:59:09.486992 (Thread-380): 14:59:09  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-02 14:59:09.493553 (Thread-380): 14:59:09  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-02 14:59:09.548246 (Thread-380): 14:59:09  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38602f40>]}
2022-03-02 14:59:10.043710 (Thread-381): handling status request
2022-03-02 14:59:10.044079 (Thread-381): 14:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38723490>]}
2022-03-02 14:59:10.044648 (Thread-381): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:10.071315 (Thread-382): handling list request
2022-03-02 14:59:10.071733 (Thread-382): 14:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38723220>]}
2022-03-02 14:59:10.107688 (Thread-382): 14:59:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b581c7340>]}
2022-03-02 14:59:10.108064 (Thread-382): 14:59:10  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:10.113925 (Thread-382): sending response (<Response 23527 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:10.977409 (Thread-383): handling status request
2022-03-02 14:59:10.977781 (Thread-383): 14:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b386be910>]}
2022-03-02 14:59:10.993172 (Thread-384): handling status request
2022-03-02 14:59:10.993531 (Thread-384): 14:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b581b9a60>]}
2022-03-02 14:59:11.003261 (Thread-383): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:11.003664 (Thread-384): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:23.377836 (Thread-385): handling status request
2022-03-02 14:59:23.378238 (Thread-385): 14:59:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b386be040>]}
2022-03-02 14:59:23.378747 (Thread-385): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:23.385969 (Thread-386): handling list request
2022-03-02 14:59:23.386268 (Thread-386): 14:59:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b386be070>]}
2022-03-02 14:59:23.424700 (Thread-386): 14:59:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58369c40>]}
2022-03-02 14:59:23.425022 (Thread-386): 14:59:23  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:23.430919 (Thread-386): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:25.347557 (Thread-387): handling status request
2022-03-02 14:59:25.347999 (Thread-387): 14:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5821e160>]}
2022-03-02 14:59:25.348530 (Thread-387): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:25.355865 (Thread-388): handling list request
2022-03-02 14:59:25.356179 (Thread-388): 14:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58205ca0>]}
2022-03-02 14:59:25.391533 (Thread-388): 14:59:25  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b385fafd0>]}
2022-03-02 14:59:25.391962 (Thread-388): 14:59:25  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:25.399015 (Thread-388): sending response (<Response 23527 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:27.238103 (Thread-389): handling status request
2022-03-02 14:59:27.238448 (Thread-389): 14:59:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38616bb0>]}
2022-03-02 14:59:27.238930 (Thread-389): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:27.245272 (Thread-390): handling list request
2022-03-02 14:59:27.245521 (Thread-390): 14:59:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3860ad30>]}
2022-03-02 14:59:27.279996 (Thread-390): 14:59:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3860a2e0>]}
2022-03-02 14:59:27.280267 (Thread-390): 14:59:27  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:27.285735 (Thread-390): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:30.812807 (Thread-391): handling status request
2022-03-02 14:59:30.813174 (Thread-391): 14:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3861ba90>]}
2022-03-02 14:59:30.813737 (Thread-391): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:30.820869 (Thread-392): handling list request
2022-03-02 14:59:30.821121 (Thread-392): 14:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5821e940>]}
2022-03-02 14:59:30.857918 (Thread-392): 14:59:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3860a730>]}
2022-03-02 14:59:30.858251 (Thread-392): 14:59:30  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:30.863843 (Thread-392): sending response (<Response 23527 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:32.878913 (Thread-393): handling status request
2022-03-02 14:59:32.879288 (Thread-393): 14:59:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b385e1910>]}
2022-03-02 14:59:32.879817 (Thread-393): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:32.886397 (Thread-394): handling list request
2022-03-02 14:59:32.886656 (Thread-394): 14:59:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b385c9ca0>]}
2022-03-02 14:59:32.921141 (Thread-394): 14:59:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3861b8b0>]}
2022-03-02 14:59:32.921455 (Thread-394): 14:59:32  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:32.926365 (Thread-394): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:36.947976 (Thread-395): handling status request
2022-03-02 14:59:36.948363 (Thread-395): 14:59:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b385eeb50>]}
2022-03-02 14:59:36.948874 (Thread-395): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:37.266839 (Thread-396): handling status request
2022-03-02 14:59:37.267201 (Thread-396): 14:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3860ab20>]}
2022-03-02 14:59:37.267719 (Thread-396): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:37.567730 (Thread-397): handling cli_args request
2022-03-02 14:59:37.568082 (Thread-397): 14:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3858f730>]}
2022-03-02 14:59:39.734112 (Thread-397): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:40.121075 (MainThread): 14:59:40  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 14:59:40.121505 (MainThread): 14:59:40  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 14:59:40.128981 (MainThread): 14:59:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46052a8fa0>]}
2022-03-02 14:59:40.161727 (MainThread): 14:59:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4605392b50>]}
2022-03-02 14:59:40.162007 (MainThread): 14:59:40  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 14:59:40.164242 (MainThread): 14:59:40  
2022-03-02 14:59:40.164559 (MainThread): 14:59:40  Acquiring new snowflake connection "master"
2022-03-02 14:59:40.166087 (ThreadPoolExecutor-0_0): 14:59:40  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 14:59:40.178929 (ThreadPoolExecutor-0_0): 14:59:40  Using snowflake connection "list_DBT_RAW"
2022-03-02 14:59:40.179040 (ThreadPoolExecutor-0_0): 14:59:40  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 14:59:40.179123 (ThreadPoolExecutor-0_0): 14:59:40  Opening a new connection, currently in state init
2022-03-02 14:59:40.494979 (Thread-398): handling poll request
2022-03-02 14:59:40.495445 (Thread-398): 14:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3858f760>]}
2022-03-02 14:59:40.496354 (Thread-398): sending response (<Response 4169 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:41.228382 (ThreadPoolExecutor-0_0): 14:59:41  SQL status: SUCCESS 7 in 1.05 seconds
2022-03-02 14:59:41.230372 (ThreadPoolExecutor-0_0): 14:59:41  On list_DBT_RAW: Close
2022-03-02 14:59:41.464920 (ThreadPoolExecutor-2_0): 14:59:41  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:59:41.472891 (ThreadPoolExecutor-2_0): 14:59:41  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 14:59:41.473041 (ThreadPoolExecutor-2_0): 14:59:41  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 14:59:41.473141 (ThreadPoolExecutor-2_0): 14:59:41  Opening a new connection, currently in state closed
2022-03-02 14:59:42.227403 (ThreadPoolExecutor-2_0): 14:59:42  SQL status: SUCCESS 31 in 0.75 seconds
2022-03-02 14:59:42.229548 (ThreadPoolExecutor-2_0): 14:59:42  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 14:59:42.312366 (Thread-399): handling poll request
2022-03-02 14:59:42.312709 (Thread-399): 14:59:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38593790>]}
2022-03-02 14:59:42.313252 (Thread-399): sending response (<Response 2905 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:42.458649 (MainThread): 14:59:42  Concurrency: 4 threads (target='default')
2022-03-02 14:59:42.458826 (MainThread): 14:59:42  
2022-03-02 14:59:42.461611 (Thread-3): 14:59:42  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:59:42.461933 (Thread-3): 14:59:42  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 14:59:42.462215 (Thread-3): 14:59:42  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:59:42.462329 (Thread-3): 14:59:42  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:59:42.462436 (Thread-3): 14:59:42  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:59:42.468680 (Thread-3): 14:59:42  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:59:42.482516 (Thread-3): 14:59:42  finished collecting timing info
2022-03-02 14:59:42.482849 (Thread-3): 14:59:42  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:59:42.506794 (Thread-3): 14:59:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:59:42.521387 (Thread-3): 14:59:42  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 14:59:42.521502 (Thread-3): 14:59:42  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 14:59:42.521588 (Thread-3): 14:59:42  Opening a new connection, currently in state closed
2022-03-02 14:59:44.106133 (Thread-400): handling poll request
2022-03-02 14:59:44.106512 (Thread-400): 14:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38596f70>]}
2022-03-02 14:59:44.107169 (Thread-400): sending response (<Response 8656 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:45.868649 (Thread-401): handling poll request
2022-03-02 14:59:45.869016 (Thread-401): 14:59:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3858a820>]}
2022-03-02 14:59:45.869501 (Thread-401): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:47.636006 (Thread-402): handling poll request
2022-03-02 14:59:47.636377 (Thread-402): 14:59:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3858a340>]}
2022-03-02 14:59:47.636859 (Thread-402): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:49.404857 (Thread-403): handling poll request
2022-03-02 14:59:49.405225 (Thread-403): 14:59:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3858aa90>]}
2022-03-02 14:59:49.405707 (Thread-403): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:50.946649 (Thread-404): handling poll request
2022-03-02 14:59:50.947043 (Thread-404): 14:59:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3858ad00>]}
2022-03-02 14:59:50.947550 (Thread-404): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:50.980692 (Thread-3): 14:59:50  SQL status: SUCCESS 1 in 8.46 seconds
2022-03-02 14:59:50.989925 (Thread-3): 14:59:50  finished collecting timing info
2022-03-02 14:59:50.990088 (Thread-3): 14:59:50  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 14:59:51.203211 (Thread-3): 14:59:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4604047100>]}
2022-03-02 14:59:51.203695 (Thread-3): 14:59:51  1 of 19 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 8.74s]
2022-03-02 14:59:51.203840 (Thread-3): 14:59:51  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 14:59:51.204886 (Thread-5): 14:59:51  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:59:51.205163 (Thread-5): 14:59:51  2 of 19 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 14:59:51.205465 (Thread-5): 14:59:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:59:51.205568 (Thread-5): 14:59:51  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:59:51.205658 (Thread-5): 14:59:51  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:59:51.246088 (Thread-5): 14:59:51  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:59:51.246250 (Thread-5): 14:59:51  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:59:51.246340 (Thread-5): 14:59:51  Opening a new connection, currently in state init
2022-03-02 14:59:52.127206 (Thread-5): 14:59:52  SQL status: SUCCESS 37 in 0.88 seconds
2022-03-02 14:59:52.157387 (Thread-5): 14:59:52  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:59:52.157523 (Thread-5): 14:59:52  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 14:59:52.297816 (Thread-5): 14:59:52  SQL status: SUCCESS 37 in 0.14 seconds
2022-03-02 14:59:52.346058 (Thread-5): 14:59:52  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:59:52.370260 (Thread-5): 14:59:52  finished collecting timing info
2022-03-02 14:59:52.370512 (Thread-5): 14:59:52  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:59:52.373040 (Thread-5): 14:59:52  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:59:52.407489 (Thread-5): 14:59:52  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 14:59:52.407670 (Thread-5): 14:59:52  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 14:59:52.709484 (Thread-405): handling poll request
2022-03-02 14:59:52.709887 (Thread-405): 14:59:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3854c970>]}
2022-03-02 14:59:52.710895 (Thread-405): sending response (<Response 20708 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:54.287939 (Thread-5): 14:59:54  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-02 14:59:54.289362 (Thread-5): 14:59:54  finished collecting timing info
2022-03-02 14:59:54.289520 (Thread-5): 14:59:54  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 14:59:54.480732 (Thread-406): handling poll request
2022-03-02 14:59:54.481098 (Thread-406): 14:59:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38596250>]}
2022-03-02 14:59:54.481611 (Thread-406): sending response (<Response 1493 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:54.543396 (Thread-5): 14:59:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f46fdf10>]}
2022-03-02 14:59:54.543866 (Thread-5): 14:59:54  2 of 19 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.34s]
2022-03-02 14:59:54.543998 (Thread-5): 14:59:54  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 14:59:54.545291 (Thread-4): 14:59:54  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:59:54.545564 (Thread-4): 14:59:54  3 of 19 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 14:59:54.545857 (Thread-4): 14:59:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:59:54.545953 (Thread-4): 14:59:54  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:59:54.546045 (Thread-4): 14:59:54  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:59:54.550361 (Thread-3): 14:59:54  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:59:54.550585 (Thread-3): 14:59:54  4 of 19 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 14:59:54.550827 (Thread-3): 14:59:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:59:54.550937 (Thread-3): 14:59:54  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:59:54.551023 (Thread-3): 14:59:54  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:59:54.555442 (Thread-6): 14:59:54  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:59:54.555694 (Thread-6): 14:59:54  5 of 19 START incremental model DBT_VAULT.hub_nation............................ [RUN]
2022-03-02 14:59:54.555953 (Thread-6): 14:59:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:59:54.556042 (Thread-6): 14:59:54  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:59:54.556125 (Thread-6): 14:59:54  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:59:54.560469 (Thread-5): 14:59:54  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:59:54.560677 (Thread-5): 14:59:54  6 of 19 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 14:59:54.560906 (Thread-5): 14:59:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:59:54.560993 (Thread-5): 14:59:54  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:59:54.561073 (Thread-5): 14:59:54  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:59:54.728339 (Thread-4): 14:59:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:59:54.731979 (Thread-5): 14:59:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:59:54.734491 (Thread-3): 14:59:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:59:54.736938 (Thread-6): 14:59:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:59:54.746075 (Thread-4): 14:59:54  finished collecting timing info
2022-03-02 14:59:54.746229 (Thread-4): 14:59:54  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:59:54.751428 (Thread-5): 14:59:54  finished collecting timing info
2022-03-02 14:59:54.751558 (Thread-5): 14:59:54  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:59:54.786168 (Thread-5): 14:59:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:59:54.789153 (Thread-4): 14:59:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:59:54.789444 (Thread-3): 14:59:54  finished collecting timing info
2022-03-02 14:59:54.789586 (Thread-3): 14:59:54  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:59:54.792579 (Thread-3): 14:59:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:59:54.792942 (Thread-6): 14:59:54  finished collecting timing info
2022-03-02 14:59:54.793139 (Thread-6): 14:59:54  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:59:54.796157 (Thread-6): 14:59:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:59:54.803778 (Thread-5): 14:59:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 14:59:54.803896 (Thread-5): 14:59:54  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:54.803987 (Thread-5): 14:59:54  Opening a new connection, currently in state closed
2022-03-02 14:59:54.808219 (Thread-4): 14:59:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 14:59:54.808333 (Thread-4): 14:59:54  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:54.808416 (Thread-4): 14:59:54  Opening a new connection, currently in state init
2022-03-02 14:59:54.811420 (Thread-6): 14:59:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 14:59:54.811537 (Thread-6): 14:59:54  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:54.811663 (Thread-6): 14:59:54  Opening a new connection, currently in state init
2022-03-02 14:59:54.813069 (Thread-3): 14:59:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 14:59:54.813171 (Thread-3): 14:59:54  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:54.813250 (Thread-3): 14:59:54  Opening a new connection, currently in state closed
2022-03-02 14:59:56.237908 (Thread-407): handling poll request
2022-03-02 14:59:56.238284 (Thread-407): 14:59:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3854ce50>]}
2022-03-02 14:59:56.239267 (Thread-407): sending response (<Response 25117 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:57.196240 (Thread-3): 14:59:57  SQL status: SUCCESS 1 in 2.38 seconds
2022-03-02 14:59:57.197791 (Thread-3): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.197961 (Thread-3): 14:59:57  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 14:59:57.294652 (Thread-5): 14:59:57  SQL status: SUCCESS 1 in 2.49 seconds
2022-03-02 14:59:57.296162 (Thread-5): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.296323 (Thread-5): 14:59:57  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 14:59:57.423246 (Thread-6): 14:59:57  SQL status: SUCCESS 1 in 2.61 seconds
2022-03-02 14:59:57.424790 (Thread-6): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.424952 (Thread-6): 14:59:57  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 14:59:57.434778 (Thread-3): 14:59:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f4588f70>]}
2022-03-02 14:59:57.435138 (Thread-3): 14:59:57  4 of 19 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 2.88s]
2022-03-02 14:59:57.435258 (Thread-3): 14:59:57  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 14:59:57.435398 (Thread-3): 14:59:57  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:59:57.435583 (Thread-3): 14:59:57  7 of 19 START incremental model DBT_VAULT.hub_part.............................. [RUN]
2022-03-02 14:59:57.435856 (Thread-3): 14:59:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:59:57.435950 (Thread-3): 14:59:57  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:59:57.436039 (Thread-3): 14:59:57  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:59:57.445882 (Thread-3): 14:59:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:59:57.459157 (Thread-3): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.459327 (Thread-3): 14:59:57  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:59:57.462347 (Thread-3): 14:59:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:59:57.476380 (Thread-3): 14:59:57  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 14:59:57.476511 (Thread-3): 14:59:57  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:57.476603 (Thread-3): 14:59:57  Opening a new connection, currently in state closed
2022-03-02 14:59:57.489012 (Thread-4): 14:59:57  SQL status: SUCCESS 1 in 2.68 seconds
2022-03-02 14:59:57.490362 (Thread-4): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.490508 (Thread-4): 14:59:57  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 14:59:57.503721 (Thread-5): 14:59:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f45680a0>]}
2022-03-02 14:59:57.504058 (Thread-5): 14:59:57  6 of 19 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 2.94s]
2022-03-02 14:59:57.504175 (Thread-5): 14:59:57  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 14:59:57.504311 (Thread-5): 14:59:57  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:59:57.504488 (Thread-5): 14:59:57  8 of 19 START incremental model DBT_VAULT.hub_region............................ [RUN]
2022-03-02 14:59:57.504717 (Thread-5): 14:59:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:59:57.504807 (Thread-5): 14:59:57  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:59:57.504895 (Thread-5): 14:59:57  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:59:57.514222 (Thread-5): 14:59:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:59:57.527513 (Thread-5): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.527682 (Thread-5): 14:59:57  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:59:57.530606 (Thread-5): 14:59:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:59:57.544961 (Thread-5): 14:59:57  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 14:59:57.545076 (Thread-5): 14:59:57  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:57.545160 (Thread-5): 14:59:57  Opening a new connection, currently in state closed
2022-03-02 14:59:57.658974 (Thread-6): 14:59:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f462a730>]}
2022-03-02 14:59:57.659325 (Thread-6): 14:59:57  5 of 19 OK created incremental model DBT_VAULT.hub_nation....................... [SUCCESS 1 in 3.10s]
2022-03-02 14:59:57.659445 (Thread-6): 14:59:57  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 14:59:57.659588 (Thread-6): 14:59:57  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:59:57.659831 (Thread-6): 14:59:57  9 of 19 START incremental model DBT_VAULT.hub_supplier.......................... [RUN]
2022-03-02 14:59:57.660066 (Thread-6): 14:59:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:59:57.660157 (Thread-6): 14:59:57  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:59:57.660243 (Thread-6): 14:59:57  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:59:57.669078 (Thread-6): 14:59:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:59:57.687594 (Thread-6): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.687759 (Thread-6): 14:59:57  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 14:59:57.690520 (Thread-6): 14:59:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:59:57.720892 (Thread-4): 14:59:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f45ce310>]}
2022-03-02 14:59:57.721205 (Thread-4): 14:59:57  3 of 19 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 3.18s]
2022-03-02 14:59:57.721321 (Thread-4): 14:59:57  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 14:59:57.721457 (Thread-4): 14:59:57  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:59:57.721627 (Thread-4): 14:59:57  10 of 19 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 14:59:57.721844 (Thread-4): 14:59:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:59:57.721932 (Thread-4): 14:59:57  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:59:57.722013 (Thread-4): 14:59:57  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:59:57.737234 (Thread-6): 14:59:57  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 14:59:57.737344 (Thread-6): 14:59:57  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:57.737429 (Thread-6): 14:59:57  Opening a new connection, currently in state closed
2022-03-02 14:59:57.781039 (Thread-4): 14:59:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:59:57.818797 (Thread-4): 14:59:57  finished collecting timing info
2022-03-02 14:59:57.818941 (Thread-4): 14:59:57  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:59:57.821604 (Thread-4): 14:59:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:59:57.845160 (Thread-4): 14:59:57  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 14:59:57.845280 (Thread-4): 14:59:57  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:57.845366 (Thread-4): 14:59:57  Opening a new connection, currently in state closed
2022-03-02 14:59:58.003449 (Thread-408): handling poll request
2022-03-02 14:59:58.003856 (Thread-408): 14:59:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3856ccd0>]}
2022-03-02 14:59:58.029603 (Thread-408): sending response (<Response 35757 bytes [200 OK]>) to 10.0.41.177
2022-03-02 14:59:59.288661 (Thread-5): 14:59:59  SQL status: SUCCESS 1 in 1.74 seconds
2022-03-02 14:59:59.290267 (Thread-5): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.290439 (Thread-5): 14:59:59  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 14:59:59.377576 (Thread-3): 14:59:59  SQL status: SUCCESS 1 in 1.9 seconds
2022-03-02 14:59:59.379646 (Thread-3): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.379875 (Thread-3): 14:59:59  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 14:59:59.496665 (Thread-5): 14:59:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f459b460>]}
2022-03-02 14:59:59.497251 (Thread-5): 14:59:59  8 of 19 OK created incremental model DBT_VAULT.hub_region....................... [SUCCESS 1 in 1.99s]
2022-03-02 14:59:59.497444 (Thread-5): 14:59:59  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 14:59:59.497662 (Thread-5): 14:59:59  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:59:59.497946 (Thread-5): 14:59:59  11 of 19 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 14:59:59.498298 (Thread-5): 14:59:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:59:59.498441 (Thread-5): 14:59:59  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:59:59.498574 (Thread-5): 14:59:59  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:59:59.511332 (Thread-5): 14:59:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:59:59.523653 (Thread-5): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.523856 (Thread-5): 14:59:59  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 14:59:59.529415 (Thread-5): 14:59:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:59:59.543137 (Thread-5): 14:59:59  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 14:59:59.543299 (Thread-5): 14:59:59  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:59.543425 (Thread-5): 14:59:59  Opening a new connection, currently in state closed
2022-03-02 14:59:59.570971 (Thread-3): 14:59:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f4559910>]}
2022-03-02 14:59:59.571363 (Thread-3): 14:59:59  7 of 19 OK created incremental model DBT_VAULT.hub_part......................... [SUCCESS 1 in 2.14s]
2022-03-02 14:59:59.571488 (Thread-3): 14:59:59  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 14:59:59.571656 (Thread-3): 14:59:59  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:59:59.571842 (Thread-3): 14:59:59  12 of 19 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 14:59:59.572079 (Thread-3): 14:59:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:59:59.572168 (Thread-3): 14:59:59  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:59:59.572257 (Thread-3): 14:59:59  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:59:59.580032 (Thread-3): 14:59:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:59:59.592711 (Thread-3): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.592858 (Thread-3): 14:59:59  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 14:59:59.595837 (Thread-3): 14:59:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:59:59.604139 (Thread-4): 14:59:59  SQL status: SUCCESS 1 in 1.76 seconds
2022-03-02 14:59:59.605415 (Thread-4): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.605555 (Thread-4): 14:59:59  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 14:59:59.614328 (Thread-3): 14:59:59  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 14:59:59.614449 (Thread-3): 14:59:59  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:59.614535 (Thread-3): 14:59:59  Opening a new connection, currently in state closed
2022-03-02 14:59:59.682914 (Thread-6): 14:59:59  SQL status: SUCCESS 1 in 1.95 seconds
2022-03-02 14:59:59.684382 (Thread-6): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.684540 (Thread-6): 14:59:59  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 14:59:59.876950 (Thread-4): 14:59:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f44e60a0>]}
2022-03-02 14:59:59.877377 (Thread-4): 14:59:59  10 of 19 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 2.16s]
2022-03-02 14:59:59.877503 (Thread-4): 14:59:59  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 14:59:59.877646 (Thread-4): 14:59:59  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:59:59.877832 (Thread-4): 14:59:59  13 of 19 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 14:59:59.878083 (Thread-4): 14:59:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:59:59.878176 (Thread-4): 14:59:59  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:59:59.878264 (Thread-4): 14:59:59  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:59:59.901270 (Thread-4): 14:59:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:59:59.927723 (Thread-4): 14:59:59  finished collecting timing info
2022-03-02 14:59:59.927900 (Thread-4): 14:59:59  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 14:59:59.931073 (Thread-4): 14:59:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:59:59.974397 (Thread-4): 14:59:59  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 14:59:59.974550 (Thread-4): 14:59:59  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 14:59:59.974641 (Thread-4): 14:59:59  Opening a new connection, currently in state closed
2022-03-02 15:00:00.000878 (Thread-6): 15:00:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f44d9f40>]}
2022-03-02 15:00:00.001275 (Thread-6): 15:00:00  9 of 19 OK created incremental model DBT_VAULT.hub_supplier..................... [SUCCESS 1 in 2.34s]
2022-03-02 15:00:00.001402 (Thread-6): 15:00:00  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 15:00:00.001543 (Thread-6): 15:00:00  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:00:00.001728 (Thread-6): 15:00:00  14 of 19 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 15:00:00.001973 (Thread-6): 15:00:00  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:00:00.002065 (Thread-6): 15:00:00  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:00:00.002152 (Thread-6): 15:00:00  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:00:00.011576 (Thread-6): 15:00:00  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:00:00.034899 (Thread-6): 15:00:00  finished collecting timing info
2022-03-02 15:00:00.035070 (Thread-6): 15:00:00  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:00:00.037994 (Thread-6): 15:00:00  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:00:00.056003 (Thread-6): 15:00:00  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:00:00.056126 (Thread-6): 15:00:00  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:00:00.056215 (Thread-6): 15:00:00  Opening a new connection, currently in state closed
2022-03-02 15:00:00.858078 (Thread-409): handling poll request
2022-03-02 15:00:00.858445 (Thread-409): 15:00:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b384ffa00>]}
2022-03-02 15:00:00.859651 (Thread-409): sending response (<Response 35432 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:01.831338 (Thread-3): 15:00:01  SQL status: SUCCESS 1 in 2.22 seconds
2022-03-02 15:00:01.832980 (Thread-3): 15:00:01  finished collecting timing info
2022-03-02 15:00:01.833159 (Thread-3): 15:00:01  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 15:00:01.953811 (Thread-5): 15:00:01  SQL status: SUCCESS 1 in 2.41 seconds
2022-03-02 15:00:01.956640 (Thread-5): 15:00:01  finished collecting timing info
2022-03-02 15:00:01.956937 (Thread-5): 15:00:01  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 15:00:02.051972 (Thread-3): 15:00:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f44e0a90>]}
2022-03-02 15:00:02.052441 (Thread-3): 15:00:02  12 of 19 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.48s]
2022-03-02 15:00:02.052577 (Thread-3): 15:00:02  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 15:00:02.052735 (Thread-3): 15:00:02  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:00:02.052939 (Thread-3): 15:00:02  15 of 19 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 15:00:02.053230 (Thread-3): 15:00:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:00:02.053332 (Thread-3): 15:00:02  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:00:02.053429 (Thread-3): 15:00:02  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:00:02.090478 (Thread-3): 15:00:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:00:02.103899 (Thread-3): 15:00:02  finished collecting timing info
2022-03-02 15:00:02.104109 (Thread-3): 15:00:02  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:00:02.107346 (Thread-3): 15:00:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:00:02.123137 (Thread-3): 15:00:02  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:00:02.123291 (Thread-3): 15:00:02  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:00:02.123381 (Thread-3): 15:00:02  Opening a new connection, currently in state closed
2022-03-02 15:00:02.177872 (Thread-5): 15:00:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f44282e0>]}
2022-03-02 15:00:02.178305 (Thread-5): 15:00:02  11 of 19 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 2.68s]
2022-03-02 15:00:02.178460 (Thread-5): 15:00:02  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 15:00:02.178621 (Thread-5): 15:00:02  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:00:02.178817 (Thread-5): 15:00:02  16 of 19 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 15:00:02.179181 (Thread-5): 15:00:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:00:02.179350 (Thread-5): 15:00:02  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:00:02.179502 (Thread-5): 15:00:02  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:00:02.194365 (Thread-5): 15:00:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:00:02.210614 (Thread-5): 15:00:02  finished collecting timing info
2022-03-02 15:00:02.210792 (Thread-5): 15:00:02  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:00:02.214027 (Thread-5): 15:00:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:00:02.228115 (Thread-5): 15:00:02  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:00:02.228319 (Thread-5): 15:00:02  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:00:02.228459 (Thread-5): 15:00:02  Opening a new connection, currently in state closed
2022-03-02 15:00:02.442121 (Thread-6): 15:00:02  SQL status: SUCCESS 1 in 2.39 seconds
2022-03-02 15:00:02.443693 (Thread-6): 15:00:02  finished collecting timing info
2022-03-02 15:00:02.443867 (Thread-6): 15:00:02  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 15:00:02.639115 (Thread-410): handling poll request
2022-03-02 15:00:02.639502 (Thread-410): 15:00:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3850eb50>]}
2022-03-02 15:00:02.640393 (Thread-410): sending response (<Response 19071 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:02.722451 (Thread-6): 15:00:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f43ba6d0>]}
2022-03-02 15:00:02.722872 (Thread-6): 15:00:02  14 of 19 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 2.72s]
2022-03-02 15:00:02.723000 (Thread-6): 15:00:02  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:00:02.723145 (Thread-6): 15:00:02  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:00:02.723330 (Thread-6): 15:00:02  17 of 19 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 15:00:02.723578 (Thread-6): 15:00:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:00:02.723724 (Thread-6): 15:00:02  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:00:02.723822 (Thread-6): 15:00:02  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:00:02.737561 (Thread-6): 15:00:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:00:02.751109 (Thread-6): 15:00:02  finished collecting timing info
2022-03-02 15:00:02.751258 (Thread-6): 15:00:02  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:00:02.754263 (Thread-6): 15:00:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:00:02.767057 (Thread-6): 15:00:02  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:00:02.767175 (Thread-6): 15:00:02  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:00:02.767262 (Thread-6): 15:00:02  Opening a new connection, currently in state closed
2022-03-02 15:00:03.027143 (Thread-4): 15:00:03  SQL status: SUCCESS 1 in 3.05 seconds
2022-03-02 15:00:03.028723 (Thread-4): 15:00:03  finished collecting timing info
2022-03-02 15:00:03.028892 (Thread-4): 15:00:03  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 15:00:03.683929 (Thread-4): 15:00:03  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f43f7f70>]}
2022-03-02 15:00:03.684360 (Thread-4): 15:00:03  13 of 19 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 3.81s]
2022-03-02 15:00:03.684488 (Thread-4): 15:00:03  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 15:00:03.684630 (Thread-4): 15:00:03  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:00:03.684810 (Thread-4): 15:00:03  18 of 19 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 15:00:03.685051 (Thread-4): 15:00:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:00:03.685143 (Thread-4): 15:00:03  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:00:03.685231 (Thread-4): 15:00:03  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:00:03.700851 (Thread-4): 15:00:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:00:03.713961 (Thread-4): 15:00:03  finished collecting timing info
2022-03-02 15:00:03.714099 (Thread-4): 15:00:03  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:00:03.716716 (Thread-4): 15:00:03  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:00:03.729244 (Thread-4): 15:00:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:00:03.729357 (Thread-4): 15:00:03  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:00:03.729441 (Thread-4): 15:00:03  Opening a new connection, currently in state closed
2022-03-02 15:00:04.495633 (Thread-411): handling poll request
2022-03-02 15:00:04.496003 (Thread-411): 15:00:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3851ba60>]}
2022-03-02 15:00:04.496800 (Thread-411): sending response (<Response 16811 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:04.547495 (Thread-3): 15:00:04  SQL status: SUCCESS 1 in 2.42 seconds
2022-03-02 15:00:04.549162 (Thread-3): 15:00:04  finished collecting timing info
2022-03-02 15:00:04.549345 (Thread-3): 15:00:04  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 15:00:04.766630 (Thread-6): 15:00:04  SQL status: SUCCESS 1 in 2.0 seconds
2022-03-02 15:00:04.768721 (Thread-6): 15:00:04  finished collecting timing info
2022-03-02 15:00:04.768942 (Thread-6): 15:00:04  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 15:00:05.105215 (Thread-6): 15:00:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f442a1c0>]}
2022-03-02 15:00:05.105781 (Thread-6): 15:00:05  17 of 19 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.38s]
2022-03-02 15:00:05.105964 (Thread-6): 15:00:05  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:00:05.106169 (Thread-6): 15:00:05  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:00:05.106433 (Thread-6): 15:00:05  19 of 19 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 15:00:05.106774 (Thread-6): 15:00:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:00:05.106911 (Thread-6): 15:00:05  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:00:05.107042 (Thread-6): 15:00:05  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:00:05.126810 (Thread-6): 15:00:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:00:05.139827 (Thread-6): 15:00:05  finished collecting timing info
2022-03-02 15:00:05.140063 (Thread-6): 15:00:05  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:00:05.144896 (Thread-6): 15:00:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:00:05.160357 (Thread-6): 15:00:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:00:05.160571 (Thread-6): 15:00:05  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:00:05.160699 (Thread-6): 15:00:05  Opening a new connection, currently in state closed
2022-03-02 15:00:05.389574 (Thread-3): 15:00:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f43c6c10>]}
2022-03-02 15:00:05.390013 (Thread-3): 15:00:05  15 of 19 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 3.34s]
2022-03-02 15:00:05.390143 (Thread-3): 15:00:05  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:00:05.428638 (Thread-5): 15:00:05  SQL status: SUCCESS 1 in 3.2 seconds
2022-03-02 15:00:05.430120 (Thread-5): 15:00:05  finished collecting timing info
2022-03-02 15:00:05.430280 (Thread-5): 15:00:05  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 15:00:05.657478 (Thread-4): 15:00:05  SQL status: SUCCESS 1 in 1.93 seconds
2022-03-02 15:00:05.658997 (Thread-4): 15:00:05  finished collecting timing info
2022-03-02 15:00:05.659161 (Thread-4): 15:00:05  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 15:00:05.723547 (Thread-5): 15:00:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f4561970>]}
2022-03-02 15:00:05.723998 (Thread-5): 15:00:05  16 of 19 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 3.54s]
2022-03-02 15:00:05.724126 (Thread-5): 15:00:05  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:00:05.915259 (Thread-4): 15:00:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f43ba550>]}
2022-03-02 15:00:05.915721 (Thread-4): 15:00:05  18 of 19 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 2.23s]
2022-03-02 15:00:05.915877 (Thread-4): 15:00:05  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:00:06.481357 (Thread-412): handling poll request
2022-03-02 15:00:06.481721 (Thread-412): 15:00:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38529a90>]}
2022-03-02 15:00:06.483659 (Thread-412): sending response (<Response 17037 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:07.038759 (Thread-6): 15:00:07  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-02 15:00:07.040376 (Thread-6): 15:00:07  finished collecting timing info
2022-03-02 15:00:07.040549 (Thread-6): 15:00:07  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 15:00:07.295947 (Thread-6): 15:00:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f134dd-4cc7-4bfe-bd90-1c7b2ccdcfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f4561b20>]}
2022-03-02 15:00:07.296372 (Thread-6): 15:00:07  19 of 19 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 2.19s]
2022-03-02 15:00:07.296500 (Thread-6): 15:00:07  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:00:07.298282 (MainThread): 15:00:07  Acquiring new snowflake connection "master"
2022-03-02 15:00:07.298662 (MainThread): 15:00:07  
2022-03-02 15:00:07.298766 (MainThread): 15:00:07  Finished running 2 table models, 17 incremental models in 27.13s.
2022-03-02 15:00:07.298850 (MainThread): 15:00:07  Connection 'master' was properly closed.
2022-03-02 15:00:07.298918 (MainThread): 15:00:07  Connection 'model.dbtvault_snowflake_demo.sat_order_cust_nation_details' was properly closed.
2022-03-02 15:00:07.298983 (MainThread): 15:00:07  Connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details' was properly closed.
2022-03-02 15:00:07.299045 (MainThread): 15:00:07  Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
2022-03-02 15:00:07.299104 (MainThread): 15:00:07  Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
2022-03-02 15:00:07.385160 (MainThread): 15:00:07  
2022-03-02 15:00:07.385385 (MainThread): 15:00:07  Completed successfully
2022-03-02 15:00:07.385512 (MainThread): 15:00:07  
2022-03-02 15:00:07.385609 (MainThread): 15:00:07  Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
2022-03-02 15:00:08.497696 (Thread-413): handling poll request
2022-03-02 15:00:08.498082 (Thread-413): 15:00:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3857c130>]}
2022-03-02 15:00:08.500688 (Thread-413): sending response (<Response 95546 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:10.289052 (Thread-414): handling status request
2022-03-02 15:00:10.289437 (Thread-414): 15:00:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b385934c0>]}
2022-03-02 15:00:10.289992 (Thread-414): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:10.298832 (Thread-415): handling status request
2022-03-02 15:00:10.299100 (Thread-415): 15:00:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38531610>]}
2022-03-02 15:00:10.299553 (Thread-415): sending response (<Response 1879 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:11.731862 (Thread-416): handling status request
2022-03-02 15:00:11.732244 (Thread-416): 15:00:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38531f70>]}
2022-03-02 15:00:11.732731 (Thread-416): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:00:11.739656 (Thread-417): handling list request
2022-03-02 15:00:11.739938 (Thread-417): 15:00:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38534dc0>]}
2022-03-02 15:00:11.779643 (Thread-417): 15:00:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38529730>]}
2022-03-02 15:00:11.780080 (Thread-417): 15:00:11  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:00:11.785222 (Thread-417): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:04.155287 (Thread-418): handling status request
2022-03-02 15:02:04.156879 (Thread-418): 15:02:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3847a370>]}
2022-03-02 15:02:04.157405 (Thread-418): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:04.170490 (Thread-419): handling list request
2022-03-02 15:02:04.170769 (Thread-419): 15:02:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3847a670>]}
2022-03-02 15:02:04.203835 (Thread-419): 15:02:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3847ae80>]}
2022-03-02 15:02:04.204151 (Thread-419): 15:02:04  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:02:04.212093 (Thread-419): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:09.237686 (Thread-420): handling status request
2022-03-02 15:02:09.238075 (Thread-420): 15:02:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b384af1f0>]}
2022-03-02 15:02:09.238575 (Thread-420): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:09.245536 (Thread-421): handling list request
2022-03-02 15:02:09.245787 (Thread-421): 15:02:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b384aff40>]}
2022-03-02 15:02:09.283122 (Thread-421): 15:02:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3847a490>]}
2022-03-02 15:02:09.283416 (Thread-421): 15:02:09  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:02:09.289755 (Thread-421): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:55.176861 (Thread-422): handling status request
2022-03-02 15:02:55.177235 (Thread-422): 15:02:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3845b370>]}
2022-03-02 15:02:55.177723 (Thread-422): sending response (<Response 1857 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:55.190910 (Thread-423): handling list request
2022-03-02 15:02:55.191189 (Thread-423): 15:02:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3845b6a0>]}
2022-03-02 15:02:55.227776 (Thread-423): 15:02:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3847a4f0>]}
2022-03-02 15:02:55.228094 (Thread-423): 15:02:55  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:02:55.231415 (Thread-423): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:57.922834 (Thread-424): 15:02:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 15:02:57.923363 (Thread-424): 15:02:57  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:02:58.116932 (Thread-424): 15:02:58  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:02:58.128589 (Thread-424): 15:02:58  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:02:58.184197 (Thread-424): 15:02:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b581541f0>]}
2022-03-02 15:02:58.321298 (Thread-425): handling status request
2022-03-02 15:02:58.321661 (Thread-425): 15:02:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b382b87f0>]}
2022-03-02 15:02:58.322152 (Thread-425): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:58.329075 (Thread-426): handling list request
2022-03-02 15:02:58.329323 (Thread-426): 15:02:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b382b84f0>]}
2022-03-02 15:02:58.367021 (Thread-426): 15:02:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b382b8e50>]}
2022-03-02 15:02:58.367388 (Thread-426): 15:02:58  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:02:58.371735 (Thread-426): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:59.235876 (Thread-427): handling status request
2022-03-02 15:02:59.236244 (Thread-427): 15:02:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b384deb80>]}
2022-03-02 15:02:59.236730 (Thread-427): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:02:59.243983 (Thread-428): handling status request
2022-03-02 15:02:59.244239 (Thread-428): 15:02:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58098ca0>]}
2022-03-02 15:02:59.244636 (Thread-428): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:09.008084 (Thread-429): handling status request
2022-03-02 15:03:09.008449 (Thread-429): 15:03:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38411640>]}
2022-03-02 15:03:09.008932 (Thread-429): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:09.313080 (Thread-430): handling status request
2022-03-02 15:03:09.313452 (Thread-430): 15:03:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b384110d0>]}
2022-03-02 15:03:09.313942 (Thread-430): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:09.629822 (Thread-431): handling cli_args request
2022-03-02 15:03:09.630277 (Thread-431): 15:03:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58154d00>]}
2022-03-02 15:03:11.832657 (Thread-431): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:12.207117 (MainThread): 15:03:12  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:03:12.207551 (MainThread): 15:03:12  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:03:12.214988 (MainThread): 15:03:12  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c1277f-00ce-457e-aecd-b33dac5ddfba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f089176bc10>]}
2022-03-02 15:03:12.253336 (MainThread): 15:03:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c1277f-00ce-457e-aecd-b33dac5ddfba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0891842a60>]}
2022-03-02 15:03:12.253604 (MainThread): 15:03:12  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:03:12.255190 (MainThread): 15:03:12  
2022-03-02 15:03:12.255489 (MainThread): 15:03:12  Acquiring new snowflake connection "master"
2022-03-02 15:03:12.256311 (ThreadPoolExecutor-0_0): 15:03:12  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 15:03:12.269368 (ThreadPoolExecutor-0_0): 15:03:12  Using snowflake connection "list_DBT_RAW"
2022-03-02 15:03:12.269473 (ThreadPoolExecutor-0_0): 15:03:12  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 15:03:12.269555 (ThreadPoolExecutor-0_0): 15:03:12  Opening a new connection, currently in state init
2022-03-02 15:03:12.610988 (Thread-432): handling poll request
2022-03-02 15:03:12.611418 (Thread-432): 15:03:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58054b80>]}
2022-03-02 15:03:12.612383 (Thread-432): sending response (<Response 4172 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:13.299798 (ThreadPoolExecutor-0_0): 15:03:13  SQL status: SUCCESS 7 in 1.03 seconds
2022-03-02 15:03:13.301781 (ThreadPoolExecutor-0_0): 15:03:13  On list_DBT_RAW: Close
2022-03-02 15:03:13.523949 (ThreadPoolExecutor-2_0): 15:03:13  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 15:03:13.531851 (ThreadPoolExecutor-2_0): 15:03:13  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 15:03:13.531992 (ThreadPoolExecutor-2_0): 15:03:13  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 15:03:13.532088 (ThreadPoolExecutor-2_0): 15:03:13  Opening a new connection, currently in state closed
2022-03-02 15:03:14.419974 (Thread-433): handling poll request
2022-03-02 15:03:14.420356 (Thread-433): 15:03:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b580603d0>]}
2022-03-02 15:03:14.447410 (Thread-433): sending response (<Response 2324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:14.540944 (ThreadPoolExecutor-2_0): 15:03:14  SQL status: SUCCESS 31 in 1.01 seconds
2022-03-02 15:03:14.543052 (ThreadPoolExecutor-2_0): 15:03:14  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 15:03:14.793899 (MainThread): 15:03:14  Concurrency: 4 threads (target='default')
2022-03-02 15:03:14.794071 (MainThread): 15:03:14  
2022-03-02 15:03:14.796897 (Thread-3): 15:03:14  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:03:14.797217 (Thread-3): 15:03:14  1 of 1 START incremental model DBT_VAULT.sat_order_customer_details............. [RUN]
2022-03-02 15:03:14.797485 (Thread-3): 15:03:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:14.797590 (Thread-3): 15:03:14  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:03:14.797701 (Thread-3): 15:03:14  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:03:14.884342 (Thread-3): 15:03:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:14.897243 (Thread-3): 15:03:14  finished collecting timing info
2022-03-02 15:03:14.897426 (Thread-3): 15:03:14  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:03:14.939014 (Thread-3): 15:03:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:14.939192 (Thread-3): 15:03:14  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:03:14.939289 (Thread-3): 15:03:14  Opening a new connection, currently in state closed
2022-03-02 15:03:16.221071 (Thread-434): handling poll request
2022-03-02 15:03:16.221454 (Thread-434): 15:03:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3861dc10>]}
2022-03-02 15:03:16.222145 (Thread-434): sending response (<Response 8288 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:18.011723 (Thread-435): handling poll request
2022-03-02 15:03:18.012093 (Thread-435): 15:03:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3861dcd0>]}
2022-03-02 15:03:18.012584 (Thread-435): sending response (<Response 327 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:18.632285 (Thread-3): 15:03:18  SQL status: SUCCESS 1 in 3.69 seconds
2022-03-02 15:03:18.641404 (Thread-3): 15:03:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:18.641541 (Thread-3): 15:03:18  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp
2022-03-02 15:03:18.772332 (Thread-3): 15:03:18  SQL status: SUCCESS 12 in 0.13 seconds
2022-03-02 15:03:18.776390 (Thread-3): 15:03:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:18.776507 (Thread-3): 15:03:18  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details
2022-03-02 15:03:18.901864 (Thread-3): 15:03:18  SQL status: SUCCESS 11 in 0.13 seconds
2022-03-02 15:03:18.910043 (Thread-3): 15:03:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:18.910169 (Thread-3): 15:03:18  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
2022-03-02 15:03:19.034285 (Thread-3): 15:03:19  SQL status: SUCCESS 11 in 0.12 seconds
2022-03-02 15:03:19.054830 (Thread-3): 15:03:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:19.068250 (Thread-3): 15:03:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:19.068379 (Thread-3): 15:03:19  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
2022-03-02 15:03:19.249921 (Thread-3): 15:03:19  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 15:03:19.250168 (Thread-3): 15:03:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:03:19.250254 (Thread-3): 15:03:19  On model.dbtvault_snowflake_demo.sat_order_customer_details: merge into DBT_RAW.DBT_VAULT.sat_order_customer_details as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMERKEY = DBT_INTERNAL_DEST.CUSTOMERKEY
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ACCBAL" = DBT_INTERNAL_SOURCE."CUSTOMER_ACCBAL","CUSTOMER_MKTSEGMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_MKTSEGMENT","CUSTOMER_COMMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_COMMENT","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-02 15:03:19.399674 (Thread-3): 15:03:19  Snowflake adapter: Snowflake query id: 01a2a8a7-0503-b4d3-0000-0ed503a4b54e
2022-03-02 15:03:19.399851 (Thread-3): 15:03:19  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 12
invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMERKEY'
2022-03-02 15:03:19.400026 (Thread-3): 15:03:19  finished collecting timing info
2022-03-02 15:03:19.400166 (Thread-3): 15:03:19  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 15:03:19.720975 (Thread-3): 15:03:19  Database Error in model sat_order_customer_details (models/raw_vault/sats/sat_order_customer_details.sql)
  000904 (42000): SQL compilation error: error line 4 at position 12
  invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMERKEY'
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:03:19.721266 (Thread-3): 15:03:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c1277f-00ce-457e-aecd-b33dac5ddfba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0890f138b0>]}
2022-03-02 15:03:19.721656 (Thread-3): 15:03:19  1 of 1 ERROR creating incremental model DBT_VAULT.sat_order_customer_details.... [ERROR in 4.92s]
2022-03-02 15:03:19.721795 (Thread-3): 15:03:19  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:03:19.723373 (MainThread): 15:03:19  Acquiring new snowflake connection "master"
2022-03-02 15:03:19.723730 (MainThread): 15:03:19  
2022-03-02 15:03:19.723837 (MainThread): 15:03:19  Finished running 1 incremental model in 7.47s.
2022-03-02 15:03:19.723924 (MainThread): 15:03:19  Connection 'master' was properly closed.
2022-03-02 15:03:19.723994 (MainThread): 15:03:19  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 15:03:19.789503 (Thread-436): handling poll request
2022-03-02 15:03:19.789861 (Thread-436): 15:03:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38716af0>]}
2022-03-02 15:03:19.790661 (Thread-436): sending response (<Response 14482 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:19.795137 (MainThread): 15:03:19  
2022-03-02 15:03:19.795351 (MainThread): 15:03:19  Completed with 1 error and 0 warnings:
2022-03-02 15:03:19.795445 (MainThread): 15:03:19  
2022-03-02 15:03:19.795537 (MainThread): 15:03:19  Database Error in model sat_order_customer_details (models/raw_vault/sats/sat_order_customer_details.sql)
2022-03-02 15:03:19.795648 (MainThread): 15:03:19    000904 (42000): SQL compilation error: error line 4 at position 12
2022-03-02 15:03:19.795726 (MainThread): 15:03:19    invalid identifier 'DBT_INTERNAL_SOURCE.CUSTOMERKEY'
2022-03-02 15:03:19.795793 (MainThread): 15:03:19    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:03:19.795869 (MainThread): 15:03:19  
2022-03-02 15:03:19.795955 (MainThread): 15:03:19  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-02 15:03:21.570323 (Thread-437): handling poll request
2022-03-02 15:03:21.570715 (Thread-437): 15:03:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38716910>]}
2022-03-02 15:03:21.572001 (Thread-437): sending response (<Response 9666 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:23.191135 (Thread-438): handling status request
2022-03-02 15:03:23.191515 (Thread-438): 15:03:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58054cd0>]}
2022-03-02 15:03:23.192102 (Thread-438): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:23.200792 (Thread-439): handling status request
2022-03-02 15:03:23.201036 (Thread-439): 15:03:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5806ee20>]}
2022-03-02 15:03:23.201420 (Thread-439): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:24.868928 (Thread-440): handling status request
2022-03-02 15:03:24.869296 (Thread-440): 15:03:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58070f70>]}
2022-03-02 15:03:24.869780 (Thread-440): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:24.876929 (Thread-441): handling list request
2022-03-02 15:03:24.877202 (Thread-441): 15:03:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58070820>]}
2022-03-02 15:03:24.914134 (Thread-441): 15:03:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58048c70>]}
2022-03-02 15:03:24.914500 (Thread-441): 15:03:24  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:03:24.918478 (Thread-441): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:34.125984 (Thread-442): handling status request
2022-03-02 15:03:34.126366 (Thread-442): 15:03:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b387165b0>]}
2022-03-02 15:03:34.126861 (Thread-442): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:34.133655 (Thread-443): handling list request
2022-03-02 15:03:34.133899 (Thread-443): 15:03:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38716ca0>]}
2022-03-02 15:03:34.166542 (Thread-443): 15:03:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58070ca0>]}
2022-03-02 15:03:34.167026 (Thread-443): 15:03:34  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:03:34.170245 (Thread-443): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:35.875727 (Thread-444): handling status request
2022-03-02 15:03:35.877502 (Thread-444): 15:03:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3862c430>]}
2022-03-02 15:03:35.877998 (Thread-444): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:03:35.885201 (Thread-445): handling list request
2022-03-02 15:03:35.885501 (Thread-445): 15:03:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38716520>]}
2022-03-02 15:03:35.920681 (Thread-445): 15:03:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5806e9a0>]}
2022-03-02 15:03:35.920970 (Thread-445): 15:03:35  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:03:35.925398 (Thread-445): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:04:10.497534 (Thread-446): handling status request
2022-03-02 15:04:10.497902 (Thread-446): 15:04:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58054eb0>]}
2022-03-02 15:04:10.498743 (Thread-446): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:04:10.512305 (Thread-447): handling list request
2022-03-02 15:04:10.512541 (Thread-447): 15:04:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38716610>]}
2022-03-02 15:04:10.550488 (Thread-447): 15:04:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b58054910>]}
2022-03-02 15:04:10.551089 (Thread-447): 15:04:10  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:04:10.556905 (Thread-447): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:04:13.228140 (Thread-448): handling status request
2022-03-02 15:04:13.228795 (Thread-448): 15:04:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38716370>]}
2022-03-02 15:04:13.229291 (Thread-448): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:04:13.236077 (Thread-449): handling list request
2022-03-02 15:04:13.236321 (Thread-449): 15:04:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3861da60>]}
2022-03-02 15:04:13.277051 (Thread-449): 15:04:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38628f10>]}
2022-03-02 15:04:13.277418 (Thread-449): 15:04:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:04:13.282489 (Thread-449): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:04:27.261019 (Thread-450): handling status request
2022-03-02 15:04:27.261389 (Thread-450): 15:04:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38628b20>]}
2022-03-02 15:04:27.261868 (Thread-450): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:04:27.275157 (Thread-451): handling list request
2022-03-02 15:04:27.275475 (Thread-451): 15:04:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3861c640>]}
2022-03-02 15:04:27.313699 (Thread-451): 15:04:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38529610>]}
2022-03-02 15:04:27.314062 (Thread-451): 15:04:27  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:04:27.320949 (Thread-451): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:13.755757 (Thread-452): handling status request
2022-03-02 15:10:13.757372 (Thread-452): 15:10:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67c3fd0>]}
2022-03-02 15:10:13.757864 (Thread-452): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:13.764515 (Thread-453): handling list request
2022-03-02 15:10:13.764753 (Thread-453): 15:10:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38603760>]}
2022-03-02 15:10:13.802491 (Thread-453): 15:10:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67c3190>]}
2022-03-02 15:10:13.802785 (Thread-453): 15:10:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:10:13.810853 (Thread-453): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:16.861461 (Thread-454): handling status request
2022-03-02 15:10:16.861906 (Thread-454): 15:10:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38413e80>]}
2022-03-02 15:10:16.862632 (Thread-454): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:16.870119 (Thread-455): handling list request
2022-03-02 15:10:16.870355 (Thread-455): 15:10:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7844ee50>]}
2022-03-02 15:10:16.908007 (Thread-455): 15:10:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38628760>]}
2022-03-02 15:10:16.931733 (Thread-455): 15:10:16  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:10:16.934947 (Thread-455): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:33.855203 (Thread-456): handling status request
2022-03-02 15:10:33.855586 (Thread-456): 15:10:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b580607f0>]}
2022-03-02 15:10:33.856126 (Thread-456): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:33.873691 (Thread-457): handling list request
2022-03-02 15:10:33.873931 (Thread-457): 15:10:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7844ebb0>]}
2022-03-02 15:10:33.909913 (Thread-457): 15:10:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b580602e0>]}
2022-03-02 15:10:33.910185 (Thread-457): 15:10:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:10:33.913408 (Thread-457): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:36.420984 (Thread-458): handling status request
2022-03-02 15:10:36.421359 (Thread-458): 15:10:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c554e20>]}
2022-03-02 15:10:36.421851 (Thread-458): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:10:36.429535 (Thread-459): handling list request
2022-03-02 15:10:36.429784 (Thread-459): 15:10:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c554df0>]}
2022-03-02 15:10:36.463208 (Thread-459): 15:10:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7844e250>]}
2022-03-02 15:10:36.463535 (Thread-459): 15:10:36  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:10:36.466984 (Thread-459): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:07.910259 (Thread-460): handling status request
2022-03-02 15:11:07.910640 (Thread-460): 15:11:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c5547c0>]}
2022-03-02 15:11:07.911144 (Thread-460): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:07.923738 (Thread-461): handling list request
2022-03-02 15:11:07.924101 (Thread-461): 15:11:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be67cf310>]}
2022-03-02 15:11:07.963836 (Thread-461): 15:11:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b386036a0>]}
2022-03-02 15:11:07.964227 (Thread-461): 15:11:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:11:07.967981 (Thread-461): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:16.515565 (Thread-462): handling status request
2022-03-02 15:11:16.515953 (Thread-462): 15:11:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be43a8730>]}
2022-03-02 15:11:16.516441 (Thread-462): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:16.523949 (Thread-463): handling list request
2022-03-02 15:11:16.524197 (Thread-463): 15:11:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c69cd90>]}
2022-03-02 15:11:16.596897 (Thread-463): 15:11:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c640820>]}
2022-03-02 15:11:16.597228 (Thread-463): 15:11:16  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:11:16.605381 (Thread-463): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:31.180800 (Thread-464): handling status request
2022-03-02 15:11:31.181161 (Thread-464): 15:11:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b780f51f0>]}
2022-03-02 15:11:31.181658 (Thread-464): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:31.189677 (Thread-465): handling list request
2022-03-02 15:11:31.189936 (Thread-465): 15:11:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b780f5550>]}
2022-03-02 15:11:31.226383 (Thread-465): 15:11:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b780f5940>]}
2022-03-02 15:11:31.226672 (Thread-465): 15:11:31  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:11:31.230194 (Thread-465): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:44.894880 (Thread-466): handling status request
2022-03-02 15:11:44.895248 (Thread-466): 15:11:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c64e3d0>]}
2022-03-02 15:11:44.895792 (Thread-466): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:11:44.911112 (Thread-467): handling list request
2022-03-02 15:11:44.911453 (Thread-467): 15:11:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c24405af0>]}
2022-03-02 15:11:44.947909 (Thread-467): 15:11:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c64ec40>]}
2022-03-02 15:11:44.948315 (Thread-467): 15:11:44  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:11:44.954547 (Thread-467): sending response (<Response 16917 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:19.014867 (Thread-468): handling status request
2022-03-02 15:12:19.015242 (Thread-468): 15:12:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38610850>]}
2022-03-02 15:12:19.015779 (Thread-468): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:19.027631 (Thread-469): handling list request
2022-03-02 15:12:19.027874 (Thread-469): 15:12:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5820ab50>]}
2022-03-02 15:12:19.066951 (Thread-469): 15:12:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed21daf0>]}
2022-03-02 15:12:19.067235 (Thread-469): 15:12:19  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:12:19.075738 (Thread-469): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:29.451173 (Thread-470): handling status request
2022-03-02 15:12:29.451559 (Thread-470): 15:12:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b382475e0>]}
2022-03-02 15:12:29.452097 (Thread-470): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:29.470834 (Thread-471): handling list request
2022-03-02 15:12:29.471075 (Thread-471): 15:12:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9c59ba30>]}
2022-03-02 15:12:29.502453 (Thread-471): 15:12:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5820ae80>]}
2022-03-02 15:12:29.502743 (Thread-471): 15:12:29  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:12:29.506179 (Thread-471): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:32.591548 (Thread-472): 15:12:32  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 15:12:32.592127 (Thread-472): 15:12:32  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:12:32.598495 (Thread-472): 15:12:32  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:12:32.610997 (Thread-472): 15:12:32  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:12:32.666209 (Thread-472): 15:12:32  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187225b0>]}
2022-03-02 15:12:32.946477 (Thread-473): handling status request
2022-03-02 15:12:32.946851 (Thread-473): 15:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b381c4490>]}
2022-03-02 15:12:32.947358 (Thread-473): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:32.953367 (Thread-474): handling list request
2022-03-02 15:12:32.953605 (Thread-474): 15:12:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b381c48b0>]}
2022-03-02 15:12:32.988644 (Thread-474): 15:12:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b381c4550>]}
2022-03-02 15:12:32.988919 (Thread-474): 15:12:32  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:12:32.992782 (Thread-474): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:33.443401 (Thread-475): handling status request
2022-03-02 15:12:33.443820 (Thread-475): 15:12:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187b7fa0>]}
2022-03-02 15:12:33.444339 (Thread-475): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:12:33.757721 (Thread-476): handling status request
2022-03-02 15:12:33.758094 (Thread-476): 15:12:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1873a490>]}
2022-03-02 15:12:33.780498 (Thread-476): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:13:39.516320 (Thread-477): handling status request
2022-03-02 15:13:39.516701 (Thread-477): 15:13:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187b3280>]}
2022-03-02 15:13:39.517189 (Thread-477): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:13:39.532994 (Thread-478): handling list request
2022-03-02 15:13:39.533264 (Thread-478): 15:13:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187b30d0>]}
2022-03-02 15:13:39.570147 (Thread-478): 15:13:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1873a850>]}
2022-03-02 15:13:39.570465 (Thread-478): 15:13:39  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:13:39.578781 (Thread-478): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:13:43.224783 (Thread-479): handling status request
2022-03-02 15:13:43.225165 (Thread-479): 15:13:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187a65b0>]}
2022-03-02 15:13:43.225681 (Thread-479): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:13:43.233527 (Thread-480): handling list request
2022-03-02 15:13:43.233774 (Thread-480): 15:13:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187b0a00>]}
2022-03-02 15:13:43.268467 (Thread-480): 15:13:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187a6790>]}
2022-03-02 15:13:43.268745 (Thread-480): 15:13:43  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:13:43.272054 (Thread-480): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:14:03.388919 (Thread-481): handling status request
2022-03-02 15:14:03.389424 (Thread-481): 15:14:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38182580>]}
2022-03-02 15:14:03.390384 (Thread-481): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:14:03.403773 (Thread-482): handling list request
2022-03-02 15:14:03.404031 (Thread-482): 15:14:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1877d2b0>]}
2022-03-02 15:14:03.442195 (Thread-482): 15:14:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b381db520>]}
2022-03-02 15:14:03.442497 (Thread-482): 15:14:03  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:14:03.446854 (Thread-482): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:14:56.810086 (Thread-483): handling status request
2022-03-02 15:14:56.810743 (Thread-483): 15:14:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187a65b0>]}
2022-03-02 15:14:56.811247 (Thread-483): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:14:56.824590 (Thread-484): handling list request
2022-03-02 15:14:56.824859 (Thread-484): 15:14:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38182040>]}
2022-03-02 15:14:56.861383 (Thread-484): 15:14:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18722fd0>]}
2022-03-02 15:14:56.861686 (Thread-484): 15:14:56  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:14:56.869575 (Thread-484): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:02.303755 (Thread-485): handling status request
2022-03-02 15:15:02.304186 (Thread-485): 15:15:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18722cd0>]}
2022-03-02 15:15:02.304675 (Thread-485): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:02.323300 (Thread-486): handling list request
2022-03-02 15:15:02.323568 (Thread-486): 15:15:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187222b0>]}
2022-03-02 15:15:02.358464 (Thread-486): 15:15:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18721dc0>]}
2022-03-02 15:15:02.358815 (Thread-486): 15:15:02  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:15:02.362171 (Thread-486): sending response (<Response 5512 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:11.746281 (Thread-487): 15:15:11  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 15:15:11.746799 (Thread-487): 15:15:11  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:15:11.753172 (Thread-487): 15:15:11  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:15:11.765170 (Thread-487): 15:15:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-02 15:15:11.824217 (Thread-487): 15:15:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1852ff10>]}
2022-03-02 15:15:12.038199 (Thread-488): handling status request
2022-03-02 15:15:12.038562 (Thread-488): 15:15:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18755730>]}
2022-03-02 15:15:12.039072 (Thread-488): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:12.047511 (Thread-489): handling list request
2022-03-02 15:15:12.047829 (Thread-489): 15:15:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18753460>]}
2022-03-02 15:15:12.078453 (Thread-489): 15:15:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18755f10>]}
2022-03-02 15:15:12.078768 (Thread-489): 15:15:12  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:15:12.082315 (Thread-489): sending response (<Response 5518 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:12.560979 (Thread-490): handling status request
2022-03-02 15:15:12.561344 (Thread-490): 15:15:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18693e80>]}
2022-03-02 15:15:12.562154 (Thread-490): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:12.897722 (Thread-491): handling status request
2022-03-02 15:15:12.898084 (Thread-491): 15:15:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18693dc0>]}
2022-03-02 15:15:12.898563 (Thread-491): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:27.853663 (Thread-492): handling status request
2022-03-02 15:15:27.854034 (Thread-492): 15:15:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18693640>]}
2022-03-02 15:15:27.854513 (Thread-492): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:27.861914 (Thread-493): handling list request
2022-03-02 15:15:27.862156 (Thread-493): 15:15:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b186933a0>]}
2022-03-02 15:15:27.897311 (Thread-493): 15:15:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b186932b0>]}
2022-03-02 15:15:27.897646 (Thread-493): 15:15:27  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:15:27.902195 (Thread-493): sending response (<Response 5518 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:32.723018 (Thread-494): handling status request
2022-03-02 15:15:32.723391 (Thread-494): 15:15:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18573dc0>]}
2022-03-02 15:15:32.723916 (Thread-494): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:33.029772 (Thread-495): handling status request
2022-03-02 15:15:33.030151 (Thread-495): 15:15:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18693100>]}
2022-03-02 15:15:33.030638 (Thread-495): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:33.196796 (Thread-496): handling cli_args request
2022-03-02 15:15:33.197189 (Thread-496): 15:15:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b381d9ca0>]}
2022-03-02 15:15:35.370321 (Thread-496): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:35.750857 (MainThread): 15:15:35  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:15:35.751291 (MainThread): 15:15:35  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:15:35.758792 (MainThread): 15:15:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c0fad45-9482-4118-9fb5-0baeff99c56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a7c2c130>]}
2022-03-02 15:15:35.792787 (MainThread): 15:15:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c0fad45-9482-4118-9fb5-0baeff99c56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a7d06b80>]}
2022-03-02 15:15:35.793063 (MainThread): 15:15:35  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:15:35.794645 (MainThread): 15:15:35  
2022-03-02 15:15:35.794964 (MainThread): 15:15:35  Acquiring new snowflake connection "master"
2022-03-02 15:15:35.795773 (ThreadPoolExecutor-0_0): 15:15:35  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 15:15:35.808599 (ThreadPoolExecutor-0_0): 15:15:35  Using snowflake connection "list_DBT_RAW"
2022-03-02 15:15:35.808713 (ThreadPoolExecutor-0_0): 15:15:35  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 15:15:35.808800 (ThreadPoolExecutor-0_0): 15:15:35  Opening a new connection, currently in state init
2022-03-02 15:15:36.153142 (Thread-497): handling poll request
2022-03-02 15:15:36.153625 (Thread-497): 15:15:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b186c38e0>]}
2022-03-02 15:15:36.154502 (Thread-497): sending response (<Response 4172 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:37.058423 (ThreadPoolExecutor-0_0): 15:15:37  SQL status: SUCCESS 7 in 1.25 seconds
2022-03-02 15:15:37.060484 (ThreadPoolExecutor-0_0): 15:15:37  On list_DBT_RAW: Close
2022-03-02 15:15:37.278667 (ThreadPoolExecutor-2_0): 15:15:37  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 15:15:37.286693 (ThreadPoolExecutor-2_0): 15:15:37  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 15:15:37.286835 (ThreadPoolExecutor-2_0): 15:15:37  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 15:15:37.286936 (ThreadPoolExecutor-2_0): 15:15:37  Opening a new connection, currently in state closed
2022-03-02 15:15:37.961119 (Thread-498): handling poll request
2022-03-02 15:15:37.961481 (Thread-498): 15:15:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18752f10>]}
2022-03-02 15:15:37.962021 (Thread-498): sending response (<Response 2324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:38.043403 (ThreadPoolExecutor-2_0): 15:15:38  SQL status: SUCCESS 31 in 0.76 seconds
2022-03-02 15:15:38.045567 (ThreadPoolExecutor-2_0): 15:15:38  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 15:15:38.244751 (MainThread): 15:15:38  Concurrency: 4 threads (target='default')
2022-03-02 15:15:38.244901 (MainThread): 15:15:38  
2022-03-02 15:15:38.247720 (Thread-3): 15:15:38  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:15:38.248029 (Thread-3): 15:15:38  1 of 1 START incremental model DBT_VAULT.sat_order_customer_details............. [RUN]
2022-03-02 15:15:38.248295 (Thread-3): 15:15:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:38.248397 (Thread-3): 15:15:38  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:15:38.248506 (Thread-3): 15:15:38  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:15:38.333729 (Thread-3): 15:15:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:38.346544 (Thread-3): 15:15:38  finished collecting timing info
2022-03-02 15:15:38.346696 (Thread-3): 15:15:38  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:15:38.386043 (Thread-3): 15:15:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:38.386167 (Thread-3): 15:15:38  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:15:38.386255 (Thread-3): 15:15:38  Opening a new connection, currently in state closed
2022-03-02 15:15:39.761910 (Thread-499): handling poll request
2022-03-02 15:15:39.762294 (Thread-499): 15:15:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1852a610>]}
2022-03-02 15:15:39.787279 (Thread-499): sending response (<Response 8287 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:41.169552 (Thread-3): 15:15:41  SQL status: SUCCESS 1 in 2.78 seconds
2022-03-02 15:15:41.178818 (Thread-3): 15:15:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:41.178962 (Thread-3): 15:15:41  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp
2022-03-02 15:15:41.346369 (Thread-3): 15:15:41  SQL status: SUCCESS 12 in 0.17 seconds
2022-03-02 15:15:41.350537 (Thread-3): 15:15:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:41.350660 (Thread-3): 15:15:41  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details
2022-03-02 15:15:41.504084 (Thread-3): 15:15:41  SQL status: SUCCESS 11 in 0.15 seconds
2022-03-02 15:15:41.513080 (Thread-3): 15:15:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:41.513238 (Thread-3): 15:15:41  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
2022-03-02 15:15:41.580480 (Thread-500): handling poll request
2022-03-02 15:15:41.580859 (Thread-500): 15:15:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1852daf0>]}
2022-03-02 15:15:41.581450 (Thread-500): sending response (<Response 4494 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:41.621213 (Thread-3): 15:15:41  SQL status: SUCCESS 11 in 0.11 seconds
2022-03-02 15:15:41.642192 (Thread-3): 15:15:41  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:41.655148 (Thread-3): 15:15:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:41.655307 (Thread-3): 15:15:41  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
2022-03-02 15:15:41.792642 (Thread-3): 15:15:41  SQL status: SUCCESS 1 in 0.14 seconds
2022-03-02 15:15:41.792893 (Thread-3): 15:15:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:41.792980 (Thread-3): 15:15:41  On model.dbtvault_snowflake_demo.sat_order_customer_details: merge into DBT_RAW.DBT_VAULT.sat_order_customer_details as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ACCBAL" = DBT_INTERNAL_SOURCE."CUSTOMER_ACCBAL","CUSTOMER_MKTSEGMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_MKTSEGMENT","CUSTOMER_COMMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_COMMENT","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-02 15:15:42.585588 (Thread-3): 15:15:42  SQL status: SUCCESS 0 in 0.79 seconds
2022-03-02 15:15:42.585795 (Thread-3): 15:15:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:15:42.585882 (Thread-3): 15:15:42  On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
2022-03-02 15:15:42.818623 (Thread-3): 15:15:42  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-02 15:15:42.828780 (Thread-3): 15:15:42  finished collecting timing info
2022-03-02 15:15:42.828966 (Thread-3): 15:15:42  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 15:15:43.054229 (Thread-3): 15:15:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0fad45-9482-4118-9fb5-0baeff99c56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a7c343a0>]}
2022-03-02 15:15:43.054674 (Thread-3): 15:15:43  1 of 1 OK created incremental model DBT_VAULT.sat_order_customer_details........ [SUCCESS 1 in 4.81s]
2022-03-02 15:15:43.054807 (Thread-3): 15:15:43  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:15:43.056467 (MainThread): 15:15:43  Acquiring new snowflake connection "master"
2022-03-02 15:15:43.056786 (MainThread): 15:15:43  
2022-03-02 15:15:43.056889 (MainThread): 15:15:43  Finished running 1 incremental model in 7.26s.
2022-03-02 15:15:43.056974 (MainThread): 15:15:43  Connection 'master' was properly closed.
2022-03-02 15:15:43.057044 (MainThread): 15:15:43  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 15:15:43.122124 (MainThread): 15:15:43  
2022-03-02 15:15:43.122313 (MainThread): 15:15:43  Completed successfully
2022-03-02 15:15:43.122413 (MainThread): 15:15:43  
2022-03-02 15:15:43.122508 (MainThread): 15:15:43  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-02 15:15:43.389115 (Thread-501): handling poll request
2022-03-02 15:15:43.389514 (Thread-501): 15:15:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185371f0>]}
2022-03-02 15:15:43.390582 (Thread-501): sending response (<Response 17030 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:44.872873 (Thread-502): handling status request
2022-03-02 15:15:44.873266 (Thread-502): 15:15:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185373d0>]}
2022-03-02 15:15:44.873845 (Thread-502): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:45.094835 (Thread-503): handling status request
2022-03-02 15:15:45.095245 (Thread-503): 15:15:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c5250>]}
2022-03-02 15:15:45.095762 (Thread-503): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:46.569583 (Thread-504): handling status request
2022-03-02 15:15:46.569949 (Thread-504): 15:15:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18537a30>]}
2022-03-02 15:15:46.570431 (Thread-504): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:46.577719 (Thread-505): handling list request
2022-03-02 15:15:46.577982 (Thread-505): 15:15:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18537ca0>]}
2022-03-02 15:15:46.614995 (Thread-505): 15:15:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1852a8b0>]}
2022-03-02 15:15:46.615322 (Thread-505): 15:15:46  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:15:46.618959 (Thread-505): sending response (<Response 5518 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:54.585869 (Thread-506): handling status request
2022-03-02 15:15:54.586240 (Thread-506): 15:15:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c5f40>]}
2022-03-02 15:15:54.586720 (Thread-506): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:54.782003 (Thread-507): handling status request
2022-03-02 15:15:54.782406 (Thread-507): 15:15:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18537b20>]}
2022-03-02 15:15:54.782895 (Thread-507): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:55.096751 (Thread-508): handling cli_args request
2022-03-02 15:15:55.097109 (Thread-508): 15:15:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c5640>]}
2022-03-02 15:15:57.302981 (Thread-508): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:57.692398 (MainThread): 15:15:57  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:15:57.692846 (MainThread): 15:15:57  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:15:57.700683 (MainThread): 15:15:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd85ebd90>]}
2022-03-02 15:15:57.734184 (MainThread): 15:15:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd86bfaf0>]}
2022-03-02 15:15:57.734509 (MainThread): 15:15:57  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:15:57.736850 (MainThread): 15:15:57  
2022-03-02 15:15:57.737186 (MainThread): 15:15:57  Acquiring new snowflake connection "master"
2022-03-02 15:15:57.738736 (ThreadPoolExecutor-0_0): 15:15:57  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 15:15:57.751740 (ThreadPoolExecutor-0_0): 15:15:57  Using snowflake connection "list_DBT_RAW"
2022-03-02 15:15:57.751853 (ThreadPoolExecutor-0_0): 15:15:57  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 15:15:57.751937 (ThreadPoolExecutor-0_0): 15:15:57  Opening a new connection, currently in state init
2022-03-02 15:15:58.085850 (Thread-509): handling poll request
2022-03-02 15:15:58.086316 (Thread-509): 15:15:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18501d90>]}
2022-03-02 15:15:58.087216 (Thread-509): sending response (<Response 4169 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:15:59.247928 (ThreadPoolExecutor-0_0): 15:15:59  SQL status: SUCCESS 7 in 1.5 seconds
2022-03-02 15:15:59.249917 (ThreadPoolExecutor-0_0): 15:15:59  On list_DBT_RAW: Close
2022-03-02 15:15:59.448021 (ThreadPoolExecutor-2_0): 15:15:59  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 15:15:59.455948 (ThreadPoolExecutor-2_0): 15:15:59  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 15:15:59.456090 (ThreadPoolExecutor-2_0): 15:15:59  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 15:15:59.456188 (ThreadPoolExecutor-2_0): 15:15:59  Opening a new connection, currently in state closed
2022-03-02 15:16:00.316764 (Thread-510): handling poll request
2022-03-02 15:16:00.317145 (Thread-510): 15:16:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18538c70>]}
2022-03-02 15:16:00.317721 (Thread-510): sending response (<Response 2320 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:02.112344 (Thread-511): handling poll request
2022-03-02 15:16:02.112718 (Thread-511): 15:16:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18538970>]}
2022-03-02 15:16:02.113219 (Thread-511): sending response (<Response 324 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:02.585461 (ThreadPoolExecutor-2_0): 15:16:02  SQL status: SUCCESS 31 in 3.13 seconds
2022-03-02 15:16:02.587589 (ThreadPoolExecutor-2_0): 15:16:02  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 15:16:02.807836 (MainThread): 15:16:02  Concurrency: 4 threads (target='default')
2022-03-02 15:16:02.808021 (MainThread): 15:16:02  
2022-03-02 15:16:02.811206 (Thread-3): 15:16:02  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 15:16:02.811540 (Thread-3): 15:16:02  1 of 19 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 15:16:02.811876 (Thread-3): 15:16:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 15:16:02.811994 (Thread-3): 15:16:02  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 15:16:02.812109 (Thread-3): 15:16:02  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 15:16:02.818202 (Thread-3): 15:16:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 15:16:02.830845 (Thread-3): 15:16:02  finished collecting timing info
2022-03-02 15:16:02.831016 (Thread-3): 15:16:02  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 15:16:02.858116 (Thread-3): 15:16:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 15:16:02.872918 (Thread-3): 15:16:02  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 15:16:02.873087 (Thread-3): 15:16:02  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 15:16:02.873183 (Thread-3): 15:16:02  Opening a new connection, currently in state closed
2022-03-02 15:16:03.924509 (Thread-512): handling poll request
2022-03-02 15:16:03.924906 (Thread-512): 15:16:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c5a60>]}
2022-03-02 15:16:03.925617 (Thread-512): sending response (<Response 9240 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:05.738167 (Thread-513): handling poll request
2022-03-02 15:16:05.738547 (Thread-513): 15:16:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1852dcd0>]}
2022-03-02 15:16:05.739049 (Thread-513): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:07.528112 (Thread-514): handling poll request
2022-03-02 15:16:07.528493 (Thread-514): 15:16:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1852dc70>]}
2022-03-02 15:16:07.528973 (Thread-514): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:09.360174 (Thread-515): handling poll request
2022-03-02 15:16:09.360582 (Thread-515): 15:16:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18537190>]}
2022-03-02 15:16:09.361070 (Thread-515): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:11.143908 (Thread-516): handling poll request
2022-03-02 15:16:11.144283 (Thread-516): 15:16:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c86d0>]}
2022-03-02 15:16:11.144776 (Thread-516): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:12.948307 (Thread-517): handling poll request
2022-03-02 15:16:12.948714 (Thread-517): 15:16:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c8430>]}
2022-03-02 15:16:12.949252 (Thread-517): sending response (<Response 325 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:13.457552 (Thread-518): handling status request
2022-03-02 15:16:13.457917 (Thread-518): 15:16:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c8b50>]}
2022-03-02 15:16:13.458461 (Thread-518): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:13.466531 (Thread-519): handling list request
2022-03-02 15:16:13.466810 (Thread-519): 15:16:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18752ee0>]}
2022-03-02 15:16:13.503332 (Thread-519): 15:16:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c8e50>]}
2022-03-02 15:16:13.503728 (Thread-519): 15:16:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:16:13.507508 (Thread-519): sending response (<Response 5495 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:13.939959 (Thread-3): 15:16:13  SQL status: SUCCESS 1 in 11.07 seconds
2022-03-02 15:16:13.949262 (Thread-3): 15:16:13  finished collecting timing info
2022-03-02 15:16:13.949431 (Thread-3): 15:16:13  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 15:16:14.170301 (Thread-3): 15:16:14  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd2fccf40>]}
2022-03-02 15:16:14.170733 (Thread-3): 15:16:14  1 of 19 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 11.36s]
2022-03-02 15:16:14.170861 (Thread-3): 15:16:14  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 15:16:14.171870 (Thread-5): 15:16:14  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 15:16:14.172146 (Thread-5): 15:16:14  2 of 19 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 15:16:14.172429 (Thread-5): 15:16:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 15:16:14.172527 (Thread-5): 15:16:14  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 15:16:14.172620 (Thread-5): 15:16:14  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 15:16:14.212271 (Thread-5): 15:16:14  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 15:16:14.212413 (Thread-5): 15:16:14  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 15:16:14.212500 (Thread-5): 15:16:14  Opening a new connection, currently in state init
2022-03-02 15:16:14.932088 (Thread-520): handling poll request
2022-03-02 15:16:14.932457 (Thread-520): 15:16:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184e71c0>]}
2022-03-02 15:16:14.933094 (Thread-520): sending response (<Response 6322 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:15.094306 (Thread-5): 15:16:15  SQL status: SUCCESS 37 in 0.88 seconds
2022-03-02 15:16:15.125440 (Thread-5): 15:16:15  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 15:16:15.125583 (Thread-5): 15:16:15  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 15:16:15.174992 (Thread-521): handling status request
2022-03-02 15:16:15.175297 (Thread-521): 15:16:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184e7550>]}
2022-03-02 15:16:15.175805 (Thread-521): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:15.182541 (Thread-522): handling list request
2022-03-02 15:16:15.182777 (Thread-522): 15:16:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184e7850>]}
2022-03-02 15:16:15.218369 (Thread-522): 15:16:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184e7100>]}
2022-03-02 15:16:15.218738 (Thread-522): 15:16:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:16:15.221923 (Thread-522): sending response (<Response 5518 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:15.242835 (Thread-5): 15:16:15  SQL status: SUCCESS 37 in 0.12 seconds
2022-03-02 15:16:15.291357 (Thread-5): 15:16:15  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 15:16:15.317050 (Thread-5): 15:16:15  finished collecting timing info
2022-03-02 15:16:15.317265 (Thread-5): 15:16:15  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 15:16:15.319843 (Thread-5): 15:16:15  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 15:16:15.356155 (Thread-5): 15:16:15  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 15:16:15.356278 (Thread-5): 15:16:15  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 15:16:16.822401 (Thread-523): handling poll request
2022-03-02 15:16:16.822768 (Thread-523): 15:16:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184ee700>]}
2022-03-02 15:16:16.823428 (Thread-523): sending response (<Response 14710 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:17.456808 (Thread-5): 15:16:17  SQL status: SUCCESS 1 in 2.1 seconds
2022-03-02 15:16:17.458226 (Thread-5): 15:16:17  finished collecting timing info
2022-03-02 15:16:17.458385 (Thread-5): 15:16:17  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 15:16:17.661525 (Thread-5): 15:16:17  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd01960d0>]}
2022-03-02 15:16:17.661938 (Thread-5): 15:16:17  2 of 19 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.49s]
2022-03-02 15:16:17.662063 (Thread-5): 15:16:17  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 15:16:17.663338 (Thread-4): 15:16:17  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 15:16:17.663599 (Thread-4): 15:16:17  3 of 19 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 15:16:17.663920 (Thread-4): 15:16:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 15:16:17.664013 (Thread-4): 15:16:17  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 15:16:17.664104 (Thread-4): 15:16:17  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 15:16:17.668474 (Thread-3): 15:16:17  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 15:16:17.668693 (Thread-3): 15:16:17  4 of 19 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 15:16:17.668929 (Thread-3): 15:16:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 15:16:17.669033 (Thread-3): 15:16:17  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 15:16:17.669118 (Thread-3): 15:16:17  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 15:16:17.678921 (Thread-6): 15:16:17  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 15:16:17.679177 (Thread-6): 15:16:17  5 of 19 START incremental model DBT_VAULT.hub_nation............................ [RUN]
2022-03-02 15:16:17.679439 (Thread-6): 15:16:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 15:16:17.679526 (Thread-6): 15:16:17  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 15:16:17.679642 (Thread-6): 15:16:17  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 15:16:17.694196 (Thread-5): 15:16:17  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 15:16:17.694424 (Thread-5): 15:16:17  6 of 19 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 15:16:17.694661 (Thread-5): 15:16:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 15:16:17.694746 (Thread-5): 15:16:17  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 15:16:17.694826 (Thread-5): 15:16:17  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 15:16:17.825634 (Thread-5): 15:16:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 15:16:17.826277 (Thread-3): 15:16:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 15:16:17.827764 (Thread-6): 15:16:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 15:16:17.828360 (Thread-4): 15:16:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 15:16:17.839989 (Thread-3): 15:16:17  finished collecting timing info
2022-03-02 15:16:17.840156 (Thread-3): 15:16:17  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 15:16:17.845359 (Thread-6): 15:16:17  finished collecting timing info
2022-03-02 15:16:17.845504 (Thread-6): 15:16:17  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 15:16:17.850493 (Thread-4): 15:16:17  finished collecting timing info
2022-03-02 15:16:17.850632 (Thread-4): 15:16:17  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 15:16:17.876357 (Thread-5): 15:16:17  finished collecting timing info
2022-03-02 15:16:17.876516 (Thread-5): 15:16:17  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 15:16:17.895537 (Thread-6): 15:16:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 15:16:17.897254 (Thread-3): 15:16:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 15:16:17.900632 (Thread-4): 15:16:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 15:16:17.903323 (Thread-5): 15:16:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 15:16:17.912876 (Thread-6): 15:16:17  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 15:16:17.913006 (Thread-6): 15:16:17  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:17.913096 (Thread-6): 15:16:17  Opening a new connection, currently in state init
2022-03-02 15:16:17.921849 (Thread-3): 15:16:17  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 15:16:17.921976 (Thread-3): 15:16:17  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:17.922062 (Thread-3): 15:16:17  Opening a new connection, currently in state closed
2022-03-02 15:16:17.923448 (Thread-5): 15:16:17  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 15:16:17.923553 (Thread-5): 15:16:17  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:17.923670 (Thread-5): 15:16:17  Opening a new connection, currently in state closed
2022-03-02 15:16:17.925305 (Thread-4): 15:16:17  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 15:16:17.925409 (Thread-4): 15:16:17  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:17.925489 (Thread-4): 15:16:17  Opening a new connection, currently in state init
2022-03-02 15:16:18.620058 (Thread-524): handling poll request
2022-03-02 15:16:18.620431 (Thread-524): 15:16:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b185c8790>]}
2022-03-02 15:16:18.621411 (Thread-524): sending response (<Response 26286 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:20.204294 (Thread-3): 15:16:20  SQL status: SUCCESS 1 in 2.28 seconds
2022-03-02 15:16:20.205862 (Thread-3): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.206024 (Thread-3): 15:16:20  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 15:16:20.279030 (Thread-4): 15:16:20  SQL status: SUCCESS 1 in 2.35 seconds
2022-03-02 15:16:20.280362 (Thread-4): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.280498 (Thread-4): 15:16:20  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 15:16:20.351045 (Thread-6): 15:16:20  SQL status: SUCCESS 1 in 2.44 seconds
2022-03-02 15:16:20.352315 (Thread-6): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.352448 (Thread-6): 15:16:20  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 15:16:20.417712 (Thread-3): 15:16:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd00339d0>]}
2022-03-02 15:16:20.418053 (Thread-3): 15:16:20  4 of 19 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 2.75s]
2022-03-02 15:16:20.418173 (Thread-3): 15:16:20  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 15:16:20.418313 (Thread-3): 15:16:20  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 15:16:20.418495 (Thread-3): 15:16:20  7 of 19 START incremental model DBT_VAULT.hub_part.............................. [RUN]
2022-03-02 15:16:20.418723 (Thread-3): 15:16:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 15:16:20.418812 (Thread-3): 15:16:20  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 15:16:20.418897 (Thread-3): 15:16:20  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 15:16:20.428613 (Thread-3): 15:16:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 15:16:20.444906 (Thread-525): handling poll request
2022-03-02 15:16:20.441948 (Thread-3): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.445423 (Thread-525): 15:16:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1848cf70>]}
2022-03-02 15:16:20.442088 (Thread-3): 15:16:20  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 15:16:20.446267 (Thread-525): sending response (<Response 8593 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:20.444808 (Thread-3): 15:16:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 15:16:20.458906 (Thread-3): 15:16:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 15:16:20.459022 (Thread-3): 15:16:20  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:20.459107 (Thread-3): 15:16:20  Opening a new connection, currently in state closed
2022-03-02 15:16:20.496912 (Thread-4): 15:16:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2fcb6a0>]}
2022-03-02 15:16:20.497238 (Thread-4): 15:16:20  3 of 19 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 2.83s]
2022-03-02 15:16:20.497354 (Thread-4): 15:16:20  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 15:16:20.497494 (Thread-4): 15:16:20  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 15:16:20.497668 (Thread-4): 15:16:20  8 of 19 START incremental model DBT_VAULT.hub_region............................ [RUN]
2022-03-02 15:16:20.497884 (Thread-4): 15:16:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 15:16:20.497970 (Thread-4): 15:16:20  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 15:16:20.498053 (Thread-4): 15:16:20  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 15:16:20.507114 (Thread-4): 15:16:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 15:16:20.521039 (Thread-4): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.521334 (Thread-4): 15:16:20  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 15:16:20.524026 (Thread-4): 15:16:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 15:16:20.538042 (Thread-4): 15:16:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 15:16:20.538163 (Thread-4): 15:16:20  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:20.538248 (Thread-4): 15:16:20  Opening a new connection, currently in state closed
2022-03-02 15:16:20.540721 (Thread-5): 15:16:20  SQL status: SUCCESS 1 in 2.62 seconds
2022-03-02 15:16:20.541930 (Thread-5): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.542059 (Thread-5): 15:16:20  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 15:16:20.550146 (Thread-6): 15:16:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd00e47f0>]}
2022-03-02 15:16:20.550444 (Thread-6): 15:16:20  5 of 19 OK created incremental model DBT_VAULT.hub_nation....................... [SUCCESS 1 in 2.87s]
2022-03-02 15:16:20.550554 (Thread-6): 15:16:20  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 15:16:20.550684 (Thread-6): 15:16:20  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 15:16:20.550853 (Thread-6): 15:16:20  9 of 19 START incremental model DBT_VAULT.hub_supplier.......................... [RUN]
2022-03-02 15:16:20.551062 (Thread-6): 15:16:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 15:16:20.551145 (Thread-6): 15:16:20  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 15:16:20.551227 (Thread-6): 15:16:20  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 15:16:20.559812 (Thread-6): 15:16:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 15:16:20.573808 (Thread-6): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.574121 (Thread-6): 15:16:20  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 15:16:20.576787 (Thread-6): 15:16:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 15:16:20.591878 (Thread-6): 15:16:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 15:16:20.591994 (Thread-6): 15:16:20  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:20.592078 (Thread-6): 15:16:20  Opening a new connection, currently in state closed
2022-03-02 15:16:20.818588 (Thread-5): 15:16:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd00901c0>]}
2022-03-02 15:16:20.818982 (Thread-5): 15:16:20  6 of 19 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 3.12s]
2022-03-02 15:16:20.819110 (Thread-5): 15:16:20  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 15:16:20.819270 (Thread-5): 15:16:20  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 15:16:20.819457 (Thread-5): 15:16:20  10 of 19 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 15:16:20.819728 (Thread-5): 15:16:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 15:16:20.819825 (Thread-5): 15:16:20  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 15:16:20.819911 (Thread-5): 15:16:20  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 15:16:20.902900 (Thread-5): 15:16:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 15:16:20.939303 (Thread-5): 15:16:20  finished collecting timing info
2022-03-02 15:16:20.939473 (Thread-5): 15:16:20  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 15:16:20.942515 (Thread-5): 15:16:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 15:16:20.995435 (Thread-5): 15:16:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 15:16:20.995580 (Thread-5): 15:16:20  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:20.995703 (Thread-5): 15:16:20  Opening a new connection, currently in state closed
2022-03-02 15:16:22.249280 (Thread-526): handling poll request
2022-03-02 15:16:22.249680 (Thread-526): 15:16:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18495700>]}
2022-03-02 15:16:22.274696 (Thread-526): sending response (<Response 27487 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:22.761812 (Thread-3): 15:16:22  SQL status: SUCCESS 1 in 2.3 seconds
2022-03-02 15:16:22.763388 (Thread-3): 15:16:22  finished collecting timing info
2022-03-02 15:16:22.763547 (Thread-3): 15:16:22  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 15:16:22.850984 (Thread-6): 15:16:22  SQL status: SUCCESS 1 in 2.26 seconds
2022-03-02 15:16:22.852470 (Thread-6): 15:16:22  finished collecting timing info
2022-03-02 15:16:22.852627 (Thread-6): 15:16:22  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 15:16:22.993127 (Thread-3): 15:16:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2fcc640>]}
2022-03-02 15:16:22.993548 (Thread-3): 15:16:22  7 of 19 OK created incremental model DBT_VAULT.hub_part......................... [SUCCESS 1 in 2.57s]
2022-03-02 15:16:22.993676 (Thread-3): 15:16:22  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 15:16:22.993825 (Thread-3): 15:16:22  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 15:16:22.994006 (Thread-3): 15:16:22  11 of 19 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 15:16:22.994242 (Thread-3): 15:16:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 15:16:22.994330 (Thread-3): 15:16:22  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 15:16:22.994418 (Thread-3): 15:16:22  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 15:16:23.003083 (Thread-3): 15:16:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 15:16:23.015585 (Thread-3): 15:16:23  finished collecting timing info
2022-03-02 15:16:23.015787 (Thread-3): 15:16:23  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 15:16:23.019130 (Thread-3): 15:16:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 15:16:23.031431 (Thread-3): 15:16:23  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 15:16:23.031557 (Thread-3): 15:16:23  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:23.031678 (Thread-3): 15:16:23  Opening a new connection, currently in state closed
2022-03-02 15:16:23.125726 (Thread-4): 15:16:23  SQL status: SUCCESS 1 in 2.59 seconds
2022-03-02 15:16:23.127189 (Thread-4): 15:16:23  finished collecting timing info
2022-03-02 15:16:23.127347 (Thread-4): 15:16:23  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 15:16:23.238079 (Thread-5): 15:16:23  SQL status: SUCCESS 1 in 2.24 seconds
2022-03-02 15:16:23.239566 (Thread-5): 15:16:23  finished collecting timing info
2022-03-02 15:16:23.239754 (Thread-5): 15:16:23  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 15:16:23.486328 (Thread-5): 15:16:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd00a2070>]}
2022-03-02 15:16:23.486757 (Thread-5): 15:16:23  10 of 19 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 2.67s]
2022-03-02 15:16:23.486884 (Thread-5): 15:16:23  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 15:16:23.487027 (Thread-5): 15:16:23  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 15:16:23.487211 (Thread-5): 15:16:23  12 of 19 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 15:16:23.487445 (Thread-5): 15:16:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 15:16:23.487534 (Thread-5): 15:16:23  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 15:16:23.487656 (Thread-5): 15:16:23  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 15:16:23.495573 (Thread-5): 15:16:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 15:16:23.507724 (Thread-5): 15:16:23  finished collecting timing info
2022-03-02 15:16:23.507873 (Thread-5): 15:16:23  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 15:16:23.510813 (Thread-5): 15:16:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 15:16:23.523797 (Thread-5): 15:16:23  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 15:16:23.523917 (Thread-5): 15:16:23  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:23.524005 (Thread-5): 15:16:23  Opening a new connection, currently in state closed
2022-03-02 15:16:23.730376 (Thread-6): 15:16:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2fd4220>]}
2022-03-02 15:16:23.730808 (Thread-6): 15:16:23  9 of 19 OK created incremental model DBT_VAULT.hub_supplier..................... [SUCCESS 1 in 3.18s]
2022-03-02 15:16:23.730934 (Thread-6): 15:16:23  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 15:16:23.731090 (Thread-6): 15:16:23  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 15:16:23.731270 (Thread-6): 15:16:23  13 of 19 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 15:16:23.731515 (Thread-6): 15:16:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 15:16:23.731639 (Thread-6): 15:16:23  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 15:16:23.731733 (Thread-6): 15:16:23  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 15:16:23.743074 (Thread-6): 15:16:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 15:16:23.744610 (Thread-4): 15:16:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2fcc580>]}
2022-03-02 15:16:23.745017 (Thread-4): 15:16:23  8 of 19 OK created incremental model DBT_VAULT.hub_region....................... [SUCCESS 1 in 3.25s]
2022-03-02 15:16:23.745135 (Thread-4): 15:16:23  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 15:16:23.745269 (Thread-4): 15:16:23  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:16:23.745471 (Thread-4): 15:16:23  14 of 19 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 15:16:23.745695 (Thread-4): 15:16:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:16:23.745782 (Thread-4): 15:16:23  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:16:23.745865 (Thread-4): 15:16:23  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:16:23.753248 (Thread-4): 15:16:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:16:23.763156 (Thread-6): 15:16:23  finished collecting timing info
2022-03-02 15:16:23.763304 (Thread-6): 15:16:23  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 15:16:23.766251 (Thread-6): 15:16:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 15:16:23.796849 (Thread-4): 15:16:23  finished collecting timing info
2022-03-02 15:16:23.797073 (Thread-4): 15:16:23  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:16:23.800709 (Thread-4): 15:16:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:16:23.817896 (Thread-6): 15:16:23  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 15:16:23.818056 (Thread-6): 15:16:23  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:23.818148 (Thread-6): 15:16:23  Opening a new connection, currently in state closed
2022-03-02 15:16:23.834892 (Thread-4): 15:16:23  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 15:16:23.835042 (Thread-4): 15:16:23  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:23.835133 (Thread-4): 15:16:23  Opening a new connection, currently in state closed
2022-03-02 15:16:24.063960 (Thread-527): handling poll request
2022-03-02 15:16:24.064329 (Thread-527): 15:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184a08e0>]}
2022-03-02 15:16:24.065548 (Thread-527): sending response (<Response 35432 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:24.983707 (Thread-3): 15:16:24  SQL status: SUCCESS 1 in 1.95 seconds
2022-03-02 15:16:24.985256 (Thread-3): 15:16:24  finished collecting timing info
2022-03-02 15:16:24.985418 (Thread-3): 15:16:24  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 15:16:25.224648 (Thread-3): 15:16:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2f7ce50>]}
2022-03-02 15:16:25.225091 (Thread-3): 15:16:25  11 of 19 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 2.23s]
2022-03-02 15:16:25.225222 (Thread-3): 15:16:25  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 15:16:25.225371 (Thread-3): 15:16:25  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:16:25.225564 (Thread-3): 15:16:25  15 of 19 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 15:16:25.225816 (Thread-3): 15:16:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:16:25.225905 (Thread-3): 15:16:25  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:16:25.225998 (Thread-3): 15:16:25  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:16:25.261374 (Thread-3): 15:16:25  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:16:25.276070 (Thread-3): 15:16:25  finished collecting timing info
2022-03-02 15:16:25.276399 (Thread-3): 15:16:25  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:16:25.279453 (Thread-3): 15:16:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:16:25.293302 (Thread-3): 15:16:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 15:16:25.293419 (Thread-3): 15:16:25  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:25.293509 (Thread-3): 15:16:25  Opening a new connection, currently in state closed
2022-03-02 15:16:25.519370 (Thread-5): 15:16:25  SQL status: SUCCESS 1 in 2.0 seconds
2022-03-02 15:16:25.520940 (Thread-5): 15:16:25  finished collecting timing info
2022-03-02 15:16:25.521103 (Thread-5): 15:16:25  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 15:16:25.782549 (Thread-5): 15:16:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb15e4e50>]}
2022-03-02 15:16:25.782980 (Thread-5): 15:16:25  12 of 19 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.30s]
2022-03-02 15:16:25.783108 (Thread-5): 15:16:25  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 15:16:25.783259 (Thread-5): 15:16:25  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:16:25.783446 (Thread-5): 15:16:25  16 of 19 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 15:16:25.783730 (Thread-5): 15:16:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:16:25.783827 (Thread-5): 15:16:25  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:16:25.783916 (Thread-5): 15:16:25  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:16:25.796062 (Thread-5): 15:16:25  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:16:25.799430 (Thread-4): 15:16:25  SQL status: SUCCESS 1 in 1.96 seconds
2022-03-02 15:16:25.800766 (Thread-4): 15:16:25  finished collecting timing info
2022-03-02 15:16:25.800904 (Thread-4): 15:16:25  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 15:16:25.850610 (Thread-528): handling poll request
2022-03-02 15:16:25.850978 (Thread-528): 15:16:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184a27f0>]}
2022-03-02 15:16:25.852048 (Thread-528): sending response (<Response 15728 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:25.809438 (Thread-5): 15:16:25  finished collecting timing info
2022-03-02 15:16:25.809582 (Thread-5): 15:16:25  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:16:25.868863 (Thread-6): 15:16:25  SQL status: SUCCESS 1 in 2.05 seconds
2022-03-02 15:16:25.870279 (Thread-6): 15:16:25  finished collecting timing info
2022-03-02 15:16:25.870429 (Thread-6): 15:16:25  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 15:16:25.876584 (Thread-5): 15:16:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:16:25.890423 (Thread-5): 15:16:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 15:16:25.890556 (Thread-5): 15:16:25  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:25.890644 (Thread-5): 15:16:25  Opening a new connection, currently in state closed
2022-03-02 15:16:26.010208 (Thread-4): 15:16:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb1652f10>]}
2022-03-02 15:16:26.010597 (Thread-4): 15:16:26  14 of 19 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 2.26s]
2022-03-02 15:16:26.010724 (Thread-4): 15:16:26  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 15:16:26.010866 (Thread-4): 15:16:26  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:16:26.011046 (Thread-4): 15:16:26  17 of 19 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 15:16:26.011282 (Thread-4): 15:16:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:16:26.011368 (Thread-4): 15:16:26  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:16:26.011454 (Thread-4): 15:16:26  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:16:26.024438 (Thread-4): 15:16:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:16:26.036307 (Thread-4): 15:16:26  finished collecting timing info
2022-03-02 15:16:26.036457 (Thread-4): 15:16:26  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:16:26.039350 (Thread-4): 15:16:26  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:16:26.052927 (Thread-4): 15:16:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 15:16:26.053051 (Thread-4): 15:16:26  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:26.053140 (Thread-4): 15:16:26  Opening a new connection, currently in state closed
2022-03-02 15:16:26.082474 (Thread-6): 15:16:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb165cfa0>]}
2022-03-02 15:16:26.082814 (Thread-6): 15:16:26  13 of 19 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 2.35s]
2022-03-02 15:16:26.082934 (Thread-6): 15:16:26  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 15:16:26.083079 (Thread-6): 15:16:26  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:16:26.083261 (Thread-6): 15:16:26  18 of 19 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 15:16:26.083489 (Thread-6): 15:16:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:16:26.083576 (Thread-6): 15:16:26  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:16:26.083697 (Thread-6): 15:16:26  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:16:26.097601 (Thread-6): 15:16:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:16:26.124872 (Thread-6): 15:16:26  finished collecting timing info
2022-03-02 15:16:26.125027 (Thread-6): 15:16:26  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:16:26.127715 (Thread-6): 15:16:26  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:16:26.160109 (Thread-6): 15:16:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 15:16:26.160235 (Thread-6): 15:16:26  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:26.160323 (Thread-6): 15:16:26  Opening a new connection, currently in state closed
2022-03-02 15:16:27.143359 (Thread-3): 15:16:27  SQL status: SUCCESS 1 in 1.85 seconds
2022-03-02 15:16:27.144926 (Thread-3): 15:16:27  finished collecting timing info
2022-03-02 15:16:27.145090 (Thread-3): 15:16:27  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 15:16:27.380054 (Thread-3): 15:16:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb1667a30>]}
2022-03-02 15:16:27.380478 (Thread-3): 15:16:27  15 of 19 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 2.15s]
2022-03-02 15:16:27.380606 (Thread-3): 15:16:27  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 15:16:27.380755 (Thread-3): 15:16:27  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:16:27.380941 (Thread-3): 15:16:27  19 of 19 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 15:16:27.381198 (Thread-3): 15:16:27  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:16:27.381295 (Thread-3): 15:16:27  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:16:27.381387 (Thread-3): 15:16:27  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:16:27.395185 (Thread-3): 15:16:27  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:16:27.408072 (Thread-3): 15:16:27  finished collecting timing info
2022-03-02 15:16:27.408228 (Thread-3): 15:16:27  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:16:27.412206 (Thread-3): 15:16:27  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:16:27.425454 (Thread-3): 15:16:27  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 15:16:27.425585 (Thread-3): 15:16:27  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 15:16:27.425675 (Thread-3): 15:16:27  Opening a new connection, currently in state closed
2022-03-02 15:16:27.617193 (Thread-5): 15:16:27  SQL status: SUCCESS 1 in 1.73 seconds
2022-03-02 15:16:27.618723 (Thread-5): 15:16:27  finished collecting timing info
2022-03-02 15:16:27.618885 (Thread-5): 15:16:27  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 15:16:27.639191 (Thread-529): handling poll request
2022-03-02 15:16:27.639560 (Thread-529): 15:16:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184b77c0>]}
2022-03-02 15:16:27.640651 (Thread-529): sending response (<Response 30193 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:27.908524 (Thread-5): 15:16:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb166be50>]}
2022-03-02 15:16:27.908956 (Thread-5): 15:16:27  16 of 19 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 2.12s]
2022-03-02 15:16:27.909088 (Thread-5): 15:16:27  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 15:16:27.958804 (Thread-4): 15:16:27  SQL status: SUCCESS 1 in 1.91 seconds
2022-03-02 15:16:27.960276 (Thread-4): 15:16:27  finished collecting timing info
2022-03-02 15:16:27.960423 (Thread-4): 15:16:27  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 15:16:28.066299 (Thread-6): 15:16:28  SQL status: SUCCESS 1 in 1.91 seconds
2022-03-02 15:16:28.067782 (Thread-6): 15:16:28  finished collecting timing info
2022-03-02 15:16:28.067941 (Thread-6): 15:16:28  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 15:16:28.168272 (Thread-4): 15:16:28  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2f6c4c0>]}
2022-03-02 15:16:28.168660 (Thread-4): 15:16:28  17 of 19 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.16s]
2022-03-02 15:16:28.168785 (Thread-4): 15:16:28  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 15:16:28.301158 (Thread-6): 15:16:28  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb2f92c70>]}
2022-03-02 15:16:28.301572 (Thread-6): 15:16:28  18 of 19 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 2.22s]
2022-03-02 15:16:28.301696 (Thread-6): 15:16:28  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 15:16:28.999419 (Thread-3): 15:16:28  SQL status: SUCCESS 1 in 1.57 seconds
2022-03-02 15:16:29.000977 (Thread-3): 15:16:29  finished collecting timing info
2022-03-02 15:16:29.001162 (Thread-3): 15:16:29  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 15:16:29.167688 (Thread-530): handling poll request
2022-03-02 15:16:29.168065 (Thread-530): 15:16:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18440130>]}
2022-03-02 15:16:29.168709 (Thread-530): sending response (<Response 8249 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:29.205681 (Thread-3): 15:16:29  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568453ba-0f50-4ae7-be45-fae7792f49e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd008abb0>]}
2022-03-02 15:16:29.206094 (Thread-3): 15:16:29  19 of 19 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 1.82s]
2022-03-02 15:16:29.206222 (Thread-3): 15:16:29  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 15:16:29.207840 (MainThread): 15:16:29  Acquiring new snowflake connection "master"
2022-03-02 15:16:29.208246 (MainThread): 15:16:29  
2022-03-02 15:16:29.208354 (MainThread): 15:16:29  Finished running 2 table models, 17 incremental models in 31.47s.
2022-03-02 15:16:29.208442 (MainThread): 15:16:29  Connection 'master' was properly closed.
2022-03-02 15:16:29.208511 (MainThread): 15:16:29  Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
2022-03-02 15:16:29.208575 (MainThread): 15:16:29  Connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details' was properly closed.
2022-03-02 15:16:29.208636 (MainThread): 15:16:29  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 15:16:29.208696 (MainThread): 15:16:29  Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
2022-03-02 15:16:29.289118 (MainThread): 15:16:29  
2022-03-02 15:16:29.289341 (MainThread): 15:16:29  Completed successfully
2022-03-02 15:16:29.289463 (MainThread): 15:16:29  
2022-03-02 15:16:29.289558 (MainThread): 15:16:29  Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
2022-03-02 15:16:30.988574 (Thread-531): handling poll request
2022-03-02 15:16:30.988970 (Thread-531): 15:16:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184531c0>]}
2022-03-02 15:16:30.991514 (Thread-531): sending response (<Response 94395 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:32.503199 (Thread-532): handling status request
2022-03-02 15:16:32.503588 (Thread-532): 15:16:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b184b7580>]}
2022-03-02 15:16:32.504149 (Thread-532): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:32.511556 (Thread-533): handling status request
2022-03-02 15:16:32.514253 (Thread-533): 15:16:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18459e80>]}
2022-03-02 15:16:32.514690 (Thread-533): sending response (<Response 1942 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:34.342332 (Thread-534): handling status request
2022-03-02 15:16:34.342751 (Thread-534): 15:16:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18460d00>]}
2022-03-02 15:16:34.343247 (Thread-534): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:34.350210 (Thread-535): handling list request
2022-03-02 15:16:34.350475 (Thread-535): 15:16:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18468a30>]}
2022-03-02 15:16:34.384378 (Thread-535): 15:16:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18459a00>]}
2022-03-02 15:16:34.384706 (Thread-535): 15:16:34  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:16:34.389176 (Thread-535): sending response (<Response 5518 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:34.476919 (Thread-536): handling status request
2022-03-02 15:16:34.477240 (Thread-536): 15:16:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b187523a0>]}
2022-03-02 15:16:34.477697 (Thread-536): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:34.494286 (Thread-537): handling list request
2022-03-02 15:16:34.494538 (Thread-537): 15:16:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18501f40>]}
2022-03-02 15:16:34.530219 (Thread-537): 15:16:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18459040>]}
2022-03-02 15:16:34.530495 (Thread-537): 15:16:34  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:16:34.535153 (Thread-537): sending response (<Response 16923 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:51.376654 (Thread-538): handling status request
2022-03-02 15:16:51.377020 (Thread-538): 15:16:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18420130>]}
2022-03-02 15:16:51.377492 (Thread-538): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:16:51.384344 (Thread-539): handling list request
2022-03-02 15:16:51.384638 (Thread-539): 15:16:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1844d6a0>]}
2022-03-02 15:16:51.417674 (Thread-539): 15:16:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1848c9a0>]}
2022-03-02 15:16:51.417991 (Thread-539): 15:16:51  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:16:51.423489 (Thread-539): sending response (<Response 23533 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:17:45.703817 (Thread-540): handling status request
2022-03-02 15:17:45.704204 (Thread-540): 15:17:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b183ce910>]}
2022-03-02 15:17:45.704713 (Thread-540): sending response (<Response 1920 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:17:45.720687 (Thread-541): handling list request
2022-03-02 15:17:45.720943 (Thread-541): 15:17:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b183cec10>]}
2022-03-02 15:17:45.761971 (Thread-541): 15:17:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18420af0>]}
2022-03-02 15:17:45.762306 (Thread-541): 15:17:45  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:17:45.771330 (Thread-541): sending response (<Response 23533 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:01.841717 (Thread-542): 15:18:01  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:18:01.842023 (Thread-542): 15:18:01  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:18:01.850909 (Thread-542): 15:18:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1818bfd0>]}
2022-03-02 15:18:02.625005 (Thread-543): handling status request
2022-03-02 15:18:02.625400 (Thread-543): 15:18:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18345400>]}
2022-03-02 15:18:02.625898 (Thread-543): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:02.709751 (Thread-544): handling status request
2022-03-02 15:18:02.710120 (Thread-544): 15:18:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18345be0>]}
2022-03-02 15:18:02.710590 (Thread-544): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:06.905746 (Thread-545): handling status request
2022-03-02 15:18:06.906113 (Thread-545): 15:18:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18460d00>]}
2022-03-02 15:18:06.906567 (Thread-545): sending response (<Response 1222 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:06.913507 (Thread-546): handling list request
2022-03-02 15:18:06.913755 (Thread-546): 15:18:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18409c70>]}
2022-03-02 15:18:06.953697 (Thread-546): 15:18:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18345d60>]}
2022-03-02 15:18:06.953993 (Thread-546): 15:18:06  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:18:06.957353 (Thread-546): sending response (<Response 5471 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:07.224918 (Thread-547): handling status request
2022-03-02 15:18:07.225278 (Thread-547): 15:18:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b38324760>]}
2022-03-02 15:18:07.225729 (Thread-547): sending response (<Response 1222 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:07.232748 (Thread-548): handling list request
2022-03-02 15:18:07.232994 (Thread-548): 15:18:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18337eb0>]}
2022-03-02 15:18:07.265791 (Thread-548): 15:18:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18350850>]}
2022-03-02 15:18:07.266090 (Thread-548): 15:18:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:18:07.269404 (Thread-548): sending response (<Response 5518 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:08.272996 (Thread-549): handling status request
2022-03-02 15:18:08.273384 (Thread-549): 15:18:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1818c5b0>]}
2022-03-02 15:18:08.274143 (Thread-549): sending response (<Response 1222 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:08.281590 (Thread-550): handling list request
2022-03-02 15:18:08.281849 (Thread-550): 15:18:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18438190>]}
2022-03-02 15:18:08.343063 (Thread-550): 15:18:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1818cb50>]}
2022-03-02 15:18:08.343421 (Thread-550): 15:18:08  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:18:08.348354 (Thread-550): sending response (<Response 16923 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:09.488866 (Thread-551): handling status request
2022-03-02 15:18:09.489253 (Thread-551): 15:18:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1818c820>]}
2022-03-02 15:18:09.489729 (Thread-551): sending response (<Response 1222 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:09.496934 (Thread-552): handling list request
2022-03-02 15:18:09.497174 (Thread-552): 15:18:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1818dcd0>]}
2022-03-02 15:18:09.533371 (Thread-552): 15:18:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b181861c0>]}
2022-03-02 15:18:09.533687 (Thread-552): 15:18:09  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:18:09.540298 (Thread-552): sending response (<Response 23533 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:10.232389 (Thread-553): handling status request
2022-03-02 15:18:10.232753 (Thread-553): 15:18:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b181ae640>]}
2022-03-02 15:18:10.233211 (Thread-553): sending response (<Response 1222 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:10.240724 (Thread-554): handling list request
2022-03-02 15:18:10.240964 (Thread-554): 15:18:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b181ae940>]}
2022-03-02 15:18:10.278255 (Thread-554): 15:18:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18255e50>]}
2022-03-02 15:18:10.278545 (Thread-554): 15:18:10  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:18:10.281815 (Thread-554): sending response (<Response 5495 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:11.923026 (Thread-555): handling status request
2022-03-02 15:18:11.923410 (Thread-555): 15:18:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18144610>]}
2022-03-02 15:18:11.923963 (Thread-555): sending response (<Response 1222 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:11.930807 (Thread-556): handling list request
2022-03-02 15:18:11.931070 (Thread-556): 15:18:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18144fd0>]}
2022-03-02 15:18:11.963156 (Thread-556): 15:18:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18144a30>]}
2022-03-02 15:18:11.963450 (Thread-556): 15:18:11  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:18:11.966183 (Thread-556): 15:18:11  The selection criterion '+1646234291534/__unsaved/Statement' does not match any nodes
2022-03-02 15:18:11.966478 (Thread-556): 15:18:11  The selection criterion '17.sql+' does not match any nodes
2022-03-02 15:18:11.966599 (Thread-556): 15:18:11  No nodes selected!
2022-03-02 15:18:11.968189 (Thread-556): sending response (<Response 2355 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:44.473362 (Thread-557): handling status request
2022-03-02 15:18:44.473733 (Thread-557): 15:18:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18255340>]}
2022-03-02 15:18:44.474199 (Thread-557): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:44.485652 (Thread-558): handling ps request
2022-03-02 15:18:44.485942 (Thread-558): 15:18:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b180fb550>]}
2022-03-02 15:18:44.490274 (Thread-558): sending response (<Response 41933 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:44.674795 (Thread-559): handling status request
2022-03-02 15:18:44.675176 (Thread-559): 15:18:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18144e80>]}
2022-03-02 15:18:44.675695 (Thread-559): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:44.920460 (Thread-560): handling status request
2022-03-02 15:18:44.920817 (Thread-560): 15:18:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b180fba90>]}
2022-03-02 15:18:44.921267 (Thread-560): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:49.491445 (Thread-561): handling poll request
2022-03-02 15:18:49.491861 (Thread-561): 15:18:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b180fbe80>]}
2022-03-02 15:18:49.497824 (Thread-561): sending response (<Response 279252 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:51.221576 (Thread-562): handling status request
2022-03-02 15:18:51.221984 (Thread-562): 15:18:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18438d60>]}
2022-03-02 15:18:51.222442 (Thread-562): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:18:51.224436 (Thread-563): handling status request
2022-03-02 15:18:51.224678 (Thread-563): 15:18:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b180fbf40>]}
2022-03-02 15:18:51.225024 (Thread-563): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:19:05.430924 (Thread-564): handling status request
2022-03-02 15:19:05.431296 (Thread-564): 15:19:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b180fbbb0>]}
2022-03-02 15:19:05.431783 (Thread-564): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:19:12.565610 (Thread-565): 15:19:12  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:19:12.565887 (Thread-565): 15:19:12  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:19:12.572780 (Thread-565): 15:19:12  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af86d2a90>]}
2022-03-02 15:19:14.088356 (Thread-566): handling status request
2022-03-02 15:19:14.088731 (Thread-566): 15:19:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b180fbf40>]}
2022-03-02 15:19:14.089214 (Thread-566): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:19:14.227190 (Thread-567): handling status request
2022-03-02 15:19:14.227571 (Thread-567): 15:19:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b18193280>]}
2022-03-02 15:19:14.228079 (Thread-567): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:19:27.320957 (Thread-568): handling status request
2022-03-02 15:19:27.321338 (Thread-568): 15:19:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b181a3fa0>]}
2022-03-02 15:19:27.321807 (Thread-568): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:19:28.966808 (Thread-569): 15:19:28  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:19:28.967039 (Thread-569): 15:19:28  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:19:28.973978 (Thread-569): 15:19:28  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af8550eb0>]}
2022-03-02 15:19:29.999918 (Thread-570): handling status request
2022-03-02 15:19:30.000308 (Thread-570): 15:19:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af86c89a0>]}
2022-03-02 15:19:30.000834 (Thread-570): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:19:30.210374 (Thread-571): handling status request
2022-03-02 15:19:30.210784 (Thread-571): 15:19:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4fe95458-3111-4a7d-884c-ef217a443f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af86c8640>]}
2022-03-02 15:19:30.211334 (Thread-571): sending response (<Response 1244 bytes [200 OK]>) to 10.0.41.177
2022-03-02 15:23:32.894091 (MainThread): Running with dbt=1.0.3
2022-03-02 15:23:33.098875 (MainThread): 15:23:33  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 15:23:33.099130 (MainThread): 15:23:33  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9256c70>]}
2022-03-02 15:23:33.099368 (MainThread): 15:23:33  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 15:23:33.099513 (MainThread): 15:23:33  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9254730>]}
2022-03-02 15:23:33.127242 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-02 15:23:33.130475 (MainThread): Tracking: tracking
2022-03-02 15:23:33.130807 (MainThread): 15:23:33  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9256d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0beb7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc92546d0>]}
2022-03-02 15:23:33.132017 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-03-02 15:23:33.138003 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-02 15:23:33.138268 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-02 15:23:33.896378 (Thread-12): 15:23:33  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:23:33.896655 (Thread-12): 15:23:33  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:23:33.904655 (Thread-12): 15:23:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc2feb700>]}
2022-03-02 15:23:50.025897 (Thread-13): handling status request
2022-03-02 15:23:50.026572 (Thread-13): 15:23:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9219880>]}
2022-03-02 15:23:50.027105 (Thread-14): handling status request
2022-03-02 15:23:50.027804 (Thread-13): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:50.028132 (Thread-14): 15:23:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8113400>]}
2022-03-02 15:23:50.029085 (Thread-14): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:50.172907 (Thread-15): handling ps request
2022-03-02 15:23:50.173281 (Thread-15): 15:23:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9219880>]}
2022-03-02 15:23:50.173762 (Thread-15): sending response (<Response 105 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:50.307815 (Thread-16): handling status request
2022-03-02 15:23:50.308173 (Thread-16): 15:23:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8113af0>]}
2022-03-02 15:23:50.308645 (Thread-16): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:58.689362 (Thread-17): handling status request
2022-03-02 15:23:58.689758 (Thread-17): 15:23:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc81131f0>]}
2022-03-02 15:23:58.690290 (Thread-17): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:58.706203 (Thread-18): handling status request
2022-03-02 15:23:58.706493 (Thread-18): 15:23:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8117220>]}
2022-03-02 15:23:58.706913 (Thread-18): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:58.795257 (Thread-19): handling ps request
2022-03-02 15:23:58.795615 (Thread-19): 15:23:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8117fd0>]}
2022-03-02 15:23:58.796022 (Thread-19): sending response (<Response 105 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:23:58.841665 (Thread-20): handling status request
2022-03-02 15:23:58.842079 (Thread-20): 15:23:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8117df0>]}
2022-03-02 15:23:58.842537 (Thread-20): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:01.122971 (Thread-21): handling status request
2022-03-02 15:24:01.123355 (Thread-21): 15:24:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8117a00>]}
2022-03-02 15:24:01.123805 (Thread-21): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:01.863407 (Thread-22): handling status request
2022-03-02 15:24:01.863777 (Thread-22): 15:24:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc81177f0>]}
2022-03-02 15:24:01.864266 (Thread-22): sending response (<Response 1219 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:01.870095 (Thread-23): handling list request
2022-03-02 15:24:01.870333 (Thread-23): 15:24:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc8117550>]}
2022-03-02 15:24:01.913791 (Thread-23): 15:24:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9287ac0>]}
2022-03-02 15:24:01.914189 (Thread-23): 15:24:01  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:24:01.917576 (Thread-23): 15:24:01  The selection criterion '+1646234641429/__unsaved/Statement' does not match any nodes
2022-03-02 15:24:01.917865 (Thread-23): 15:24:01  The selection criterion '5.sql+' does not match any nodes
2022-03-02 15:24:01.918013 (Thread-23): 15:24:01  No nodes selected!
2022-03-02 15:24:01.919655 (Thread-23): sending response (<Response 2349 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:21.923245 (Thread-24): handling status request
2022-03-02 15:24:21.924962 (Thread-24): 15:24:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc81172b0>]}
2022-03-02 15:24:21.925433 (Thread-24): sending response (<Response 1219 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:21.931069 (Thread-25): handling list request
2022-03-02 15:24:21.931312 (Thread-25): 15:24:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9260850>]}
2022-03-02 15:24:21.964585 (Thread-25): 15:24:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc81179d0>]}
2022-03-02 15:24:21.964861 (Thread-25): 15:24:21  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:24:21.971439 (Thread-25): sending response (<Response 14588 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:40.874458 (Thread-26): handling status request
2022-03-02 15:24:40.874852 (Thread-26): 15:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc81135b0>]}
2022-03-02 15:24:40.875338 (Thread-26): sending response (<Response 1219 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:40.892137 (Thread-27): handling list request
2022-03-02 15:24:40.892469 (Thread-27): 15:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc2febcd0>]}
2022-03-02 15:24:40.925399 (Thread-27): 15:24:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc92607f0>]}
2022-03-02 15:24:40.925758 (Thread-27): 15:24:40  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:24:40.927513 (Thread-27): 15:24:40  The selection criterion '+1646234641429/__unsaved/Statement' does not match any nodes
2022-03-02 15:24:40.927818 (Thread-27): 15:24:40  The selection criterion '5.sql+' does not match any nodes
2022-03-02 15:24:40.927932 (Thread-27): 15:24:40  No nodes selected!
2022-03-02 15:24:40.929471 (Thread-27): sending response (<Response 2349 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:46.073530 (Thread-28): handling status request
2022-03-02 15:24:46.074032 (Thread-28): 15:24:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc2ff7cd0>]}
2022-03-02 15:24:46.074531 (Thread-28): sending response (<Response 1219 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:24:46.080971 (Thread-29): handling list request
2022-03-02 15:24:46.081296 (Thread-29): 15:24:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9224b50>]}
2022-03-02 15:24:46.114697 (Thread-29): 15:24:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc2feb4c0>]}
2022-03-02 15:24:46.115069 (Thread-29): 15:24:46  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:24:46.123192 (Thread-29): sending response (<Response 14588 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:00.287090 (Thread-30): handling status request
2022-03-02 15:26:00.288808 (Thread-30): 15:26:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9224040>]}
2022-03-02 15:26:00.289341 (Thread-30): sending response (<Response 1219 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:00.301068 (Thread-31): handling list request
2022-03-02 15:26:00.301329 (Thread-31): 15:26:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc173cc40>]}
2022-03-02 15:26:00.339232 (Thread-31): 15:26:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc2fbb490>]}
2022-03-02 15:26:00.339725 (Thread-31): 15:26:00  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:26:00.342304 (Thread-31): 15:26:00  The selection criterion '+1646234641429/__unsaved/Statement' does not match any nodes
2022-03-02 15:26:00.342622 (Thread-31): 15:26:00  The selection criterion '5.sql+' does not match any nodes
2022-03-02 15:26:00.342745 (Thread-31): 15:26:00  No nodes selected!
2022-03-02 15:26:00.344353 (Thread-31): sending response (<Response 2349 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:11.120294 (Thread-32): handling status request
2022-03-02 15:26:11.120683 (Thread-32): 15:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1742850>]}
2022-03-02 15:26:11.121168 (Thread-32): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:11.991787 (Thread-33): handling compile_sql request
2022-03-02 15:26:11.992161 (Thread-33): 15:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1742ee0>]}
2022-03-02 15:26:14.207546 (Thread-33): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:14.237031 (MainThread): 15:26:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8bf49ca-0bff-414a-a321-5bc964898b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e407f9160>]}
2022-03-02 15:26:14.237611 (MainThread): 15:26:14  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:26:14.238237 (Thread-1): 15:26:14  Acquiring new snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-02 15:26:14.238369 (Thread-1): 15:26:14  Began compiling node rpc.dbtvault_snowflake_demo.request
2022-03-02 15:26:14.238464 (Thread-1): 15:26:14  Compiling rpc.dbtvault_snowflake_demo.request
2022-03-02 15:26:14.240243 (Thread-1): 15:26:14  finished collecting timing info
2022-03-02 15:26:14.240377 (Thread-1): 15:26:14  Began executing node rpc.dbtvault_snowflake_demo.request
2022-03-02 15:26:14.240479 (Thread-1): 15:26:14  finished collecting timing info
2022-03-02 15:26:14.961518 (Thread-34): handling poll request
2022-03-02 15:26:14.962039 (Thread-34): 15:26:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1758700>]}
2022-03-02 15:26:14.963197 (Thread-34): sending response (<Response 5437 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:38.651309 (Thread-35): handling status request
2022-03-02 15:26:38.651689 (Thread-35): 15:26:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1758b20>]}
2022-03-02 15:26:38.652194 (Thread-35): sending response (<Response 1241 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:39.398236 (Thread-36): handling run_sql request
2022-03-02 15:26:39.398607 (Thread-36): 15:26:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1758f10>]}
2022-03-02 15:26:41.605965 (Thread-36): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:41.634092 (MainThread): 15:26:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f83438f-2564-4b5b-b7da-74a1938c376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4603392b0>]}
2022-03-02 15:26:41.634627 (MainThread): 15:26:41  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:26:41.635217 (Thread-1): 15:26:41  Acquiring new snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-02 15:26:41.635352 (Thread-1): 15:26:41  Began compiling node rpc.dbtvault_snowflake_demo.request
2022-03-02 15:26:41.635443 (Thread-1): 15:26:41  Compiling rpc.dbtvault_snowflake_demo.request
2022-03-02 15:26:41.636973 (Thread-1): 15:26:41  finished collecting timing info
2022-03-02 15:26:41.637108 (Thread-1): 15:26:41  Began executing node rpc.dbtvault_snowflake_demo.request
2022-03-02 15:26:41.637620 (Thread-1): 15:26:41  Using snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-02 15:26:41.637709 (Thread-1): 15:26:41  On rpc.dbtvault_snowflake_demo.request: SELECT
*
FROM
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER"
limit 500
/* limit added automatically by dbt cloud */
2022-03-02 15:26:41.637794 (Thread-1): 15:26:41  Opening a new connection, currently in state init
2022-03-02 15:26:42.374890 (Thread-37): handling poll request
2022-03-02 15:26:42.375742 (Thread-37): 15:26:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1760eb0>]}
2022-03-02 15:26:42.376580 (Thread-37): sending response (<Response 3851 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:43.809618 (Thread-1): 15:26:43  SQL status: SUCCESS 500 in 2.17 seconds
2022-03-02 15:26:43.823034 (Thread-1): 15:26:43  finished collecting timing info
2022-03-02 15:26:43.823303 (Thread-1): 15:26:43  On rpc.dbtvault_snowflake_demo.request: Close
2022-03-02 15:26:44.133588 (Thread-38): handling poll request
2022-03-02 15:26:44.134116 (Thread-38): 15:26:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc92246d0>]}
2022-03-02 15:26:44.134837 (Thread-38): sending response (<Response 1392 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:26:45.889578 (Thread-39): handling poll request
2022-03-02 15:26:45.889979 (Thread-39): 15:26:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1751cd0>]}
2022-03-02 15:26:45.893219 (Thread-39): sending response (<Response 94613 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:27:28.093385 (Thread-40): 15:27:28  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-03-02 15:27:28.093871 (Thread-40): 15:27:28  Partial parsing: added file: dbtvault_snowflake_demo://models/test.sql
2022-03-02 15:27:28.107154 (Thread-40): 15:27:28  1699: static parser successfully parsed test.sql
2022-03-02 15:27:28.173830 (Thread-40): 15:27:28  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc04c83d0>]}
2022-03-02 15:27:28.989777 (Thread-41): handling status request
2022-03-02 15:27:28.990211 (Thread-41): 15:27:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1751eb0>]}
2022-03-02 15:27:28.990730 (Thread-41): sending response (<Response 1541 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:27:28.994222 (Thread-42): handling status request
2022-03-02 15:27:28.994494 (Thread-42): 15:27:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc06f5910>]}
2022-03-02 15:27:28.994942 (Thread-42): sending response (<Response 1541 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:27:38.944184 (Thread-43): 15:27:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 15:27:38.945007 (Thread-43): 15:27:38  Partial parsing: updated file: dbtvault_snowflake_demo://models/test.sql
2022-03-02 15:27:38.953778 (Thread-43): 15:27:38  1699: static parser successfully parsed test.sql
2022-03-02 15:27:39.155416 (Thread-43): 15:27:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9219dc0>]}
2022-03-02 15:27:39.952302 (Thread-44): handling status request
2022-03-02 15:27:39.952708 (Thread-44): 15:27:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc04d9f70>]}
2022-03-02 15:27:39.953176 (Thread-44): sending response (<Response 1543 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:27:39.960179 (Thread-45): handling status request
2022-03-02 15:27:39.960435 (Thread-45): 15:27:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc04c6040>]}
2022-03-02 15:27:39.960819 (Thread-45): sending response (<Response 1543 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:27:59.717735 (Thread-46): handling status request
2022-03-02 15:27:59.718274 (Thread-46): 15:27:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1760d90>]}
2022-03-02 15:27:59.718943 (Thread-46): sending response (<Response 1543 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:00.302307 (Thread-47): handling status request
2022-03-02 15:28:00.302686 (Thread-47): 15:28:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc1760a30>]}
2022-03-02 15:28:00.303157 (Thread-47): sending response (<Response 1543 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:00.373093 (Thread-48): handling cli_args request
2022-03-02 15:28:00.373479 (Thread-48): 15:28:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc04d69a0>]}
2022-03-02 15:28:02.652785 (Thread-48): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:03.091171 (MainThread): 15:28:03  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:28:03.091631 (MainThread): 15:28:03  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:28:03.099321 (MainThread): 15:28:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49896515-c3b3-474f-8c9a-e4ef3161bfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d15ee910>]}
2022-03-02 15:28:03.133296 (MainThread): 15:28:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49896515-c3b3-474f-8c9a-e4ef3161bfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d16c67c0>]}
2022-03-02 15:28:03.133975 (MainThread): 15:28:03  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:28:03.134794 (MainThread): 15:28:03  The selection criterion 'test.sql' does not match any nodes
2022-03-02 15:28:03.136871 (MainThread): 15:28:03  
2022-03-02 15:28:03.137048 (MainThread): 15:28:03  [WARNING]: Nothing to do. Try checking your model configs and model specification args
2022-03-02 15:28:03.405572 (Thread-49): handling poll request
2022-03-02 15:28:03.406066 (Thread-49): 15:28:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddc05ac70>]}
2022-03-02 15:28:03.407209 (Thread-49): sending response (<Response 3228 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:04.798793 (Thread-50): handling status request
2022-03-02 15:28:04.799166 (Thread-50): 15:28:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faddc05ac70>]}
2022-03-02 15:28:04.799677 (Thread-50): sending response (<Response 1543 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:05.054810 (Thread-51): handling status request
2022-03-02 15:28:05.055284 (Thread-51): 15:28:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc9229a30>]}
2022-03-02 15:28:05.055880 (Thread-51): sending response (<Response 1543 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:23.427974 (Thread-52): 15:28:23  Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-03-02 15:28:23.428475 (Thread-52): 15:28:23  Partial parsing: added file: dbtvault_snowflake_demo://models/test1.sql
2022-03-02 15:28:23.428636 (Thread-52): 15:28:23  Partial parsing: deleted file: dbtvault_snowflake_demo://models/test.sql
2022-03-02 15:28:23.435122 (Thread-52): 15:28:23  1699: static parser successfully parsed test1.sql
2022-03-02 15:28:23.491944 (Thread-52): 15:28:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc0501c40>]}
2022-03-02 15:28:24.227302 (Thread-53): handling status request
2022-03-02 15:28:24.227684 (Thread-53): 15:28:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc06404f0>]}
2022-03-02 15:28:24.228237 (Thread-53): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:24.233231 (Thread-54): handling status request
2022-03-02 15:28:24.233529 (Thread-54): 15:28:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc0640160>]}
2022-03-02 15:28:24.234010 (Thread-54): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:34.080318 (Thread-55): handling status request
2022-03-02 15:28:34.080692 (Thread-55): 15:28:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc04c6be0>]}
2022-03-02 15:28:34.081172 (Thread-55): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:34.849858 (Thread-56): handling run_sql request
2022-03-02 15:28:34.850273 (Thread-56): 15:28:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc04c68e0>]}
2022-03-02 15:28:37.192769 (Thread-56): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:37.224484 (MainThread): 15:28:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '021823db-2fdf-441b-b794-5ab6a441f4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570563d6d0>]}
2022-03-02 15:28:37.225085 (MainThread): 15:28:37  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:28:37.225764 (Thread-1): 15:28:37  Acquiring new snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-02 15:28:37.225945 (Thread-1): 15:28:37  Began compiling node rpc.dbtvault_snowflake_demo.request
2022-03-02 15:28:37.226082 (Thread-1): 15:28:37  Compiling rpc.dbtvault_snowflake_demo.request
2022-03-02 15:28:37.228184 (Thread-1): 15:28:37  finished collecting timing info
2022-03-02 15:28:37.228329 (Thread-1): 15:28:37  Began executing node rpc.dbtvault_snowflake_demo.request
2022-03-02 15:28:37.229066 (Thread-1): 15:28:37  Using snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-02 15:28:37.229169 (Thread-1): 15:28:37  On rpc.dbtvault_snowflake_demo.request: SELECT
*
FROM
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER"
limit 500
/* limit added automatically by dbt cloud */
2022-03-02 15:28:37.229293 (Thread-1): 15:28:37  Opening a new connection, currently in state init
2022-03-02 15:28:37.971427 (Thread-57): handling poll request
2022-03-02 15:28:37.971991 (Thread-57): 15:28:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc0596100>]}
2022-03-02 15:28:37.973043 (Thread-57): sending response (<Response 3834 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:38.507651 (Thread-1): 15:28:38  SQL status: SUCCESS 500 in 1.28 seconds
2022-03-02 15:28:38.523033 (Thread-1): 15:28:38  finished collecting timing info
2022-03-02 15:28:38.523319 (Thread-1): 15:28:38  On rpc.dbtvault_snowflake_demo.request: Close
2022-03-02 15:28:39.745706 (Thread-58): handling poll request
2022-03-02 15:28:39.746141 (Thread-58): 15:28:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada14786a0>]}
2022-03-02 15:28:39.749388 (Thread-58): sending response (<Response 95600 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:46.653872 (Thread-59): handling status request
2022-03-02 15:28:46.654277 (Thread-59): 15:28:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1478850>]}
2022-03-02 15:28:46.654818 (Thread-59): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:46.983024 (Thread-60): handling status request
2022-03-02 15:28:46.983400 (Thread-60): 15:28:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1478c40>]}
2022-03-02 15:28:46.983874 (Thread-60): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:47.274932 (Thread-61): handling cli_args request
2022-03-02 15:28:47.275347 (Thread-61): 15:28:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc0596100>]}
2022-03-02 15:28:49.592022 (Thread-61): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:50.258542 (MainThread): 15:28:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:28:50.258982 (MainThread): 15:28:50  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:28:50.266937 (MainThread): 15:28:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5331b54c-0a5f-4384-b92e-a1f4c34c24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe53f9ee880>]}
2022-03-02 15:28:50.301243 (MainThread): 15:28:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5331b54c-0a5f-4384-b92e-a1f4c34c24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe53fac9fa0>]}
2022-03-02 15:28:50.301566 (MainThread): 15:28:50  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:28:50.302108 (MainThread): 15:28:50  The selection criterion 'test.sql' does not match any nodes
2022-03-02 15:28:50.303436 (MainThread): 15:28:50  
2022-03-02 15:28:50.303569 (MainThread): 15:28:50  [WARNING]: Nothing to do. Try checking your model configs and model specification args
2022-03-02 15:28:50.347201 (Thread-62): handling poll request
2022-03-02 15:28:50.347645 (Thread-62): 15:28:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada147fd90>]}
2022-03-02 15:28:50.348493 (Thread-62): sending response (<Response 3108 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:52.179141 (Thread-63): handling poll request
2022-03-02 15:28:52.179550 (Thread-63): 15:28:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada147ffa0>]}
2022-03-02 15:28:52.205410 (Thread-63): sending response (<Response 423 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:53.645353 (Thread-64): handling status request
2022-03-02 15:28:53.645744 (Thread-64): 15:28:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1480070>]}
2022-03-02 15:28:53.646332 (Thread-64): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:53.901102 (Thread-65): handling status request
2022-03-02 15:28:53.901481 (Thread-65): 15:28:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada14808b0>]}
2022-03-02 15:28:53.902036 (Thread-65): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:57.568135 (Thread-66): handling status request
2022-03-02 15:28:57.568532 (Thread-66): 15:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1484dc0>]}
2022-03-02 15:28:57.569040 (Thread-66): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:57.875850 (Thread-67): handling status request
2022-03-02 15:28:57.876224 (Thread-67): 15:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1484760>]}
2022-03-02 15:28:57.876710 (Thread-67): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:28:58.096215 (Thread-68): handling cli_args request
2022-03-02 15:28:58.096569 (Thread-68): 15:28:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1484400>]}
2022-03-02 15:29:00.373239 (Thread-68): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:29:00.809273 (MainThread): 15:29:00  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 15:29:00.809701 (MainThread): 15:29:00  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 15:29:00.817329 (MainThread): 15:29:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2680d5b-5e3c-4595-91ad-6d056319219f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cafdef820>]}
2022-03-02 15:29:00.848127 (MainThread): 15:29:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2680d5b-5e3c-4595-91ad-6d056319219f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cafed2f40>]}
2022-03-02 15:29:00.848420 (MainThread): 15:29:00  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 15:29:00.848905 (MainThread): 15:29:00  The selection criterion 'test1.sql' does not match any nodes
2022-03-02 15:29:00.850177 (MainThread): 15:29:00  
2022-03-02 15:29:00.850289 (MainThread): 15:29:00  [WARNING]: Nothing to do. Try checking your model configs and model specification args
2022-03-02 15:29:01.157911 (Thread-69): handling poll request
2022-03-02 15:29:01.158402 (Thread-69): 15:29:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1499a00>]}
2022-03-02 15:29:01.159238 (Thread-69): sending response (<Response 3230 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:29:02.637268 (Thread-70): handling status request
2022-03-02 15:29:02.637665 (Thread-70): 15:29:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1499bb0>]}
2022-03-02 15:29:02.638244 (Thread-70): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 15:29:02.940210 (Thread-71): handling status request
2022-03-02 15:29:02.940707 (Thread-71): 15:29:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '11bf281b-0b82-45c3-bd22-141d7b261641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1499f70>]}
2022-03-02 15:29:02.941355 (Thread-71): sending response (<Response 1856 bytes [200 OK]>) to 10.0.12.141
2022-03-02 16:01:32.256626 (MainThread): Running with dbt=1.0.3
2022-03-02 16:01:32.479911 (MainThread): 16:01:32  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 16:01:32.480173 (MainThread): 16:01:32  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f942011d1c0>]}
2022-03-02 16:01:32.480427 (MainThread): 16:01:32  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 16:01:32.480588 (MainThread): 16:01:32  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420102250>]}
2022-03-02 16:01:32.509105 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-02 16:01:32.517901 (MainThread): Tracking: tracking
2022-03-02 16:01:32.518239 (MainThread): 16:01:32  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9434502130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f942011ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420102820>]}
2022-03-02 16:01:32.518574 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-03-02 16:01:32.524448 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-02 16:01:32.524659 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-02 16:01:33.749838 (Thread-12): 16:01:33  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:01:33.750103 (Thread-12): 16:01:33  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:01:33.758782 (Thread-12): 16:01:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f16522e0>]}
2022-03-02 16:01:35.867510 (Thread-13): handling status request
2022-03-02 16:01:35.867923 (Thread-13): 16:01:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420134040>]}
2022-03-02 16:01:35.868568 (Thread-13): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:01:36.068112 (Thread-14): handling status request
2022-03-02 16:01:36.068513 (Thread-14): 16:01:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420156700>]}
2022-03-02 16:01:36.068996 (Thread-14): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:01:36.076980 (Thread-15): handling status request
2022-03-02 16:01:36.077300 (Thread-15): 16:01:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420142190>]}
2022-03-02 16:01:36.077717 (Thread-15): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:01:36.197484 (Thread-16): handling ps request
2022-03-02 16:01:36.197857 (Thread-16): 16:01:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f942011ddc0>]}
2022-03-02 16:01:36.198312 (Thread-16): sending response (<Response 105 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:01:39.220577 (Thread-17): handling status request
2022-03-02 16:01:39.220973 (Thread-17): 16:01:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1636d30>]}
2022-03-02 16:01:39.221481 (Thread-17): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:02:36.758683 (Thread-18): handling status request
2022-03-02 16:02:36.761075 (Thread-18): 16:02:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1636a30>]}
2022-03-02 16:02:36.761642 (Thread-18): sending response (<Response 1219 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:02:36.767711 (Thread-19): handling list request
2022-03-02 16:02:36.767987 (Thread-19): 16:02:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1636790>]}
2022-03-02 16:02:36.813791 (Thread-19): 16:02:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201429d0>]}
2022-03-02 16:02:36.814186 (Thread-19): 16:02:36  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:02:36.820120 (Thread-19): sending response (<Response 5491 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:02:38.961028 (Thread-20): handling status request
2022-03-02 16:02:38.961474 (Thread-20): 16:02:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94000b01f0>]}
2022-03-02 16:02:38.961977 (Thread-20): sending response (<Response 1219 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:02:38.984850 (Thread-21): handling list request
2022-03-02 16:02:38.985222 (Thread-21): 16:02:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9400066d60>]}
2022-03-02 16:02:39.029670 (Thread-21): 16:02:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420134910>]}
2022-03-02 16:02:39.030079 (Thread-21): 16:02:39  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:02:39.035964 (Thread-21): sending response (<Response 5491 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:02:40.909080 (Thread-22): handling status request
2022-03-02 16:02:40.909518 (Thread-22): 16:02:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1634940>]}
2022-03-02 16:02:40.910000 (Thread-22): sending response (<Response 1219 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:02:40.915805 (Thread-23): handling list request
2022-03-02 16:02:40.916101 (Thread-23): 16:02:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1634f40>]}
2022-03-02 16:02:40.955332 (Thread-23): 16:02:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1636ca0>]}
2022-03-02 16:02:40.955758 (Thread-23): 16:02:40  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:02:40.966896 (Thread-23): sending response (<Response 5514 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:15.026089 (Thread-24): handling status request
2022-03-02 16:04:15.028345 (Thread-24): 16:04:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420155b20>]}
2022-03-02 16:04:15.028944 (Thread-24): sending response (<Response 1219 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:15.045089 (Thread-25): handling list request
2022-03-02 16:04:15.045476 (Thread-25): 16:04:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420157370>]}
2022-03-02 16:04:15.086399 (Thread-25): 16:04:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1634640>]}
2022-03-02 16:04:15.086764 (Thread-25): 16:04:15  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:04:15.097710 (Thread-25): sending response (<Response 5514 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:21.091853 (Thread-26): handling status request
2022-03-02 16:04:21.092196 (Thread-26): 16:04:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05bf550>]}
2022-03-02 16:04:21.092647 (Thread-26): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:21.393530 (Thread-27): handling status request
2022-03-02 16:04:21.393899 (Thread-27): 16:04:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05bf6a0>]}
2022-03-02 16:04:21.394362 (Thread-27): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:21.612865 (Thread-28): handling cli_args request
2022-03-02 16:04:21.613415 (Thread-28): 16:04:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05bf9d0>]}
2022-03-02 16:04:23.943401 (Thread-28): sending response (<Response 138 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:24.723408 (Thread-29): handling poll request
2022-03-02 16:04:24.723879 (Thread-29): 16:04:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05927c0>]}
2022-03-02 16:04:24.724663 (Thread-29): sending response (<Response 327 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:24.769823 (MainThread): 16:04:24  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:04:24.770268 (MainThread): 16:04:24  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:04:24.778596 (MainThread): 16:04:24  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '398708f9-55ed-4e44-8ca1-0119bf88102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454dab880>]}
2022-03-02 16:04:24.816044 (MainThread): 16:04:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '398708f9-55ed-4e44-8ca1-0119bf88102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454e98fa0>]}
2022-03-02 16:04:24.816338 (MainThread): 16:04:24  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:04:24.818251 (MainThread): 16:04:24  
2022-03-02 16:04:24.818735 (MainThread): 16:04:24  Acquiring new snowflake connection "master"
2022-03-02 16:04:24.819598 (ThreadPoolExecutor-0_0): 16:04:24  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 16:04:24.833624 (ThreadPoolExecutor-0_0): 16:04:24  Using snowflake connection "list_DBT_RAW"
2022-03-02 16:04:24.833742 (ThreadPoolExecutor-0_0): 16:04:24  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 16:04:24.833827 (ThreadPoolExecutor-0_0): 16:04:24  Opening a new connection, currently in state init
2022-03-02 16:04:26.128027 (ThreadPoolExecutor-0_0): 16:04:26  SQL status: SUCCESS 6 in 1.29 seconds
2022-03-02 16:04:26.130057 (ThreadPoolExecutor-0_0): 16:04:26  On list_DBT_RAW: Close
2022-03-02 16:04:26.368928 (ThreadPoolExecutor-0_0): 16:04:26  Acquiring new snowflake connection "create_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:26.369194 (ThreadPoolExecutor-0_0): 16:04:26  Acquiring new snowflake connection "create_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:26.369574 (ThreadPoolExecutor-0_0): 16:04:26  Creating schema "_ReferenceKey(database='dbt_raw', schema='dbt_vault', identifier=None)"
2022-03-02 16:04:26.436131 (ThreadPoolExecutor-0_0): 16:04:26  Using snowflake connection "create_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:26.436282 (ThreadPoolExecutor-0_0): 16:04:26  On create_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "create_DBT_RAW_DBT_VAULT"} */
create schema if not exists DBT_RAW.DBT_VAULT
2022-03-02 16:04:26.436379 (ThreadPoolExecutor-0_0): 16:04:26  Opening a new connection, currently in state closed
2022-03-02 16:04:26.602096 (Thread-30): handling poll request
2022-03-02 16:04:26.602473 (Thread-30): 16:04:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f059bd30>]}
2022-03-02 16:04:26.603131 (Thread-30): sending response (<Response 6827 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:27.452822 (ThreadPoolExecutor-0_0): 16:04:27  SQL status: SUCCESS 1 in 1.02 seconds
2022-03-02 16:04:27.453807 (ThreadPoolExecutor-0_0): 16:04:27  On create_DBT_RAW_DBT_VAULT: Close
2022-03-02 16:04:27.694656 (ThreadPoolExecutor-2_0): 16:04:27  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:27.701697 (ThreadPoolExecutor-2_0): 16:04:27  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:27.701844 (ThreadPoolExecutor-2_0): 16:04:27  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 16:04:27.701934 (ThreadPoolExecutor-2_0): 16:04:27  Opening a new connection, currently in state closed
2022-03-02 16:04:28.384125 (Thread-31): handling poll request
2022-03-02 16:04:28.384474 (Thread-31): 16:04:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f059b610>]}
2022-03-02 16:04:28.385013 (Thread-31): sending response (<Response 2330 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:28.921974 (ThreadPoolExecutor-2_0): 16:04:28  SQL status: SUCCESS 0 in 1.22 seconds
2022-03-02 16:04:28.923324 (ThreadPoolExecutor-2_0): 16:04:28  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 16:04:29.170226 (MainThread): 16:04:29  Concurrency: 4 threads (target='default')
2022-03-02 16:04:29.170396 (MainThread): 16:04:29  
2022-03-02 16:04:29.172929 (Thread-4): 16:04:29  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:29.173294 (Thread-4): 16:04:29  1 of 1 START incremental model DBT_VAULT.sat_order_customer_details............. [RUN]
2022-03-02 16:04:29.173593 (Thread-4): 16:04:29  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:29.173701 (Thread-4): 16:04:29  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:29.173808 (Thread-4): 16:04:29  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:29.260267 (Thread-4): 16:04:29  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:29.285143 (Thread-4): 16:04:29  finished collecting timing info
2022-03-02 16:04:29.285394 (Thread-4): 16:04:29  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:29.326513 (Thread-4): 16:04:29  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:29.352180 (Thread-4): 16:04:29  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:29.352334 (Thread-4): 16:04:29  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:04:29.352428 (Thread-4): 16:04:29  Opening a new connection, currently in state closed
2022-03-02 16:04:30.004357 (Thread-4): 16:04:30  Snowflake adapter: Snowflake query id: 01a2a8e4-0503-b72c-0000-0ed503a4d2f6
2022-03-02 16:04:30.004567 (Thread-4): 16:04:30  Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_RAW.DBT_VAULT.V_STG_ORDERS' does not exist or not authorized.
2022-03-02 16:04:30.004743 (Thread-4): 16:04:30  finished collecting timing info
2022-03-02 16:04:30.004884 (Thread-4): 16:04:30  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 16:04:30.182822 (Thread-32): handling poll request
2022-03-02 16:04:30.183199 (Thread-32): 16:04:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05a9340>]}
2022-03-02 16:04:30.184006 (Thread-32): sending response (<Response 9437 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:30.219390 (Thread-4): 16:04:30  Database Error in model sat_order_customer_details (models/raw_vault/sats/sat_order_customer_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_RAW.DBT_VAULT.V_STG_ORDERS' does not exist or not authorized.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 16:04:30.219681 (Thread-4): 16:04:30  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '398708f9-55ed-4e44-8ca1-0119bf88102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44c1a75b0>]}
2022-03-02 16:04:30.220051 (Thread-4): 16:04:30  1 of 1 ERROR creating incremental model DBT_VAULT.sat_order_customer_details.... [ERROR in 1.05s]
2022-03-02 16:04:30.220171 (Thread-4): 16:04:30  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:30.222033 (MainThread): 16:04:30  Acquiring new snowflake connection "master"
2022-03-02 16:04:30.222371 (MainThread): 16:04:30  
2022-03-02 16:04:30.222515 (MainThread): 16:04:30  Finished running 1 incremental model in 5.40s.
2022-03-02 16:04:30.222638 (MainThread): 16:04:30  Connection 'master' was properly closed.
2022-03-02 16:04:30.222713 (MainThread): 16:04:30  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 16:04:30.313062 (MainThread): 16:04:30  
2022-03-02 16:04:30.313309 (MainThread): 16:04:30  Completed with 1 error and 0 warnings:
2022-03-02 16:04:30.313418 (MainThread): 16:04:30  
2022-03-02 16:04:30.313513 (MainThread): 16:04:30  Database Error in model sat_order_customer_details (models/raw_vault/sats/sat_order_customer_details.sql)
2022-03-02 16:04:30.313591 (MainThread): 16:04:30    002003 (42S02): SQL compilation error:
2022-03-02 16:04:30.313660 (MainThread): 16:04:30    Object 'DBT_RAW.DBT_VAULT.V_STG_ORDERS' does not exist or not authorized.
2022-03-02 16:04:30.313729 (MainThread): 16:04:30    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 16:04:30.313806 (MainThread): 16:04:30  
2022-03-02 16:04:30.313894 (MainThread): 16:04:30  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-02 16:04:31.995722 (Thread-33): handling poll request
2022-03-02 16:04:31.997228 (Thread-33): 16:04:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f1636c10>]}
2022-03-02 16:04:31.998301 (Thread-33): sending response (<Response 12458 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:33.788454 (Thread-34): handling status request
2022-03-02 16:04:33.788820 (Thread-34): 16:04:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0593c40>]}
2022-03-02 16:04:33.816460 (Thread-34): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:33.924433 (Thread-35): handling status request
2022-03-02 16:04:33.924830 (Thread-35): 16:04:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0593220>]}
2022-03-02 16:04:33.925382 (Thread-35): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:36.445722 (Thread-36): handling status request
2022-03-02 16:04:36.446101 (Thread-36): 16:04:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05933a0>]}
2022-03-02 16:04:36.446637 (Thread-36): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:36.760585 (Thread-37): handling status request
2022-03-02 16:04:36.760966 (Thread-37): 16:04:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0594490>]}
2022-03-02 16:04:36.761599 (Thread-37): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:37.074339 (Thread-38): handling cli_args request
2022-03-02 16:04:37.074714 (Thread-38): 16:04:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0594ca0>]}
2022-03-02 16:04:39.406805 (Thread-38): sending response (<Response 138 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:39.951269 (MainThread): 16:04:39  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:04:39.951763 (MainThread): 16:04:39  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:04:39.960242 (MainThread): 16:04:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fbe5444-17b6-4fd0-bc15-f34d39530443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b38ec790>]}
2022-03-02 16:04:39.993793 (MainThread): 16:04:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fbe5444-17b6-4fd0-bc15-f34d39530443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b39d8fd0>]}
2022-03-02 16:04:39.994078 (MainThread): 16:04:39  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:04:39.995905 (MainThread): 16:04:39  
2022-03-02 16:04:39.996237 (MainThread): 16:04:39  Acquiring new snowflake connection "master"
2022-03-02 16:04:39.997088 (ThreadPoolExecutor-0_0): 16:04:39  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 16:04:40.011437 (ThreadPoolExecutor-0_0): 16:04:40  Using snowflake connection "list_DBT_RAW"
2022-03-02 16:04:40.011553 (ThreadPoolExecutor-0_0): 16:04:40  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 16:04:40.011639 (ThreadPoolExecutor-0_0): 16:04:40  Opening a new connection, currently in state init
2022-03-02 16:04:40.174208 (Thread-39): handling poll request
2022-03-02 16:04:40.174637 (Thread-39): 16:04:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0593700>]}
2022-03-02 16:04:40.175508 (Thread-39): sending response (<Response 4161 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:41.125759 (ThreadPoolExecutor-0_0): 16:04:41  SQL status: SUCCESS 7 in 1.11 seconds
2022-03-02 16:04:41.127863 (ThreadPoolExecutor-0_0): 16:04:41  On list_DBT_RAW: Close
2022-03-02 16:04:41.330253 (ThreadPoolExecutor-2_0): 16:04:41  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:41.395896 (ThreadPoolExecutor-2_0): 16:04:41  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:04:41.396055 (ThreadPoolExecutor-2_0): 16:04:41  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 16:04:41.396150 (ThreadPoolExecutor-2_0): 16:04:41  Opening a new connection, currently in state closed
2022-03-02 16:04:41.952140 (Thread-40): handling poll request
2022-03-02 16:04:41.952517 (Thread-40): 16:04:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0593640>]}
2022-03-02 16:04:41.953052 (Thread-40): sending response (<Response 2318 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:42.436784 (ThreadPoolExecutor-2_0): 16:04:42  SQL status: SUCCESS 0 in 1.04 seconds
2022-03-02 16:04:42.438130 (ThreadPoolExecutor-2_0): 16:04:42  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 16:04:42.646735 (MainThread): 16:04:42  Concurrency: 4 threads (target='default')
2022-03-02 16:04:42.646913 (MainThread): 16:04:42  
2022-03-02 16:04:42.649699 (Thread-3): 16:04:42  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:42.650052 (Thread-3): 16:04:42  1 of 1 START incremental model DBT_VAULT.sat_order_customer_details............. [RUN]
2022-03-02 16:04:42.650427 (Thread-3): 16:04:42  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:42.650566 (Thread-3): 16:04:42  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:42.650676 (Thread-3): 16:04:42  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:42.734607 (Thread-3): 16:04:42  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:42.750135 (Thread-3): 16:04:42  finished collecting timing info
2022-03-02 16:04:42.750340 (Thread-3): 16:04:42  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:42.793605 (Thread-3): 16:04:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:42.810664 (Thread-3): 16:04:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:04:42.810849 (Thread-3): 16:04:42  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:04:42.810951 (Thread-3): 16:04:42  Opening a new connection, currently in state closed
2022-03-02 16:04:43.550885 (Thread-3): 16:04:43  Snowflake adapter: Snowflake query id: 01a2a8e4-0503-b3d2-0000-0ed503a4c752
2022-03-02 16:04:43.551051 (Thread-3): 16:04:43  Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_RAW.DBT_VAULT.V_STG_ORDERS' does not exist or not authorized.
2022-03-02 16:04:43.551227 (Thread-3): 16:04:43  finished collecting timing info
2022-03-02 16:04:43.551369 (Thread-3): 16:04:43  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 16:04:43.750054 (Thread-41): handling poll request
2022-03-02 16:04:43.750462 (Thread-41): 16:04:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420134a30>]}
2022-03-02 16:04:43.751244 (Thread-41): sending response (<Response 9437 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:43.766428 (Thread-3): 16:04:43  Database Error in model sat_order_customer_details (models/raw_vault/sats/sat_order_customer_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_RAW.DBT_VAULT.V_STG_ORDERS' does not exist or not authorized.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 16:04:43.766729 (Thread-3): 16:04:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fbe5444-17b6-4fd0-bc15-f34d39530443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b158c3d0>]}
2022-03-02 16:04:43.767398 (Thread-3): 16:04:43  1 of 1 ERROR creating incremental model DBT_VAULT.sat_order_customer_details.... [ERROR in 1.12s]
2022-03-02 16:04:43.767545 (Thread-3): 16:04:43  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:04:43.769191 (MainThread): 16:04:43  Acquiring new snowflake connection "master"
2022-03-02 16:04:43.769549 (MainThread): 16:04:43  
2022-03-02 16:04:43.769654 (MainThread): 16:04:43  Finished running 1 incremental model in 3.77s.
2022-03-02 16:04:43.769742 (MainThread): 16:04:43  Connection 'master' was properly closed.
2022-03-02 16:04:43.769812 (MainThread): 16:04:43  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 16:04:43.842553 (MainThread): 16:04:43  
2022-03-02 16:04:43.842783 (MainThread): 16:04:43  Completed with 1 error and 0 warnings:
2022-03-02 16:04:43.842877 (MainThread): 16:04:43  
2022-03-02 16:04:43.842970 (MainThread): 16:04:43  Database Error in model sat_order_customer_details (models/raw_vault/sats/sat_order_customer_details.sql)
2022-03-02 16:04:43.843049 (MainThread): 16:04:43    002003 (42S02): SQL compilation error:
2022-03-02 16:04:43.843119 (MainThread): 16:04:43    Object 'DBT_RAW.DBT_VAULT.V_STG_ORDERS' does not exist or not authorized.
2022-03-02 16:04:43.843187 (MainThread): 16:04:43    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_vault/sats/sat_order_customer_details.sql
2022-03-02 16:04:43.843261 (MainThread): 16:04:43  
2022-03-02 16:04:43.843372 (MainThread): 16:04:43  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-02 16:04:45.551798 (Thread-42): handling poll request
2022-03-02 16:04:45.552189 (Thread-42): 16:04:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05b6820>]}
2022-03-02 16:04:45.553207 (Thread-42): sending response (<Response 12458 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:47.367091 (Thread-43): handling status request
2022-03-02 16:04:47.367471 (Thread-43): 16:04:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05b69d0>]}
2022-03-02 16:04:47.367979 (Thread-43): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:47.451359 (Thread-44): handling status request
2022-03-02 16:04:47.451797 (Thread-44): 16:04:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05b6dc0>]}
2022-03-02 16:04:47.452345 (Thread-44): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:57.866583 (Thread-45): handling status request
2022-03-02 16:04:57.867009 (Thread-45): 16:04:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05b6fa0>]}
2022-03-02 16:04:57.867502 (Thread-45): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:58.197392 (Thread-46): handling status request
2022-03-02 16:04:58.197750 (Thread-46): 16:04:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05492b0>]}
2022-03-02 16:04:58.198231 (Thread-46): sending response (<Response 1241 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:04:58.493721 (Thread-47): handling cli_args request
2022-03-02 16:04:58.494183 (Thread-47): 16:04:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05b6b20>]}
2022-03-02 16:05:00.823017 (Thread-47): sending response (<Response 138 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:01.616604 (MainThread): 16:05:01  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:05:01.617041 (MainThread): 16:05:01  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:05:01.625212 (MainThread): 16:05:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3caddac790>]}
2022-03-02 16:05:01.641183 (Thread-48): handling poll request
2022-03-02 16:05:01.641711 (Thread-48): 16:05:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0549520>]}
2022-03-02 16:05:01.643226 (Thread-48): sending response (<Response 1357 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:01.660794 (MainThread): 16:05:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cade95fd0>]}
2022-03-02 16:05:01.661452 (MainThread): 16:05:01  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:05:01.665369 (MainThread): 16:05:01  
2022-03-02 16:05:01.665850 (MainThread): 16:05:01  Acquiring new snowflake connection "master"
2022-03-02 16:05:01.669516 (ThreadPoolExecutor-0_0): 16:05:01  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 16:05:01.683854 (ThreadPoolExecutor-0_0): 16:05:01  Using snowflake connection "list_DBT_RAW"
2022-03-02 16:05:01.684033 (ThreadPoolExecutor-0_0): 16:05:01  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 16:05:01.684140 (ThreadPoolExecutor-0_0): 16:05:01  Opening a new connection, currently in state init
2022-03-02 16:05:02.763097 (ThreadPoolExecutor-0_0): 16:05:02  SQL status: SUCCESS 7 in 1.08 seconds
2022-03-02 16:05:02.765335 (ThreadPoolExecutor-0_0): 16:05:02  On list_DBT_RAW: Close
2022-03-02 16:05:03.005006 (ThreadPoolExecutor-2_0): 16:05:03  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:05:03.076109 (ThreadPoolExecutor-2_0): 16:05:03  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:05:03.076273 (ThreadPoolExecutor-2_0): 16:05:03  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 16:05:03.076369 (ThreadPoolExecutor-2_0): 16:05:03  Opening a new connection, currently in state closed
2022-03-02 16:05:03.442839 (Thread-49): handling poll request
2022-03-02 16:05:03.443210 (Thread-49): 16:05:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0560460>]}
2022-03-02 16:05:03.443841 (Thread-49): sending response (<Response 5050 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:04.178737 (ThreadPoolExecutor-2_0): 16:05:04  SQL status: SUCCESS 0 in 1.1 seconds
2022-03-02 16:05:04.180003 (ThreadPoolExecutor-2_0): 16:05:04  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 16:05:04.424986 (MainThread): 16:05:04  Concurrency: 4 threads (target='default')
2022-03-02 16:05:04.425190 (MainThread): 16:05:04  
2022-03-02 16:05:04.428093 (Thread-3): 16:05:04  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:05:04.428452 (Thread-3): 16:05:04  1 of 32 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 16:05:04.428769 (Thread-3): 16:05:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:05:04.428890 (Thread-3): 16:05:04  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:05:04.429002 (Thread-3): 16:05:04  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:05:04.429872 (Thread-4): 16:05:04  Began running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:05:04.430118 (Thread-4): 16:05:04  2 of 32 START table model DBT_VAULT.raw_transactions............................ [RUN]
2022-03-02 16:05:04.430385 (Thread-4): 16:05:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:05:04.430474 (Thread-4): 16:05:04  Began compiling node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:05:04.430592 (Thread-4): 16:05:04  Compiling model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:05:04.434091 (Thread-4): 16:05:04  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:05:04.434516 (Thread-5): 16:05:04  Began running node model.dbtvault_snowflake_demo.test1
2022-03-02 16:05:04.434759 (Thread-5): 16:05:04  3 of 32 START view model DBT_VAULT.test1........................................ [RUN]
2022-03-02 16:05:04.435054 (Thread-5): 16:05:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.test1"
2022-03-02 16:05:04.435190 (Thread-5): 16:05:04  Began compiling node model.dbtvault_snowflake_demo.test1
2022-03-02 16:05:04.435289 (Thread-5): 16:05:04  Compiling model.dbtvault_snowflake_demo.test1
2022-03-02 16:05:04.436985 (Thread-5): 16:05:04  Writing injected SQL for node "model.dbtvault_snowflake_demo.test1"
2022-03-02 16:05:04.443920 (Thread-3): 16:05:04  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:05:04.452430 (Thread-4): 16:05:04  finished collecting timing info
2022-03-02 16:05:04.452610 (Thread-4): 16:05:04  Began executing node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:05:04.457851 (Thread-5): 16:05:04  finished collecting timing info
2022-03-02 16:05:04.458001 (Thread-5): 16:05:04  Began executing node model.dbtvault_snowflake_demo.test1
2022-03-02 16:05:04.506276 (Thread-5): 16:05:04  Writing runtime SQL for node "model.dbtvault_snowflake_demo.test1"
2022-03-02 16:05:04.506735 (Thread-4): 16:05:04  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:05:04.507006 (Thread-3): 16:05:04  finished collecting timing info
2022-03-02 16:05:04.507180 (Thread-3): 16:05:04  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:05:04.509967 (Thread-3): 16:05:04  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:05:04.520660 (Thread-5): 16:05:04  Using snowflake connection "model.dbtvault_snowflake_demo.test1"
2022-03-02 16:05:04.520791 (Thread-5): 16:05:04  On model.dbtvault_snowflake_demo.test1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.test1"} */

  create or replace  view DBT_RAW.DBT_VAULT.test1 
  
   as (
    SELECT
*
FROM
"SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER";
2022-03-02 16:05:04.520885 (Thread-5): 16:05:04  Opening a new connection, currently in state init
2022-03-02 16:05:04.528447 (Thread-3): 16:05:04  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:05:04.528578 (Thread-3): 16:05:04  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 16:05:04.528666 (Thread-3): 16:05:04  Opening a new connection, currently in state closed
2022-03-02 16:05:04.530472 (Thread-4): 16:05:04  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:05:04.530628 (Thread-4): 16:05:04  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_transactions  as
      (SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 16:05:04.530724 (Thread-4): 16:05:04  Opening a new connection, currently in state init
2022-03-02 16:05:04.749335 (Thread-50): 16:05:04  Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
2022-03-02 16:05:04.749736 (Thread-50): 16:05:04  Partial parsing: deleted file: dbtvault_snowflake_demo://models/test1.sql
2022-03-02 16:05:04.822792 (Thread-50): 16:05:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0374ca0>]}
2022-03-02 16:05:05.217956 (Thread-51): handling poll request
2022-03-02 16:05:05.218327 (Thread-51): 16:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0468730>]}
2022-03-02 16:05:05.219239 (Thread-51): sending response (<Response 20056 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:05.739956 (Thread-5): 16:05:05  Snowflake adapter: Snowflake query id: 01a2a8e5-0503-b3d2-0000-0ed503a4c75a
2022-03-02 16:05:05.740125 (Thread-5): 16:05:05  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 46 unexpected ';'.
2022-03-02 16:05:05.740312 (Thread-5): 16:05:05  finished collecting timing info
2022-03-02 16:05:05.740473 (Thread-5): 16:05:05  On model.dbtvault_snowflake_demo.test1: Close
2022-03-02 16:05:05.888344 (Thread-52): handling status request
2022-03-02 16:05:05.888730 (Thread-52): 16:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0503400>]}
2022-03-02 16:05:05.889314 (Thread-52): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:06.143320 (Thread-53): handling status request
2022-03-02 16:05:06.143727 (Thread-53): 16:05:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0503ca0>]}
2022-03-02 16:05:06.144214 (Thread-53): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:06.285746 (Thread-5): 16:05:06  Database Error in model test1 (models/test1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 46 unexpected ';'.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/test1.sql
2022-03-02 16:05:06.286070 (Thread-5): 16:05:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac657a00>]}
2022-03-02 16:05:06.286459 (Thread-5): 16:05:06  3 of 32 ERROR creating view model DBT_VAULT.test1............................... [ERROR in 1.85s]
2022-03-02 16:05:06.286583 (Thread-5): 16:05:06  Finished running node model.dbtvault_snowflake_demo.test1
2022-03-02 16:05:07.084948 (Thread-54): handling poll request
2022-03-02 16:05:07.085406 (Thread-54): 16:05:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05609a0>]}
2022-03-02 16:05:07.086083 (Thread-54): sending response (<Response 3951 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:07.815454 (Thread-55): handling status request
2022-03-02 16:05:07.815832 (Thread-55): 16:05:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0549040>]}
2022-03-02 16:05:07.816376 (Thread-55): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:07.822893 (Thread-56): handling list request
2022-03-02 16:05:07.823206 (Thread-56): 16:05:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f050edc0>]}
2022-03-02 16:05:07.866913 (Thread-56): 16:05:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0560100>]}
2022-03-02 16:05:07.867443 (Thread-56): 16:05:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:05:07.872896 (Thread-56): sending response (<Response 5514 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:08.894130 (Thread-57): handling poll request
2022-03-02 16:05:08.894501 (Thread-57): 16:05:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201574c0>]}
2022-03-02 16:05:08.894995 (Thread-57): sending response (<Response 292 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:10.350920 (Thread-4): 16:05:10  SQL status: SUCCESS 1 in 5.82 seconds
2022-03-02 16:05:10.361040 (Thread-4): 16:05:10  finished collecting timing info
2022-03-02 16:05:10.361222 (Thread-4): 16:05:10  On model.dbtvault_snowflake_demo.raw_transactions: Close
2022-03-02 16:05:10.603576 (Thread-4): 16:05:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac679af0>]}
2022-03-02 16:05:10.604111 (Thread-4): 16:05:10  2 of 32 OK created table model DBT_VAULT.raw_transactions....................... [SUCCESS 1 in 6.17s]
2022-03-02 16:05:10.604266 (Thread-4): 16:05:10  Finished running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:05:10.605049 (Thread-6): 16:05:10  Began running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:05:10.605356 (Thread-6): 16:05:10  4 of 32 START table model DBT_VAULT.v_stg_transactions.......................... [RUN]
2022-03-02 16:05:10.605652 (Thread-6): 16:05:10  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:05:10.605746 (Thread-6): 16:05:10  Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:05:10.605835 (Thread-6): 16:05:10  Compiling model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:05:10.641750 (Thread-6): 16:05:10  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:05:10.641903 (Thread-6): 16:05:10  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-02 16:05:10.641995 (Thread-6): 16:05:10  Opening a new connection, currently in state init
2022-03-02 16:05:10.790669 (Thread-58): handling poll request
2022-03-02 16:05:10.791036 (Thread-58): 16:05:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03bb1c0>]}
2022-03-02 16:05:10.791699 (Thread-58): sending response (<Response 6442 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:11.486085 (Thread-6): 16:05:11  SQL status: SUCCESS 7 in 0.84 seconds
2022-03-02 16:05:11.517167 (Thread-6): 16:05:11  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:05:11.517358 (Thread-6): 16:05:11  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-02 16:05:11.685963 (Thread-6): 16:05:11  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-02 16:05:11.721657 (Thread-6): 16:05:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:05:11.738506 (Thread-6): 16:05:11  finished collecting timing info
2022-03-02 16:05:11.738722 (Thread-6): 16:05:11  Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:05:11.742423 (Thread-6): 16:05:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:05:11.759527 (Thread-6): 16:05:11  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:05:11.759695 (Thread-6): 16:05:11  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_transactions  as
      (







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM DBT_RAW.DBT_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
      );
2022-03-02 16:05:12.569786 (Thread-59): handling poll request
2022-03-02 16:05:12.570156 (Thread-59): 16:05:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03b8af0>]}
2022-03-02 16:05:12.570773 (Thread-59): sending response (<Response 6258 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:14.206556 (Thread-6): 16:05:14  SQL status: SUCCESS 1 in 2.45 seconds
2022-03-02 16:05:14.208002 (Thread-6): 16:05:14  finished collecting timing info
2022-03-02 16:05:14.208177 (Thread-6): 16:05:14  On model.dbtvault_snowflake_demo.v_stg_transactions: Close
2022-03-02 16:05:14.355394 (Thread-60): handling poll request
2022-03-02 16:05:14.355781 (Thread-60): 16:05:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03b8760>]}
2022-03-02 16:05:14.356327 (Thread-60): sending response (<Response 1481 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:14.490323 (Thread-6): 16:05:14  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac0a8d00>]}
2022-03-02 16:05:14.490822 (Thread-6): 16:05:14  4 of 32 OK created table model DBT_VAULT.v_stg_transactions..................... [SUCCESS 1 in 3.88s]
2022-03-02 16:05:14.490985 (Thread-6): 16:05:14  Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:05:14.491745 (Thread-4): 16:05:14  Began running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:05:14.492111 (Thread-4): 16:05:14  5 of 32 START incremental model DBT_VAULT.t_link_transactions................... [RUN]
2022-03-02 16:05:14.492431 (Thread-4): 16:05:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:05:14.492551 (Thread-4): 16:05:14  Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:05:14.492645 (Thread-4): 16:05:14  Compiling model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:05:14.555862 (Thread-4): 16:05:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:05:14.572920 (Thread-4): 16:05:14  finished collecting timing info
2022-03-02 16:05:14.573136 (Thread-4): 16:05:14  Began executing node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:05:14.599384 (Thread-4): 16:05:14  Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:05:14.616293 (Thread-4): 16:05:14  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:05:14.616455 (Thread-4): 16:05:14  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.t_link_transactions  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:14.616548 (Thread-4): 16:05:14  Opening a new connection, currently in state closed
2022-03-02 16:05:14.959080 (Thread-3): 16:05:14  SQL status: SUCCESS 1 in 10.43 seconds
2022-03-02 16:05:14.960820 (Thread-3): 16:05:14  finished collecting timing info
2022-03-02 16:05:14.961067 (Thread-3): 16:05:14  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 16:05:15.162310 (Thread-3): 16:05:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cad575190>]}
2022-03-02 16:05:15.163280 (Thread-3): 16:05:15  1 of 32 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 10.73s]
2022-03-02 16:05:15.163526 (Thread-3): 16:05:15  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:05:15.164273 (Thread-6): 16:05:15  Began running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:05:15.164564 (Thread-6): 16:05:15  6 of 32 START table model DBT_VAULT.raw_inventory............................... [RUN]
2022-03-02 16:05:15.164841 (Thread-6): 16:05:15  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:05:15.164936 (Thread-6): 16:05:15  Began compiling node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:05:15.165027 (Thread-6): 16:05:15  Compiling model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:05:15.166483 (Thread-5): 16:05:15  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:05:15.166731 (Thread-5): 16:05:15  7 of 32 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 16:05:15.166985 (Thread-5): 16:05:15  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:05:15.167076 (Thread-5): 16:05:15  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:05:15.167163 (Thread-5): 16:05:15  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:05:15.181419 (Thread-6): 16:05:15  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:05:15.187330 (Thread-5): 16:05:15  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:05:15.187450 (Thread-5): 16:05:15  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 16:05:15.187537 (Thread-5): 16:05:15  Opening a new connection, currently in state closed
2022-03-02 16:05:15.201864 (Thread-6): 16:05:15  finished collecting timing info
2022-03-02 16:05:15.202128 (Thread-6): 16:05:15  Began executing node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:05:15.206062 (Thread-6): 16:05:15  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:05:15.230650 (Thread-6): 16:05:15  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:05:15.230835 (Thread-6): 16:05:15  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_inventory  as
      (SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DBT_RAW.DBT_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
      );
2022-03-02 16:05:15.230939 (Thread-6): 16:05:15  Opening a new connection, currently in state closed
2022-03-02 16:05:16.152888 (Thread-61): handling poll request
2022-03-02 16:05:16.153355 (Thread-61): 16:05:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03b7e80>]}
2022-03-02 16:05:16.154318 (Thread-61): sending response (<Response 20452 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:16.315966 (Thread-5): 16:05:16  SQL status: SUCCESS 37 in 1.13 seconds
2022-03-02 16:05:16.323936 (Thread-5): 16:05:16  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:05:16.324081 (Thread-5): 16:05:16  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 16:05:16.489767 (Thread-5): 16:05:16  SQL status: SUCCESS 37 in 0.17 seconds
2022-03-02 16:05:16.512173 (Thread-5): 16:05:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:05:16.546093 (Thread-5): 16:05:16  finished collecting timing info
2022-03-02 16:05:16.546310 (Thread-5): 16:05:16  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:05:16.548753 (Thread-5): 16:05:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:05:16.593205 (Thread-5): 16:05:16  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:05:16.593414 (Thread-5): 16:05:16  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 16:05:16.845025 (Thread-4): 16:05:16  SQL status: SUCCESS 1 in 2.23 seconds
2022-03-02 16:05:16.846598 (Thread-4): 16:05:16  finished collecting timing info
2022-03-02 16:05:16.846776 (Thread-4): 16:05:16  On model.dbtvault_snowflake_demo.t_link_transactions: Close
2022-03-02 16:05:17.189201 (Thread-4): 16:05:17  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac66bf70>]}
2022-03-02 16:05:17.189712 (Thread-4): 16:05:17  5 of 32 OK created incremental model DBT_VAULT.t_link_transactions.............. [SUCCESS 1 in 2.70s]
2022-03-02 16:05:17.189851 (Thread-4): 16:05:17  Finished running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:05:17.967356 (Thread-62): handling poll request
2022-03-02 16:05:17.967752 (Thread-62): 16:05:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03b2a90>]}
2022-03-02 16:05:17.968597 (Thread-62): sending response (<Response 17247 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:18.929144 (Thread-5): 16:05:18  SQL status: SUCCESS 1 in 2.34 seconds
2022-03-02 16:05:18.931349 (Thread-5): 16:05:18  finished collecting timing info
2022-03-02 16:05:18.931605 (Thread-5): 16:05:18  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 16:05:19.165002 (Thread-5): 16:05:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac1645e0>]}
2022-03-02 16:05:19.165507 (Thread-5): 16:05:19  7 of 32 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 4.00s]
2022-03-02 16:05:19.165671 (Thread-5): 16:05:19  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:05:19.166700 (Thread-3): 16:05:19  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:05:19.166953 (Thread-3): 16:05:19  8 of 32 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 16:05:19.167225 (Thread-3): 16:05:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:05:19.167323 (Thread-3): 16:05:19  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:05:19.167415 (Thread-3): 16:05:19  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:05:19.171844 (Thread-4): 16:05:19  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:05:19.172150 (Thread-4): 16:05:19  9 of 32 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 16:05:19.172488 (Thread-4): 16:05:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:05:19.172615 (Thread-4): 16:05:19  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:05:19.172737 (Thread-4): 16:05:19  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:05:19.176885 (Thread-5): 16:05:19  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:05:19.177106 (Thread-5): 16:05:19  10 of 32 START incremental model DBT_VAULT.hub_order............................ [RUN]
2022-03-02 16:05:19.177395 (Thread-5): 16:05:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:05:19.177491 (Thread-5): 16:05:19  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:05:19.177576 (Thread-5): 16:05:19  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:05:19.241634 (Thread-5): 16:05:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:05:19.250713 (Thread-4): 16:05:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:05:19.255798 (Thread-3): 16:05:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:05:19.266864 (Thread-5): 16:05:19  finished collecting timing info
2022-03-02 16:05:19.267037 (Thread-5): 16:05:19  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:05:19.270234 (Thread-5): 16:05:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:05:19.271604 (Thread-3): 16:05:19  finished collecting timing info
2022-03-02 16:05:19.271758 (Thread-3): 16:05:19  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:05:19.274226 (Thread-3): 16:05:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:05:19.274557 (Thread-4): 16:05:19  finished collecting timing info
2022-03-02 16:05:19.274880 (Thread-4): 16:05:19  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:05:19.279024 (Thread-4): 16:05:19  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:05:19.288100 (Thread-5): 16:05:19  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:05:19.288226 (Thread-5): 16:05:19  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:19.288319 (Thread-5): 16:05:19  Opening a new connection, currently in state closed
2022-03-02 16:05:19.293735 (Thread-3): 16:05:19  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:05:19.293879 (Thread-3): 16:05:19  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:19.293980 (Thread-3): 16:05:19  Opening a new connection, currently in state closed
2022-03-02 16:05:19.297834 (Thread-4): 16:05:19  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:05:19.297995 (Thread-4): 16:05:19  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:19.298126 (Thread-4): 16:05:19  Opening a new connection, currently in state closed
2022-03-02 16:05:19.770932 (Thread-63): handling poll request
2022-03-02 16:05:19.771296 (Thread-63): 16:05:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05280d0>]}
2022-03-02 16:05:19.793918 (Thread-63): sending response (<Response 19779 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:20.488829 (Thread-6): 16:05:20  SQL status: SUCCESS 1 in 5.26 seconds
2022-03-02 16:05:20.490355 (Thread-6): 16:05:20  finished collecting timing info
2022-03-02 16:05:20.490529 (Thread-6): 16:05:20  On model.dbtvault_snowflake_demo.raw_inventory: Close
2022-03-02 16:05:20.762265 (Thread-6): 16:05:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac091a90>]}
2022-03-02 16:05:20.762688 (Thread-6): 16:05:20  6 of 32 OK created table model DBT_VAULT.raw_inventory.......................... [SUCCESS 1 in 5.60s]
2022-03-02 16:05:20.762819 (Thread-6): 16:05:20  Finished running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:05:20.762970 (Thread-6): 16:05:20  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:05:20.763154 (Thread-6): 16:05:20  11 of 32 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 16:05:20.763393 (Thread-6): 16:05:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:05:20.763482 (Thread-6): 16:05:20  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:05:20.763574 (Thread-6): 16:05:20  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:05:20.795886 (Thread-6): 16:05:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:05:20.814784 (Thread-6): 16:05:20  finished collecting timing info
2022-03-02 16:05:20.814985 (Thread-6): 16:05:20  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:05:20.818159 (Thread-6): 16:05:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:05:20.834572 (Thread-6): 16:05:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:05:20.834784 (Thread-6): 16:05:20  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:20.834916 (Thread-6): 16:05:20  Opening a new connection, currently in state closed
2022-03-02 16:05:21.408551 (Thread-3): 16:05:21  SQL status: SUCCESS 1 in 2.11 seconds
2022-03-02 16:05:21.411061 (Thread-3): 16:05:21  finished collecting timing info
2022-03-02 16:05:21.411335 (Thread-3): 16:05:21  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 16:05:21.579244 (Thread-64): handling poll request
2022-03-02 16:05:21.579668 (Thread-64): 16:05:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03b05b0>]}
2022-03-02 16:05:21.580595 (Thread-64): sending response (<Response 10023 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:21.849511 (Thread-3): 16:05:21  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac064250>]}
2022-03-02 16:05:21.849939 (Thread-3): 16:05:21  8 of 32 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 2.68s]
2022-03-02 16:05:21.850069 (Thread-3): 16:05:21  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:05:21.850214 (Thread-3): 16:05:21  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:05:21.850392 (Thread-3): 16:05:21  12 of 32 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 16:05:21.850634 (Thread-3): 16:05:21  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:05:21.850723 (Thread-3): 16:05:21  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:05:21.850816 (Thread-3): 16:05:21  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:05:21.858953 (Thread-3): 16:05:21  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:05:21.860140 (Thread-5): 16:05:21  SQL status: SUCCESS 1 in 2.57 seconds
2022-03-02 16:05:21.861649 (Thread-5): 16:05:21  finished collecting timing info
2022-03-02 16:05:21.861812 (Thread-5): 16:05:21  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 16:05:21.875359 (Thread-3): 16:05:21  finished collecting timing info
2022-03-02 16:05:21.875523 (Thread-3): 16:05:21  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:05:21.878552 (Thread-3): 16:05:21  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:05:21.894737 (Thread-3): 16:05:21  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:05:21.894880 (Thread-3): 16:05:21  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:21.894972 (Thread-3): 16:05:21  Opening a new connection, currently in state closed
2022-03-02 16:05:21.935155 (Thread-4): 16:05:21  SQL status: SUCCESS 1 in 2.64 seconds
2022-03-02 16:05:21.937445 (Thread-4): 16:05:21  finished collecting timing info
2022-03-02 16:05:21.937678 (Thread-4): 16:05:21  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 16:05:22.103793 (Thread-5): 16:05:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c76c640>]}
2022-03-02 16:05:22.104221 (Thread-5): 16:05:22  10 of 32 OK created incremental model DBT_VAULT.hub_order....................... [SUCCESS 1 in 2.93s]
2022-03-02 16:05:22.104350 (Thread-5): 16:05:22  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:05:22.104493 (Thread-5): 16:05:22  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:05:22.104677 (Thread-5): 16:05:22  13 of 32 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 16:05:22.104922 (Thread-5): 16:05:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:05:22.105010 (Thread-5): 16:05:22  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:05:22.105098 (Thread-5): 16:05:22  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:05:22.112719 (Thread-5): 16:05:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:05:22.154640 (Thread-5): 16:05:22  finished collecting timing info
2022-03-02 16:05:22.154838 (Thread-5): 16:05:22  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:05:22.157862 (Thread-5): 16:05:22  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:05:22.186104 (Thread-4): 16:05:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c6ffd00>]}
2022-03-02 16:05:22.197474 (Thread-5): 16:05:22  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:05:22.197620 (Thread-5): 16:05:22  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:22.197715 (Thread-5): 16:05:22  Opening a new connection, currently in state closed
2022-03-02 16:05:22.210161 (Thread-4): 16:05:22  9 of 32 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 3.01s]
2022-03-02 16:05:22.210329 (Thread-4): 16:05:22  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:05:22.210488 (Thread-4): 16:05:22  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:05:22.210756 (Thread-4): 16:05:22  14 of 32 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 16:05:22.211047 (Thread-4): 16:05:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:05:22.211138 (Thread-4): 16:05:22  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:05:22.211264 (Thread-4): 16:05:22  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:05:22.234614 (Thread-4): 16:05:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:05:22.261452 (Thread-4): 16:05:22  finished collecting timing info
2022-03-02 16:05:22.261638 (Thread-4): 16:05:22  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:05:22.268561 (Thread-4): 16:05:22  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:05:22.301265 (Thread-4): 16:05:22  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:05:22.301435 (Thread-4): 16:05:22  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:22.301529 (Thread-4): 16:05:22  Opening a new connection, currently in state closed
2022-03-02 16:05:23.358940 (Thread-65): handling poll request
2022-03-02 16:05:23.359324 (Thread-65): 16:05:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0572370>]}
2022-03-02 16:05:23.360379 (Thread-65): sending response (<Response 24878 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:23.770239 (Thread-6): 16:05:23  SQL status: SUCCESS 1 in 2.94 seconds
2022-03-02 16:05:23.771800 (Thread-6): 16:05:23  finished collecting timing info
2022-03-02 16:05:23.771979 (Thread-6): 16:05:23  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 16:05:23.977171 (Thread-6): 16:05:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac098a30>]}
2022-03-02 16:05:23.977671 (Thread-6): 16:05:23  11 of 32 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 3.21s]
2022-03-02 16:05:23.977806 (Thread-6): 16:05:23  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:05:23.977958 (Thread-6): 16:05:23  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:05:23.978141 (Thread-6): 16:05:23  15 of 32 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 16:05:23.978387 (Thread-6): 16:05:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:05:23.978478 (Thread-6): 16:05:23  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:05:23.978570 (Thread-6): 16:05:23  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:05:24.015322 (Thread-6): 16:05:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:05:24.031798 (Thread-6): 16:05:24  finished collecting timing info
2022-03-02 16:05:24.032015 (Thread-6): 16:05:24  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:05:24.036268 (Thread-6): 16:05:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:05:24.052444 (Thread-6): 16:05:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:05:24.052615 (Thread-6): 16:05:24  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:24.052710 (Thread-6): 16:05:24  Opening a new connection, currently in state closed
2022-03-02 16:05:24.064232 (Thread-5): 16:05:24  SQL status: SUCCESS 1 in 1.87 seconds
2022-03-02 16:05:24.066256 (Thread-5): 16:05:24  finished collecting timing info
2022-03-02 16:05:24.066429 (Thread-5): 16:05:24  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 16:05:24.322014 (Thread-5): 16:05:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c60b220>]}
2022-03-02 16:05:24.322588 (Thread-5): 16:05:24  13 of 32 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 2.22s]
2022-03-02 16:05:24.322765 (Thread-5): 16:05:24  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:05:24.322925 (Thread-5): 16:05:24  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:05:24.323192 (Thread-5): 16:05:24  16 of 32 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 16:05:24.323445 (Thread-5): 16:05:24  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:05:24.323537 (Thread-5): 16:05:24  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:05:24.323629 (Thread-5): 16:05:24  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:05:24.334292 (Thread-5): 16:05:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:05:24.370885 (Thread-5): 16:05:24  finished collecting timing info
2022-03-02 16:05:24.371190 (Thread-5): 16:05:24  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:05:24.374612 (Thread-5): 16:05:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:05:24.411990 (Thread-5): 16:05:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:05:24.412149 (Thread-5): 16:05:24  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:24.412241 (Thread-5): 16:05:24  Opening a new connection, currently in state closed
2022-03-02 16:05:24.441415 (Thread-3): 16:05:24  SQL status: SUCCESS 1 in 2.55 seconds
2022-03-02 16:05:24.443027 (Thread-3): 16:05:24  finished collecting timing info
2022-03-02 16:05:24.443203 (Thread-3): 16:05:24  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 16:05:24.722250 (Thread-3): 16:05:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c6897f0>]}
2022-03-02 16:05:24.722841 (Thread-3): 16:05:24  12 of 32 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 2.87s]
2022-03-02 16:05:24.723040 (Thread-3): 16:05:24  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:05:24.723235 (Thread-3): 16:05:24  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:05:24.723494 (Thread-3): 16:05:24  17 of 32 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 16:05:24.723843 (Thread-3): 16:05:24  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:05:24.723993 (Thread-3): 16:05:24  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:05:24.724120 (Thread-3): 16:05:24  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:05:24.835057 (Thread-3): 16:05:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:05:24.860891 (Thread-3): 16:05:24  finished collecting timing info
2022-03-02 16:05:24.861116 (Thread-3): 16:05:24  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:05:24.865294 (Thread-3): 16:05:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:05:24.892716 (Thread-3): 16:05:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:05:24.892944 (Thread-3): 16:05:24  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:24.893055 (Thread-3): 16:05:24  Opening a new connection, currently in state closed
2022-03-02 16:05:24.956884 (Thread-4): 16:05:24  SQL status: SUCCESS 1 in 2.66 seconds
2022-03-02 16:05:24.958680 (Thread-4): 16:05:24  finished collecting timing info
2022-03-02 16:05:24.958870 (Thread-4): 16:05:24  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 16:05:25.147255 (Thread-66): handling poll request
2022-03-02 16:05:25.147631 (Thread-66): 16:05:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0371790>]}
2022-03-02 16:05:25.148821 (Thread-66): sending response (<Response 27832 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:25.474551 (Thread-4): 16:05:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c667610>]}
2022-03-02 16:05:25.474987 (Thread-4): 16:05:25  14 of 32 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 3.26s]
2022-03-02 16:05:25.475120 (Thread-4): 16:05:25  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:05:25.475306 (Thread-4): 16:05:25  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:05:25.475535 (Thread-4): 16:05:25  18 of 32 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 16:05:25.475792 (Thread-4): 16:05:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:05:25.475898 (Thread-4): 16:05:25  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:05:25.475994 (Thread-4): 16:05:25  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:05:25.492631 (Thread-4): 16:05:25  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:05:25.508851 (Thread-4): 16:05:25  finished collecting timing info
2022-03-02 16:05:25.509053 (Thread-4): 16:05:25  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:05:25.512247 (Thread-4): 16:05:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:05:25.528099 (Thread-4): 16:05:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:05:25.528263 (Thread-4): 16:05:25  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:25.528366 (Thread-4): 16:05:25  Opening a new connection, currently in state closed
2022-03-02 16:05:26.301416 (Thread-6): 16:05:26  SQL status: SUCCESS 1 in 2.25 seconds
2022-03-02 16:05:26.303221 (Thread-6): 16:05:26  finished collecting timing info
2022-03-02 16:05:26.303394 (Thread-6): 16:05:26  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 16:05:26.456026 (Thread-5): 16:05:26  SQL status: SUCCESS 1 in 2.04 seconds
2022-03-02 16:05:26.457650 (Thread-5): 16:05:26  finished collecting timing info
2022-03-02 16:05:26.457817 (Thread-5): 16:05:26  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 16:05:26.531754 (Thread-6): 16:05:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c6875b0>]}
2022-03-02 16:05:26.532352 (Thread-6): 16:05:26  15 of 32 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 2.55s]
2022-03-02 16:05:26.532518 (Thread-6): 16:05:26  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:05:26.532671 (Thread-6): 16:05:26  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:05:26.532858 (Thread-6): 16:05:26  19 of 32 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 16:05:26.533123 (Thread-6): 16:05:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:05:26.533214 (Thread-6): 16:05:26  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:05:26.533360 (Thread-6): 16:05:26  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:05:26.548139 (Thread-6): 16:05:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:05:26.563251 (Thread-6): 16:05:26  finished collecting timing info
2022-03-02 16:05:26.563461 (Thread-6): 16:05:26  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:05:26.567103 (Thread-6): 16:05:26  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:05:26.583129 (Thread-6): 16:05:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:05:26.583293 (Thread-6): 16:05:26  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:26.583503 (Thread-6): 16:05:26  Opening a new connection, currently in state closed
2022-03-02 16:05:26.707544 (Thread-5): 16:05:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c5e8b50>]}
2022-03-02 16:05:26.708059 (Thread-5): 16:05:26  16 of 32 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 2.38s]
2022-03-02 16:05:26.708221 (Thread-5): 16:05:26  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:05:26.708385 (Thread-5): 16:05:26  Began running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:05:26.708604 (Thread-5): 16:05:26  20 of 32 START table model DBT_VAULT.v_stg_inventory............................ [RUN]
2022-03-02 16:05:26.708890 (Thread-5): 16:05:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:05:26.708995 (Thread-5): 16:05:26  Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:05:26.709104 (Thread-5): 16:05:26  Compiling model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:05:26.722366 (Thread-5): 16:05:26  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:05:26.722506 (Thread-5): 16:05:26  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-02 16:05:26.722592 (Thread-5): 16:05:26  Opening a new connection, currently in state closed
2022-03-02 16:05:26.839876 (Thread-3): 16:05:26  SQL status: SUCCESS 1 in 1.95 seconds
2022-03-02 16:05:26.842111 (Thread-3): 16:05:26  finished collecting timing info
2022-03-02 16:05:26.842356 (Thread-3): 16:05:26  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 16:05:26.954663 (Thread-67): handling poll request
2022-03-02 16:05:26.955033 (Thread-67): 16:05:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0365d60>]}
2022-03-02 16:05:26.956247 (Thread-67): sending response (<Response 24134 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:27.159422 (Thread-3): 16:05:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c73b2b0>]}
2022-03-02 16:05:27.159863 (Thread-3): 16:05:27  17 of 32 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 2.44s]
2022-03-02 16:05:27.159996 (Thread-3): 16:05:27  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:05:27.411737 (Thread-4): 16:05:27  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-02 16:05:27.413465 (Thread-4): 16:05:27  finished collecting timing info
2022-03-02 16:05:27.413660 (Thread-4): 16:05:27  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 16:05:27.662627 (Thread-4): 16:05:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c75fe20>]}
2022-03-02 16:05:27.663224 (Thread-4): 16:05:27  18 of 32 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 2.19s]
2022-03-02 16:05:27.663438 (Thread-4): 16:05:27  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:05:27.670474 (Thread-5): 16:05:27  SQL status: SUCCESS 24 in 0.95 seconds
2022-03-02 16:05:27.677221 (Thread-5): 16:05:27  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:05:27.677369 (Thread-5): 16:05:27  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-02 16:05:27.863472 (Thread-5): 16:05:27  SQL status: SUCCESS 24 in 0.19 seconds
2022-03-02 16:05:27.878142 (Thread-5): 16:05:27  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:05:27.904695 (Thread-5): 16:05:27  finished collecting timing info
2022-03-02 16:05:27.904896 (Thread-5): 16:05:27  Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:05:27.907624 (Thread-5): 16:05:27  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:05:27.943293 (Thread-5): 16:05:27  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:05:27.943451 (Thread-5): 16:05:27  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_inventory  as
      (








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
      );
2022-03-02 16:05:28.663510 (Thread-6): 16:05:28  SQL status: SUCCESS 1 in 2.08 seconds
2022-03-02 16:05:28.665870 (Thread-6): 16:05:28  finished collecting timing info
2022-03-02 16:05:28.666139 (Thread-6): 16:05:28  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 16:05:28.778706 (Thread-68): handling poll request
2022-03-02 16:05:28.779087 (Thread-68): 16:05:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03bb6d0>]}
2022-03-02 16:05:28.779852 (Thread-68): sending response (<Response 16910 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:28.944151 (Thread-6): 16:05:28  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c7ee7c0>]}
2022-03-02 16:05:28.944571 (Thread-6): 16:05:28  19 of 32 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 2.41s]
2022-03-02 16:05:28.944700 (Thread-6): 16:05:28  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:05:30.382929 (Thread-5): 16:05:30  SQL status: SUCCESS 1 in 2.44 seconds
2022-03-02 16:05:30.384375 (Thread-5): 16:05:30  finished collecting timing info
2022-03-02 16:05:30.384539 (Thread-5): 16:05:30  On model.dbtvault_snowflake_demo.v_stg_inventory: Close
2022-03-02 16:05:30.585460 (Thread-69): handling poll request
2022-03-02 16:05:30.585880 (Thread-69): 16:05:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f035d3a0>]}
2022-03-02 16:05:30.586462 (Thread-69): sending response (<Response 2869 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:30.955001 (Thread-5): 16:05:30  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac67dee0>]}
2022-03-02 16:05:30.955450 (Thread-5): 16:05:30  20 of 32 OK created table model DBT_VAULT.v_stg_inventory....................... [SUCCESS 1 in 4.25s]
2022-03-02 16:05:30.955587 (Thread-5): 16:05:30  Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:05:30.956799 (Thread-3): 16:05:30  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:05:30.957069 (Thread-3): 16:05:30  21 of 32 START incremental model DBT_VAULT.hub_nation........................... [RUN]
2022-03-02 16:05:30.957401 (Thread-3): 16:05:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:05:30.957514 (Thread-3): 16:05:30  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:05:30.957619 (Thread-3): 16:05:30  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:05:30.962116 (Thread-4): 16:05:30  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:05:30.962369 (Thread-4): 16:05:30  22 of 32 START incremental model DBT_VAULT.hub_part............................. [RUN]
2022-03-02 16:05:30.962621 (Thread-4): 16:05:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:05:30.962712 (Thread-4): 16:05:30  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:05:30.962799 (Thread-4): 16:05:30  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:05:30.967225 (Thread-6): 16:05:30  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:05:30.967464 (Thread-6): 16:05:30  23 of 32 START incremental model DBT_VAULT.hub_region........................... [RUN]
2022-03-02 16:05:30.967708 (Thread-6): 16:05:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:05:30.967797 (Thread-6): 16:05:30  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:05:30.967884 (Thread-6): 16:05:30  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:05:30.972273 (Thread-5): 16:05:30  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:05:30.972507 (Thread-5): 16:05:30  24 of 32 START incremental model DBT_VAULT.hub_supplier......................... [RUN]
2022-03-02 16:05:30.972738 (Thread-5): 16:05:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:05:30.972827 (Thread-5): 16:05:30  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:05:30.972910 (Thread-5): 16:05:30  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:05:30.982030 (Thread-4): 16:05:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:05:30.986645 (Thread-6): 16:05:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:05:30.996101 (Thread-5): 16:05:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:05:30.996674 (Thread-3): 16:05:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:05:31.007430 (Thread-4): 16:05:31  finished collecting timing info
2022-03-02 16:05:31.007597 (Thread-4): 16:05:31  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:05:31.012828 (Thread-3): 16:05:31  finished collecting timing info
2022-03-02 16:05:31.012972 (Thread-3): 16:05:31  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:05:31.015658 (Thread-3): 16:05:31  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:05:31.015872 (Thread-5): 16:05:31  finished collecting timing info
2022-03-02 16:05:31.016012 (Thread-5): 16:05:31  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:05:31.018716 (Thread-5): 16:05:31  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:05:31.018952 (Thread-6): 16:05:31  finished collecting timing info
2022-03-02 16:05:31.019091 (Thread-6): 16:05:31  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:05:31.022239 (Thread-6): 16:05:31  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:05:31.022402 (Thread-4): 16:05:31  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:05:31.034711 (Thread-3): 16:05:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:05:31.034840 (Thread-3): 16:05:31  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:31.034931 (Thread-3): 16:05:31  Opening a new connection, currently in state closed
2022-03-02 16:05:31.040633 (Thread-5): 16:05:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:05:31.040765 (Thread-5): 16:05:31  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:31.040855 (Thread-5): 16:05:31  Opening a new connection, currently in state closed
2022-03-02 16:05:31.043110 (Thread-4): 16:05:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:05:31.043238 (Thread-4): 16:05:31  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:31.043326 (Thread-4): 16:05:31  Opening a new connection, currently in state closed
2022-03-02 16:05:31.045008 (Thread-6): 16:05:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:05:31.045119 (Thread-6): 16:05:31  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:31.045215 (Thread-6): 16:05:31  Opening a new connection, currently in state closed
2022-03-02 16:05:32.381349 (Thread-70): handling poll request
2022-03-02 16:05:32.381720 (Thread-70): 16:05:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f035ba30>]}
2022-03-02 16:05:32.382728 (Thread-70): sending response (<Response 27361 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:33.628723 (Thread-4): 16:05:33  SQL status: SUCCESS 1 in 2.59 seconds
2022-03-02 16:05:33.630520 (Thread-4): 16:05:33  finished collecting timing info
2022-03-02 16:05:33.630696 (Thread-4): 16:05:33  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 16:05:33.738677 (Thread-3): 16:05:33  SQL status: SUCCESS 1 in 2.7 seconds
2022-03-02 16:05:33.740258 (Thread-3): 16:05:33  finished collecting timing info
2022-03-02 16:05:33.740432 (Thread-3): 16:05:33  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 16:05:33.876964 (Thread-4): 16:05:33  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac17a2b0>]}
2022-03-02 16:05:33.877445 (Thread-4): 16:05:33  22 of 32 OK created incremental model DBT_VAULT.hub_part........................ [SUCCESS 1 in 2.91s]
2022-03-02 16:05:33.877582 (Thread-4): 16:05:33  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:05:33.877728 (Thread-4): 16:05:33  Began running node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:05:33.877913 (Thread-4): 16:05:33  25 of 32 START incremental model DBT_VAULT.link_inventory....................... [RUN]
2022-03-02 16:05:33.878155 (Thread-4): 16:05:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:05:33.878245 (Thread-4): 16:05:33  Began compiling node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:05:33.878336 (Thread-4): 16:05:33  Compiling model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:05:33.887090 (Thread-4): 16:05:33  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:05:33.903587 (Thread-4): 16:05:33  finished collecting timing info
2022-03-02 16:05:33.903791 (Thread-4): 16:05:33  Began executing node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:05:33.907388 (Thread-4): 16:05:33  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:05:33.919670 (Thread-5): 16:05:33  SQL status: SUCCESS 1 in 2.88 seconds
2022-03-02 16:05:33.921167 (Thread-5): 16:05:33  finished collecting timing info
2022-03-02 16:05:33.921375 (Thread-5): 16:05:33  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 16:05:33.925843 (Thread-4): 16:05:33  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:05:33.925985 (Thread-4): 16:05:33  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_inventory  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:33.926080 (Thread-4): 16:05:33  Opening a new connection, currently in state closed
2022-03-02 16:05:33.977449 (Thread-3): 16:05:33  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c610a30>]}
2022-03-02 16:05:33.977885 (Thread-3): 16:05:33  21 of 32 OK created incremental model DBT_VAULT.hub_nation...................... [SUCCESS 1 in 3.02s]
2022-03-02 16:05:33.978018 (Thread-3): 16:05:33  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:05:33.978167 (Thread-3): 16:05:33  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:05:33.978356 (Thread-3): 16:05:33  26 of 32 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 16:05:33.978607 (Thread-3): 16:05:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:05:33.978699 (Thread-3): 16:05:33  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:05:33.978790 (Thread-3): 16:05:33  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:05:33.989767 (Thread-3): 16:05:33  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:05:34.005014 (Thread-6): 16:05:34  SQL status: SUCCESS 1 in 2.96 seconds
2022-03-02 16:05:34.006568 (Thread-6): 16:05:34  finished collecting timing info
2022-03-02 16:05:34.006734 (Thread-6): 16:05:34  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 16:05:34.008231 (Thread-3): 16:05:34  finished collecting timing info
2022-03-02 16:05:34.008384 (Thread-3): 16:05:34  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:05:34.011662 (Thread-3): 16:05:34  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:05:34.029978 (Thread-3): 16:05:34  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:05:34.030148 (Thread-3): 16:05:34  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:34.030247 (Thread-3): 16:05:34  Opening a new connection, currently in state closed
2022-03-02 16:05:34.148815 (Thread-5): 16:05:34  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c64cdc0>]}
2022-03-02 16:05:34.149280 (Thread-5): 16:05:34  24 of 32 OK created incremental model DBT_VAULT.hub_supplier.................... [SUCCESS 1 in 3.18s]
2022-03-02 16:05:34.149428 (Thread-5): 16:05:34  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:05:34.149574 (Thread-5): 16:05:34  Began running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:05:34.149764 (Thread-5): 16:05:34  27 of 32 START incremental model DBT_VAULT.link_supplier_nation................. [RUN]
2022-03-02 16:05:34.150013 (Thread-5): 16:05:34  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:05:34.150105 (Thread-5): 16:05:34  Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:05:34.150195 (Thread-5): 16:05:34  Compiling model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:05:34.158754 (Thread-5): 16:05:34  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:05:34.167391 (Thread-71): handling poll request
2022-03-02 16:05:34.167813 (Thread-71): 16:05:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ff070>]}
2022-03-02 16:05:34.168851 (Thread-71): sending response (<Response 24219 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:34.204465 (Thread-5): 16:05:34  finished collecting timing info
2022-03-02 16:05:34.204720 (Thread-5): 16:05:34  Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:05:34.208135 (Thread-5): 16:05:34  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:05:34.255957 (Thread-5): 16:05:34  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:05:34.256146 (Thread-5): 16:05:34  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table DBT_RAW.DBT_VAULT.link_supplier_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:34.256244 (Thread-5): 16:05:34  Opening a new connection, currently in state closed
2022-03-02 16:05:34.373445 (Thread-6): 16:05:34  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c59e940>]}
2022-03-02 16:05:34.373881 (Thread-6): 16:05:34  23 of 32 OK created incremental model DBT_VAULT.hub_region...................... [SUCCESS 1 in 3.41s]
2022-03-02 16:05:34.374011 (Thread-6): 16:05:34  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:05:34.374153 (Thread-6): 16:05:34  Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:05:34.374338 (Thread-6): 16:05:34  28 of 32 START incremental model DBT_VAULT.sat_inv_inventory_details............ [RUN]
2022-03-02 16:05:34.374584 (Thread-6): 16:05:34  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:05:34.374671 (Thread-6): 16:05:34  Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:05:34.374767 (Thread-6): 16:05:34  Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:05:34.394047 (Thread-6): 16:05:34  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:05:34.437911 (Thread-6): 16:05:34  finished collecting timing info
2022-03-02 16:05:34.438115 (Thread-6): 16:05:34  Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:05:34.441731 (Thread-6): 16:05:34  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:05:34.465885 (Thread-6): 16:05:34  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:05:34.466051 (Thread-6): 16:05:34  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:34.466145 (Thread-6): 16:05:34  Opening a new connection, currently in state closed
2022-03-02 16:05:35.967405 (Thread-72): handling poll request
2022-03-02 16:05:35.967770 (Thread-72): 16:05:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ffac0>]}
2022-03-02 16:05:35.968560 (Thread-72): sending response (<Response 11030 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:37.765511 (Thread-73): handling poll request
2022-03-02 16:05:37.765895 (Thread-73): 16:05:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ffc70>]}
2022-03-02 16:05:37.766385 (Thread-73): sending response (<Response 292 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:38.516861 (Thread-3): 16:05:38  SQL status: SUCCESS 1 in 4.49 seconds
2022-03-02 16:05:38.518553 (Thread-3): 16:05:38  finished collecting timing info
2022-03-02 16:05:38.518724 (Thread-3): 16:05:38  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 16:05:38.719281 (Thread-3): 16:05:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c675bb0>]}
2022-03-02 16:05:38.719733 (Thread-3): 16:05:38  26 of 32 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 4.74s]
2022-03-02 16:05:38.719872 (Thread-3): 16:05:38  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:05:38.720020 (Thread-3): 16:05:38  Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:05:38.720205 (Thread-3): 16:05:38  29 of 32 START incremental model DBT_VAULT.sat_inv_part_details................. [RUN]
2022-03-02 16:05:38.720452 (Thread-3): 16:05:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:05:38.720543 (Thread-3): 16:05:38  Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:05:38.720634 (Thread-3): 16:05:38  Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:05:38.735411 (Thread-3): 16:05:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:05:38.750964 (Thread-3): 16:05:38  finished collecting timing info
2022-03-02 16:05:38.751130 (Thread-3): 16:05:38  Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:05:38.754273 (Thread-3): 16:05:38  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:05:38.756153 (Thread-5): 16:05:38  SQL status: SUCCESS 1 in 4.5 seconds
2022-03-02 16:05:38.757514 (Thread-5): 16:05:38  finished collecting timing info
2022-03-02 16:05:38.757659 (Thread-5): 16:05:38  On model.dbtvault_snowflake_demo.link_supplier_nation: Close
2022-03-02 16:05:38.771118 (Thread-3): 16:05:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:05:38.771246 (Thread-3): 16:05:38  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_part_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:38.771337 (Thread-3): 16:05:38  Opening a new connection, currently in state closed
2022-03-02 16:05:38.887080 (Thread-4): 16:05:38  SQL status: SUCCESS 1 in 4.96 seconds
2022-03-02 16:05:38.888990 (Thread-4): 16:05:38  finished collecting timing info
2022-03-02 16:05:38.889383 (Thread-4): 16:05:38  On model.dbtvault_snowflake_demo.link_inventory: Close
2022-03-02 16:05:38.942249 (Thread-6): 16:05:38  SQL status: SUCCESS 1 in 4.48 seconds
2022-03-02 16:05:38.943748 (Thread-6): 16:05:38  finished collecting timing info
2022-03-02 16:05:38.943911 (Thread-6): 16:05:38  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
2022-03-02 16:05:39.009766 (Thread-5): 16:05:39  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c58ae50>]}
2022-03-02 16:05:39.010201 (Thread-5): 16:05:39  27 of 32 OK created incremental model DBT_VAULT.link_supplier_nation............ [SUCCESS 1 in 4.86s]
2022-03-02 16:05:39.010336 (Thread-5): 16:05:39  Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:05:39.010488 (Thread-5): 16:05:39  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:05:39.010693 (Thread-5): 16:05:39  30 of 32 START incremental model DBT_VAULT.sat_inv_supp_nation_details.......... [RUN]
2022-03-02 16:05:39.010942 (Thread-5): 16:05:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:05:39.011033 (Thread-5): 16:05:39  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:05:39.011124 (Thread-5): 16:05:39  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:05:39.035399 (Thread-5): 16:05:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:05:39.078742 (Thread-5): 16:05:39  finished collecting timing info
2022-03-02 16:05:39.078967 (Thread-5): 16:05:39  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:05:39.082366 (Thread-5): 16:05:39  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:05:39.121588 (Thread-5): 16:05:39  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:05:39.121772 (Thread-5): 16:05:39  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:39.121868 (Thread-5): 16:05:39  Opening a new connection, currently in state closed
2022-03-02 16:05:39.162247 (Thread-4): 16:05:39  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac053760>]}
2022-03-02 16:05:39.162651 (Thread-4): 16:05:39  25 of 32 OK created incremental model DBT_VAULT.link_inventory.................. [SUCCESS 1 in 5.28s]
2022-03-02 16:05:39.162778 (Thread-4): 16:05:39  Finished running node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:05:39.162918 (Thread-4): 16:05:39  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:05:39.163101 (Thread-4): 16:05:39  31 of 32 START incremental model DBT_VAULT.sat_inv_supp_region_details.......... [RUN]
2022-03-02 16:05:39.163340 (Thread-4): 16:05:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:05:39.163428 (Thread-4): 16:05:39  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:05:39.163516 (Thread-4): 16:05:39  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:05:39.176971 (Thread-4): 16:05:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:05:39.193662 (Thread-4): 16:05:39  finished collecting timing info
2022-03-02 16:05:39.193859 (Thread-4): 16:05:39  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:05:39.197058 (Thread-4): 16:05:39  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:05:39.214559 (Thread-4): 16:05:39  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:05:39.214715 (Thread-4): 16:05:39  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:39.214809 (Thread-4): 16:05:39  Opening a new connection, currently in state closed
2022-03-02 16:05:39.243657 (Thread-6): 16:05:39  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cac71ca90>]}
2022-03-02 16:05:39.270810 (Thread-6): 16:05:39  28 of 32 OK created incremental model DBT_VAULT.sat_inv_inventory_details....... [SUCCESS 1 in 4.87s]
2022-03-02 16:05:39.271215 (Thread-6): 16:05:39  Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:05:39.271477 (Thread-6): 16:05:39  Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:05:39.271769 (Thread-6): 16:05:39  32 of 32 START incremental model DBT_VAULT.sat_inv_supplier_details............. [RUN]
2022-03-02 16:05:39.272168 (Thread-6): 16:05:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:05:39.272310 (Thread-6): 16:05:39  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:05:39.272445 (Thread-6): 16:05:39  Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:05:39.287583 (Thread-6): 16:05:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:05:39.305019 (Thread-6): 16:05:39  finished collecting timing info
2022-03-02 16:05:39.305348 (Thread-6): 16:05:39  Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:05:39.309143 (Thread-6): 16:05:39  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:05:39.326023 (Thread-6): 16:05:39  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:05:39.326162 (Thread-6): 16:05:39  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:05:39.326254 (Thread-6): 16:05:39  Opening a new connection, currently in state closed
2022-03-02 16:05:39.616209 (Thread-74): handling poll request
2022-03-02 16:05:39.616595 (Thread-74): 16:05:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f030dfa0>]}
2022-03-02 16:05:39.617994 (Thread-74): sending response (<Response 34999 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:40.676400 (Thread-3): 16:05:40  SQL status: SUCCESS 1 in 1.9 seconds
2022-03-02 16:05:40.678559 (Thread-3): 16:05:40  finished collecting timing info
2022-03-02 16:05:40.678742 (Thread-3): 16:05:40  On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
2022-03-02 16:05:40.922332 (Thread-3): 16:05:40  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c77fc40>]}
2022-03-02 16:05:40.922767 (Thread-3): 16:05:40  29 of 32 OK created incremental model DBT_VAULT.sat_inv_part_details............ [SUCCESS 1 in 2.20s]
2022-03-02 16:05:40.922895 (Thread-3): 16:05:40  Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:05:41.251807 (Thread-4): 16:05:41  SQL status: SUCCESS 1 in 2.04 seconds
2022-03-02 16:05:41.253343 (Thread-4): 16:05:41  finished collecting timing info
2022-03-02 16:05:41.253515 (Thread-4): 16:05:41  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
2022-03-02 16:05:41.431359 (Thread-75): handling poll request
2022-03-02 16:05:41.431777 (Thread-75): 16:05:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03185e0>]}
2022-03-02 16:05:41.432367 (Thread-75): sending response (<Response 4104 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:41.478618 (Thread-4): 16:05:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c65f610>]}
2022-03-02 16:05:41.479162 (Thread-4): 16:05:41  31 of 32 OK created incremental model DBT_VAULT.sat_inv_supp_region_details..... [SUCCESS 1 in 2.32s]
2022-03-02 16:05:41.479316 (Thread-4): 16:05:41  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:05:41.531623 (Thread-5): 16:05:41  SQL status: SUCCESS 1 in 2.41 seconds
2022-03-02 16:05:41.533106 (Thread-5): 16:05:41  finished collecting timing info
2022-03-02 16:05:41.533303 (Thread-5): 16:05:41  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
2022-03-02 16:05:41.675421 (Thread-6): 16:05:41  SQL status: SUCCESS 1 in 2.35 seconds
2022-03-02 16:05:41.676953 (Thread-6): 16:05:41  finished collecting timing info
2022-03-02 16:05:41.677131 (Thread-6): 16:05:41  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
2022-03-02 16:05:41.837093 (Thread-5): 16:05:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c59a520>]}
2022-03-02 16:05:41.837553 (Thread-5): 16:05:41  30 of 32 OK created incremental model DBT_VAULT.sat_inv_supp_nation_details..... [SUCCESS 1 in 2.83s]
2022-03-02 16:05:41.837687 (Thread-5): 16:05:41  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:05:41.880421 (Thread-6): 16:05:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bcbc68-b0d4-4c4a-8894-d8d5d212d680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9c577e50>]}
2022-03-02 16:05:41.880820 (Thread-6): 16:05:41  32 of 32 OK created incremental model DBT_VAULT.sat_inv_supplier_details........ [SUCCESS 1 in 2.61s]
2022-03-02 16:05:41.880945 (Thread-6): 16:05:41  Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:05:41.882649 (MainThread): 16:05:41  Acquiring new snowflake connection "master"
2022-03-02 16:05:41.883128 (MainThread): 16:05:41  
2022-03-02 16:05:41.883241 (MainThread): 16:05:41  Finished running 1 view model, 6 table models, 25 incremental models in 40.22s.
2022-03-02 16:05:41.883331 (MainThread): 16:05:41  Connection 'master' was properly closed.
2022-03-02 16:05:41.883401 (MainThread): 16:05:41  Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
2022-03-02 16:05:41.883466 (MainThread): 16:05:41  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
2022-03-02 16:05:41.883533 (MainThread): 16:05:41  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
2022-03-02 16:05:41.883596 (MainThread): 16:05:41  Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
2022-03-02 16:05:41.968175 (MainThread): 16:05:41  
2022-03-02 16:05:41.968392 (MainThread): 16:05:41  Completed with 1 error and 0 warnings:
2022-03-02 16:05:41.968485 (MainThread): 16:05:41  
2022-03-02 16:05:41.968578 (MainThread): 16:05:41  Database Error in model test1 (models/test1.sql)
2022-03-02 16:05:41.968657 (MainThread): 16:05:41    001003 (42000): SQL compilation error:
2022-03-02 16:05:41.968728 (MainThread): 16:05:41    syntax error line 7 at position 46 unexpected ';'.
2022-03-02 16:05:41.968806 (MainThread): 16:05:41    compiled SQL at target/run/dbtvault_snowflake_demo/models/test1.sql
2022-03-02 16:05:41.968923 (MainThread): 16:05:41  
2022-03-02 16:05:41.969014 (MainThread): 16:05:41  Done. PASS=31 WARN=0 ERROR=1 SKIP=0 TOTAL=32
2022-03-02 16:05:43.259336 (Thread-76): handling poll request
2022-03-02 16:05:43.259723 (Thread-76): 16:05:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03333a0>]}
2022-03-02 16:05:43.263359 (Thread-76): sending response (<Response 159231 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:45.283273 (Thread-77): handling status request
2022-03-02 16:05:45.283638 (Thread-77): 16:05:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f030df70>]}
2022-03-02 16:05:45.284103 (Thread-77): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:45.285128 (Thread-78): handling status request
2022-03-02 16:05:45.285563 (Thread-78): 16:05:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0328580>]}
2022-03-02 16:05:45.286016 (Thread-78): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:54.197745 (Thread-79): handling status request
2022-03-02 16:05:54.198261 (Thread-79): 16:05:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f05659a0>]}
2022-03-02 16:05:54.198810 (Thread-79): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:54.204890 (Thread-80): handling list request
2022-03-02 16:05:54.205168 (Thread-80): 16:05:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02caa90>]}
2022-03-02 16:05:54.241225 (Thread-80): 16:05:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ca220>]}
2022-03-02 16:05:54.241633 (Thread-80): 16:05:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:05:54.245333 (Thread-80): sending response (<Response 5514 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:05:59.902270 (Thread-81): handling status request
2022-03-02 16:05:59.902719 (Thread-81): 16:05:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02caf10>]}
2022-03-02 16:05:59.903243 (Thread-81): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:00.202692 (Thread-82): handling status request
2022-03-02 16:06:00.203050 (Thread-82): 16:06:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03286a0>]}
2022-03-02 16:06:00.203522 (Thread-82): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:00.508433 (Thread-83): handling cli_args request
2022-03-02 16:06:00.508817 (Thread-83): 16:06:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0365970>]}
2022-03-02 16:06:02.936057 (Thread-83): sending response (<Response 138 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:03.513097 (MainThread): 16:06:03  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:06:03.513563 (MainThread): 16:06:03  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:06:03.521681 (MainThread): 16:06:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80baea8c-9f09-4e90-8a1b-9a5d070c13c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c476bfa0>]}
2022-03-02 16:06:03.558544 (MainThread): 16:06:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80baea8c-9f09-4e90-8a1b-9a5d070c13c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c4840b20>]}
2022-03-02 16:06:03.558902 (MainThread): 16:06:03  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:06:03.560760 (MainThread): 16:06:03  
2022-03-02 16:06:03.561121 (MainThread): 16:06:03  Acquiring new snowflake connection "master"
2022-03-02 16:06:03.562026 (ThreadPoolExecutor-0_0): 16:06:03  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 16:06:03.575991 (ThreadPoolExecutor-0_0): 16:06:03  Using snowflake connection "list_DBT_RAW"
2022-03-02 16:06:03.576125 (ThreadPoolExecutor-0_0): 16:06:03  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 16:06:03.576212 (ThreadPoolExecutor-0_0): 16:06:03  Opening a new connection, currently in state init
2022-03-02 16:06:03.790497 (Thread-84): handling poll request
2022-03-02 16:06:03.790964 (Thread-84): 16:06:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03182e0>]}
2022-03-02 16:06:03.791932 (Thread-84): sending response (<Response 4161 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:04.864737 (ThreadPoolExecutor-0_0): 16:06:04  SQL status: SUCCESS 7 in 1.29 seconds
2022-03-02 16:06:04.866869 (ThreadPoolExecutor-0_0): 16:06:04  On list_DBT_RAW: Close
2022-03-02 16:06:05.193578 (ThreadPoolExecutor-2_0): 16:06:05  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:06:05.201740 (ThreadPoolExecutor-2_0): 16:06:05  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:06:05.201912 (ThreadPoolExecutor-2_0): 16:06:05  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 16:06:05.202019 (ThreadPoolExecutor-2_0): 16:06:05  Opening a new connection, currently in state closed
2022-03-02 16:06:05.604303 (Thread-85): handling poll request
2022-03-02 16:06:05.604741 (Thread-85): 16:06:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ec310>]}
2022-03-02 16:06:05.605378 (Thread-85): sending response (<Response 2317 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:06.094947 (ThreadPoolExecutor-2_0): 16:06:06  SQL status: SUCCESS 31 in 0.89 seconds
2022-03-02 16:06:06.097157 (ThreadPoolExecutor-2_0): 16:06:06  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 16:06:06.385027 (MainThread): 16:06:06  Concurrency: 4 threads (target='default')
2022-03-02 16:06:06.385213 (MainThread): 16:06:06  
2022-03-02 16:06:06.388281 (Thread-3): 16:06:06  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:06:06.388722 (Thread-3): 16:06:06  1 of 1 START incremental model DBT_VAULT.sat_order_customer_details............. [RUN]
2022-03-02 16:06:06.389094 (Thread-3): 16:06:06  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:06.389212 (Thread-3): 16:06:06  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:06:06.389350 (Thread-3): 16:06:06  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:06:06.482620 (Thread-3): 16:06:06  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:06.498277 (Thread-3): 16:06:06  finished collecting timing info
2022-03-02 16:06:06.498504 (Thread-3): 16:06:06  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:06:06.542485 (Thread-3): 16:06:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:06.542658 (Thread-3): 16:06:06  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:06:06.542770 (Thread-3): 16:06:06  Opening a new connection, currently in state closed
2022-03-02 16:06:08.315960 (Thread-86): handling poll request
2022-03-02 16:06:08.316384 (Thread-86): 16:06:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f028cc10>]}
2022-03-02 16:06:08.317049 (Thread-86): sending response (<Response 8273 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:09.067741 (Thread-3): 16:06:09  SQL status: SUCCESS 1 in 2.52 seconds
2022-03-02 16:06:09.078024 (Thread-3): 16:06:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:09.078173 (Thread-3): 16:06:09  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp
2022-03-02 16:06:09.299699 (Thread-3): 16:06:09  SQL status: SUCCESS 12 in 0.22 seconds
2022-03-02 16:06:09.303806 (Thread-3): 16:06:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:09.303930 (Thread-3): 16:06:09  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details
2022-03-02 16:06:09.412338 (Thread-3): 16:06:09  SQL status: SUCCESS 12 in 0.11 seconds
2022-03-02 16:06:09.420764 (Thread-3): 16:06:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:09.420892 (Thread-3): 16:06:09  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
2022-03-02 16:06:09.560409 (Thread-3): 16:06:09  SQL status: SUCCESS 12 in 0.14 seconds
2022-03-02 16:06:09.581815 (Thread-3): 16:06:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:09.599635 (Thread-3): 16:06:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:09.599783 (Thread-3): 16:06:09  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
2022-03-02 16:06:09.782926 (Thread-3): 16:06:09  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:06:09.783182 (Thread-3): 16:06:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:09.783273 (Thread-3): 16:06:09  On model.dbtvault_snowflake_demo.sat_order_customer_details: merge into DBT_RAW.DBT_VAULT.sat_order_customer_details as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ACCBAL" = DBT_INTERNAL_SOURCE."CUSTOMER_ACCBAL","CUSTOMER_MKTSEGMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_MKTSEGMENT","CUSTOMER_COMMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_COMMENT","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-02 16:06:09.829924 (Thread-87): handling poll request
2022-03-02 16:06:09.830283 (Thread-87): 16:06:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0298460>]}
2022-03-02 16:06:09.830932 (Thread-87): sending response (<Response 8950 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:10.341149 (Thread-3): 16:06:10  SQL status: SUCCESS 0 in 0.56 seconds
2022-03-02 16:06:10.341407 (Thread-3): 16:06:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:06:10.341501 (Thread-3): 16:06:10  On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
2022-03-02 16:06:10.624312 (Thread-3): 16:06:10  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-02 16:06:10.635017 (Thread-3): 16:06:10  finished collecting timing info
2022-03-02 16:06:10.635244 (Thread-3): 16:06:10  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 16:06:10.913785 (Thread-3): 16:06:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80baea8c-9f09-4e90-8a1b-9a5d070c13c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bc3b9760>]}
2022-03-02 16:06:10.914236 (Thread-3): 16:06:10  1 of 1 OK created incremental model DBT_VAULT.sat_order_customer_details........ [SUCCESS 1 in 4.52s]
2022-03-02 16:06:10.914429 (Thread-3): 16:06:10  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:06:10.916081 (MainThread): 16:06:10  Acquiring new snowflake connection "master"
2022-03-02 16:06:10.916403 (MainThread): 16:06:10  
2022-03-02 16:06:10.916507 (MainThread): 16:06:10  Finished running 1 incremental model in 7.36s.
2022-03-02 16:06:10.916592 (MainThread): 16:06:10  Connection 'master' was properly closed.
2022-03-02 16:06:10.916662 (MainThread): 16:06:10  Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
2022-03-02 16:06:10.994343 (MainThread): 16:06:10  
2022-03-02 16:06:10.994579 (MainThread): 16:06:10  Completed successfully
2022-03-02 16:06:10.994688 (MainThread): 16:06:10  
2022-03-02 16:06:10.994799 (MainThread): 16:06:10  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-02 16:06:11.663547 (Thread-88): handling poll request
2022-03-02 16:06:11.663963 (Thread-88): 16:06:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0298fd0>]}
2022-03-02 16:06:11.664952 (Thread-88): sending response (<Response 12632 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:50.472140 (Thread-89): handling status request
2022-03-02 16:06:50.472511 (Thread-89): 16:06:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b21c0>]}
2022-03-02 16:06:50.473024 (Thread-89): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:50.895846 (Thread-90): handling status request
2022-03-02 16:06:50.896213 (Thread-90): 16:06:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b25b0>]}
2022-03-02 16:06:50.896679 (Thread-90): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:50.906259 (Thread-91): handling ps request
2022-03-02 16:06:50.906525 (Thread-91): 16:06:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b27f0>]}
2022-03-02 16:06:50.907391 (Thread-91): sending response (<Response 3573 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:51.127328 (Thread-92): handling status request
2022-03-02 16:06:51.127694 (Thread-92): 16:06:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b2a90>]}
2022-03-02 16:06:51.149974 (Thread-92): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:53.809275 (Thread-93): handling poll request
2022-03-02 16:06:53.809673 (Thread-93): 16:06:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b2f10>]}
2022-03-02 16:06:53.810973 (Thread-93): sending response (<Response 35034 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:55.597216 (Thread-94): handling status request
2022-03-02 16:06:55.597627 (Thread-94): 16:06:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b28e0>]}
2022-03-02 16:06:55.598100 (Thread-94): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:06:55.870216 (Thread-95): handling status request
2022-03-02 16:06:55.870675 (Thread-95): 16:06:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0298f10>]}
2022-03-02 16:06:55.871254 (Thread-95): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:07:48.275195 (Thread-96): handling status request
2022-03-02 16:07:48.275731 (Thread-96): 16:07:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f028c700>]}
2022-03-02 16:07:48.276229 (Thread-96): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:07:48.282168 (Thread-97): handling list request
2022-03-02 16:07:48.282430 (Thread-97): 16:07:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ee8e0>]}
2022-03-02 16:07:48.324475 (Thread-97): 16:07:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0298430>]}
2022-03-02 16:07:48.324907 (Thread-97): 16:07:48  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:07:48.332607 (Thread-97): sending response (<Response 5514 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:08:00.564866 (Thread-98): handling status request
2022-03-02 16:08:00.566996 (Thread-98): 16:08:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0528040>]}
2022-03-02 16:08:00.567476 (Thread-98): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:08:00.573380 (Thread-99): handling list request
2022-03-02 16:08:00.573628 (Thread-99): 16:08:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02b2dc0>]}
2022-03-02 16:08:00.610606 (Thread-99): 16:08:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0298d90>]}
2022-03-02 16:08:00.610938 (Thread-99): 16:08:00  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:08:00.621130 (Thread-99): sending response (<Response 16919 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:08:41.911950 (Thread-100): handling status request
2022-03-02 16:08:41.912318 (Thread-100): 16:08:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0258f10>]}
2022-03-02 16:08:41.912782 (Thread-100): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:08:41.926260 (Thread-101): handling list request
2022-03-02 16:08:41.926562 (Thread-101): 16:08:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f026ea00>]}
2022-03-02 16:08:41.962026 (Thread-101): 16:08:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ee5e0>]}
2022-03-02 16:08:41.962395 (Thread-101): 16:08:41  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:08:41.971939 (Thread-101): sending response (<Response 23531 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:09:19.717821 (Thread-102): handling status request
2022-03-02 16:09:19.718201 (Thread-102): 16:09:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02386a0>]}
2022-03-02 16:09:19.718680 (Thread-102): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:09:19.725035 (Thread-103): handling list request
2022-03-02 16:09:19.725407 (Thread-103): 16:09:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ee670>]}
2022-03-02 16:09:19.766535 (Thread-103): 16:09:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0266c70>]}
2022-03-02 16:09:19.766893 (Thread-103): 16:09:19  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:09:19.779645 (Thread-103): sending response (<Response 16921 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:10:42.254569 (Thread-104): handling status request
2022-03-02 16:10:42.256630 (Thread-104): 16:10:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02eb9a0>]}
2022-03-02 16:10:42.257117 (Thread-104): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:10:42.274432 (Thread-105): handling list request
2022-03-02 16:10:42.274734 (Thread-105): 16:10:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02eb0a0>]}
2022-03-02 16:10:42.316079 (Thread-105): 16:10:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0287f10>]}
2022-03-02 16:10:42.316461 (Thread-105): 16:10:42  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:10:42.327166 (Thread-105): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:36.253425 (Thread-106): handling status request
2022-03-02 16:11:36.254067 (Thread-106): 16:11:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ee6d0>]}
2022-03-02 16:11:36.254587 (Thread-107): handling status request
2022-03-02 16:11:36.255453 (Thread-106): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:36.255820 (Thread-107): 16:11:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02eecd0>]}
2022-03-02 16:11:36.256511 (Thread-107): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:36.377052 (Thread-108): handling ps request
2022-03-02 16:11:36.377494 (Thread-108): 16:11:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ee280>]}
2022-03-02 16:11:36.378370 (Thread-108): sending response (<Response 5023 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:36.396849 (Thread-109): handling status request
2022-03-02 16:11:36.397138 (Thread-109): 16:11:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ee6d0>]}
2022-03-02 16:11:36.397599 (Thread-109): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:37.689435 (Thread-110): handling poll request
2022-03-02 16:11:37.689902 (Thread-110): 16:11:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0287bb0>]}
2022-03-02 16:11:37.691289 (Thread-110): sending response (<Response 35034 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:39.519077 (Thread-111): handling status request
2022-03-02 16:11:39.519475 (Thread-111): 16:11:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02876a0>]}
2022-03-02 16:11:39.519982 (Thread-111): sending response (<Response 1255 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:52.751853 (Thread-112): handling status request
2022-03-02 16:11:52.752231 (Thread-112): 16:11:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f028c9d0>]}
2022-03-02 16:11:52.752699 (Thread-112): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:11:52.758656 (Thread-113): handling list request
2022-03-02 16:11:52.759073 (Thread-113): 16:11:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f03b8910>]}
2022-03-02 16:11:52.793037 (Thread-113): 16:11:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0287df0>]}
2022-03-02 16:11:52.793419 (Thread-113): 16:11:52  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:11:52.797138 (Thread-113): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:12:41.422962 (Thread-114): handling status request
2022-03-02 16:12:41.423333 (Thread-114): 16:12:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f02ec5b0>]}
2022-03-02 16:12:41.423800 (Thread-114): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:12:41.428983 (Thread-115): handling list request
2022-03-02 16:12:41.429274 (Thread-115): 16:12:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01d78b0>]}
2022-03-02 16:12:41.474911 (Thread-115): 16:12:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0287d00>]}
2022-03-02 16:12:41.500264 (Thread-115): 16:12:41  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:12:41.511032 (Thread-115): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:12:42.100445 (Thread-116): handling status request
2022-03-02 16:12:42.100832 (Thread-116): 16:12:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0228820>]}
2022-03-02 16:12:42.101353 (Thread-116): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:12:42.117559 (Thread-117): handling list request
2022-03-02 16:12:42.117864 (Thread-117): 16:12:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0228e20>]}
2022-03-02 16:12:42.151221 (Thread-117): 16:12:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0228dc0>]}
2022-03-02 16:12:42.151581 (Thread-117): 16:12:42  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:12:42.155373 (Thread-117): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:13:38.078836 (Thread-118): handling status request
2022-03-02 16:13:38.079225 (Thread-118): 16:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01d7490>]}
2022-03-02 16:13:38.079704 (Thread-118): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:13:38.095452 (Thread-119): handling list request
2022-03-02 16:13:38.095800 (Thread-119): 16:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f022cfd0>]}
2022-03-02 16:13:38.131207 (Thread-119): 16:13:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0528430>]}
2022-03-02 16:13:38.131567 (Thread-119): 16:13:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:13:38.134272 (Thread-119): sending response (<Response 1923 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:13:38.394620 (Thread-120): handling status request
2022-03-02 16:13:38.395004 (Thread-120): 16:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0206e80>]}
2022-03-02 16:13:38.395483 (Thread-120): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:13:38.402220 (Thread-121): handling list request
2022-03-02 16:13:38.402527 (Thread-121): 16:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0528910>]}
2022-03-02 16:13:38.437012 (Thread-121): 16:13:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01d7e20>]}
2022-03-02 16:13:38.437405 (Thread-121): 16:13:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:13:38.440966 (Thread-121): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:13:38.768680 (Thread-122): handling status request
2022-03-02 16:13:38.769070 (Thread-122): 16:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01b24c0>]}
2022-03-02 16:13:38.769621 (Thread-122): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:13:38.776265 (Thread-123): handling list request
2022-03-02 16:13:38.776644 (Thread-123): 16:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01b2df0>]}
2022-03-02 16:13:38.809830 (Thread-123): 16:13:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f022cee0>]}
2022-03-02 16:13:38.810148 (Thread-123): 16:13:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:13:38.812636 (Thread-123): sending response (<Response 1923 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:14:15.366836 (Thread-124): handling status request
2022-03-02 16:14:15.367208 (Thread-124): 16:14:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f014c250>]}
2022-03-02 16:14:15.367677 (Thread-124): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:14:15.373807 (Thread-125): handling list request
2022-03-02 16:14:15.374100 (Thread-125): 16:14:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0228490>]}
2022-03-02 16:14:15.457819 (Thread-125): 16:14:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01b2df0>]}
2022-03-02 16:14:15.458163 (Thread-125): 16:14:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:14:15.469054 (Thread-125): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:14:30.330787 (Thread-126): handling status request
2022-03-02 16:14:30.331156 (Thread-126): 16:14:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0159130>]}
2022-03-02 16:14:30.331618 (Thread-126): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:14:30.351943 (Thread-127): handling list request
2022-03-02 16:14:30.352215 (Thread-127): 16:14:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0159fd0>]}
2022-03-02 16:14:30.387377 (Thread-127): 16:14:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0159910>]}
2022-03-02 16:14:30.387678 (Thread-127): 16:14:30  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:14:30.396203 (Thread-127): sending response (<Response 16921 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:46.137834 (Thread-128): handling status request
2022-03-02 16:15:46.140197 (Thread-128): 16:15:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01594c0>]}
2022-03-02 16:15:46.140692 (Thread-128): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:46.158567 (Thread-129): handling list request
2022-03-02 16:15:46.158979 (Thread-129): 16:15:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0174b20>]}
2022-03-02 16:15:46.204332 (Thread-129): 16:15:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0159b20>]}
2022-03-02 16:15:46.204713 (Thread-129): 16:15:46  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:15:46.213462 (Thread-129): sending response (<Response 3766 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:48.996070 (Thread-130): handling status request
2022-03-02 16:15:48.996473 (Thread-130): 16:15:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f011f430>]}
2022-03-02 16:15:48.996977 (Thread-130): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:49.003040 (Thread-131): handling list request
2022-03-02 16:15:49.003365 (Thread-131): 16:15:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f011f760>]}
2022-03-02 16:15:49.036718 (Thread-131): 16:15:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0174ca0>]}
2022-03-02 16:15:49.037096 (Thread-131): 16:15:49  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:15:49.044451 (Thread-131): sending response (<Response 16921 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:51.741811 (Thread-132): handling status request
2022-03-02 16:15:51.742196 (Thread-132): 16:15:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0108d00>]}
2022-03-02 16:15:51.742679 (Thread-132): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:51.749638 (Thread-133): handling list request
2022-03-02 16:15:51.749928 (Thread-133): 16:15:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0108f40>]}
2022-03-02 16:15:51.916203 (Thread-133): 16:15:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94206aeeb0>]}
2022-03-02 16:15:51.916553 (Thread-133): 16:15:51  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:15:51.925846 (Thread-133): sending response (<Response 5516 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:52.729523 (Thread-134): handling status request
2022-03-02 16:15:52.729898 (Thread-134): 16:15:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9420192820>]}
2022-03-02 16:15:52.730370 (Thread-134): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:52.736314 (Thread-135): handling list request
2022-03-02 16:15:52.736589 (Thread-135): 16:15:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201928e0>]}
2022-03-02 16:15:52.771522 (Thread-135): 16:15:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f01171f0>]}
2022-03-02 16:15:52.790355 (Thread-135): 16:15:52  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:15:52.796198 (Thread-135): sending response (<Response 5469 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:56.566190 (Thread-136): handling status request
2022-03-02 16:15:56.566553 (Thread-136): 16:15:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201acac0>]}
2022-03-02 16:15:56.567023 (Thread-136): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:56.574228 (Thread-137): handling list request
2022-03-02 16:15:56.574502 (Thread-137): 16:15:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201afa30>]}
2022-03-02 16:15:56.611046 (Thread-137): 16:15:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201ac520>]}
2022-03-02 16:15:56.611380 (Thread-137): 16:15:56  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:15:56.616649 (Thread-137): sending response (<Response 5481 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:58.998189 (Thread-138): handling status request
2022-03-02 16:15:58.998563 (Thread-138): 16:15:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201b37f0>]}
2022-03-02 16:15:58.999166 (Thread-138): sending response (<Response 1233 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:15:59.004965 (Thread-139): handling list request
2022-03-02 16:15:59.005264 (Thread-139): 16:15:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201b3e20>]}
2022-03-02 16:15:59.042064 (Thread-139): 16:15:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e2aa22-26be-40f5-8c5a-60fda58c086f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94201afa00>]}
2022-03-02 16:15:59.042409 (Thread-139): 16:15:59  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:15:59.048166 (Thread-139): sending response (<Response 6660 bytes [200 OK]>) to 10.0.23.55
2022-03-02 16:30:59.287164 (MainThread): Running with dbt=1.0.3
2022-03-02 16:30:59.496581 (MainThread): 16:30:59  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 16:30:59.496858 (MainThread): 16:30:59  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80a7610>]}
2022-03-02 16:30:59.497169 (MainThread): 16:30:59  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-02 16:30:59.497333 (MainThread): 16:30:59  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80a72b0>]}
2022-03-02 16:30:59.526156 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-02 16:30:59.529510 (MainThread): Tracking: tracking
2022-03-02 16:30:59.530813 (MainThread): 16:30:59  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed7bae130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80cdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbece2ddd30>]}
2022-03-02 16:30:59.532779 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-03-02 16:30:59.537594 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-02 16:30:59.537888 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-02 16:31:00.405572 (Thread-12): 16:31:00  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:31:00.405866 (Thread-12): 16:31:00  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:31:00.416033 (Thread-12): 16:31:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ce8be0>]}
2022-03-02 16:32:54.588540 (Thread-13): handling status request
2022-03-02 16:32:54.588936 (Thread-13): 16:32:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80aed90>]}
2022-03-02 16:32:54.589574 (Thread-13): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:32:54.590930 (Thread-14): handling status request
2022-03-02 16:32:54.591287 (Thread-14): 16:32:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea807a730>]}
2022-03-02 16:32:54.591735 (Thread-14): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:32:54.753303 (Thread-15): handling status request
2022-03-02 16:32:54.753689 (Thread-15): 16:32:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea806c2b0>]}
2022-03-02 16:32:54.754238 (Thread-15): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:32:54.760032 (Thread-16): handling ps request
2022-03-02 16:32:54.760383 (Thread-16): 16:32:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4430>]}
2022-03-02 16:32:54.760861 (Thread-16): sending response (<Response 105 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:01.172477 (Thread-17): handling status request
2022-03-02 16:33:01.172938 (Thread-17): 16:33:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4310>]}
2022-03-02 16:33:01.173541 (Thread-17): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:01.281650 (Thread-18): handling status request
2022-03-02 16:33:01.282091 (Thread-18): 16:33:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4eb0>]}
2022-03-02 16:33:01.282578 (Thread-18): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:01.316783 (Thread-19): handling ps request
2022-03-02 16:33:01.317165 (Thread-19): 16:33:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4b80>]}
2022-03-02 16:33:01.317591 (Thread-19): sending response (<Response 105 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:01.461650 (Thread-20): handling status request
2022-03-02 16:33:01.462080 (Thread-20): 16:33:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4ac0>]}
2022-03-02 16:33:01.462563 (Thread-20): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:03.056663 (Thread-21): handling status request
2022-03-02 16:33:03.057063 (Thread-21): 16:33:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92cd2670>]}
2022-03-02 16:33:03.057589 (Thread-21): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:03.064518 (Thread-22): handling list request
2022-03-02 16:33:03.070247 (Thread-22): 16:33:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92cd23d0>]}
2022-03-02 16:33:03.110894 (Thread-22): 16:33:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80920a0>]}
2022-03-02 16:33:03.111336 (Thread-22): 16:33:03  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:33:03.114925 (Thread-22): 16:33:03  The selection criterion '+1646238782679/__unsaved/Statement' does not match any nodes
2022-03-02 16:33:03.115465 (Thread-22): 16:33:03  The selection criterion '22.sql+' does not match any nodes
2022-03-02 16:33:03.115619 (Thread-22): 16:33:03  No nodes selected!
2022-03-02 16:33:03.117414 (Thread-22): sending response (<Response 2345 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:33:03.397219 (Thread-23): handling status request
2022-03-02 16:33:03.397607 (Thread-23): 16:33:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea807a340>]}
2022-03-02 16:33:03.398157 (Thread-23): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:21.067830 (Thread-24): handling status request
2022-03-02 16:37:21.069749 (Thread-24): 16:37:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4e80>]}
2022-03-02 16:37:21.070257 (Thread-24): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:21.866932 (Thread-25): handling status request
2022-03-02 16:37:21.867300 (Thread-25): 16:37:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80842b0>]}
2022-03-02 16:37:21.867753 (Thread-25): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:21.875922 (Thread-26): handling cli_args request
2022-03-02 16:37:21.876168 (Thread-26): 16:37:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8084130>]}
2022-03-02 16:37:24.138609 (Thread-26): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:24.523664 (MainThread): 16:37:24  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-02 16:37:24.524116 (MainThread): 16:37:24  Partial parsing enabled, no changes found, skipping parsing
2022-03-02 16:37:24.531870 (MainThread): 16:37:24  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cfd69c10>]}
2022-03-02 16:37:24.579608 (MainThread): 16:37:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cfe46a60>]}
2022-03-02 16:37:24.579947 (MainThread): 16:37:24  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:37:24.582387 (MainThread): 16:37:24  
2022-03-02 16:37:24.582774 (MainThread): 16:37:24  Acquiring new snowflake connection "master"
2022-03-02 16:37:24.584863 (ThreadPoolExecutor-0_0): 16:37:24  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-02 16:37:24.598023 (ThreadPoolExecutor-0_0): 16:37:24  Using snowflake connection "list_DBT_RAW"
2022-03-02 16:37:24.598156 (ThreadPoolExecutor-0_0): 16:37:24  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-02 16:37:24.598244 (ThreadPoolExecutor-0_0): 16:37:24  Opening a new connection, currently in state init
2022-03-02 16:37:24.891730 (Thread-27): handling poll request
2022-03-02 16:37:24.892170 (Thread-27): 16:37:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca1ac0>]}
2022-03-02 16:37:24.893056 (Thread-27): sending response (<Response 4125 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:25.640130 (ThreadPoolExecutor-0_0): 16:37:25  SQL status: SUCCESS 7 in 1.04 seconds
2022-03-02 16:37:25.642900 (ThreadPoolExecutor-0_0): 16:37:25  On list_DBT_RAW: Close
2022-03-02 16:37:25.873299 (ThreadPoolExecutor-2_0): 16:37:25  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:37:25.882397 (ThreadPoolExecutor-2_0): 16:37:25  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-02 16:37:25.882555 (ThreadPoolExecutor-2_0): 16:37:25  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-02 16:37:25.882656 (ThreadPoolExecutor-2_0): 16:37:25  Opening a new connection, currently in state closed
2022-03-02 16:37:26.691433 (Thread-28): handling poll request
2022-03-02 16:37:26.691851 (Thread-28): 16:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8070fa0>]}
2022-03-02 16:37:26.692404 (Thread-28): sending response (<Response 2282 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:26.716607 (ThreadPoolExecutor-2_0): 16:37:26  SQL status: SUCCESS 31 in 0.83 seconds
2022-03-02 16:37:26.718796 (ThreadPoolExecutor-2_0): 16:37:26  On list_DBT_RAW_DBT_VAULT: Close
2022-03-02 16:37:26.960683 (MainThread): 16:37:26  Concurrency: 4 threads (target='default')
2022-03-02 16:37:26.960861 (MainThread): 16:37:26  
2022-03-02 16:37:26.963885 (Thread-3): 16:37:26  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:37:26.964237 (Thread-3): 16:37:26  1 of 31 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-02 16:37:26.964527 (Thread-3): 16:37:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:37:26.964635 (Thread-3): 16:37:26  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:37:26.964746 (Thread-3): 16:37:26  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:37:26.968946 (Thread-4): 16:37:26  Began running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:37:26.969212 (Thread-4): 16:37:26  2 of 31 START table model DBT_VAULT.raw_transactions............................ [RUN]
2022-03-02 16:37:26.969496 (Thread-4): 16:37:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:37:26.969589 (Thread-4): 16:37:26  Began compiling node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:37:26.969682 (Thread-4): 16:37:26  Compiling model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:37:26.973210 (Thread-4): 16:37:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:37:26.975250 (Thread-3): 16:37:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:37:26.992366 (Thread-3): 16:37:26  finished collecting timing info
2022-03-02 16:37:26.992590 (Thread-3): 16:37:26  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:37:26.997434 (Thread-4): 16:37:26  finished collecting timing info
2022-03-02 16:37:26.997624 (Thread-4): 16:37:26  Began executing node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:37:27.043381 (Thread-4): 16:37:27  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:37:27.043859 (Thread-3): 16:37:27  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:37:27.063806 (Thread-3): 16:37:27  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-02 16:37:27.063993 (Thread-3): 16:37:27  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 16:37:27.064089 (Thread-3): 16:37:27  Opening a new connection, currently in state closed
2022-03-02 16:37:27.066021 (Thread-4): 16:37:27  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-02 16:37:27.066153 (Thread-4): 16:37:27  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_transactions  as
      (SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-02 16:37:27.066236 (Thread-4): 16:37:27  Opening a new connection, currently in state init
2022-03-02 16:37:28.448704 (Thread-29): handling poll request
2022-03-02 16:37:28.449104 (Thread-29): 16:37:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca7340>]}
2022-03-02 16:37:28.449972 (Thread-29): sending response (<Response 15116 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:30.226753 (Thread-30): handling poll request
2022-03-02 16:37:30.227127 (Thread-30): 16:37:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca74f0>]}
2022-03-02 16:37:30.227647 (Thread-30): sending response (<Response 291 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:31.500670 (Thread-4): 16:37:31  SQL status: SUCCESS 1 in 4.43 seconds
2022-03-02 16:37:31.510281 (Thread-4): 16:37:31  finished collecting timing info
2022-03-02 16:37:31.510471 (Thread-4): 16:37:31  On model.dbtvault_snowflake_demo.raw_transactions: Close
2022-03-02 16:37:31.743873 (Thread-4): 16:37:31  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc17e970>]}
2022-03-02 16:37:31.744334 (Thread-4): 16:37:31  2 of 31 OK created table model DBT_VAULT.raw_transactions....................... [SUCCESS 1 in 4.77s]
2022-03-02 16:37:31.744466 (Thread-4): 16:37:31  Finished running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-02 16:37:31.745307 (Thread-6): 16:37:31  Began running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:37:31.745577 (Thread-6): 16:37:31  3 of 31 START table model DBT_VAULT.v_stg_transactions.......................... [RUN]
2022-03-02 16:37:31.745964 (Thread-6): 16:37:31  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:37:31.746113 (Thread-6): 16:37:31  Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:37:31.746260 (Thread-6): 16:37:31  Compiling model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:37:31.787409 (Thread-6): 16:37:31  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:37:31.787573 (Thread-6): 16:37:31  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-02 16:37:31.787665 (Thread-6): 16:37:31  Opening a new connection, currently in state init
2022-03-02 16:37:31.998241 (Thread-31): handling poll request
2022-03-02 16:37:31.998623 (Thread-31): 16:37:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca7d60>]}
2022-03-02 16:37:31.999288 (Thread-31): sending response (<Response 6442 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:32.456130 (Thread-6): 16:37:32  SQL status: SUCCESS 7 in 0.67 seconds
2022-03-02 16:37:32.485035 (Thread-6): 16:37:32  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:37:32.485198 (Thread-6): 16:37:32  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-02 16:37:32.644796 (Thread-6): 16:37:32  SQL status: SUCCESS 7 in 0.16 seconds
2022-03-02 16:37:32.678015 (Thread-6): 16:37:32  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:37:32.693988 (Thread-6): 16:37:32  finished collecting timing info
2022-03-02 16:37:32.694191 (Thread-6): 16:37:32  Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:37:32.696824 (Thread-6): 16:37:32  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:37:32.712709 (Thread-6): 16:37:32  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-02 16:37:32.712846 (Thread-6): 16:37:32  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_transactions  as
      (







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM DBT_RAW.DBT_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
      );
2022-03-02 16:37:33.774411 (Thread-32): handling poll request
2022-03-02 16:37:33.774781 (Thread-32): 16:37:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca7850>]}
2022-03-02 16:37:33.775390 (Thread-32): sending response (<Response 6258 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:34.632137 (Thread-6): 16:37:34  SQL status: SUCCESS 1 in 1.92 seconds
2022-03-02 16:37:34.633581 (Thread-6): 16:37:34  finished collecting timing info
2022-03-02 16:37:34.633749 (Thread-6): 16:37:34  On model.dbtvault_snowflake_demo.v_stg_transactions: Close
2022-03-02 16:37:34.831604 (Thread-6): 16:37:34  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc1f8520>]}
2022-03-02 16:37:34.832038 (Thread-6): 16:37:34  3 of 31 OK created table model DBT_VAULT.v_stg_transactions..................... [SUCCESS 1 in 3.09s]
2022-03-02 16:37:34.832166 (Thread-6): 16:37:34  Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-02 16:37:34.832961 (Thread-4): 16:37:34  Began running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:37:34.833234 (Thread-4): 16:37:34  4 of 31 START incremental model DBT_VAULT.t_link_transactions................... [RUN]
2022-03-02 16:37:34.833506 (Thread-4): 16:37:34  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:34.833622 (Thread-4): 16:37:34  Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:37:34.833718 (Thread-4): 16:37:34  Compiling model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:37:34.897515 (Thread-4): 16:37:34  Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:34.913880 (Thread-4): 16:37:34  finished collecting timing info
2022-03-02 16:37:34.914091 (Thread-4): 16:37:34  Began executing node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:37:34.939217 (Thread-4): 16:37:34  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:34.939385 (Thread-4): 16:37:34  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN DBT_RAW.DBT_VAULT.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:34.939477 (Thread-4): 16:37:34  Opening a new connection, currently in state closed
2022-03-02 16:37:35.541943 (Thread-33): handling poll request
2022-03-02 16:37:35.542364 (Thread-33): 16:37:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca3df0>]}
2022-03-02 16:37:35.543095 (Thread-33): sending response (<Response 8578 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:36.215463 (Thread-3): 16:37:36  SQL status: SUCCESS 1 in 9.15 seconds
2022-03-02 16:37:36.216980 (Thread-3): 16:37:36  finished collecting timing info
2022-03-02 16:37:36.217151 (Thread-3): 16:37:36  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-02 16:37:36.539518 (Thread-3): 16:37:36  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d7b431c0>]}
2022-03-02 16:37:36.540304 (Thread-3): 16:37:36  1 of 31 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 9.57s]
2022-03-02 16:37:36.540515 (Thread-3): 16:37:36  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-02 16:37:36.541220 (Thread-6): 16:37:36  Began running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:37:36.541476 (Thread-6): 16:37:36  5 of 31 START table model DBT_VAULT.raw_inventory............................... [RUN]
2022-03-02 16:37:36.541754 (Thread-6): 16:37:36  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:37:36.541900 (Thread-6): 16:37:36  Began compiling node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:37:36.541996 (Thread-6): 16:37:36  Compiling model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:37:36.543056 (Thread-5): 16:37:36  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:37:36.543297 (Thread-5): 16:37:36  6 of 31 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-02 16:37:36.543596 (Thread-5): 16:37:36  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:37:36.543691 (Thread-5): 16:37:36  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:37:36.543774 (Thread-5): 16:37:36  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:37:36.552220 (Thread-6): 16:37:36  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:37:36.561356 (Thread-5): 16:37:36  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:37:36.561489 (Thread-5): 16:37:36  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 16:37:36.561581 (Thread-5): 16:37:36  Opening a new connection, currently in state init
2022-03-02 16:37:36.572452 (Thread-6): 16:37:36  finished collecting timing info
2022-03-02 16:37:36.572663 (Thread-6): 16:37:36  Began executing node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:37:36.575449 (Thread-6): 16:37:36  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:37:36.591509 (Thread-6): 16:37:36  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-02 16:37:36.591687 (Thread-6): 16:37:36  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_inventory  as
      (SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DBT_RAW.DBT_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
      );
2022-03-02 16:37:36.591784 (Thread-6): 16:37:36  Opening a new connection, currently in state closed
2022-03-02 16:37:36.816016 (Thread-4): 16:37:36  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-02 16:37:36.819402 (Thread-4): 16:37:36  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:36.819523 (Thread-4): 16:37:36  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
2022-03-02 16:37:37.060558 (Thread-4): 16:37:37  SQL status: SUCCESS 10 in 0.24 seconds
2022-03-02 16:37:37.065493 (Thread-4): 16:37:37  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:37.065634 (Thread-4): 16:37:37  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions
2022-03-02 16:37:37.255633 (Thread-4): 16:37:37  SQL status: SUCCESS 10 in 0.19 seconds
2022-03-02 16:37:37.264260 (Thread-4): 16:37:37  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:37.264418 (Thread-4): 16:37:37  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DBT_RAW"."DBT_VAULT"."T_LINK_TRANSACTIONS"
2022-03-02 16:37:37.386200 (Thread-4): 16:37:37  SQL status: SUCCESS 10 in 0.12 seconds
2022-03-02 16:37:37.404794 (Thread-4): 16:37:37  Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:37.420925 (Thread-4): 16:37:37  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:37.421110 (Thread-4): 16:37:37  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
2022-03-02 16:37:37.517129 (Thread-5): 16:37:37  SQL status: SUCCESS 37 in 0.96 seconds
2022-03-02 16:37:37.525268 (Thread-5): 16:37:37  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:37:37.525417 (Thread-5): 16:37:37  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-02 16:37:37.605654 (Thread-34): handling poll request
2022-03-02 16:37:37.606107 (Thread-34): 16:37:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92cbcc70>]}
2022-03-02 16:37:37.607063 (Thread-34): sending response (<Response 20078 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:37.632971 (Thread-4): 16:37:37  SQL status: SUCCESS 1 in 0.21 seconds
2022-03-02 16:37:37.633206 (Thread-4): 16:37:37  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:37.633297 (Thread-4): 16:37:37  On model.dbtvault_snowflake_demo.t_link_transactions: insert into DBT_RAW.DBT_VAULT.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
        );
2022-03-02 16:37:37.648020 (Thread-5): 16:37:37  SQL status: SUCCESS 37 in 0.12 seconds
2022-03-02 16:37:37.669604 (Thread-5): 16:37:37  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:37:37.700665 (Thread-5): 16:37:37  finished collecting timing info
2022-03-02 16:37:37.700922 (Thread-5): 16:37:37  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:37:37.703844 (Thread-5): 16:37:37  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:37:37.741261 (Thread-5): 16:37:37  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-02 16:37:37.741438 (Thread-5): 16:37:37  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-02 16:37:38.277738 (Thread-4): 16:37:38  SQL status: SUCCESS 0 in 0.64 seconds
2022-03-02 16:37:38.277993 (Thread-4): 16:37:38  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-02 16:37:38.278080 (Thread-4): 16:37:38  On model.dbtvault_snowflake_demo.t_link_transactions: commit;
2022-03-02 16:37:38.596411 (Thread-4): 16:37:38  SQL status: SUCCESS 1 in 0.32 seconds
2022-03-02 16:37:38.597958 (Thread-4): 16:37:38  finished collecting timing info
2022-03-02 16:37:38.598121 (Thread-4): 16:37:38  On model.dbtvault_snowflake_demo.t_link_transactions: Close
2022-03-02 16:37:38.799599 (Thread-4): 16:37:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc1d7730>]}
2022-03-02 16:37:38.800032 (Thread-4): 16:37:38  4 of 31 OK created incremental model DBT_VAULT.t_link_transactions.............. [SUCCESS 1 in 3.97s]
2022-03-02 16:37:38.800161 (Thread-4): 16:37:38  Finished running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-02 16:37:39.429898 (Thread-35): handling poll request
2022-03-02 16:37:39.430312 (Thread-35): 16:37:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c42640>]}
2022-03-02 16:37:39.431068 (Thread-35): sending response (<Response 18661 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:39.512442 (Thread-5): 16:37:39  SQL status: SUCCESS 1 in 1.77 seconds
2022-03-02 16:37:39.513982 (Thread-5): 16:37:39  finished collecting timing info
2022-03-02 16:37:39.514164 (Thread-5): 16:37:39  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-02 16:37:39.697022 (Thread-5): 16:37:39  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5fd2df0>]}
2022-03-02 16:37:39.697459 (Thread-5): 16:37:39  6 of 31 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 3.15s]
2022-03-02 16:37:39.697591 (Thread-5): 16:37:39  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-02 16:37:39.698666 (Thread-3): 16:37:39  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:37:39.699045 (Thread-3): 16:37:39  7 of 31 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-02 16:37:39.699408 (Thread-3): 16:37:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:39.699517 (Thread-3): 16:37:39  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:37:39.699612 (Thread-3): 16:37:39  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:37:39.703905 (Thread-4): 16:37:39  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:37:39.704161 (Thread-4): 16:37:39  8 of 31 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-02 16:37:39.704416 (Thread-4): 16:37:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:39.704505 (Thread-4): 16:37:39  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:37:39.704591 (Thread-4): 16:37:39  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:37:39.714142 (Thread-5): 16:37:39  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:37:39.714404 (Thread-5): 16:37:39  9 of 31 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-02 16:37:39.714651 (Thread-5): 16:37:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:39.714762 (Thread-5): 16:37:39  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:37:39.714847 (Thread-5): 16:37:39  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:37:39.754542 (Thread-4): 16:37:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:39.763092 (Thread-5): 16:37:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:39.775145 (Thread-3): 16:37:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:39.782169 (Thread-4): 16:37:39  finished collecting timing info
2022-03-02 16:37:39.782341 (Thread-4): 16:37:39  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:37:39.786691 (Thread-4): 16:37:39  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:39.786808 (Thread-4): 16:37:39  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:39.786895 (Thread-4): 16:37:39  Opening a new connection, currently in state closed
2022-03-02 16:37:39.787888 (Thread-5): 16:37:39  finished collecting timing info
2022-03-02 16:37:39.788028 (Thread-5): 16:37:39  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:37:39.791671 (Thread-5): 16:37:39  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:39.791781 (Thread-5): 16:37:39  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:39.791865 (Thread-5): 16:37:39  Opening a new connection, currently in state closed
2022-03-02 16:37:39.800200 (Thread-3): 16:37:39  finished collecting timing info
2022-03-02 16:37:39.800370 (Thread-3): 16:37:39  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:37:39.805216 (Thread-3): 16:37:39  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:39.805354 (Thread-3): 16:37:39  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:39.805557 (Thread-3): 16:37:39  Opening a new connection, currently in state closed
2022-03-02 16:37:41.204604 (Thread-36): handling poll request
2022-03-02 16:37:41.205004 (Thread-36): 16:37:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c49790>]}
2022-03-02 16:37:41.206010 (Thread-36): sending response (<Response 19057 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:41.662953 (Thread-6): 16:37:41  SQL status: SUCCESS 1 in 5.07 seconds
2022-03-02 16:37:41.664525 (Thread-6): 16:37:41  finished collecting timing info
2022-03-02 16:37:41.664706 (Thread-6): 16:37:41  On model.dbtvault_snowflake_demo.raw_inventory: Close
2022-03-02 16:37:41.872634 (Thread-6): 16:37:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc1f8100>]}
2022-03-02 16:37:41.873085 (Thread-6): 16:37:41  5 of 31 OK created table model DBT_VAULT.raw_inventory.......................... [SUCCESS 1 in 5.33s]
2022-03-02 16:37:41.873232 (Thread-6): 16:37:41  Finished running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-02 16:37:41.873389 (Thread-6): 16:37:41  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:37:41.873580 (Thread-6): 16:37:41  10 of 31 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-02 16:37:41.873885 (Thread-6): 16:37:41  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:41.873980 (Thread-6): 16:37:41  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:37:41.874072 (Thread-6): 16:37:41  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:37:41.903535 (Thread-6): 16:37:41  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:41.926888 (Thread-6): 16:37:41  finished collecting timing info
2022-03-02 16:37:41.927247 (Thread-6): 16:37:41  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:37:41.934325 (Thread-6): 16:37:41  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:41.934526 (Thread-6): 16:37:41  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_customer_nation AS d
    ON a.LINK_CUSTOMER_NATION_PK = d.LINK_CUSTOMER_NATION_PK
    WHERE d.LINK_CUSTOMER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:41.934662 (Thread-6): 16:37:41  Opening a new connection, currently in state closed
2022-03-02 16:37:42.008711 (Thread-5): 16:37:42  SQL status: SUCCESS 1 in 2.22 seconds
2022-03-02 16:37:42.011939 (Thread-5): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:42.012069 (Thread-5): 16:37:42  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DBT_RAW.DBT_VAULT.hub_order__dbt_tmp
2022-03-02 16:37:42.159038 (Thread-3): 16:37:42  SQL status: SUCCESS 1 in 2.35 seconds
2022-03-02 16:37:42.162356 (Thread-3): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:42.162473 (Thread-3): 16:37:42  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp
2022-03-02 16:37:42.207152 (Thread-4): 16:37:42  SQL status: SUCCESS 1 in 2.42 seconds
2022-03-02 16:37:42.216932 (Thread-4): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:42.217127 (Thread-4): 16:37:42  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp
2022-03-02 16:37:42.223870 (Thread-5): 16:37:42  SQL status: SUCCESS 4 in 0.21 seconds
2022-03-02 16:37:42.227107 (Thread-5): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:42.227229 (Thread-5): 16:37:42  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DBT_RAW.DBT_VAULT.hub_order
2022-03-02 16:37:42.329469 (Thread-3): 16:37:42  SQL status: SUCCESS 4 in 0.17 seconds
2022-03-02 16:37:42.335072 (Thread-3): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:42.335232 (Thread-3): 16:37:42  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DBT_RAW.DBT_VAULT.hub_customer
2022-03-02 16:37:42.400450 (Thread-4): 16:37:42  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-02 16:37:42.404386 (Thread-4): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:42.404536 (Thread-4): 16:37:42  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.hub_lineitem
2022-03-02 16:37:42.407439 (Thread-5): 16:37:42  SQL status: SUCCESS 4 in 0.18 seconds
2022-03-02 16:37:42.411059 (Thread-5): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:42.411187 (Thread-5): 16:37:42  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_ORDER"
2022-03-02 16:37:42.456747 (Thread-3): 16:37:42  SQL status: SUCCESS 4 in 0.12 seconds
2022-03-02 16:37:42.460438 (Thread-3): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:42.460557 (Thread-3): 16:37:42  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_CUSTOMER"
2022-03-02 16:37:42.566124 (Thread-4): 16:37:42  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:37:42.569862 (Thread-4): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:42.570002 (Thread-4): 16:37:42  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_LINEITEM"
2022-03-02 16:37:42.580990 (Thread-5): 16:37:42  SQL status: SUCCESS 4 in 0.17 seconds
2022-03-02 16:37:42.583019 (Thread-5): 16:37:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:42.599482 (Thread-5): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:42.599654 (Thread-5): 16:37:42  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
2022-03-02 16:37:42.634636 (Thread-3): 16:37:42  SQL status: SUCCESS 4 in 0.17 seconds
2022-03-02 16:37:42.636716 (Thread-3): 16:37:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:42.651980 (Thread-3): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:42.652146 (Thread-3): 16:37:42  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
2022-03-02 16:37:42.744920 (Thread-4): 16:37:42  SQL status: SUCCESS 5 in 0.17 seconds
2022-03-02 16:37:42.747038 (Thread-4): 16:37:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:42.762391 (Thread-4): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:42.762563 (Thread-4): 16:37:42  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
2022-03-02 16:37:42.821558 (Thread-5): 16:37:42  SQL status: SUCCESS 1 in 0.22 seconds
2022-03-02 16:37:42.821830 (Thread-5): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:42.821948 (Thread-5): 16:37:42  On model.dbtvault_snowflake_demo.hub_order: insert into DBT_RAW.DBT_VAULT.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_order__dbt_tmp
        );
2022-03-02 16:37:42.895348 (Thread-3): 16:37:42  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-02 16:37:42.895563 (Thread-3): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:42.895649 (Thread-3): 16:37:42  On model.dbtvault_snowflake_demo.hub_customer: insert into DBT_RAW.DBT_VAULT.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp
        );
2022-03-02 16:37:42.940402 (Thread-4): 16:37:42  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:37:42.940635 (Thread-4): 16:37:42  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:42.940725 (Thread-4): 16:37:42  On model.dbtvault_snowflake_demo.hub_lineitem: insert into DBT_RAW.DBT_VAULT.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp
        );
2022-03-02 16:37:43.138696 (Thread-5): 16:37:43  SQL status: SUCCESS 0 in 0.32 seconds
2022-03-02 16:37:43.138904 (Thread-5): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-02 16:37:43.138988 (Thread-5): 16:37:43  On model.dbtvault_snowflake_demo.hub_order: commit;
2022-03-02 16:37:43.269645 (Thread-4): 16:37:43  SQL status: SUCCESS 0 in 0.33 seconds
2022-03-02 16:37:43.269990 (Thread-4): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-02 16:37:43.270153 (Thread-4): 16:37:43  On model.dbtvault_snowflake_demo.hub_lineitem: commit;
2022-03-02 16:37:43.467455 (Thread-3): 16:37:43  SQL status: SUCCESS 0 in 0.57 seconds
2022-03-02 16:37:43.467665 (Thread-3): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-02 16:37:43.467752 (Thread-3): 16:37:43  On model.dbtvault_snowflake_demo.hub_customer: commit;
2022-03-02 16:37:43.484827 (Thread-5): 16:37:43  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-02 16:37:43.486479 (Thread-5): 16:37:43  finished collecting timing info
2022-03-02 16:37:43.486657 (Thread-5): 16:37:43  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-02 16:37:43.621071 (Thread-4): 16:37:43  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-02 16:37:43.623469 (Thread-4): 16:37:43  finished collecting timing info
2022-03-02 16:37:43.623755 (Thread-4): 16:37:43  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-02 16:37:43.678015 (Thread-6): 16:37:43  SQL status: SUCCESS 1 in 1.74 seconds
2022-03-02 16:37:43.681471 (Thread-6): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:43.681600 (Thread-6): 16:37:43  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp
2022-03-02 16:37:43.736420 (Thread-3): 16:37:43  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-02 16:37:43.738017 (Thread-3): 16:37:43  finished collecting timing info
2022-03-02 16:37:43.738180 (Thread-3): 16:37:43  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-02 16:37:43.742008 (Thread-5): 16:37:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b57530a0>]}
2022-03-02 16:37:43.742390 (Thread-5): 16:37:43  9 of 31 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 4.03s]
2022-03-02 16:37:43.742517 (Thread-5): 16:37:43  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-02 16:37:43.742660 (Thread-5): 16:37:43  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:37:43.742849 (Thread-5): 16:37:43  11 of 31 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-02 16:37:43.743100 (Thread-5): 16:37:43  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:43.743206 (Thread-5): 16:37:43  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:37:43.743297 (Thread-5): 16:37:43  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:37:43.754022 (Thread-5): 16:37:43  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:43.768510 (Thread-5): 16:37:43  finished collecting timing info
2022-03-02 16:37:43.768717 (Thread-5): 16:37:43  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:37:43.773000 (Thread-5): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:43.773131 (Thread-5): 16:37:43  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_customer_order AS d
    ON a.ORDER_CUSTOMER_PK = d.ORDER_CUSTOMER_PK
    WHERE d.ORDER_CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:43.773239 (Thread-5): 16:37:43  Opening a new connection, currently in state closed
2022-03-02 16:37:43.859358 (Thread-6): 16:37:43  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-02 16:37:43.862986 (Thread-6): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:43.863115 (Thread-6): 16:37:43  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_nation
2022-03-02 16:37:43.874085 (Thread-4): 16:37:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5fc3f40>]}
2022-03-02 16:37:43.874512 (Thread-4): 16:37:43  8 of 31 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 4.17s]
2022-03-02 16:37:43.874638 (Thread-4): 16:37:43  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-02 16:37:43.874781 (Thread-4): 16:37:43  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:37:43.874969 (Thread-4): 16:37:43  12 of 31 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-02 16:37:43.875221 (Thread-4): 16:37:43  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:43.875313 (Thread-4): 16:37:43  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:37:43.875403 (Thread-4): 16:37:43  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:37:43.884233 (Thread-4): 16:37:43  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:43.901046 (Thread-4): 16:37:43  finished collecting timing info
2022-03-02 16:37:43.901259 (Thread-4): 16:37:43  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:37:43.905902 (Thread-4): 16:37:43  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:43.906058 (Thread-4): 16:37:43  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory_allocation AS d
    ON a.INVENTORY_ALLOCATION_PK = d.INVENTORY_ALLOCATION_PK
    WHERE d.INVENTORY_ALLOCATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:43.906149 (Thread-4): 16:37:43  Opening a new connection, currently in state closed
2022-03-02 16:37:43.977279 (Thread-37): handling poll request
2022-03-02 16:37:43.977692 (Thread-37): 16:37:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c58ee0>]}
2022-03-02 16:37:44.002586 (Thread-37): sending response (<Response 52800 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:44.038376 (Thread-3): 16:37:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5f7d640>]}
2022-03-02 16:37:44.038805 (Thread-3): 16:37:44  7 of 31 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 4.34s]
2022-03-02 16:37:44.038935 (Thread-3): 16:37:44  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-02 16:37:44.039079 (Thread-3): 16:37:44  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:37:44.039263 (Thread-3): 16:37:44  13 of 31 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-02 16:37:44.039514 (Thread-3): 16:37:44  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:44.039602 (Thread-3): 16:37:44  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:37:44.039691 (Thread-3): 16:37:44  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:37:44.048232 (Thread-6): 16:37:44  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-02 16:37:44.139756 (Thread-3): 16:37:44  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:44.145666 (Thread-6): 16:37:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:44.145846 (Thread-6): 16:37:44  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_CUSTOMER_NATION"
2022-03-02 16:37:44.195104 (Thread-3): 16:37:44  finished collecting timing info
2022-03-02 16:37:44.195326 (Thread-3): 16:37:44  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:37:44.199691 (Thread-3): 16:37:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:44.199840 (Thread-3): 16:37:44  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_order_lineitem AS d
    ON a.LINK_LINEITEM_ORDER_PK = d.LINK_LINEITEM_ORDER_PK
    WHERE d.LINK_LINEITEM_ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:44.199931 (Thread-3): 16:37:44  Opening a new connection, currently in state closed
2022-03-02 16:37:44.360079 (Thread-6): 16:37:44  SQL status: SUCCESS 5 in 0.21 seconds
2022-03-02 16:37:44.362280 (Thread-6): 16:37:44  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:44.380811 (Thread-6): 16:37:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:44.381002 (Thread-6): 16:37:44  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
begin;
2022-03-02 16:37:44.573481 (Thread-6): 16:37:44  SQL status: SUCCESS 1 in 0.19 seconds
2022-03-02 16:37:44.573702 (Thread-6): 16:37:44  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:44.573821 (Thread-6): 16:37:44  On model.dbtvault_snowflake_demo.link_customer_nation: insert into DBT_RAW.DBT_VAULT.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp
        );
2022-03-02 16:37:45.039222 (Thread-6): 16:37:45  SQL status: SUCCESS 0 in 0.47 seconds
2022-03-02 16:37:45.039436 (Thread-6): 16:37:45  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-02 16:37:45.039521 (Thread-6): 16:37:45  On model.dbtvault_snowflake_demo.link_customer_nation: commit;
2022-03-02 16:37:45.455906 (Thread-6): 16:37:45  SQL status: SUCCESS 1 in 0.42 seconds
2022-03-02 16:37:45.457545 (Thread-6): 16:37:45  finished collecting timing info
2022-03-02 16:37:45.457733 (Thread-6): 16:37:45  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-02 16:37:45.743268 (Thread-6): 16:37:45  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5775070>]}
2022-03-02 16:37:45.743857 (Thread-6): 16:37:45  10 of 31 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 3.87s]
2022-03-02 16:37:45.744007 (Thread-6): 16:37:45  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-02 16:37:45.744164 (Thread-6): 16:37:45  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:37:45.744468 (Thread-6): 16:37:45  14 of 31 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-02 16:37:45.744878 (Thread-6): 16:37:45  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:45.745039 (Thread-6): 16:37:45  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:37:45.745193 (Thread-6): 16:37:45  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:37:45.803333 (Thread-6): 16:37:45  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:45.818821 (Thread-6): 16:37:45  finished collecting timing info
2022-03-02 16:37:45.819130 (Thread-6): 16:37:45  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:37:45.827588 (Thread-6): 16:37:45  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:45.827817 (Thread-6): 16:37:45  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_NATION_HASHDIFF != stage.CUSTOMER_NATION_HASHDIFF
                OR latest_records.CUSTOMER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:45.827972 (Thread-6): 16:37:45  Opening a new connection, currently in state closed
2022-03-02 16:37:45.848275 (Thread-38): handling poll request
2022-03-02 16:37:45.848686 (Thread-38): 16:37:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c617c0>]}
2022-03-02 16:37:45.849699 (Thread-38): sending response (<Response 22342 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:46.160628 (Thread-5): 16:37:46  SQL status: SUCCESS 1 in 2.39 seconds
2022-03-02 16:37:46.163972 (Thread-5): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:46.164113 (Thread-5): 16:37:46  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp
2022-03-02 16:37:46.264941 (Thread-4): 16:37:46  SQL status: SUCCESS 1 in 2.36 seconds
2022-03-02 16:37:46.268848 (Thread-4): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:46.269056 (Thread-4): 16:37:46  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp
2022-03-02 16:37:46.308588 (Thread-3): 16:37:46  SQL status: SUCCESS 1 in 2.11 seconds
2022-03-02 16:37:46.312027 (Thread-3): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:46.312171 (Thread-3): 16:37:46  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp
2022-03-02 16:37:46.328462 (Thread-5): 16:37:46  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:37:46.333299 (Thread-5): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:46.333438 (Thread-5): 16:37:46  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_order
2022-03-02 16:37:46.459199 (Thread-4): 16:37:46  SQL status: SUCCESS 6 in 0.19 seconds
2022-03-02 16:37:46.462982 (Thread-4): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:46.463147 (Thread-4): 16:37:46  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory_allocation
2022-03-02 16:37:46.466024 (Thread-3): 16:37:46  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-02 16:37:46.469279 (Thread-3): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:46.469382 (Thread-3): 16:37:46  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.link_order_lineitem
2022-03-02 16:37:46.470679 (Thread-5): 16:37:46  SQL status: SUCCESS 5 in 0.14 seconds
2022-03-02 16:37:46.473966 (Thread-5): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:46.474073 (Thread-5): 16:37:46  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_CUSTOMER_ORDER"
2022-03-02 16:37:46.624315 (Thread-4): 16:37:46  SQL status: SUCCESS 6 in 0.16 seconds
2022-03-02 16:37:46.628345 (Thread-4): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:46.628491 (Thread-4): 16:37:46  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY_ALLOCATION"
2022-03-02 16:37:46.629992 (Thread-5): 16:37:46  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:37:46.631978 (Thread-5): 16:37:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:46.634078 (Thread-3): 16:37:46  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:37:46.637492 (Thread-3): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:46.637606 (Thread-3): 16:37:46  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_ORDER_LINEITEM"
2022-03-02 16:37:46.647181 (Thread-5): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:46.647345 (Thread-5): 16:37:46  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
begin;
2022-03-02 16:37:46.787156 (Thread-3): 16:37:46  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-02 16:37:46.789267 (Thread-3): 16:37:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:46.795499 (Thread-4): 16:37:46  SQL status: SUCCESS 6 in 0.17 seconds
2022-03-02 16:37:46.797608 (Thread-4): 16:37:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:46.805134 (Thread-3): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:46.805283 (Thread-3): 16:37:46  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
begin;
2022-03-02 16:37:46.814352 (Thread-4): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:46.814514 (Thread-4): 16:37:46  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
begin;
2022-03-02 16:37:46.861660 (Thread-5): 16:37:46  SQL status: SUCCESS 1 in 0.21 seconds
2022-03-02 16:37:46.861913 (Thread-5): 16:37:46  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:46.862000 (Thread-5): 16:37:46  On model.dbtvault_snowflake_demo.link_customer_order: insert into DBT_RAW.DBT_VAULT.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp
        );
2022-03-02 16:37:47.056314 (Thread-4): 16:37:47  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-02 16:37:47.056536 (Thread-4): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:47.056620 (Thread-4): 16:37:47  On model.dbtvault_snowflake_demo.link_inventory_allocation: insert into DBT_RAW.DBT_VAULT.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp
        );
2022-03-02 16:37:47.059303 (Thread-3): 16:37:47  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-02 16:37:47.059495 (Thread-3): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:47.059580 (Thread-3): 16:37:47  On model.dbtvault_snowflake_demo.link_order_lineitem: insert into DBT_RAW.DBT_VAULT.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp
        );
2022-03-02 16:37:47.216667 (Thread-5): 16:37:47  SQL status: SUCCESS 0 in 0.35 seconds
2022-03-02 16:37:47.216871 (Thread-5): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-02 16:37:47.216955 (Thread-5): 16:37:47  On model.dbtvault_snowflake_demo.link_customer_order: commit;
2022-03-02 16:37:47.395668 (Thread-3): 16:37:47  SQL status: SUCCESS 0 in 0.34 seconds
2022-03-02 16:37:47.395886 (Thread-3): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-02 16:37:47.395975 (Thread-3): 16:37:47  On model.dbtvault_snowflake_demo.link_order_lineitem: commit;
2022-03-02 16:37:47.418621 (Thread-4): 16:37:47  SQL status: SUCCESS 0 in 0.36 seconds
2022-03-02 16:37:47.418831 (Thread-4): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-02 16:37:47.418921 (Thread-4): 16:37:47  On model.dbtvault_snowflake_demo.link_inventory_allocation: commit;
2022-03-02 16:37:47.498720 (Thread-5): 16:37:47  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-02 16:37:47.500688 (Thread-5): 16:37:47  finished collecting timing info
2022-03-02 16:37:47.500887 (Thread-5): 16:37:47  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-02 16:37:47.581191 (Thread-6): 16:37:47  SQL status: SUCCESS 1 in 1.75 seconds
2022-03-02 16:37:47.584642 (Thread-6): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:47.584780 (Thread-6): 16:37:47  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp
2022-03-02 16:37:47.624712 (Thread-3): 16:37:47  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-02 16:37:47.626315 (Thread-3): 16:37:47  finished collecting timing info
2022-03-02 16:37:47.626489 (Thread-3): 16:37:47  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-02 16:37:47.703579 (Thread-4): 16:37:47  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-02 16:37:47.705117 (Thread-4): 16:37:47  finished collecting timing info
2022-03-02 16:37:47.705293 (Thread-4): 16:37:47  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-02 16:37:47.720672 (Thread-39): handling poll request
2022-03-02 16:37:47.721064 (Thread-39): 16:37:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91bfc2e0>]}
2022-03-02 16:37:47.722264 (Thread-39): sending response (<Response 30214 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:47.745430 (Thread-5): 16:37:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5752f70>]}
2022-03-02 16:37:47.745959 (Thread-5): 16:37:47  11 of 31 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 4.00s]
2022-03-02 16:37:47.746103 (Thread-5): 16:37:47  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-02 16:37:47.746253 (Thread-5): 16:37:47  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:37:47.746440 (Thread-5): 16:37:47  15 of 31 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-02 16:37:47.746704 (Thread-5): 16:37:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:47.746804 (Thread-5): 16:37:47  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:37:47.746896 (Thread-5): 16:37:47  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:37:47.763182 (Thread-5): 16:37:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:47.771423 (Thread-6): 16:37:47  SQL status: SUCCESS 7 in 0.19 seconds
2022-03-02 16:37:47.775301 (Thread-6): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:47.775445 (Thread-6): 16:37:47  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details
2022-03-02 16:37:47.783448 (Thread-5): 16:37:47  finished collecting timing info
2022-03-02 16:37:47.783663 (Thread-5): 16:37:47  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:37:47.788997 (Thread-5): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:47.789155 (Thread-5): 16:37:47  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_REGION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_REGION_HASHDIFF != stage.CUSTOMER_REGION_HASHDIFF
                OR latest_records.CUSTOMER_REGION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:47.789247 (Thread-5): 16:37:47  Opening a new connection, currently in state closed
2022-03-02 16:37:47.857301 (Thread-3): 16:37:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5738ee0>]}
2022-03-02 16:37:47.857742 (Thread-3): 16:37:47  13 of 31 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 3.82s]
2022-03-02 16:37:47.857911 (Thread-3): 16:37:47  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-02 16:37:47.858052 (Thread-3): 16:37:47  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:37:47.858242 (Thread-3): 16:37:47  16 of 31 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-02 16:37:47.858494 (Thread-3): 16:37:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:47.858583 (Thread-3): 16:37:47  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:37:47.858672 (Thread-3): 16:37:47  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:37:47.875399 (Thread-3): 16:37:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:47.890735 (Thread-3): 16:37:47  finished collecting timing info
2022-03-02 16:37:47.890948 (Thread-3): 16:37:47  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:37:47.897590 (Thread-3): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:47.897742 (Thread-3): 16:37:47  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:47.897915 (Thread-3): 16:37:47  Opening a new connection, currently in state closed
2022-03-02 16:37:47.901273 (Thread-6): 16:37:47  SQL status: SUCCESS 7 in 0.13 seconds
2022-03-02 16:37:47.905097 (Thread-6): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:47.905230 (Thread-6): 16:37:47  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUST_NATION_DETAILS"
2022-03-02 16:37:47.936574 (Thread-4): 16:37:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b5fa4a90>]}
2022-03-02 16:37:47.937000 (Thread-4): 16:37:47  12 of 31 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 4.06s]
2022-03-02 16:37:47.937131 (Thread-4): 16:37:47  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-02 16:37:47.937273 (Thread-4): 16:37:47  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:37:47.937462 (Thread-4): 16:37:47  17 of 31 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-02 16:37:47.937718 (Thread-4): 16:37:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:47.937862 (Thread-4): 16:37:47  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:37:47.937963 (Thread-4): 16:37:47  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:37:47.955763 (Thread-4): 16:37:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:47.972236 (Thread-4): 16:37:47  finished collecting timing info
2022-03-02 16:37:47.972444 (Thread-4): 16:37:47  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:37:47.978018 (Thread-4): 16:37:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:47.978165 (Thread-4): 16:37:47  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

latest_records AS (

    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINEITEM_PK, current_records.LINEITEM_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.LINEITEM_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINEITEM_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINEITEM_PK = source_records.LINEITEM_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.LINEITEM_PK = stage.LINEITEM_PK
                WHERE latest_records.LINEITEM_HASHDIFF != stage.LINEITEM_HASHDIFF
                OR latest_records.LINEITEM_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:47.978255 (Thread-4): 16:37:47  Opening a new connection, currently in state closed
2022-03-02 16:37:48.049076 (Thread-6): 16:37:48  SQL status: SUCCESS 7 in 0.14 seconds
2022-03-02 16:37:48.051587 (Thread-6): 16:37:48  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:48.099647 (Thread-6): 16:37:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:48.099830 (Thread-6): 16:37:48  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
begin;
2022-03-02 16:37:48.354171 (Thread-6): 16:37:48  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-02 16:37:48.354404 (Thread-6): 16:37:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:48.354512 (Thread-6): 16:37:48  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: insert into DBT_RAW.DBT_VAULT.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp
        );
2022-03-02 16:37:48.909551 (Thread-6): 16:37:48  SQL status: SUCCESS 0 in 0.55 seconds
2022-03-02 16:37:48.909770 (Thread-6): 16:37:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-02 16:37:48.909902 (Thread-6): 16:37:48  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: commit;
2022-03-02 16:37:49.255560 (Thread-6): 16:37:49  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-02 16:37:49.257148 (Thread-6): 16:37:49  finished collecting timing info
2022-03-02 16:37:49.257325 (Thread-6): 16:37:49  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-02 16:37:49.565699 (Thread-6): 16:37:49  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc217910>]}
2022-03-02 16:37:49.566210 (Thread-6): 16:37:49  14 of 31 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 3.82s]
2022-03-02 16:37:49.566347 (Thread-6): 16:37:49  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-02 16:37:49.566492 (Thread-6): 16:37:49  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:37:49.566686 (Thread-6): 16:37:49  18 of 31 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-02 16:37:49.566946 (Thread-6): 16:37:49  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:49.567035 (Thread-6): 16:37:49  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:37:49.567126 (Thread-6): 16:37:49  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:37:49.573985 (Thread-40): handling poll request
2022-03-02 16:37:49.574322 (Thread-40): 16:37:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c0d610>]}
2022-03-02 16:37:49.575451 (Thread-40): sending response (<Response 37199 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:49.583536 (Thread-6): 16:37:49  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:49.598173 (Thread-6): 16:37:49  finished collecting timing info
2022-03-02 16:37:49.598389 (Thread-6): 16:37:49  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:37:49.603630 (Thread-6): 16:37:49  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:49.603772 (Thread-6): 16:37:49  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.ORDER_PK = stage.ORDER_PK
                WHERE latest_records.ORDER_HASHDIFF != stage.ORDER_HASHDIFF
                OR latest_records.ORDER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:49.603865 (Thread-6): 16:37:49  Opening a new connection, currently in state closed
2022-03-02 16:37:49.928951 (Thread-5): 16:37:49  SQL status: SUCCESS 1 in 2.14 seconds
2022-03-02 16:37:49.933449 (Thread-5): 16:37:49  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:49.933598 (Thread-5): 16:37:49  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp
2022-03-02 16:37:50.108081 (Thread-5): 16:37:50  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-02 16:37:50.111929 (Thread-5): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:50.112066 (Thread-5): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_region_details
2022-03-02 16:37:50.265877 (Thread-5): 16:37:50  SQL status: SUCCESS 7 in 0.15 seconds
2022-03-02 16:37:50.269922 (Thread-5): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:50.270066 (Thread-5): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUST_REGION_DETAILS"
2022-03-02 16:37:50.402737 (Thread-5): 16:37:50  SQL status: SUCCESS 7 in 0.13 seconds
2022-03-02 16:37:50.405021 (Thread-5): 16:37:50  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:50.421078 (Thread-5): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:50.421237 (Thread-5): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
begin;
2022-03-02 16:37:50.614807 (Thread-4): 16:37:50  SQL status: SUCCESS 1 in 2.64 seconds
2022-03-02 16:37:50.618370 (Thread-4): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:50.618496 (Thread-4): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp
2022-03-02 16:37:50.636935 (Thread-5): 16:37:50  SQL status: SUCCESS 1 in 0.22 seconds
2022-03-02 16:37:50.637161 (Thread-5): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:50.637254 (Thread-5): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: insert into DBT_RAW.DBT_VAULT.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp
        );
2022-03-02 16:37:50.745186 (Thread-3): 16:37:50  SQL status: SUCCESS 1 in 2.85 seconds
2022-03-02 16:37:50.748653 (Thread-3): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:50.748902 (Thread-3): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp
2022-03-02 16:37:50.753399 (Thread-4): 16:37:50  SQL status: SUCCESS 16 in 0.13 seconds
2022-03-02 16:37:50.757284 (Thread-4): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:50.757404 (Thread-4): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_lineitem_details
2022-03-02 16:37:50.888282 (Thread-3): 16:37:50  SQL status: SUCCESS 12 in 0.14 seconds
2022-03-02 16:37:50.895922 (Thread-3): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:50.896139 (Thread-3): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details
2022-03-02 16:37:50.898186 (Thread-4): 16:37:50  SQL status: SUCCESS 16 in 0.14 seconds
2022-03-02 16:37:50.902616 (Thread-4): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:50.903752 (Thread-4): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_LINEITEM_DETAILS"
2022-03-02 16:37:50.991227 (Thread-5): 16:37:50  SQL status: SUCCESS 0 in 0.35 seconds
2022-03-02 16:37:50.991428 (Thread-5): 16:37:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-02 16:37:50.991513 (Thread-5): 16:37:50  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: commit;
2022-03-02 16:37:51.052794 (Thread-3): 16:37:51  SQL status: SUCCESS 12 in 0.16 seconds
2022-03-02 16:37:51.057050 (Thread-3): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:51.057191 (Thread-3): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
2022-03-02 16:37:51.060080 (Thread-4): 16:37:51  SQL status: SUCCESS 16 in 0.16 seconds
2022-03-02 16:37:51.062766 (Thread-4): 16:37:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:51.078176 (Thread-4): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:51.078349 (Thread-4): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
begin;
2022-03-02 16:37:51.174019 (Thread-3): 16:37:51  SQL status: SUCCESS 12 in 0.12 seconds
2022-03-02 16:37:51.183710 (Thread-3): 16:37:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:51.200891 (Thread-3): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:51.201048 (Thread-3): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
2022-03-02 16:37:51.230666 (Thread-5): 16:37:51  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-02 16:37:51.232182 (Thread-5): 16:37:51  finished collecting timing info
2022-03-02 16:37:51.232349 (Thread-5): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-02 16:37:51.257563 (Thread-4): 16:37:51  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:37:51.257842 (Thread-4): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:51.257939 (Thread-4): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: insert into DBT_RAW.DBT_VAULT.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp
        );
2022-03-02 16:37:51.392781 (Thread-3): 16:37:51  SQL status: SUCCESS 1 in 0.19 seconds
2022-03-02 16:37:51.393056 (Thread-3): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:51.393146 (Thread-3): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_customer_details: merge into DBT_RAW.DBT_VAULT.sat_order_customer_details as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ACCBAL" = DBT_INTERNAL_SOURCE."CUSTOMER_ACCBAL","CUSTOMER_MKTSEGMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_MKTSEGMENT","CUSTOMER_COMMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_COMMENT","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-02 16:37:51.419260 (Thread-41): handling poll request
2022-03-02 16:37:51.419630 (Thread-41): 16:37:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c14f40>]}
2022-03-02 16:37:51.420726 (Thread-41): sending response (<Response 30882 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:51.434268 (Thread-6): 16:37:51  SQL status: SUCCESS 1 in 1.83 seconds
2022-03-02 16:37:51.437739 (Thread-6): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:51.437905 (Thread-6): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp
2022-03-02 16:37:51.466422 (Thread-5): 16:37:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b56a5df0>]}
2022-03-02 16:37:51.466862 (Thread-5): 16:37:51  15 of 31 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 3.72s]
2022-03-02 16:37:51.466994 (Thread-5): 16:37:51  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-02 16:37:51.467140 (Thread-5): 16:37:51  Began running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:37:51.467331 (Thread-5): 16:37:51  19 of 31 START table model DBT_VAULT.v_stg_inventory............................ [RUN]
2022-03-02 16:37:51.467582 (Thread-5): 16:37:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:37:51.467672 (Thread-5): 16:37:51  Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:37:51.467764 (Thread-5): 16:37:51  Compiling model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:37:51.479802 (Thread-5): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:37:51.479937 (Thread-5): 16:37:51  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-02 16:37:51.480026 (Thread-5): 16:37:51  Opening a new connection, currently in state closed
2022-03-02 16:37:51.569772 (Thread-6): 16:37:51  SQL status: SUCCESS 12 in 0.13 seconds
2022-03-02 16:37:51.575375 (Thread-6): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:51.575502 (Thread-6): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_order_details
2022-03-02 16:37:51.582514 (Thread-4): 16:37:51  SQL status: SUCCESS 0 in 0.32 seconds
2022-03-02 16:37:51.582696 (Thread-4): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-02 16:37:51.582778 (Thread-4): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: commit;
2022-03-02 16:37:51.688052 (Thread-3): 16:37:51  SQL status: SUCCESS 0 in 0.29 seconds
2022-03-02 16:37:51.688256 (Thread-3): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-02 16:37:51.688341 (Thread-3): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
2022-03-02 16:37:51.740943 (Thread-6): 16:37:51  SQL status: SUCCESS 12 in 0.17 seconds
2022-03-02 16:37:51.744995 (Thread-6): 16:37:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:51.745112 (Thread-6): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_ORDER_DETAILS"
2022-03-02 16:37:51.899011 (Thread-4): 16:37:51  SQL status: SUCCESS 1 in 0.32 seconds
2022-03-02 16:37:51.900565 (Thread-4): 16:37:51  finished collecting timing info
2022-03-02 16:37:51.900734 (Thread-4): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-02 16:37:51.915123 (Thread-3): 16:37:51  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-02 16:37:51.916723 (Thread-3): 16:37:51  finished collecting timing info
2022-03-02 16:37:51.916903 (Thread-3): 16:37:51  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-02 16:37:51.980930 (Thread-6): 16:37:51  SQL status: SUCCESS 12 in 0.24 seconds
2022-03-02 16:37:51.983590 (Thread-6): 16:37:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:52.000610 (Thread-6): 16:37:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:52.000768 (Thread-6): 16:37:52  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
begin;
2022-03-02 16:37:52.111523 (Thread-4): 16:37:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b4e43460>]}
2022-03-02 16:37:52.111967 (Thread-4): 16:37:52  17 of 31 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 4.17s]
2022-03-02 16:37:52.112097 (Thread-4): 16:37:52  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-02 16:37:52.145130 (Thread-3): 16:37:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b57349a0>]}
2022-03-02 16:37:52.145707 (Thread-3): 16:37:52  16 of 31 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 4.29s]
2022-03-02 16:37:52.145941 (Thread-3): 16:37:52  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-02 16:37:52.174098 (Thread-6): 16:37:52  SQL status: SUCCESS 1 in 0.17 seconds
2022-03-02 16:37:52.174307 (Thread-6): 16:37:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:52.174392 (Thread-6): 16:37:52  On model.dbtvault_snowflake_demo.sat_order_order_details: insert into DBT_RAW.DBT_VAULT.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp
        );
2022-03-02 16:37:52.376488 (Thread-5): 16:37:52  SQL status: SUCCESS 24 in 0.9 seconds
2022-03-02 16:37:52.383044 (Thread-5): 16:37:52  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:37:52.383205 (Thread-5): 16:37:52  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-02 16:37:52.546438 (Thread-6): 16:37:52  SQL status: SUCCESS 0 in 0.37 seconds
2022-03-02 16:37:52.546639 (Thread-6): 16:37:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-02 16:37:52.546724 (Thread-6): 16:37:52  On model.dbtvault_snowflake_demo.sat_order_order_details: commit;
2022-03-02 16:37:52.559654 (Thread-5): 16:37:52  SQL status: SUCCESS 24 in 0.18 seconds
2022-03-02 16:37:52.574331 (Thread-5): 16:37:52  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:37:52.600427 (Thread-5): 16:37:52  finished collecting timing info
2022-03-02 16:37:52.600642 (Thread-5): 16:37:52  Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:37:52.603565 (Thread-5): 16:37:52  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:37:52.638078 (Thread-5): 16:37:52  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-02 16:37:52.638252 (Thread-5): 16:37:52  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_inventory  as
      (








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
      );
2022-03-02 16:37:52.904961 (Thread-6): 16:37:52  SQL status: SUCCESS 1 in 0.36 seconds
2022-03-02 16:37:52.906558 (Thread-6): 16:37:52  finished collecting timing info
2022-03-02 16:37:52.906726 (Thread-6): 16:37:52  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-02 16:37:53.196415 (Thread-6): 16:37:53  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b574ad00>]}
2022-03-02 16:37:53.196867 (Thread-6): 16:37:53  18 of 31 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 3.63s]
2022-03-02 16:37:53.196992 (Thread-6): 16:37:53  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-02 16:37:54.251274 (Thread-42): handling poll request
2022-03-02 16:37:54.251704 (Thread-42): 16:37:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c2fa30>]}
2022-03-02 16:37:54.252868 (Thread-42): sending response (<Response 35365 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:54.416930 (Thread-5): 16:37:54  SQL status: SUCCESS 1 in 1.78 seconds
2022-03-02 16:37:54.418422 (Thread-5): 16:37:54  finished collecting timing info
2022-03-02 16:37:54.418585 (Thread-5): 16:37:54  On model.dbtvault_snowflake_demo.v_stg_inventory: Close
2022-03-02 16:37:54.644250 (Thread-5): 16:37:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ce755f70>]}
2022-03-02 16:37:54.644693 (Thread-5): 16:37:54  19 of 31 OK created table model DBT_VAULT.v_stg_inventory....................... [SUCCESS 1 in 3.18s]
2022-03-02 16:37:54.644825 (Thread-5): 16:37:54  Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-02 16:37:54.646148 (Thread-4): 16:37:54  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:37:54.646434 (Thread-4): 16:37:54  20 of 31 START incremental model DBT_VAULT.hub_nation........................... [RUN]
2022-03-02 16:37:54.646712 (Thread-4): 16:37:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:54.646809 (Thread-4): 16:37:54  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:37:54.646902 (Thread-4): 16:37:54  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:37:54.651256 (Thread-3): 16:37:54  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:37:54.651542 (Thread-3): 16:37:54  21 of 31 START incremental model DBT_VAULT.hub_part............................. [RUN]
2022-03-02 16:37:54.651818 (Thread-3): 16:37:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:54.651912 (Thread-3): 16:37:54  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:37:54.652003 (Thread-3): 16:37:54  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:37:54.667684 (Thread-4): 16:37:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:54.667945 (Thread-6): 16:37:54  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:37:54.668206 (Thread-6): 16:37:54  22 of 31 START incremental model DBT_VAULT.hub_region........................... [RUN]
2022-03-02 16:37:54.668475 (Thread-6): 16:37:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:54.668570 (Thread-6): 16:37:54  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:37:54.668661 (Thread-6): 16:37:54  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:37:54.673027 (Thread-5): 16:37:54  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:37:54.673285 (Thread-5): 16:37:54  23 of 31 START incremental model DBT_VAULT.hub_supplier......................... [RUN]
2022-03-02 16:37:54.673538 (Thread-5): 16:37:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:54.673626 (Thread-5): 16:37:54  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:37:54.673710 (Thread-5): 16:37:54  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:37:54.678735 (Thread-3): 16:37:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:54.690164 (Thread-6): 16:37:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:54.691002 (Thread-5): 16:37:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:54.705068 (Thread-4): 16:37:54  finished collecting timing info
2022-03-02 16:37:54.705280 (Thread-4): 16:37:54  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:37:54.710123 (Thread-3): 16:37:54  finished collecting timing info
2022-03-02 16:37:54.710291 (Thread-3): 16:37:54  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:37:54.714763 (Thread-3): 16:37:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:54.714898 (Thread-3): 16:37:54  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:54.714989 (Thread-3): 16:37:54  Opening a new connection, currently in state closed
2022-03-02 16:37:54.715375 (Thread-6): 16:37:54  finished collecting timing info
2022-03-02 16:37:54.715581 (Thread-6): 16:37:54  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:37:54.720551 (Thread-4): 16:37:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:54.720747 (Thread-4): 16:37:54  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:54.720848 (Thread-4): 16:37:54  Opening a new connection, currently in state closed
2022-03-02 16:37:54.722074 (Thread-5): 16:37:54  finished collecting timing info
2022-03-02 16:37:54.722225 (Thread-5): 16:37:54  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:37:54.726792 (Thread-5): 16:37:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:54.726920 (Thread-5): 16:37:54  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:54.727007 (Thread-5): 16:37:54  Opening a new connection, currently in state closed
2022-03-02 16:37:54.730435 (Thread-6): 16:37:54  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:54.730551 (Thread-6): 16:37:54  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:54.730636 (Thread-6): 16:37:54  Opening a new connection, currently in state closed
2022-03-02 16:37:56.082170 (Thread-43): handling poll request
2022-03-02 16:37:56.082548 (Thread-43): 16:37:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91bc40d0>]}
2022-03-02 16:37:56.083645 (Thread-43): sending response (<Response 27572 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:57.756206 (Thread-6): 16:37:57  SQL status: SUCCESS 1 in 3.03 seconds
2022-03-02 16:37:57.759928 (Thread-6): 16:37:57  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:57.760069 (Thread-6): 16:37:57  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DBT_RAW.DBT_VAULT.hub_region__dbt_tmp
2022-03-02 16:37:57.868703 (Thread-3): 16:37:57  SQL status: SUCCESS 1 in 3.15 seconds
2022-03-02 16:37:57.872225 (Thread-3): 16:37:57  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:57.872368 (Thread-3): 16:37:57  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DBT_RAW.DBT_VAULT.hub_part__dbt_tmp
2022-03-02 16:37:57.876128 (Thread-44): handling poll request
2022-03-02 16:37:57.876508 (Thread-44): 16:37:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91c0d130>]}
2022-03-02 16:37:57.877087 (Thread-44): sending response (<Response 2828 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:57.962604 (Thread-6): 16:37:57  SQL status: SUCCESS 4 in 0.2 seconds
2022-03-02 16:37:57.967045 (Thread-6): 16:37:57  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:57.967193 (Thread-6): 16:37:57  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DBT_RAW.DBT_VAULT.hub_region
2022-03-02 16:37:58.001774 (Thread-5): 16:37:58  SQL status: SUCCESS 1 in 3.27 seconds
2022-03-02 16:37:58.005154 (Thread-5): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:58.005296 (Thread-5): 16:37:58  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp
2022-03-02 16:37:58.020005 (Thread-3): 16:37:58  SQL status: SUCCESS 4 in 0.15 seconds
2022-03-02 16:37:58.023447 (Thread-3): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:58.023567 (Thread-3): 16:37:58  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DBT_RAW.DBT_VAULT.hub_part
2022-03-02 16:37:58.206354 (Thread-5): 16:37:58  SQL status: SUCCESS 4 in 0.2 seconds
2022-03-02 16:37:58.209938 (Thread-5): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:58.210075 (Thread-5): 16:37:58  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DBT_RAW.DBT_VAULT.hub_supplier
2022-03-02 16:37:58.212199 (Thread-6): 16:37:58  SQL status: SUCCESS 4 in 0.24 seconds
2022-03-02 16:37:58.215841 (Thread-6): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:58.215971 (Thread-6): 16:37:58  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_REGION"
2022-03-02 16:37:58.216921 (Thread-3): 16:37:58  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-02 16:37:58.220372 (Thread-3): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:58.220497 (Thread-3): 16:37:58  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_PART"
2022-03-02 16:37:58.337766 (Thread-6): 16:37:58  SQL status: SUCCESS 4 in 0.12 seconds
2022-03-02 16:37:58.339894 (Thread-6): 16:37:58  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:58.355555 (Thread-6): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:58.355739 (Thread-6): 16:37:58  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
2022-03-02 16:37:58.378518 (Thread-3): 16:37:58  SQL status: SUCCESS 4 in 0.16 seconds
2022-03-02 16:37:58.380606 (Thread-3): 16:37:58  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:58.396005 (Thread-5): 16:37:58  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-02 16:37:58.401737 (Thread-3): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:58.401906 (Thread-3): 16:37:58  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
2022-03-02 16:37:58.402675 (Thread-5): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:58.402795 (Thread-5): 16:37:58  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_SUPPLIER"
2022-03-02 16:37:58.518992 (Thread-6): 16:37:58  SQL status: SUCCESS 1 in 0.16 seconds
2022-03-02 16:37:58.519203 (Thread-6): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:58.519286 (Thread-6): 16:37:58  On model.dbtvault_snowflake_demo.hub_region: insert into DBT_RAW.DBT_VAULT.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_region__dbt_tmp
        );
2022-03-02 16:37:58.532838 (Thread-5): 16:37:58  SQL status: SUCCESS 4 in 0.13 seconds
2022-03-02 16:37:58.534952 (Thread-5): 16:37:58  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:58.550623 (Thread-5): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:58.550789 (Thread-5): 16:37:58  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
2022-03-02 16:37:58.579462 (Thread-3): 16:37:58  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:37:58.579680 (Thread-3): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:58.579765 (Thread-3): 16:37:58  On model.dbtvault_snowflake_demo.hub_part: insert into DBT_RAW.DBT_VAULT.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_part__dbt_tmp
        );
2022-03-02 16:37:58.720484 (Thread-5): 16:37:58  SQL status: SUCCESS 1 in 0.17 seconds
2022-03-02 16:37:58.720703 (Thread-5): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:58.720788 (Thread-5): 16:37:58  On model.dbtvault_snowflake_demo.hub_supplier: insert into DBT_RAW.DBT_VAULT.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp
        );
2022-03-02 16:37:58.939538 (Thread-6): 16:37:58  SQL status: SUCCESS 0 in 0.42 seconds
2022-03-02 16:37:58.939831 (Thread-6): 16:37:58  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-02 16:37:58.939939 (Thread-6): 16:37:58  On model.dbtvault_snowflake_demo.hub_region: commit;
2022-03-02 16:37:59.006828 (Thread-3): 16:37:59  SQL status: SUCCESS 0 in 0.43 seconds
2022-03-02 16:37:59.007041 (Thread-3): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-02 16:37:59.007127 (Thread-3): 16:37:59  On model.dbtvault_snowflake_demo.hub_part: commit;
2022-03-02 16:37:59.138626 (Thread-4): 16:37:59  SQL status: SUCCESS 1 in 4.42 seconds
2022-03-02 16:37:59.143290 (Thread-4): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:59.143484 (Thread-4): 16:37:59  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp
2022-03-02 16:37:59.209514 (Thread-6): 16:37:59  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-02 16:37:59.211732 (Thread-6): 16:37:59  finished collecting timing info
2022-03-02 16:37:59.211917 (Thread-6): 16:37:59  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-02 16:37:59.214574 (Thread-5): 16:37:59  SQL status: SUCCESS 0 in 0.49 seconds
2022-03-02 16:37:59.214743 (Thread-5): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-02 16:37:59.214826 (Thread-5): 16:37:59  On model.dbtvault_snowflake_demo.hub_supplier: commit;
2022-03-02 16:37:59.287712 (Thread-4): 16:37:59  SQL status: SUCCESS 4 in 0.14 seconds
2022-03-02 16:37:59.291442 (Thread-4): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:59.291607 (Thread-4): 16:37:59  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DBT_RAW.DBT_VAULT.hub_nation
2022-03-02 16:37:59.344120 (Thread-3): 16:37:59  SQL status: SUCCESS 1 in 0.34 seconds
2022-03-02 16:37:59.345661 (Thread-3): 16:37:59  finished collecting timing info
2022-03-02 16:37:59.345884 (Thread-3): 16:37:59  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-02 16:37:59.438855 (Thread-4): 16:37:59  SQL status: SUCCESS 4 in 0.15 seconds
2022-03-02 16:37:59.442776 (Thread-4): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:59.442921 (Thread-4): 16:37:59  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_NATION"
2022-03-02 16:37:59.471846 (Thread-6): 16:37:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b4d9dbe0>]}
2022-03-02 16:37:59.472299 (Thread-6): 16:37:59  22 of 31 OK created incremental model DBT_VAULT.hub_region...................... [SUCCESS 1 in 4.80s]
2022-03-02 16:37:59.472434 (Thread-6): 16:37:59  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-02 16:37:59.472579 (Thread-6): 16:37:59  Began running node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:37:59.472767 (Thread-6): 16:37:59  24 of 31 START incremental model DBT_VAULT.link_inventory....................... [RUN]
2022-03-02 16:37:59.473030 (Thread-6): 16:37:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:37:59.473123 (Thread-6): 16:37:59  Began compiling node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:37:59.473229 (Thread-6): 16:37:59  Compiling model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:37:59.482022 (Thread-6): 16:37:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:37:59.497350 (Thread-6): 16:37:59  finished collecting timing info
2022-03-02 16:37:59.497562 (Thread-6): 16:37:59  Began executing node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:37:59.501965 (Thread-6): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:37:59.502111 (Thread-6): 16:37:59  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:59.502200 (Thread-6): 16:37:59  Opening a new connection, currently in state closed
2022-03-02 16:37:59.505043 (Thread-5): 16:37:59  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-02 16:37:59.506514 (Thread-5): 16:37:59  finished collecting timing info
2022-03-02 16:37:59.506679 (Thread-5): 16:37:59  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-02 16:37:59.695829 (Thread-45): handling poll request
2022-03-02 16:37:59.696234 (Thread-45): 16:37:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91bdd1f0>]}
2022-03-02 16:37:59.697521 (Thread-45): sending response (<Response 35352 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:37:59.707997 (Thread-4): 16:37:59  SQL status: SUCCESS 4 in 0.26 seconds
2022-03-02 16:37:59.710117 (Thread-4): 16:37:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:59.727565 (Thread-4): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:59.727734 (Thread-4): 16:37:59  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
2022-03-02 16:37:59.756541 (Thread-3): 16:37:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b4d88310>]}
2022-03-02 16:37:59.756983 (Thread-3): 16:37:59  21 of 31 OK created incremental model DBT_VAULT.hub_part........................ [SUCCESS 1 in 5.10s]
2022-03-02 16:37:59.757111 (Thread-3): 16:37:59  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-02 16:37:59.757258 (Thread-3): 16:37:59  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:37:59.757446 (Thread-3): 16:37:59  25 of 31 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-02 16:37:59.757708 (Thread-3): 16:37:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:37:59.757846 (Thread-3): 16:37:59  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:37:59.757945 (Thread-3): 16:37:59  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:37:59.797150 (Thread-3): 16:37:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:37:59.819089 (Thread-5): 16:37:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc1e52e0>]}
2022-03-02 16:37:59.824835 (Thread-5): 16:37:59  23 of 31 OK created incremental model DBT_VAULT.hub_supplier.................... [SUCCESS 1 in 5.15s]
2022-03-02 16:37:59.825004 (Thread-5): 16:37:59  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-02 16:37:59.825156 (Thread-5): 16:37:59  Began running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:37:59.825354 (Thread-5): 16:37:59  26 of 31 START incremental model DBT_VAULT.link_supplier_nation................. [RUN]
2022-03-02 16:37:59.825648 (Thread-5): 16:37:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:37:59.825739 (Thread-5): 16:37:59  Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:37:59.825870 (Thread-5): 16:37:59  Compiling model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:37:59.844598 (Thread-5): 16:37:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:37:59.855193 (Thread-3): 16:37:59  finished collecting timing info
2022-03-02 16:37:59.855362 (Thread-3): 16:37:59  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:37:59.864847 (Thread-3): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:37:59.864984 (Thread-3): 16:37:59  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_nation_region AS d
    ON a.NATION_REGION_PK = d.NATION_REGION_PK
    WHERE d.NATION_REGION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:59.865076 (Thread-3): 16:37:59  Opening a new connection, currently in state closed
2022-03-02 16:37:59.879565 (Thread-5): 16:37:59  finished collecting timing info
2022-03-02 16:37:59.879842 (Thread-5): 16:37:59  Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:37:59.886959 (Thread-5): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:37:59.887133 (Thread-5): 16:37:59  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:37:59.887267 (Thread-5): 16:37:59  Opening a new connection, currently in state closed
2022-03-02 16:37:59.989643 (Thread-4): 16:37:59  SQL status: SUCCESS 1 in 0.26 seconds
2022-03-02 16:37:59.989902 (Thread-4): 16:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:37:59.989994 (Thread-4): 16:37:59  On model.dbtvault_snowflake_demo.hub_nation: insert into DBT_RAW.DBT_VAULT.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp
        );
2022-03-02 16:38:00.390954 (Thread-4): 16:38:00  SQL status: SUCCESS 0 in 0.4 seconds
2022-03-02 16:38:00.391174 (Thread-4): 16:38:00  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-02 16:38:00.391263 (Thread-4): 16:38:00  On model.dbtvault_snowflake_demo.hub_nation: commit;
2022-03-02 16:38:00.652697 (Thread-4): 16:38:00  SQL status: SUCCESS 1 in 0.26 seconds
2022-03-02 16:38:00.654328 (Thread-4): 16:38:00  finished collecting timing info
2022-03-02 16:38:00.654503 (Thread-4): 16:38:00  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-02 16:38:01.049660 (Thread-4): 16:38:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b56fd490>]}
2022-03-02 16:38:01.050353 (Thread-4): 16:38:01  20 of 31 OK created incremental model DBT_VAULT.hub_nation...................... [SUCCESS 1 in 6.40s]
2022-03-02 16:38:01.050495 (Thread-4): 16:38:01  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-02 16:38:01.050639 (Thread-4): 16:38:01  Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:38:01.050823 (Thread-4): 16:38:01  27 of 31 START incremental model DBT_VAULT.sat_inv_inventory_details............ [RUN]
2022-03-02 16:38:01.051081 (Thread-4): 16:38:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:01.051170 (Thread-4): 16:38:01  Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:38:01.051263 (Thread-4): 16:38:01  Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:38:01.065934 (Thread-4): 16:38:01  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:01.081479 (Thread-4): 16:38:01  finished collecting timing info
2022-03-02 16:38:01.081694 (Thread-4): 16:38:01  Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:38:01.087055 (Thread-4): 16:38:01  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:01.087205 (Thread-4): 16:38:01  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (

    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.INVENTORY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
                WHERE latest_records.INVENTORY_HASHDIFF != stage.INVENTORY_HASHDIFF
                OR latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:38:01.087298 (Thread-4): 16:38:01  Opening a new connection, currently in state closed
2022-03-02 16:38:01.514779 (Thread-46): handling poll request
2022-03-02 16:38:01.515166 (Thread-46): 16:38:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91be9970>]}
2022-03-02 16:38:01.516255 (Thread-46): sending response (<Response 28399 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:01.538709 (Thread-6): 16:38:01  SQL status: SUCCESS 1 in 2.04 seconds
2022-03-02 16:38:01.542305 (Thread-6): 16:38:01  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:01.542449 (Thread-6): 16:38:01  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
2022-03-02 16:38:01.679574 (Thread-6): 16:38:01  SQL status: SUCCESS 5 in 0.14 seconds
2022-03-02 16:38:01.684248 (Thread-6): 16:38:01  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:01.684386 (Thread-6): 16:38:01  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory
2022-03-02 16:38:01.841831 (Thread-6): 16:38:01  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:38:01.845547 (Thread-6): 16:38:01  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:01.845694 (Thread-6): 16:38:01  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY"
2022-03-02 16:38:02.027477 (Thread-6): 16:38:02  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-02 16:38:02.029606 (Thread-6): 16:38:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:02.045243 (Thread-6): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:02.045413 (Thread-6): 16:38:02  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
2022-03-02 16:38:02.053596 (Thread-5): 16:38:02  SQL status: SUCCESS 1 in 2.17 seconds
2022-03-02 16:38:02.059021 (Thread-5): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:02.059223 (Thread-5): 16:38:02  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
2022-03-02 16:38:02.181429 (Thread-3): 16:38:02  SQL status: SUCCESS 1 in 2.32 seconds
2022-03-02 16:38:02.184855 (Thread-3): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:02.185013 (Thread-3): 16:38:02  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp
2022-03-02 16:38:02.226625 (Thread-6): 16:38:02  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:38:02.226832 (Thread-6): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:02.226914 (Thread-6): 16:38:02  On model.dbtvault_snowflake_demo.link_inventory: insert into DBT_RAW.DBT_VAULT.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
        );
2022-03-02 16:38:02.243127 (Thread-5): 16:38:02  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-02 16:38:02.248167 (Thread-5): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:02.248545 (Thread-5): 16:38:02  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation
2022-03-02 16:38:02.343208 (Thread-3): 16:38:02  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:38:02.346828 (Thread-3): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:02.346948 (Thread-3): 16:38:02  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DBT_RAW.DBT_VAULT.link_nation_region
2022-03-02 16:38:02.417173 (Thread-5): 16:38:02  SQL status: SUCCESS 5 in 0.17 seconds
2022-03-02 16:38:02.420721 (Thread-5): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:02.420836 (Thread-5): 16:38:02  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_SUPPLIER_NATION"
2022-03-02 16:38:02.490282 (Thread-3): 16:38:02  SQL status: SUCCESS 5 in 0.14 seconds
2022-03-02 16:38:02.493890 (Thread-3): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:02.494013 (Thread-3): 16:38:02  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_NATION_REGION"
2022-03-02 16:38:02.541611 (Thread-5): 16:38:02  SQL status: SUCCESS 5 in 0.12 seconds
2022-03-02 16:38:02.543752 (Thread-5): 16:38:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:02.562009 (Thread-5): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:02.562173 (Thread-5): 16:38:02  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
2022-03-02 16:38:02.577023 (Thread-6): 16:38:02  SQL status: SUCCESS 0 in 0.35 seconds
2022-03-02 16:38:02.577227 (Thread-6): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-02 16:38:02.577313 (Thread-6): 16:38:02  On model.dbtvault_snowflake_demo.link_inventory: commit;
2022-03-02 16:38:02.656627 (Thread-3): 16:38:02  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-02 16:38:02.658856 (Thread-3): 16:38:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:02.674984 (Thread-3): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:02.675149 (Thread-3): 16:38:02  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
begin;
2022-03-02 16:38:02.737942 (Thread-5): 16:38:02  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:38:02.738146 (Thread-5): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:02.738229 (Thread-5): 16:38:02  On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DBT_RAW.DBT_VAULT.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
        );
2022-03-02 16:38:02.832317 (Thread-6): 16:38:02  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-02 16:38:02.833878 (Thread-6): 16:38:02  finished collecting timing info
2022-03-02 16:38:02.834051 (Thread-6): 16:38:02  On model.dbtvault_snowflake_demo.link_inventory: Close
2022-03-02 16:38:02.836175 (Thread-3): 16:38:02  SQL status: SUCCESS 1 in 0.16 seconds
2022-03-02 16:38:02.836326 (Thread-3): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:02.836409 (Thread-3): 16:38:02  On model.dbtvault_snowflake_demo.link_nation_region: insert into DBT_RAW.DBT_VAULT.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp
        );
2022-03-02 16:38:02.923978 (Thread-4): 16:38:02  SQL status: SUCCESS 1 in 1.84 seconds
2022-03-02 16:38:02.927499 (Thread-4): 16:38:02  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:02.927630 (Thread-4): 16:38:02  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
2022-03-02 16:38:03.061175 (Thread-6): 16:38:03  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b56de400>]}
2022-03-02 16:38:03.061619 (Thread-6): 16:38:03  24 of 31 OK created incremental model DBT_VAULT.link_inventory.................. [SUCCESS 1 in 3.59s]
2022-03-02 16:38:03.061757 (Thread-6): 16:38:03  Finished running node model.dbtvault_snowflake_demo.link_inventory
2022-03-02 16:38:03.061953 (Thread-6): 16:38:03  Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:38:03.062151 (Thread-6): 16:38:03  28 of 31 START incremental model DBT_VAULT.sat_inv_part_details................. [RUN]
2022-03-02 16:38:03.062400 (Thread-6): 16:38:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:03.062491 (Thread-6): 16:38:03  Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:38:03.062582 (Thread-6): 16:38:03  Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:38:03.078491 (Thread-6): 16:38:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:03.079842 (Thread-4): 16:38:03  SQL status: SUCCESS 8 in 0.15 seconds
2022-03-02 16:38:03.083446 (Thread-4): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:03.083562 (Thread-4): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details
2022-03-02 16:38:03.093994 (Thread-6): 16:38:03  finished collecting timing info
2022-03-02 16:38:03.094206 (Thread-6): 16:38:03  Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:38:03.099147 (Thread-6): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:03.099540 (Thread-6): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (

    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.PART_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.PART_PK = stage.PART_PK
                WHERE latest_records.PART_HASHDIFF != stage.PART_HASHDIFF
                OR latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:38:03.099649 (Thread-6): 16:38:03  Opening a new connection, currently in state closed
2022-03-02 16:38:03.103817 (Thread-5): 16:38:03  SQL status: SUCCESS 0 in 0.37 seconds
2022-03-02 16:38:03.103982 (Thread-5): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-02 16:38:03.104065 (Thread-5): 16:38:03  On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
2022-03-02 16:38:03.176985 (Thread-3): 16:38:03  SQL status: SUCCESS 0 in 0.34 seconds
2022-03-02 16:38:03.177193 (Thread-3): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-02 16:38:03.177276 (Thread-3): 16:38:03  On model.dbtvault_snowflake_demo.link_nation_region: commit;
2022-03-02 16:38:03.195323 (Thread-4): 16:38:03  SQL status: SUCCESS 8 in 0.11 seconds
2022-03-02 16:38:03.199332 (Thread-4): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:03.199477 (Thread-4): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_INVENTORY_DETAILS"
2022-03-02 16:38:03.350267 (Thread-4): 16:38:03  SQL status: SUCCESS 8 in 0.15 seconds
2022-03-02 16:38:03.352558 (Thread-4): 16:38:03  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:03.374640 (Thread-5): 16:38:03  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-02 16:38:03.376128 (Thread-5): 16:38:03  finished collecting timing info
2022-03-02 16:38:03.376296 (Thread-5): 16:38:03  On model.dbtvault_snowflake_demo.link_supplier_nation: Close
2022-03-02 16:38:03.393213 (Thread-4): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:03.393352 (Thread-4): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
2022-03-02 16:38:03.438321 (Thread-3): 16:38:03  SQL status: SUCCESS 1 in 0.26 seconds
2022-03-02 16:38:03.439922 (Thread-3): 16:38:03  finished collecting timing info
2022-03-02 16:38:03.440083 (Thread-3): 16:38:03  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-02 16:38:03.600489 (Thread-4): 16:38:03  SQL status: SUCCESS 1 in 0.21 seconds
2022-03-02 16:38:03.600717 (Thread-4): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:03.600804 (Thread-4): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DBT_RAW.DBT_VAULT.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
        );
2022-03-02 16:38:03.644675 (Thread-5): 16:38:03  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b4de8760>]}
2022-03-02 16:38:03.645117 (Thread-5): 16:38:03  26 of 31 OK created incremental model DBT_VAULT.link_supplier_nation............ [SUCCESS 1 in 3.82s]
2022-03-02 16:38:03.645247 (Thread-5): 16:38:03  Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-02 16:38:03.645396 (Thread-5): 16:38:03  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:38:03.645589 (Thread-5): 16:38:03  29 of 31 START incremental model DBT_VAULT.sat_inv_supp_nation_details.......... [RUN]
2022-03-02 16:38:03.645897 (Thread-5): 16:38:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:03.645996 (Thread-5): 16:38:03  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:38:03.646086 (Thread-5): 16:38:03  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:38:03.659972 (Thread-5): 16:38:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:03.675090 (Thread-5): 16:38:03  finished collecting timing info
2022-03-02 16:38:03.675293 (Thread-5): 16:38:03  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:38:03.680530 (Thread-5): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:03.680681 (Thread-5): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:38:03.680774 (Thread-5): 16:38:03  Opening a new connection, currently in state closed
2022-03-02 16:38:03.683903 (Thread-3): 16:38:03  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b4d4fc40>]}
2022-03-02 16:38:03.684266 (Thread-3): 16:38:03  25 of 31 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 3.93s]
2022-03-02 16:38:03.684388 (Thread-3): 16:38:03  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-02 16:38:03.684537 (Thread-3): 16:38:03  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:38:03.684724 (Thread-3): 16:38:03  30 of 31 START incremental model DBT_VAULT.sat_inv_supp_region_details.......... [RUN]
2022-03-02 16:38:03.684962 (Thread-3): 16:38:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:03.685048 (Thread-3): 16:38:03  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:38:03.685135 (Thread-3): 16:38:03  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:38:03.700559 (Thread-3): 16:38:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:03.715260 (Thread-3): 16:38:03  finished collecting timing info
2022-03-02 16:38:03.715479 (Thread-3): 16:38:03  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:38:03.720877 (Thread-3): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:03.721023 (Thread-3): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:38:03.721113 (Thread-3): 16:38:03  Opening a new connection, currently in state closed
2022-03-02 16:38:03.944880 (Thread-4): 16:38:03  SQL status: SUCCESS 0 in 0.34 seconds
2022-03-02 16:38:03.945088 (Thread-4): 16:38:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-02 16:38:03.945174 (Thread-4): 16:38:03  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
2022-03-02 16:38:04.240231 (Thread-4): 16:38:04  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-02 16:38:04.241896 (Thread-4): 16:38:04  finished collecting timing info
2022-03-02 16:38:04.242075 (Thread-4): 16:38:04  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
2022-03-02 16:38:04.252808 (Thread-47): handling poll request
2022-03-02 16:38:04.253150 (Thread-47): 16:38:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b8d850>]}
2022-03-02 16:38:04.254927 (Thread-47): sending response (<Response 62148 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:04.524169 (Thread-4): 16:38:04  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc181880>]}
2022-03-02 16:38:04.524607 (Thread-4): 16:38:04  27 of 31 OK created incremental model DBT_VAULT.sat_inv_inventory_details....... [SUCCESS 1 in 3.47s]
2022-03-02 16:38:04.524734 (Thread-4): 16:38:04  Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-02 16:38:04.524876 (Thread-4): 16:38:04  Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:38:04.525062 (Thread-4): 16:38:04  31 of 31 START incremental model DBT_VAULT.sat_inv_supplier_details............. [RUN]
2022-03-02 16:38:04.525308 (Thread-4): 16:38:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:04.525399 (Thread-4): 16:38:04  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:38:04.525488 (Thread-4): 16:38:04  Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:38:04.541518 (Thread-4): 16:38:04  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:04.555864 (Thread-4): 16:38:04  finished collecting timing info
2022-03-02 16:38:04.556075 (Thread-4): 16:38:04  Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:38:04.561508 (Thread-4): 16:38:04  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:04.561660 (Thread-4): 16:38:04  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_HASHDIFF != stage.SUPPLIER_HASHDIFF
                OR latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-02 16:38:04.561753 (Thread-4): 16:38:04  Opening a new connection, currently in state closed
2022-03-02 16:38:04.895682 (Thread-6): 16:38:04  SQL status: SUCCESS 1 in 1.8 seconds
2022-03-02 16:38:04.899003 (Thread-6): 16:38:04  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:04.899126 (Thread-6): 16:38:04  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
2022-03-02 16:38:05.100823 (Thread-6): 16:38:05  SQL status: SUCCESS 13 in 0.2 seconds
2022-03-02 16:38:05.105127 (Thread-6): 16:38:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:05.105280 (Thread-6): 16:38:05  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details
2022-03-02 16:38:05.278642 (Thread-6): 16:38:05  SQL status: SUCCESS 13 in 0.17 seconds
2022-03-02 16:38:05.282762 (Thread-6): 16:38:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:05.282891 (Thread-6): 16:38:05  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_PART_DETAILS"
2022-03-02 16:38:05.436167 (Thread-6): 16:38:05  SQL status: SUCCESS 13 in 0.15 seconds
2022-03-02 16:38:05.438793 (Thread-6): 16:38:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:05.453884 (Thread-6): 16:38:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:05.454051 (Thread-6): 16:38:05  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
2022-03-02 16:38:05.656996 (Thread-6): 16:38:05  SQL status: SUCCESS 1 in 0.2 seconds
2022-03-02 16:38:05.657303 (Thread-6): 16:38:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:05.657430 (Thread-6): 16:38:05  On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DBT_RAW.DBT_VAULT.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
        );
2022-03-02 16:38:05.685745 (Thread-3): 16:38:05  SQL status: SUCCESS 1 in 1.96 seconds
2022-03-02 16:38:05.691108 (Thread-3): 16:38:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:05.691309 (Thread-3): 16:38:05  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
2022-03-02 16:38:05.988818 (Thread-6): 16:38:05  SQL status: SUCCESS 0 in 0.33 seconds
2022-03-02 16:38:05.989029 (Thread-6): 16:38:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-02 16:38:05.989116 (Thread-6): 16:38:05  On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
2022-03-02 16:38:06.039597 (Thread-5): 16:38:06  SQL status: SUCCESS 1 in 2.36 seconds
2022-03-02 16:38:06.046589 (Thread-5): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.046753 (Thread-5): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
2022-03-02 16:38:06.074304 (Thread-48): handling poll request
2022-03-02 16:38:06.074689 (Thread-48): 16:38:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b959a0>]}
2022-03-02 16:38:06.075508 (Thread-48): sending response (<Response 19676 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:06.104708 (Thread-3): 16:38:06  SQL status: SUCCESS 7 in 0.41 seconds
2022-03-02 16:38:06.110758 (Thread-3): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:06.110967 (Thread-3): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details
2022-03-02 16:38:06.188432 (Thread-5): 16:38:06  SQL status: SUCCESS 7 in 0.14 seconds
2022-03-02 16:38:06.192289 (Thread-5): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.192416 (Thread-5): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details
2022-03-02 16:38:06.223606 (Thread-6): 16:38:06  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-02 16:38:06.225144 (Thread-6): 16:38:06  finished collecting timing info
2022-03-02 16:38:06.225318 (Thread-6): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
2022-03-02 16:38:06.237751 (Thread-3): 16:38:06  SQL status: SUCCESS 7 in 0.13 seconds
2022-03-02 16:38:06.244194 (Thread-3): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:06.244394 (Thread-3): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_REGION_DETAILS"
2022-03-02 16:38:06.323007 (Thread-5): 16:38:06  SQL status: SUCCESS 7 in 0.13 seconds
2022-03-02 16:38:06.326950 (Thread-5): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.327083 (Thread-5): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_NATION_DETAILS"
2022-03-02 16:38:06.384474 (Thread-3): 16:38:06  SQL status: SUCCESS 7 in 0.14 seconds
2022-03-02 16:38:06.388000 (Thread-3): 16:38:06  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:06.406841 (Thread-3): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:06.407091 (Thread-3): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
2022-03-02 16:38:06.450408 (Thread-6): 16:38:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b56c5730>]}
2022-03-02 16:38:06.473875 (Thread-5): 16:38:06  SQL status: SUCCESS 7 in 0.15 seconds
2022-03-02 16:38:06.476682 (Thread-5): 16:38:06  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.477562 (Thread-6): 16:38:06  28 of 31 OK created incremental model DBT_VAULT.sat_inv_part_details............ [SUCCESS 1 in 3.39s]
2022-03-02 16:38:06.477714 (Thread-6): 16:38:06  Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-02 16:38:06.494510 (Thread-5): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.494673 (Thread-5): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
2022-03-02 16:38:06.589489 (Thread-3): 16:38:06  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-02 16:38:06.589719 (Thread-3): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:06.589844 (Thread-3): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
        );
2022-03-02 16:38:06.688654 (Thread-5): 16:38:06  SQL status: SUCCESS 1 in 0.19 seconds
2022-03-02 16:38:06.688873 (Thread-5): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.688958 (Thread-5): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
        );
2022-03-02 16:38:06.795766 (Thread-4): 16:38:06  SQL status: SUCCESS 1 in 2.23 seconds
2022-03-02 16:38:06.800273 (Thread-4): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:06.800410 (Thread-4): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
2022-03-02 16:38:06.958715 (Thread-4): 16:38:06  SQL status: SUCCESS 10 in 0.16 seconds
2022-03-02 16:38:06.962465 (Thread-4): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:06.962597 (Thread-4): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details
2022-03-02 16:38:06.970352 (Thread-3): 16:38:06  SQL status: SUCCESS 0 in 0.38 seconds
2022-03-02 16:38:06.970520 (Thread-3): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-02 16:38:06.970602 (Thread-3): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
2022-03-02 16:38:06.980210 (Thread-5): 16:38:06  SQL status: SUCCESS 0 in 0.29 seconds
2022-03-02 16:38:06.980366 (Thread-5): 16:38:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-02 16:38:06.980446 (Thread-5): 16:38:06  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
2022-03-02 16:38:07.109543 (Thread-4): 16:38:07  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-02 16:38:07.115494 (Thread-4): 16:38:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:07.115630 (Thread-4): 16:38:07  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPPLIER_DETAILS"
2022-03-02 16:38:07.230062 (Thread-3): 16:38:07  SQL status: SUCCESS 1 in 0.26 seconds
2022-03-02 16:38:07.231546 (Thread-3): 16:38:07  finished collecting timing info
2022-03-02 16:38:07.231709 (Thread-3): 16:38:07  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
2022-03-02 16:38:07.242031 (Thread-4): 16:38:07  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-02 16:38:07.244424 (Thread-4): 16:38:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:07.245620 (Thread-5): 16:38:07  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-02 16:38:07.246993 (Thread-5): 16:38:07  finished collecting timing info
2022-03-02 16:38:07.247146 (Thread-5): 16:38:07  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
2022-03-02 16:38:07.262037 (Thread-4): 16:38:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:07.262187 (Thread-4): 16:38:07  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
2022-03-02 16:38:07.431454 (Thread-4): 16:38:07  SQL status: SUCCESS 1 in 0.17 seconds
2022-03-02 16:38:07.431679 (Thread-4): 16:38:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:07.431764 (Thread-4): 16:38:07  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
        );
2022-03-02 16:38:07.458130 (Thread-3): 16:38:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cc144ca0>]}
2022-03-02 16:38:07.458568 (Thread-3): 16:38:07  30 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_region_details..... [SUCCESS 1 in 3.77s]
2022-03-02 16:38:07.458697 (Thread-3): 16:38:07  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-02 16:38:07.467792 (Thread-5): 16:38:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b56b2100>]}
2022-03-02 16:38:07.468181 (Thread-5): 16:38:07  29 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_nation_details..... [SUCCESS 1 in 3.82s]
2022-03-02 16:38:07.468302 (Thread-5): 16:38:07  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-02 16:38:07.807262 (Thread-4): 16:38:07  SQL status: SUCCESS 0 in 0.38 seconds
2022-03-02 16:38:07.807468 (Thread-4): 16:38:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-02 16:38:07.807551 (Thread-4): 16:38:07  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
2022-03-02 16:38:07.852458 (Thread-49): handling poll request
2022-03-02 16:38:07.852825 (Thread-49): 16:38:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91bae760>]}
2022-03-02 16:38:07.854103 (Thread-49): sending response (<Response 31340 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:08.090228 (Thread-4): 16:38:08  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-02 16:38:08.091749 (Thread-4): 16:38:08  finished collecting timing info
2022-03-02 16:38:08.091909 (Thread-4): 16:38:08  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
2022-03-02 16:38:08.310561 (Thread-4): 16:38:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497f0b-f7d1-42f9-abca-1401ab5cd1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b57306d0>]}
2022-03-02 16:38:08.310985 (Thread-4): 16:38:08  31 of 31 OK created incremental model DBT_VAULT.sat_inv_supplier_details........ [SUCCESS 1 in 3.79s]
2022-03-02 16:38:08.311112 (Thread-4): 16:38:08  Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-02 16:38:08.312936 (MainThread): 16:38:08  Acquiring new snowflake connection "master"
2022-03-02 16:38:08.313376 (MainThread): 16:38:08  
2022-03-02 16:38:08.313482 (MainThread): 16:38:08  Finished running 6 table models, 25 incremental models in 43.73s.
2022-03-02 16:38:08.313568 (MainThread): 16:38:08  Connection 'master' was properly closed.
2022-03-02 16:38:08.313636 (MainThread): 16:38:08  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
2022-03-02 16:38:08.313699 (MainThread): 16:38:08  Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
2022-03-02 16:38:08.313760 (MainThread): 16:38:08  Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
2022-03-02 16:38:08.313867 (MainThread): 16:38:08  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
2022-03-02 16:38:08.412428 (MainThread): 16:38:08  
2022-03-02 16:38:08.412666 (MainThread): 16:38:08  Completed successfully
2022-03-02 16:38:08.412801 (MainThread): 16:38:08  
2022-03-02 16:38:08.412897 (MainThread): 16:38:08  Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
2022-03-02 16:38:09.628790 (Thread-50): handling poll request
2022-03-02 16:38:09.629223 (Thread-50): 16:38:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b45b80>]}
2022-03-02 16:38:09.632870 (Thread-50): sending response (<Response 165509 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:11.519542 (Thread-51): handling status request
2022-03-02 16:38:11.519955 (Thread-51): 16:38:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b4d580>]}
2022-03-02 16:38:11.520478 (Thread-51): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:11.532871 (Thread-52): handling status request
2022-03-02 16:38:11.533197 (Thread-52): 16:38:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b55ca0>]}
2022-03-02 16:38:11.533623 (Thread-52): sending response (<Response 1241 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:13.360284 (Thread-53): handling status request
2022-03-02 16:38:13.360681 (Thread-53): 16:38:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b5baf0>]}
2022-03-02 16:38:13.361145 (Thread-53): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:38:13.368072 (Thread-54): handling list request
2022-03-02 16:38:13.368353 (Thread-54): 16:38:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b63c70>]}
2022-03-02 16:38:13.406742 (Thread-54): 16:38:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91bae9d0>]}
2022-03-02 16:38:13.407265 (Thread-54): 16:38:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:38:13.409047 (Thread-54): 16:38:13  The selection criterion '+1646238782679/__unsaved/Statement' does not match any nodes
2022-03-02 16:38:13.409367 (Thread-54): 16:38:13  The selection criterion '22.sql+' does not match any nodes
2022-03-02 16:38:13.409487 (Thread-54): 16:38:13  No nodes selected!
2022-03-02 16:38:13.411142 (Thread-54): sending response (<Response 2345 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:02.868838 (Thread-55): handling status request
2022-03-02 16:41:02.870700 (Thread-55): 16:41:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca5640>]}
2022-03-02 16:41:02.871200 (Thread-55): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:02.878383 (Thread-56): handling list request
2022-03-02 16:41:02.878666 (Thread-56): 16:41:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca5e50>]}
2022-03-02 16:41:02.919318 (Thread-56): 16:41:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca1d60>]}
2022-03-02 16:41:02.919748 (Thread-56): 16:41:02  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:41:02.923464 (Thread-56): 16:41:02  The selection criterion '+1646238782679/__unsaved/Statement' does not match any nodes
2022-03-02 16:41:02.923784 (Thread-56): 16:41:02  The selection criterion '22.sql+' does not match any nodes
2022-03-02 16:41:02.923909 (Thread-56): 16:41:02  No nodes selected!
2022-03-02 16:41:02.925428 (Thread-56): sending response (<Response 2345 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:03.789661 (Thread-57): handling status request
2022-03-02 16:41:03.790099 (Thread-57): 16:41:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca3d60>]}
2022-03-02 16:41:03.790564 (Thread-57): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:03.796949 (Thread-58): handling list request
2022-03-02 16:41:03.797219 (Thread-58): 16:41:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca3c40>]}
2022-03-02 16:41:03.837467 (Thread-58): 16:41:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca7f70>]}
2022-03-02 16:41:03.837888 (Thread-58): 16:41:03  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:41:03.846712 (Thread-58): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:22.724516 (Thread-59): handling status request
2022-03-02 16:41:22.724907 (Thread-59): 16:41:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8070490>]}
2022-03-02 16:41:22.725384 (Thread-59): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:22.732221 (Thread-60): handling list request
2022-03-02 16:41:22.732515 (Thread-60): 16:41:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b71b50>]}
2022-03-02 16:41:22.765416 (Thread-60): 16:41:22  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92ca3580>]}
2022-03-02 16:41:22.765878 (Thread-60): 16:41:22  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:41:22.773723 (Thread-60): sending response (<Response 5514 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:26.377063 (Thread-61): handling status request
2022-03-02 16:41:26.377442 (Thread-61): 16:41:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b279a0>]}
2022-03-02 16:41:26.377966 (Thread-61): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:26.392584 (Thread-62): handling list request
2022-03-02 16:41:26.392868 (Thread-62): 16:41:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b1c130>]}
2022-03-02 16:41:26.428964 (Thread-62): 16:41:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b71f70>]}
2022-03-02 16:41:26.456479 (Thread-62): 16:41:26  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:41:26.461434 (Thread-62): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:37.702110 (Thread-63): handling status request
2022-03-02 16:41:37.702484 (Thread-63): 16:41:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe91b1cb50>]}
2022-03-02 16:41:37.702961 (Thread-63): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:41:37.720066 (Thread-64): handling list request
2022-03-02 16:41:37.720407 (Thread-64): 16:41:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90ae1cd0>]}
2022-03-02 16:41:37.758362 (Thread-64): 16:41:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe92de4700>]}
2022-03-02 16:41:37.758772 (Thread-64): 16:41:37  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:41:37.766852 (Thread-64): sending response (<Response 23529 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:42:33.739933 (Thread-65): handling status request
2022-03-02 16:42:33.740324 (Thread-65): 16:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe902440d0>]}
2022-03-02 16:42:33.740802 (Thread-65): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:42:33.747317 (Thread-66): handling list request
2022-03-02 16:42:33.747591 (Thread-66): 16:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe902443d0>]}
2022-03-02 16:42:33.790737 (Thread-66): 16:42:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90244d00>]}
2022-03-02 16:42:33.791277 (Thread-66): 16:42:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:42:33.802532 (Thread-66): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:42:54.042217 (Thread-67): handling status request
2022-03-02 16:42:54.042587 (Thread-67): 16:42:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9026f5e0>]}
2022-03-02 16:42:54.043046 (Thread-67): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:42:54.049819 (Thread-68): handling list request
2022-03-02 16:42:54.050072 (Thread-68): 16:42:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9026f3d0>]}
2022-03-02 16:42:54.088138 (Thread-68): 16:42:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90244310>]}
2022-03-02 16:42:54.088514 (Thread-68): 16:42:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:42:54.095911 (Thread-68): sending response (<Response 5514 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:42:56.723318 (Thread-69): handling status request
2022-03-02 16:42:56.723701 (Thread-69): 16:42:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90272df0>]}
2022-03-02 16:42:56.724169 (Thread-69): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:42:56.731042 (Thread-70): handling list request
2022-03-02 16:42:56.731337 (Thread-70): 16:42:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90272b20>]}
2022-03-02 16:42:56.771895 (Thread-70): 16:42:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9026f490>]}
2022-03-02 16:42:56.772278 (Thread-70): 16:42:56  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:42:56.777291 (Thread-70): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:43:07.865988 (Thread-71): handling status request
2022-03-02 16:43:07.866387 (Thread-71): 16:43:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90277bb0>]}
2022-03-02 16:43:07.866861 (Thread-71): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:43:07.889403 (Thread-72): handling list request
2022-03-02 16:43:07.889752 (Thread-72): 16:43:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9022f7c0>]}
2022-03-02 16:43:07.930719 (Thread-72): 16:43:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90272b80>]}
2022-03-02 16:43:07.931103 (Thread-72): 16:43:07  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:43:07.936017 (Thread-72): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:43:13.923956 (Thread-73): handling status request
2022-03-02 16:43:13.924326 (Thread-73): 16:43:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9017c310>]}
2022-03-02 16:43:13.924809 (Thread-73): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:43:13.931979 (Thread-74): handling list request
2022-03-02 16:43:13.933199 (Thread-74): 16:43:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90272f40>]}
2022-03-02 16:43:13.967218 (Thread-74): 16:43:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90277c10>]}
2022-03-02 16:43:13.967605 (Thread-74): 16:43:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:43:13.971171 (Thread-74): sending response (<Response 5514 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:44:44.783090 (Thread-75): handling status request
2022-03-02 16:44:44.785236 (Thread-75): 16:44:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9017ce50>]}
2022-03-02 16:44:44.785752 (Thread-75): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:44:44.792675 (Thread-76): handling list request
2022-03-02 16:44:44.793018 (Thread-76): 16:44:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9017cfd0>]}
2022-03-02 16:44:44.834427 (Thread-76): 16:44:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90277c40>]}
2022-03-02 16:44:44.834817 (Thread-76): 16:44:44  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:44:44.843168 (Thread-76): sending response (<Response 5514 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:46:02.492906 (Thread-77): handling status request
2022-03-02 16:46:02.494920 (Thread-77): 16:46:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901e2250>]}
2022-03-02 16:46:02.495389 (Thread-77): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:46:02.510719 (Thread-78): handling list request
2022-03-02 16:46:02.511037 (Thread-78): 16:46:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901e2520>]}
2022-03-02 16:46:02.551440 (Thread-78): 16:46:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901e25e0>]}
2022-03-02 16:46:02.551810 (Thread-78): 16:46:02  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:46:02.563062 (Thread-78): sending response (<Response 5399 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:46:10.922587 (Thread-79): handling status request
2022-03-02 16:46:10.922976 (Thread-79): 16:46:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901bf400>]}
2022-03-02 16:46:10.923467 (Thread-79): sending response (<Response 1219 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:46:10.930765 (Thread-80): handling list request
2022-03-02 16:46:10.931067 (Thread-80): 16:46:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901bf640>]}
2022-03-02 16:46:10.963824 (Thread-80): 16:46:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901e2d00>]}
2022-03-02 16:46:10.964225 (Thread-80): 16:46:10  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:46:10.971531 (Thread-80): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:47:55.504895 (Thread-81): 16:47:55  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-02 16:47:55.506941 (Thread-81): 16:47:55  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-02 16:47:55.520150 (Thread-81): 16:47:55  1603: static parser failed on stage/v_stg_orders.sql
2022-03-02 16:47:55.654643 (Thread-81): 16:47:55  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-02 16:47:55.725215 (Thread-81): 16:47:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe706adf10>]}
2022-03-02 16:47:56.228078 (Thread-82): handling status request
2022-03-02 16:47:56.228464 (Thread-82): 16:47:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe900b0790>]}
2022-03-02 16:47:56.228962 (Thread-82): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:47:56.246171 (Thread-83): handling list request
2022-03-02 16:47:56.246523 (Thread-83): 16:47:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe900b0520>]}
2022-03-02 16:47:56.304977 (Thread-83): 16:47:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe900b0af0>]}
2022-03-02 16:47:56.305407 (Thread-83): 16:47:56  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:47:56.311035 (Thread-83): sending response (<Response 16919 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:47:56.538711 (Thread-84): handling status request
2022-03-02 16:47:56.539157 (Thread-84): 16:47:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7067e4c0>]}
2022-03-02 16:47:56.539673 (Thread-84): sending response (<Response 1868 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:47:56.590481 (Thread-85): handling status request
2022-03-02 16:47:56.590840 (Thread-85): 16:47:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901ae3d0>]}
2022-03-02 16:47:56.591326 (Thread-85): sending response (<Response 1868 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:48:14.973303 (Thread-86): handling status request
2022-03-02 16:48:14.973694 (Thread-86): 16:48:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe90198c10>]}
2022-03-02 16:48:14.974251 (Thread-86): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:48:14.981299 (Thread-87): handling list request
2022-03-02 16:48:14.981603 (Thread-87): 16:48:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe706adf40>]}
2022-03-02 16:48:15.157127 (Thread-87): 16:48:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed21923d0>]}
2022-03-02 16:48:15.157508 (Thread-87): 16:48:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:48:15.159212 (Thread-87): 16:48:15  The selection criterion '+dbt_packages/dbtvault/macros/materialisations/incremental_bridge_helpers.sql+' does not match any nodes
2022-03-02 16:48:15.159391 (Thread-87): 16:48:15  No nodes selected!
2022-03-02 16:48:15.160798 (Thread-87): sending response (<Response 1986 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:48:50.778544 (Thread-88): handling status request
2022-03-02 16:48:50.778935 (Thread-88): 16:48:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed2182ca0>]}
2022-03-02 16:48:50.779429 (Thread-88): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:48:50.786179 (Thread-89): handling list request
2022-03-02 16:48:50.786485 (Thread-89): 16:48:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80f9190>]}
2022-03-02 16:48:50.821403 (Thread-89): 16:48:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed2182d00>]}
2022-03-02 16:48:50.821958 (Thread-89): 16:48:50  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:48:50.823510 (Thread-89): 16:48:50  The selection criterion '+dbt_packages/dbtvault/macros/tables/eff_sat.sql+' does not match any nodes
2022-03-02 16:48:50.823676 (Thread-89): 16:48:50  No nodes selected!
2022-03-02 16:48:50.824986 (Thread-89): sending response (<Response 1957 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:48:53.410979 (Thread-90): handling status request
2022-03-02 16:48:53.411358 (Thread-90): 16:48:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea81011f0>]}
2022-03-02 16:48:53.411839 (Thread-90): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:48:53.417891 (Thread-91): handling list request
2022-03-02 16:48:53.418194 (Thread-91): 16:48:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed2192940>]}
2022-03-02 16:48:53.451910 (Thread-91): 16:48:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa20f490>]}
2022-03-02 16:48:53.452267 (Thread-91): 16:48:53  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:48:53.453946 (Thread-91): 16:48:53  The selection criterion '+dbt_packages/dbtvault/macros/tables/sat.sql+' does not match any nodes
2022-03-02 16:48:53.454119 (Thread-91): 16:48:53  No nodes selected!
2022-03-02 16:48:53.455456 (Thread-91): sending response (<Response 1953 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:17.183451 (Thread-92): handling status request
2022-03-02 16:50:17.185411 (Thread-92): 16:50:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea811b940>]}
2022-03-02 16:50:17.185973 (Thread-92): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:17.199704 (Thread-93): handling list request
2022-03-02 16:50:17.200023 (Thread-93): 16:50:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea81170a0>]}
2022-03-02 16:50:17.237149 (Thread-93): 16:50:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea81017c0>]}
2022-03-02 16:50:17.237554 (Thread-93): 16:50:17  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:17.248251 (Thread-93): sending response (<Response 5399 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:18.022958 (Thread-94): handling status request
2022-03-02 16:50:18.023356 (Thread-94): 16:50:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea810d250>]}
2022-03-02 16:50:18.023847 (Thread-94): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:18.038102 (Thread-95): handling list request
2022-03-02 16:50:18.038441 (Thread-95): 16:50:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea810d640>]}
2022-03-02 16:50:18.073978 (Thread-95): 16:50:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8117ac0>]}
2022-03-02 16:50:18.074364 (Thread-95): 16:50:18  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:18.081158 (Thread-95): 16:50:18  The selection criterion '+dbt_packages/dbtvault/macros/materialisations/incremental_bridge_helpers.sql+' does not match any nodes
2022-03-02 16:50:18.081373 (Thread-95): 16:50:18  No nodes selected!
2022-03-02 16:50:18.082905 (Thread-95): sending response (<Response 1986 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:18.773112 (Thread-96): handling status request
2022-03-02 16:50:18.773494 (Thread-96): 16:50:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea810c310>]}
2022-03-02 16:50:18.774023 (Thread-96): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:18.781158 (Thread-97): handling list request
2022-03-02 16:50:18.781480 (Thread-97): 16:50:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea810c8e0>]}
2022-03-02 16:50:18.814141 (Thread-97): 16:50:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea810cca0>]}
2022-03-02 16:50:18.814534 (Thread-97): 16:50:18  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:18.818201 (Thread-97): sending response (<Response 5399 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:19.293340 (Thread-98): handling status request
2022-03-02 16:50:19.293718 (Thread-98): 16:50:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea811edf0>]}
2022-03-02 16:50:19.294280 (Thread-98): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:19.301403 (Thread-99): handling list request
2022-03-02 16:50:19.301707 (Thread-99): 16:50:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea811ed30>]}
2022-03-02 16:50:19.339757 (Thread-99): 16:50:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea810d820>]}
2022-03-02 16:50:19.340144 (Thread-99): 16:50:19  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:19.348251 (Thread-99): sending response (<Response 23529 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:23.625439 (Thread-100): handling status request
2022-03-02 16:50:23.625878 (Thread-100): 16:50:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea811e790>]}
2022-03-02 16:50:23.626429 (Thread-100): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:23.641675 (Thread-101): handling list request
2022-03-02 16:50:23.642016 (Thread-101): 16:50:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea811f790>]}
2022-03-02 16:50:23.728278 (Thread-101): 16:50:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8108bb0>]}
2022-03-02 16:50:23.728677 (Thread-101): 16:50:23  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:23.734502 (Thread-101): sending response (<Response 5516 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:26.257275 (Thread-102): handling status request
2022-03-02 16:50:26.257652 (Thread-102): 16:50:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea81098b0>]}
2022-03-02 16:50:26.258174 (Thread-102): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:26.264959 (Thread-103): handling list request
2022-03-02 16:50:26.265230 (Thread-103): 16:50:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80d6fa0>]}
2022-03-02 16:50:26.305660 (Thread-103): 16:50:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8109ca0>]}
2022-03-02 16:50:26.330334 (Thread-103): 16:50:26  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:26.337827 (Thread-103): sending response (<Response 16921 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:28.898129 (Thread-104): handling status request
2022-03-02 16:50:28.898517 (Thread-104): 16:50:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8116ee0>]}
2022-03-02 16:50:28.899031 (Thread-104): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:28.905501 (Thread-105): handling list request
2022-03-02 16:50:28.905835 (Thread-105): 16:50:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8116280>]}
2022-03-02 16:50:28.945848 (Thread-105): 16:50:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea81098b0>]}
2022-03-02 16:50:28.946260 (Thread-105): 16:50:28  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:28.950450 (Thread-105): 16:50:28  The selection criterion '+dbt_packages/dbtvault/macros/tables/eff_sat.sql+' does not match any nodes
2022-03-02 16:50:28.950657 (Thread-105): 16:50:28  No nodes selected!
2022-03-02 16:50:28.952315 (Thread-105): sending response (<Response 1961 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:33.238082 (Thread-106): handling status request
2022-03-02 16:50:33.238497 (Thread-106): 16:50:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80cd310>]}
2022-03-02 16:50:33.239013 (Thread-106): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:33.244971 (Thread-107): handling list request
2022-03-02 16:50:33.245264 (Thread-107): 16:50:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80d6e20>]}
2022-03-02 16:50:33.281570 (Thread-107): 16:50:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80cd250>]}
2022-03-02 16:50:33.282066 (Thread-107): 16:50:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:33.283780 (Thread-107): 16:50:33  The selection criterion '+dbt_packages/dbtvault/macros/tables/eff_sat.sql+' does not match any nodes
2022-03-02 16:50:33.283986 (Thread-107): 16:50:33  No nodes selected!
2022-03-02 16:50:33.285392 (Thread-107): sending response (<Response 1961 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:38.543270 (Thread-108): handling status request
2022-03-02 16:50:38.543664 (Thread-108): 16:50:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901ae1c0>]}
2022-03-02 16:50:38.544194 (Thread-108): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:38.550789 (Thread-109): handling list request
2022-03-02 16:50:38.551116 (Thread-109): 16:50:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe901aea90>]}
2022-03-02 16:50:38.581229 (Thread-110): handling status request
2022-03-02 16:50:38.581504 (Thread-110): 16:50:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70712880>]}
2022-03-02 16:50:38.582056 (Thread-110): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:38.590029 (Thread-111): handling list request
2022-03-02 16:50:38.585898 (Thread-109): 16:50:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70743d00>]}
2022-03-02 16:50:38.590577 (Thread-111): 16:50:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70717100>]}
2022-03-02 16:50:38.586333 (Thread-109): 16:50:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:38.587906 (Thread-109): 16:50:38  The selection criterion '+dbt_packages/dbtvault/macros/tables/eff_sat.sql+' does not match any nodes
2022-03-02 16:50:38.588096 (Thread-109): 16:50:38  No nodes selected!
2022-03-02 16:50:38.593579 (Thread-109): sending response (<Response 2921 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:50:38.632882 (Thread-111): 16:50:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea80a7dc0>]}
2022-03-02 16:50:38.633305 (Thread-111): 16:50:38  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:50:38.635706 (Thread-111): 16:50:38  The selection criterion '+dbt_packages/dbtvault/macros/tables/sat.sql+' does not match any nodes
2022-03-02 16:50:38.635914 (Thread-111): 16:50:38  No nodes selected!
2022-03-02 16:50:38.637924 (Thread-111): sending response (<Response 2739 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:51:13.898000 (Thread-112): handling status request
2022-03-02 16:51:13.898397 (Thread-112): 16:51:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe707744f0>]}
2022-03-02 16:51:13.898886 (Thread-112): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:51:13.905917 (Thread-113): handling list request
2022-03-02 16:51:13.906204 (Thread-113): 16:51:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe707749a0>]}
2022-03-02 16:51:13.944080 (Thread-113): 16:51:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea811f880>]}
2022-03-02 16:51:13.944497 (Thread-113): 16:51:13  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:51:13.948131 (Thread-113): sending response (<Response 5516 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:52:10.205081 (Thread-114): handling status request
2022-03-02 16:52:10.205487 (Thread-114): 16:52:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70704070>]}
2022-03-02 16:52:10.206023 (Thread-114): sending response (<Response 1846 bytes [200 OK]>) to 10.0.21.58
2022-03-02 16:52:10.219328 (Thread-115): handling list request
2022-03-02 16:52:10.219667 (Thread-115): 16:52:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70704910>]}
2022-03-02 16:52:10.265961 (Thread-115): 16:52:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f55ea96-ec27-4fde-8bf4-b4602528ad01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70704190>]}
2022-03-02 16:52:10.266323 (Thread-115): 16:52:10  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-02 16:52:10.278009 (Thread-115): sending response (<Response 23531 bytes [200 OK]>) to 10.0.21.58
2022-03-03 15:44:50.622648 (MainThread): Running with dbt=1.0.3
2022-03-03 15:44:50.840265 (MainThread): 15:44:50  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-03 15:44:50.840519 (MainThread): 15:44:50  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc116340>]}
2022-03-03 15:44:50.840792 (MainThread): 15:44:50  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-03-03 15:44:50.840952 (MainThread): 15:44:50  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc126cd0>]}
2022-03-03 15:44:50.869222 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-03 15:44:50.873378 (MainThread): Tracking: tracking
2022-03-03 15:44:50.875002 (MainThread): 15:44:50  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5210f235e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc16abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc18a520>]}
2022-03-03 15:44:50.879334 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-03-03 15:44:50.879622 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-03 15:44:50.879800 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-03 15:44:51.833876 (Thread-12): 15:44:51  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 15:44:51.834134 (Thread-12): 15:44:51  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 15:44:51.842270 (Thread-12): 15:44:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d1e14b50>]}
2022-03-03 15:59:38.353063 (Thread-13): handling status request
2022-03-03 15:59:38.353480 (Thread-13): 15:59:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc1a3370>]}
2022-03-03 15:59:38.354125 (Thread-13): sending response (<Response 1241 bytes [200 OK]>) to 10.0.14.238
2022-03-03 15:59:38.479209 (Thread-14): handling status request
2022-03-03 15:59:38.479575 (Thread-14): 15:59:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc18a9d0>]}
2022-03-03 15:59:38.480027 (Thread-14): sending response (<Response 1241 bytes [200 OK]>) to 10.0.14.238
2022-03-03 15:59:38.554020 (Thread-15): handling ps request
2022-03-03 15:59:38.554398 (Thread-15): 15:59:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811d220>]}
2022-03-03 15:59:38.554852 (Thread-15): sending response (<Response 105 bytes [200 OK]>) to 10.0.14.238
2022-03-03 15:59:38.591721 (Thread-16): handling status request
2022-03-03 15:59:38.592010 (Thread-16): 15:59:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811d0a0>]}
2022-03-03 15:59:38.592427 (Thread-16): sending response (<Response 1241 bytes [200 OK]>) to 10.0.14.238
2022-03-03 15:59:40.199174 (Thread-17): handling status request
2022-03-03 15:59:40.199534 (Thread-17): 15:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811dc70>]}
2022-03-03 15:59:40.200103 (Thread-17): sending response (<Response 1241 bytes [200 OK]>) to 10.0.14.238
2022-03-03 15:59:44.504491 (Thread-18): handling status request
2022-03-03 15:59:44.504916 (Thread-18): 15:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d8072580>]}
2022-03-03 15:59:44.505376 (Thread-18): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 15:59:44.510441 (Thread-19): handling list request
2022-03-03 15:59:44.510688 (Thread-19): 15:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d80723a0>]}
2022-03-03 15:59:44.563294 (Thread-19): 15:59:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc18a9d0>]}
2022-03-03 15:59:44.563646 (Thread-19): 15:59:44  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 15:59:44.569703 (Thread-19): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:39.585323 (Thread-20): handling status request
2022-03-03 16:00:39.587081 (Thread-20): 16:00:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811dfa0>]}
2022-03-03 16:00:39.587629 (Thread-20): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:39.593572 (Thread-21): handling list request
2022-03-03 16:00:39.593834 (Thread-21): 16:00:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc1383a0>]}
2022-03-03 16:00:39.626018 (Thread-21): 16:00:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811daf0>]}
2022-03-03 16:00:39.626375 (Thread-21): 16:00:39  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:00:39.635479 (Thread-21): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:42.994019 (Thread-22): handling status request
2022-03-03 16:00:42.994394 (Thread-22): 16:00:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d1e1e190>]}
2022-03-03 16:00:42.994858 (Thread-22): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:43.002866 (Thread-23): handling list request
2022-03-03 16:00:43.003119 (Thread-23): 16:00:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d1e1ec40>]}
2022-03-03 16:00:43.047142 (Thread-23): 16:00:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc1380a0>]}
2022-03-03 16:00:43.047506 (Thread-23): 16:00:43  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:00:43.056123 (Thread-23): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:43.670188 (Thread-24): handling status request
2022-03-03 16:00:43.670568 (Thread-24): 16:00:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f67f0>]}
2022-03-03 16:00:43.671043 (Thread-24): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:43.676334 (Thread-25): handling list request
2022-03-03 16:00:43.676598 (Thread-25): 16:00:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f6af0>]}
2022-03-03 16:00:43.713551 (Thread-25): 16:00:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07e3790>]}
2022-03-03 16:00:43.713915 (Thread-25): 16:00:43  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:00:43.719668 (Thread-25): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:59.656547 (Thread-26): handling status request
2022-03-03 16:00:59.659132 (Thread-26): 16:00:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07b8e50>]}
2022-03-03 16:00:59.659620 (Thread-26): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:00:59.665820 (Thread-27): handling list request
2022-03-03 16:00:59.666148 (Thread-27): 16:00:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d070c5b0>]}
2022-03-03 16:00:59.699475 (Thread-27): 16:00:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f67c0>]}
2022-03-03 16:00:59.699869 (Thread-27): 16:00:59  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:00:59.702826 (Thread-27): sending response (<Response 2210 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:01:00.053621 (Thread-28): handling status request
2022-03-03 16:01:00.054004 (Thread-28): 16:01:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f91c0>]}
2022-03-03 16:01:00.054490 (Thread-28): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:01:00.059496 (Thread-29): handling list request
2022-03-03 16:01:00.059766 (Thread-29): 16:01:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f9310>]}
2022-03-03 16:01:00.095326 (Thread-29): 16:01:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d070c3a0>]}
2022-03-03 16:01:00.095897 (Thread-29): 16:01:00  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:01:00.101620 (Thread-29): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:01:00.441163 (Thread-30): handling status request
2022-03-03 16:01:00.441554 (Thread-30): 16:01:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d078b0d0>]}
2022-03-03 16:01:00.442039 (Thread-30): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:01:00.447226 (Thread-31): handling list request
2022-03-03 16:01:00.447504 (Thread-31): 16:01:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0717070>]}
2022-03-03 16:01:00.486370 (Thread-31): 16:01:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f90a0>]}
2022-03-03 16:01:00.513044 (Thread-31): 16:01:00  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:01:00.515943 (Thread-31): sending response (<Response 2210 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:01:10.088238 (Thread-32): handling status request
2022-03-03 16:01:10.088626 (Thread-32): 16:01:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d073c100>]}
2022-03-03 16:01:10.089148 (Thread-32): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:01:10.094698 (Thread-33): handling list request
2022-03-03 16:01:10.094954 (Thread-33): 16:01:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d073cee0>]}
2022-03-03 16:01:10.127921 (Thread-33): 16:01:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0717c70>]}
2022-03-03 16:01:10.128258 (Thread-33): 16:01:10  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:01:10.134096 (Thread-33): sending response (<Response 14588 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:08:45.047540 (Thread-34): handling status request
2022-03-03 16:08:45.049434 (Thread-34): 16:08:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06c4a90>]}
2022-03-03 16:08:45.049959 (Thread-34): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:08:45.059742 (Thread-35): handling list request
2022-03-03 16:08:45.060032 (Thread-35): 16:08:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f9be0>]}
2022-03-03 16:08:45.098066 (Thread-35): 16:08:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d072b280>]}
2022-03-03 16:08:45.098437 (Thread-35): 16:08:45  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:08:45.109212 (Thread-35): sending response (<Response 14588 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:03.961228 (Thread-36): handling status request
2022-03-03 16:10:03.961612 (Thread-36): 16:10:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d072b7c0>]}
2022-03-03 16:10:03.962089 (Thread-36): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:03.972868 (Thread-37): handling list request
2022-03-03 16:10:03.973183 (Thread-37): 16:10:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811d3d0>]}
2022-03-03 16:10:04.008192 (Thread-37): 16:10:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f9be0>]}
2022-03-03 16:10:04.009479 (Thread-37): 16:10:04  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:10:04.014245 (Thread-37): sending response (<Response 14588 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:05.867931 (Thread-38): handling ps request
2022-03-03 16:10:05.868308 (Thread-38): 16:10:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06c4fd0>]}
2022-03-03 16:10:05.869071 (Thread-38): sending response (<Response 3013 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:05.980105 (Thread-39): handling status request
2022-03-03 16:10:05.980481 (Thread-39): 16:10:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06fd340>]}
2022-03-03 16:10:05.980992 (Thread-39): sending response (<Response 1241 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.208449 (Thread-40): handling status request
2022-03-03 16:10:12.208916 (Thread-40): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06fd580>]}
2022-03-03 16:10:12.209408 (Thread-40): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.215480 (Thread-41): handling list request
2022-03-03 16:10:12.215807 (Thread-41): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06fd7f0>]}
2022-03-03 16:10:12.249433 (Thread-41): 16:10:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06fd190>]}
2022-03-03 16:10:12.249792 (Thread-41): 16:10:12  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:10:12.251526 (Thread-41): 16:10:12  The selection criterion '+dbt_packages/dbtvault/macros/materialisations/incremental_bridge_helpers.sql+' does not match any nodes
2022-03-03 16:10:12.251696 (Thread-41): 16:10:12  No nodes selected!
2022-03-03 16:10:12.253344 (Thread-41): sending response (<Response 1990 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.519098 (Thread-42): handling status request
2022-03-03 16:10:12.519682 (Thread-42): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06c4fa0>]}
2022-03-03 16:10:12.520365 (Thread-42): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.521002 (Thread-43): handling status request
2022-03-03 16:10:12.521777 (Thread-43): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06f7fa0>]}
2022-03-03 16:10:12.522228 (Thread-43): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.523351 (Thread-44): handling status request
2022-03-03 16:10:12.523692 (Thread-44): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d069f100>]}
2022-03-03 16:10:12.524155 (Thread-44): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.525179 (Thread-45): handling status request
2022-03-03 16:10:12.525485 (Thread-45): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d811d250>]}
2022-03-03 16:10:12.525868 (Thread-45): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.527687 (Thread-46): handling list request
2022-03-03 16:10:12.528049 (Thread-46): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06f7dc0>]}
2022-03-03 16:10:12.607255 (Thread-49): sending response (<Response 214 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.681682 (Thread-50): handling status request
2022-03-03 16:10:12.682063 (Thread-50): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d06a9e50>]}
2022-03-03 16:10:12.682532 (Thread-50): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.686614 (Thread-51): handling status request
2022-03-03 16:10:12.686957 (Thread-51): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d069fd90>]}
2022-03-03 16:10:12.687418 (Thread-51): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.688304 (Thread-52): handling list request
2022-03-03 16:10:12.688669 (Thread-52): 16:10:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0674220>]}
2022-03-03 16:10:12.770444 (Thread-53): sending response (<Response 214 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:12.764203 (Thread-55): 16:10:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d067fc70>]}
2022-03-03 16:10:12.764540 (Thread-55): 16:10:12  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:10:12.765243 (Thread-53): 16:10:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d067f670>]}
2022-03-03 16:10:12.765510 (Thread-53): 16:10:12  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:10:12.767360 (Thread-55): 16:10:12  The selection criterion '+dbt_packages/dbtvault/macros/tables/sat.sql+' does not match any nodes
2022-03-03 16:10:12.767519 (Thread-55): 16:10:12  No nodes selected!
2022-03-03 16:10:12.773163 (Thread-55): sending response (<Response 2978 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:57.991953 (Thread-56): handling status request
2022-03-03 16:10:57.992325 (Thread-56): 16:10:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d067e430>]}
2022-03-03 16:10:57.992841 (Thread-56): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:10:58.001611 (Thread-57): handling list request
2022-03-03 16:10:58.002003 (Thread-57): 16:10:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0640cd0>]}
2022-03-03 16:10:58.041513 (Thread-57): 16:10:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d069ffd0>]}
2022-03-03 16:10:58.041834 (Thread-57): 16:10:58  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:10:58.046946 (Thread-57): sending response (<Response 14588 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:15:25.606017 (Thread-58): handling status request
2022-03-03 16:15:25.607742 (Thread-58): 16:15:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05c3790>]}
2022-03-03 16:15:25.608240 (Thread-58): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:15:25.619600 (Thread-59): handling list request
2022-03-03 16:15:25.619872 (Thread-59): 16:15:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05c39d0>]}
2022-03-03 16:15:25.653685 (Thread-59): 16:15:25  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0640cd0>]}
2022-03-03 16:15:25.653985 (Thread-59): 16:15:25  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:15:25.664520 (Thread-59): sending response (<Response 14588 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:15.210949 (Thread-60): handling status request
2022-03-03 16:27:15.212626 (Thread-60): 16:27:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0650be0>]}
2022-03-03 16:27:15.213276 (Thread-60): sending response (<Response 1219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:15.224268 (Thread-61): handling list request
2022-03-03 16:27:15.224544 (Thread-61): 16:27:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0650fd0>]}
2022-03-03 16:27:15.271088 (Thread-61): 16:27:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05c3730>]}
2022-03-03 16:27:15.271639 (Thread-61): 16:27:15  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:27:15.282625 (Thread-61): sending response (<Response 14588 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:24.650615 (Thread-62): 16:27:24  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:27:24.653425 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.LINEITEM
2022-03-03 16:27:24.653775 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.CUSTOMER
2022-03-03 16:27:24.653893 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.ORDERS
2022-03-03 16:27:24.653995 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.PARTSUPP
2022-03-03 16:27:24.654093 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.SUPPLIER
2022-03-03 16:27:24.654189 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.PART
2022-03-03 16:27:24.654281 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.NATION
2022-03-03 16:27:24.654373 (Thread-62): 16:27:24  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.REGION
2022-03-03 16:27:24.654500 (Thread-62): 16:27:24  Partial parsing: update schema file: dbtvault_snowflake_demo://models/schema.yml
2022-03-03 16:27:24.666650 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:27:24.752707 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:27:24.754381 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:27:24.763284 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:27:24.764554 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:27:24.772852 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:27:24.774064 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:27:24.782160 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:27:24.783334 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:27:24.809020 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:27:24.810281 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:27:24.820110 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:27:24.821327 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:27:24.828602 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:27:24.829864 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:27:24.864179 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:27:24.865533 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:27:24.876614 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:27:24.877878 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:27:24.887852 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:27:24.889340 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:27:24.898293 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:27:24.899659 (Thread-62): 16:27:24  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:27:24.909503 (Thread-62): 16:27:24  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:27:24.910675 (Thread-62): 16:27:24  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:27:25.137861 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:27:25.140657 (Thread-62): 16:27:25  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:27:25.143145 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:27:25.150235 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:27:25.151447 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:27:25.158052 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:27:25.159320 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:27:25.165697 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:27:25.166878 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:27:25.174832 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:27:25.175994 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:27:25.182883 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:27:25.184052 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:27:25.191425 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:27:25.192586 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:27:25.199223 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:27:25.200398 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:27:25.211032 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:27:25.212581 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:27:25.221701 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:27:25.222961 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:27:25.234383 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:27:25.235589 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:27:25.247831 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:27:25.249130 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:27:25.260872 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:27:25.262106 (Thread-62): 16:27:25  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:27:25.292364 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:27:25.294198 (Thread-62): 16:27:25  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:27:25.301500 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:27:25.302775 (Thread-62): 16:27:25  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:27:25.320254 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:27:25.321525 (Thread-62): 16:27:25  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:27:25.331711 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:27:25.333050 (Thread-62): 16:27:25  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:27:25.338775 (Thread-62): 16:27:25  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:27:25.442724 (Thread-62): 16:27:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d032b970>]}
2022-03-03 16:27:25.603378 (Thread-63): handling status request
2022-03-03 16:27:25.603801 (Thread-63): 16:27:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d047a640>]}
2022-03-03 16:27:25.604907 (Thread-63): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:25.855129 (Thread-64): handling status request
2022-03-03 16:27:25.855498 (Thread-64): 16:27:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d047a310>]}
2022-03-03 16:27:25.856579 (Thread-64): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:28.143920 (Thread-65): handling status request
2022-03-03 16:27:28.144302 (Thread-65): 16:27:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02bc8e0>]}
2022-03-03 16:27:28.145449 (Thread-65): sending response (<Response 23004 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:28.152070 (Thread-66): handling list request
2022-03-03 16:27:28.152362 (Thread-66): 16:27:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02bcd90>]}
2022-03-03 16:27:28.183677 (Thread-66): 16:27:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0650e50>]}
2022-03-03 16:27:28.184029 (Thread-66): 16:27:28  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:27:28.189362 (Thread-66): sending response (<Response 16921 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:33.524791 (Thread-67): handling status request
2022-03-03 16:27:33.525172 (Thread-67): 16:27:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d047aa30>]}
2022-03-03 16:27:33.526247 (Thread-67): sending response (<Response 23004 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:33.536367 (Thread-68): handling list request
2022-03-03 16:27:33.536657 (Thread-68): 16:27:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05bd550>]}
2022-03-03 16:27:33.568013 (Thread-68): 16:27:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02bcd90>]}
2022-03-03 16:27:33.568332 (Thread-68): 16:27:33  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:27:33.574064 (Thread-68): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:36.804158 (Thread-69): handling status request
2022-03-03 16:27:36.804537 (Thread-69): 16:27:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05b3b20>]}
2022-03-03 16:27:36.805619 (Thread-69): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:37.109076 (Thread-70): handling status request
2022-03-03 16:27:37.109534 (Thread-70): 16:27:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05b3370>]}
2022-03-03 16:27:37.110511 (Thread-70): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:37.248692 (Thread-71): handling cli_args request
2022-03-03 16:27:37.249080 (Thread-71): 16:27:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05b38e0>]}
2022-03-03 16:27:37.260820 (Thread-71): sending response (<Response 575 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:39.684804 (Thread-72): handling status request
2022-03-03 16:27:39.685190 (Thread-72): 16:27:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05a8430>]}
2022-03-03 16:27:39.686218 (Thread-72): sending response (<Response 23004 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:39.692433 (Thread-73): handling list request
2022-03-03 16:27:39.692741 (Thread-73): 16:27:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05a8c40>]}
2022-03-03 16:27:39.722213 (Thread-73): 16:27:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05a8820>]}
2022-03-03 16:27:39.722590 (Thread-73): 16:27:39  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:27:39.728697 (Thread-73): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:40.154291 (Thread-74): handling status request
2022-03-03 16:27:40.154678 (Thread-74): 16:27:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05a8640>]}
2022-03-03 16:27:40.176953 (Thread-74): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:40.448414 (Thread-75): handling status request
2022-03-03 16:27:40.448824 (Thread-75): 16:27:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05bb880>]}
2022-03-03 16:27:40.449825 (Thread-75): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:47.413610 (Thread-76): handling status request
2022-03-03 16:27:47.413994 (Thread-76): 16:27:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05bb340>]}
2022-03-03 16:27:47.415001 (Thread-76): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:48.181856 (Thread-77): handling cli_args request
2022-03-03 16:27:48.182471 (Thread-77): 16:27:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d032b130>]}
2022-03-03 16:27:48.182980 (Thread-78): handling status request
2022-03-03 16:27:48.184261 (Thread-78): 16:27:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d006fe80>]}
2022-03-03 16:27:48.185751 (Thread-78): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:50.463593 (Thread-77): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:50.869443 (MainThread): 16:27:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:27:50.869885 (MainThread): 16:27:50  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:27:50.877849 (MainThread): 16:27:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd269218e20>]}
2022-03-03 16:27:50.913118 (MainThread): 16:27:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26932a5e0>]}
2022-03-03 16:27:50.913431 (MainThread): 16:27:50  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:27:50.915740 (MainThread): 16:27:50  
2022-03-03 16:27:50.916074 (MainThread): 16:27:50  Acquiring new snowflake connection "master"
2022-03-03 16:27:50.918175 (ThreadPoolExecutor-0_0): 16:27:50  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:27:50.931580 (ThreadPoolExecutor-0_0): 16:27:50  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:27:50.931692 (ThreadPoolExecutor-0_0): 16:27:50  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:27:50.931777 (ThreadPoolExecutor-0_0): 16:27:50  Opening a new connection, currently in state init
2022-03-03 16:27:51.337021 (Thread-79): handling poll request
2022-03-03 16:27:51.337502 (Thread-79): 16:27:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41d8730>]}
2022-03-03 16:27:51.338479 (Thread-79): sending response (<Response 4125 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:52.005847 (ThreadPoolExecutor-0_0): 16:27:52  SQL status: SUCCESS 8 in 1.07 seconds
2022-03-03 16:27:52.007953 (ThreadPoolExecutor-0_0): 16:27:52  On list_DBT_RAW: Close
2022-03-03 16:27:52.290282 (ThreadPoolExecutor-2_0): 16:27:52  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:27:52.358678 (ThreadPoolExecutor-2_0): 16:27:52  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:27:52.358840 (ThreadPoolExecutor-2_0): 16:27:52  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:27:52.358936 (ThreadPoolExecutor-2_0): 16:27:52  Opening a new connection, currently in state closed
2022-03-03 16:27:53.199464 (Thread-80): handling poll request
2022-03-03 16:27:53.199882 (Thread-80): 16:27:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05a8640>]}
2022-03-03 16:27:53.200437 (Thread-80): sending response (<Response 2282 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:53.415409 (ThreadPoolExecutor-2_0): 16:27:53  SQL status: SUCCESS 31 in 1.06 seconds
2022-03-03 16:27:53.417706 (ThreadPoolExecutor-2_0): 16:27:53  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:27:53.878632 (MainThread): 16:27:53  Concurrency: 4 threads (target='default')
2022-03-03 16:27:53.878810 (MainThread): 16:27:53  
2022-03-03 16:27:53.881806 (Thread-3): 16:27:53  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:27:53.882121 (Thread-3): 16:27:53  1 of 31 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-03 16:27:53.882428 (Thread-3): 16:27:53  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:27:53.882541 (Thread-3): 16:27:53  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:27:53.882657 (Thread-3): 16:27:53  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:27:53.887051 (Thread-4): 16:27:53  Began running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:27:53.887303 (Thread-4): 16:27:53  2 of 31 START table model DBT_VAULT.raw_transactions............................ [RUN]
2022-03-03 16:27:53.887568 (Thread-4): 16:27:53  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:27:53.887656 (Thread-4): 16:27:53  Began compiling node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:27:53.887739 (Thread-4): 16:27:53  Compiling model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:27:53.891192 (Thread-4): 16:27:53  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:27:53.893244 (Thread-3): 16:27:53  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:27:53.905024 (Thread-4): 16:27:53  finished collecting timing info
2022-03-03 16:27:53.905200 (Thread-4): 16:27:53  Began executing node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:27:53.910483 (Thread-3): 16:27:53  finished collecting timing info
2022-03-03 16:27:53.910710 (Thread-3): 16:27:53  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:27:53.958875 (Thread-4): 16:27:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:27:53.964429 (Thread-3): 16:27:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:27:53.976871 (Thread-4): 16:27:53  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:27:53.977046 (Thread-4): 16:27:53  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_transactions  as
      (SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM DBT_RAW.TPCH_SF10.ORDERS  AS b
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:27:53.977144 (Thread-4): 16:27:53  Opening a new connection, currently in state init
2022-03-03 16:27:53.982476 (Thread-3): 16:27:53  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:27:53.982608 (Thread-3): 16:27:53  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM DBT_RAW.TPCH_SF10.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:27:53.982696 (Thread-3): 16:27:53  Opening a new connection, currently in state closed
2022-03-03 16:27:54.983683 (Thread-81): handling poll request
2022-03-03 16:27:54.984073 (Thread-81): 16:27:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d006fd00>]}
2022-03-03 16:27:54.984979 (Thread-81): sending response (<Response 14962 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:56.805678 (Thread-82): handling poll request
2022-03-03 16:27:56.806092 (Thread-82): 16:27:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d030d430>]}
2022-03-03 16:27:56.806603 (Thread-82): sending response (<Response 291 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:58.645489 (Thread-83): handling poll request
2022-03-03 16:27:58.645863 (Thread-83): 16:27:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02f2df0>]}
2022-03-03 16:27:58.646397 (Thread-83): sending response (<Response 292 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:27:59.643074 (Thread-4): 16:27:59  SQL status: SUCCESS 1 in 5.67 seconds
2022-03-03 16:27:59.652812 (Thread-4): 16:27:59  finished collecting timing info
2022-03-03 16:27:59.653000 (Thread-4): 16:27:59  On model.dbtvault_snowflake_demo.raw_transactions: Close
2022-03-03 16:27:59.980856 (Thread-4): 16:27:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25aec15e0>]}
2022-03-03 16:27:59.981300 (Thread-4): 16:27:59  2 of 31 OK created table model DBT_VAULT.raw_transactions....................... [SUCCESS 1 in 6.09s]
2022-03-03 16:27:59.981430 (Thread-4): 16:27:59  Finished running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:27:59.982230 (Thread-6): 16:27:59  Began running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:27:59.982504 (Thread-6): 16:27:59  3 of 31 START table model DBT_VAULT.v_stg_transactions.......................... [RUN]
2022-03-03 16:27:59.982788 (Thread-6): 16:27:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:27:59.982882 (Thread-6): 16:27:59  Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:27:59.982972 (Thread-6): 16:27:59  Compiling model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:00.017194 (Thread-6): 16:28:00  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:00.017351 (Thread-6): 16:28:00  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-03 16:28:00.017446 (Thread-6): 16:28:00  Opening a new connection, currently in state init
2022-03-03 16:28:00.499581 (Thread-84): handling poll request
2022-03-03 16:28:00.499950 (Thread-84): 16:28:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0313be0>]}
2022-03-03 16:28:00.500594 (Thread-84): sending response (<Response 6442 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:00.891907 (Thread-6): 16:28:00  SQL status: SUCCESS 7 in 0.87 seconds
2022-03-03 16:28:00.921468 (Thread-6): 16:28:00  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:00.921648 (Thread-6): 16:28:00  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-03 16:28:01.208810 (Thread-6): 16:28:01  SQL status: SUCCESS 7 in 0.29 seconds
2022-03-03 16:28:01.242518 (Thread-6): 16:28:01  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:01.256114 (Thread-6): 16:28:01  finished collecting timing info
2022-03-03 16:28:01.256306 (Thread-6): 16:28:01  Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:01.258884 (Thread-6): 16:28:01  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:01.274469 (Thread-6): 16:28:01  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:01.274607 (Thread-6): 16:28:01  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_transactions  as
      (







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM DBT_RAW.DBT_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
      );
2022-03-03 16:28:03.306772 (Thread-85): handling poll request
2022-03-03 16:28:03.307155 (Thread-85): 16:28:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0582d00>]}
2022-03-03 16:28:03.307757 (Thread-85): sending response (<Response 6258 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:03.522321 (Thread-6): 16:28:03  SQL status: SUCCESS 1 in 2.25 seconds
2022-03-03 16:28:03.523805 (Thread-6): 16:28:03  finished collecting timing info
2022-03-03 16:28:03.523976 (Thread-6): 16:28:03  On model.dbtvault_snowflake_demo.v_stg_transactions: Close
2022-03-03 16:28:03.781859 (Thread-6): 16:28:03  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25aea25b0>]}
2022-03-03 16:28:03.782313 (Thread-6): 16:28:03  3 of 31 OK created table model DBT_VAULT.v_stg_transactions..................... [SUCCESS 1 in 3.80s]
2022-03-03 16:28:03.782467 (Thread-6): 16:28:03  Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:03.783278 (Thread-4): 16:28:03  Began running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:03.783539 (Thread-4): 16:28:03  4 of 31 START incremental model DBT_VAULT.t_link_transactions................... [RUN]
2022-03-03 16:28:03.783813 (Thread-4): 16:28:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:03.783959 (Thread-4): 16:28:03  Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:03.784057 (Thread-4): 16:28:03  Compiling model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:03.852222 (Thread-4): 16:28:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:03.865712 (Thread-4): 16:28:03  finished collecting timing info
2022-03-03 16:28:03.865940 (Thread-4): 16:28:03  Began executing node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:03.893695 (Thread-4): 16:28:03  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:03.893864 (Thread-4): 16:28:03  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN DBT_RAW.DBT_VAULT.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:03.893961 (Thread-4): 16:28:03  Opening a new connection, currently in state closed
2022-03-03 16:28:03.949589 (Thread-3): 16:28:03  SQL status: SUCCESS 1 in 9.97 seconds
2022-03-03 16:28:03.951471 (Thread-3): 16:28:03  finished collecting timing info
2022-03-03 16:28:03.951651 (Thread-3): 16:28:03  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:28:04.242275 (Thread-3): 16:28:04  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25aed7040>]}
2022-03-03 16:28:04.242684 (Thread-3): 16:28:04  1 of 31 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 10.36s]
2022-03-03 16:28:04.242964 (Thread-3): 16:28:04  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:28:04.243920 (Thread-6): 16:28:04  Began running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:04.244229 (Thread-6): 16:28:04  5 of 31 START table model DBT_VAULT.raw_inventory............................... [RUN]
2022-03-03 16:28:04.244501 (Thread-6): 16:28:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:04.244614 (Thread-6): 16:28:04  Began compiling node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:04.244760 (Thread-6): 16:28:04  Compiling model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:04.249423 (Thread-6): 16:28:04  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:04.250100 (Thread-5): 16:28:04  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:04.250333 (Thread-5): 16:28:04  6 of 31 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-03 16:28:04.250603 (Thread-5): 16:28:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:04.250691 (Thread-5): 16:28:04  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:04.250774 (Thread-5): 16:28:04  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:04.264526 (Thread-5): 16:28:04  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:04.264674 (Thread-5): 16:28:04  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:28:04.264773 (Thread-5): 16:28:04  Opening a new connection, currently in state init
2022-03-03 16:28:04.275035 (Thread-6): 16:28:04  finished collecting timing info
2022-03-03 16:28:04.275196 (Thread-6): 16:28:04  Began executing node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:04.277654 (Thread-6): 16:28:04  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:04.299215 (Thread-6): 16:28:04  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:04.299348 (Thread-6): 16:28:04  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_inventory  as
      (SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF10.PARTSUPP AS a
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DBT_RAW.DBT_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
      );
2022-03-03 16:28:04.299438 (Thread-6): 16:28:04  Opening a new connection, currently in state closed
2022-03-03 16:28:05.244545 (Thread-86): handling poll request
2022-03-03 16:28:05.244963 (Thread-86): 16:28:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d05aa1f0>]}
2022-03-03 16:28:05.245954 (Thread-86): sending response (<Response 21336 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:05.428469 (Thread-5): 16:28:05  SQL status: SUCCESS 37 in 1.16 seconds
2022-03-03 16:28:05.435716 (Thread-5): 16:28:05  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:05.435853 (Thread-5): 16:28:05  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:28:05.657978 (Thread-5): 16:28:05  SQL status: SUCCESS 37 in 0.22 seconds
2022-03-03 16:28:05.680110 (Thread-5): 16:28:05  [DBT_RAW.DBT_VAULT.v_stg_orders] Warning: You provided a list of columns under a 'columns' key, but did not provide the 'is_hashdiff' flag. Use list syntax for PKs.
2022-03-03 16:28:05.681233 (Thread-5): 16:28:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:05.710914 (Thread-5): 16:28:05  finished collecting timing info
2022-03-03 16:28:05.711138 (Thread-5): 16:28:05  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:05.713972 (Thread-5): 16:28:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:05.761701 (Thread-5): 16:28:05  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:05.761976 (Thread-5): 16:28:05  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ALL AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS ALL_COLUMNS

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF,
    ALL_COLUMNS

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-03 16:28:05.953119 (Thread-5): 16:28:05  Snowflake adapter: Snowflake query id: 01a2ae9c-0503-b8b2-0000-0ed503a5926e
2022-03-03 16:28:05.953281 (Thread-5): 16:28:05  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 239 at position 38 unexpected 'ALL'.
2022-03-03 16:28:05.953441 (Thread-5): 16:28:05  finished collecting timing info
2022-03-03 16:28:05.953579 (Thread-5): 16:28:05  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:28:06.343393 (Thread-5): 16:28:06  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 239 at position 38 unexpected 'ALL'.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:28:06.343857 (Thread-5): 16:28:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258691490>]}
2022-03-03 16:28:06.344231 (Thread-5): 16:28:06  6 of 31 ERROR creating table model DBT_VAULT.v_stg_orders....................... [ERROR in 2.09s]
2022-03-03 16:28:06.344353 (Thread-5): 16:28:06  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:06.345423 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:28:06.345615 (Thread-3): 16:28:06  7 of 31 SKIP relation DBT_VAULT.hub_customer.................................... [SKIP]
2022-03-03 16:28:06.345740 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:28:06.345869 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:28:06.345980 (Thread-3): 16:28:06  8 of 31 SKIP relation DBT_VAULT.hub_lineitem.................................... [SKIP]
2022-03-03 16:28:06.346067 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:28:06.346175 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:28:06.346293 (Thread-3): 16:28:06  9 of 31 SKIP relation DBT_VAULT.hub_order....................................... [SKIP]
2022-03-03 16:28:06.346383 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:28:06.346486 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:28:06.346581 (Thread-3): 16:28:06  10 of 31 SKIP relation DBT_VAULT.link_customer_nation........................... [SKIP]
2022-03-03 16:28:06.346665 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:28:06.346762 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:28:06.346856 (Thread-3): 16:28:06  11 of 31 SKIP relation DBT_VAULT.link_customer_order............................ [SKIP]
2022-03-03 16:28:06.346938 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:28:06.347032 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:28:06.347124 (Thread-3): 16:28:06  12 of 31 SKIP relation DBT_VAULT.link_inventory_allocation...................... [SKIP]
2022-03-03 16:28:06.347224 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:28:06.347384 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:28:06.347508 (Thread-3): 16:28:06  13 of 31 SKIP relation DBT_VAULT.link_order_lineitem............................ [SKIP]
2022-03-03 16:28:06.347606 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:28:06.347731 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:28:06.347838 (Thread-3): 16:28:06  14 of 31 SKIP relation DBT_VAULT.sat_order_cust_nation_details.................. [SKIP]
2022-03-03 16:28:06.347950 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:28:06.348105 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:28:06.348221 (Thread-3): 16:28:06  15 of 31 SKIP relation DBT_VAULT.sat_order_cust_region_details.................. [SKIP]
2022-03-03 16:28:06.348308 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:28:06.348404 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:28:06.348501 (Thread-3): 16:28:06  16 of 31 SKIP relation DBT_VAULT.sat_order_customer_details..................... [SKIP]
2022-03-03 16:28:06.348584 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:28:06.348712 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:28:06.348810 (Thread-3): 16:28:06  17 of 31 SKIP relation DBT_VAULT.sat_order_lineitem_details..................... [SKIP]
2022-03-03 16:28:06.348900 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:28:06.348993 (Thread-3): 16:28:06  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:28:06.349085 (Thread-3): 16:28:06  18 of 31 SKIP relation DBT_VAULT.sat_order_order_details........................ [SKIP]
2022-03-03 16:28:06.349164 (Thread-3): 16:28:06  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:28:06.792482 (Thread-4): 16:28:06  SQL status: SUCCESS 1 in 2.9 seconds
2022-03-03 16:28:06.796020 (Thread-4): 16:28:06  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:06.796141 (Thread-4): 16:28:06  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
2022-03-03 16:28:07.023271 (Thread-4): 16:28:07  SQL status: SUCCESS 10 in 0.23 seconds
2022-03-03 16:28:07.027491 (Thread-4): 16:28:07  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:07.027609 (Thread-4): 16:28:07  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions
2022-03-03 16:28:07.067459 (Thread-87): handling poll request
2022-03-03 16:28:07.067822 (Thread-87): 16:28:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d030df40>]}
2022-03-03 16:28:07.069147 (Thread-87): sending response (<Response 41374 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:07.180463 (Thread-4): 16:28:07  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 16:28:07.189163 (Thread-4): 16:28:07  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:07.189289 (Thread-4): 16:28:07  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DBT_RAW"."DBT_VAULT"."T_LINK_TRANSACTIONS"
2022-03-03 16:28:07.396607 (Thread-4): 16:28:07  SQL status: SUCCESS 10 in 0.21 seconds
2022-03-03 16:28:07.412144 (Thread-4): 16:28:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:07.425585 (Thread-4): 16:28:07  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:07.425757 (Thread-4): 16:28:07  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
2022-03-03 16:28:07.806761 (Thread-4): 16:28:07  SQL status: SUCCESS 1 in 0.38 seconds
2022-03-03 16:28:07.806982 (Thread-4): 16:28:07  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:07.807068 (Thread-4): 16:28:07  On model.dbtvault_snowflake_demo.t_link_transactions: insert into DBT_RAW.DBT_VAULT.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
        );
2022-03-03 16:28:08.147770 (Thread-4): 16:28:08  SQL status: SUCCESS 0 in 0.34 seconds
2022-03-03 16:28:08.147971 (Thread-4): 16:28:08  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:08.148055 (Thread-4): 16:28:08  On model.dbtvault_snowflake_demo.t_link_transactions: commit;
2022-03-03 16:28:08.760568 (Thread-4): 16:28:08  SQL status: SUCCESS 1 in 0.61 seconds
2022-03-03 16:28:08.762384 (Thread-4): 16:28:08  finished collecting timing info
2022-03-03 16:28:08.762550 (Thread-4): 16:28:08  On model.dbtvault_snowflake_demo.t_link_transactions: Close
2022-03-03 16:28:08.986179 (Thread-88): handling poll request
2022-03-03 16:28:08.986549 (Thread-88): 16:28:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d047aac0>]}
2022-03-03 16:28:08.987285 (Thread-88): sending response (<Response 7190 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:09.151490 (Thread-4): 16:28:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2585ca400>]}
2022-03-03 16:28:09.151919 (Thread-4): 16:28:09  4 of 31 OK created incremental model DBT_VAULT.t_link_transactions.............. [SUCCESS 1 in 5.37s]
2022-03-03 16:28:09.152049 (Thread-4): 16:28:09  Finished running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:09.584988 (Thread-6): 16:28:09  SQL status: SUCCESS 1 in 5.29 seconds
2022-03-03 16:28:09.586423 (Thread-6): 16:28:09  finished collecting timing info
2022-03-03 16:28:09.586587 (Thread-6): 16:28:09  On model.dbtvault_snowflake_demo.raw_inventory: Close
2022-03-03 16:28:09.833480 (Thread-6): 16:28:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258611610>]}
2022-03-03 16:28:09.833927 (Thread-6): 16:28:09  5 of 31 OK created table model DBT_VAULT.raw_inventory.......................... [SUCCESS 1 in 5.59s]
2022-03-03 16:28:09.834060 (Thread-6): 16:28:09  Finished running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:09.834953 (Thread-3): 16:28:09  Began running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:28:09.835260 (Thread-3): 16:28:09  19 of 31 START table model DBT_VAULT.v_stg_inventory............................ [RUN]
2022-03-03 16:28:09.835548 (Thread-3): 16:28:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:28:09.835648 (Thread-3): 16:28:09  Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:28:09.835739 (Thread-3): 16:28:09  Compiling model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:28:09.849160 (Thread-3): 16:28:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:28:09.849276 (Thread-3): 16:28:09  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-03 16:28:09.849367 (Thread-3): 16:28:09  Opening a new connection, currently in state closed
2022-03-03 16:28:10.812093 (Thread-89): handling poll request
2022-03-03 16:28:10.812499 (Thread-89): 16:28:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02bc460>]}
2022-03-03 16:28:10.813279 (Thread-89): sending response (<Response 7746 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:11.089899 (Thread-3): 16:28:11  SQL status: SUCCESS 24 in 1.24 seconds
2022-03-03 16:28:11.096025 (Thread-3): 16:28:11  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:28:11.096174 (Thread-3): 16:28:11  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-03 16:28:11.255106 (Thread-3): 16:28:11  SQL status: SUCCESS 24 in 0.16 seconds
2022-03-03 16:28:11.270543 (Thread-3): 16:28:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:28:11.295268 (Thread-3): 16:28:11  finished collecting timing info
2022-03-03 16:28:11.295453 (Thread-3): 16:28:11  Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:28:11.298182 (Thread-3): 16:28:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:28:11.331323 (Thread-3): 16:28:11  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:28:11.331477 (Thread-3): 16:28:11  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_inventory  as
      (








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
      );
2022-03-03 16:28:12.681580 (Thread-90): handling poll request
2022-03-03 16:28:12.681943 (Thread-90): 16:28:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41e0850>]}
2022-03-03 16:28:12.682569 (Thread-90): sending response (<Response 11651 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:13.839438 (Thread-3): 16:28:13  SQL status: SUCCESS 1 in 2.51 seconds
2022-03-03 16:28:13.840932 (Thread-3): 16:28:13  finished collecting timing info
2022-03-03 16:28:13.841098 (Thread-3): 16:28:13  On model.dbtvault_snowflake_demo.v_stg_inventory: Close
2022-03-03 16:28:14.144431 (Thread-3): 16:28:14  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258509340>]}
2022-03-03 16:28:14.144892 (Thread-3): 16:28:14  19 of 31 OK created table model DBT_VAULT.v_stg_inventory....................... [SUCCESS 1 in 4.31s]
2022-03-03 16:28:14.145032 (Thread-3): 16:28:14  Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:28:14.146285 (Thread-4): 16:28:14  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:28:14.146471 (Thread-4): 16:28:14  20 of 31 SKIP relation DBT_VAULT.hub_nation..................................... [SKIP]
2022-03-03 16:28:14.146578 (Thread-4): 16:28:14  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:28:14.146701 (Thread-4): 16:28:14  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:28:14.146805 (Thread-4): 16:28:14  21 of 31 SKIP relation DBT_VAULT.hub_part....................................... [SKIP]
2022-03-03 16:28:14.146892 (Thread-4): 16:28:14  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:28:14.146990 (Thread-4): 16:28:14  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:28:14.147086 (Thread-4): 16:28:14  22 of 31 SKIP relation DBT_VAULT.hub_region..................................... [SKIP]
2022-03-03 16:28:14.147174 (Thread-4): 16:28:14  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:28:14.147273 (Thread-4): 16:28:14  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:28:14.147369 (Thread-4): 16:28:14  23 of 31 SKIP relation DBT_VAULT.hub_supplier................................... [SKIP]
2022-03-03 16:28:14.147450 (Thread-4): 16:28:14  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:28:14.147546 (Thread-4): 16:28:14  Began running node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:28:14.147721 (Thread-4): 16:28:14  24 of 31 START incremental model DBT_VAULT.link_inventory....................... [RUN]
2022-03-03 16:28:14.149236 (Thread-4): 16:28:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:14.149342 (Thread-4): 16:28:14  Began compiling node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:28:14.149434 (Thread-4): 16:28:14  Compiling model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:28:14.151391 (Thread-6): 16:28:14  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:28:14.151600 (Thread-6): 16:28:14  25 of 31 SKIP relation DBT_VAULT.link_nation_region............................. [SKIP]
2022-03-03 16:28:14.151762 (Thread-6): 16:28:14  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:28:14.151938 (Thread-6): 16:28:14  Began running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:28:14.152208 (Thread-6): 16:28:14  26 of 31 START incremental model DBT_VAULT.link_supplier_nation................. [RUN]
2022-03-03 16:28:14.152558 (Thread-6): 16:28:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:14.152734 (Thread-6): 16:28:14  Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:28:14.152880 (Thread-6): 16:28:14  Compiling model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:28:14.161504 (Thread-5): 16:28:14  Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:28:14.161705 (Thread-5): 16:28:14  27 of 31 START incremental model DBT_VAULT.sat_inv_inventory_details............ [RUN]
2022-03-03 16:28:14.161930 (Thread-5): 16:28:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:14.162015 (Thread-5): 16:28:14  Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:28:14.162092 (Thread-5): 16:28:14  Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:28:14.202893 (Thread-3): 16:28:14  Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:28:14.203217 (Thread-3): 16:28:14  28 of 31 START incremental model DBT_VAULT.sat_inv_part_details................. [RUN]
2022-03-03 16:28:14.203494 (Thread-3): 16:28:14  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:14.203615 (Thread-3): 16:28:14  Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:28:14.203707 (Thread-3): 16:28:14  Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:28:14.236508 (Thread-6): 16:28:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:14.242324 (Thread-4): 16:28:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:14.276258 (Thread-3): 16:28:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:14.281091 (Thread-5): 16:28:14  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:14.287471 (Thread-6): 16:28:14  finished collecting timing info
2022-03-03 16:28:14.287625 (Thread-6): 16:28:14  Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:28:14.291550 (Thread-6): 16:28:14  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:14.291665 (Thread-6): 16:28:14  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:14.291754 (Thread-6): 16:28:14  Opening a new connection, currently in state closed
2022-03-03 16:28:14.292673 (Thread-4): 16:28:14  finished collecting timing info
2022-03-03 16:28:14.292807 (Thread-4): 16:28:14  Began executing node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:28:14.296605 (Thread-4): 16:28:14  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:14.296728 (Thread-4): 16:28:14  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:14.296840 (Thread-4): 16:28:14  Opening a new connection, currently in state closed
2022-03-03 16:28:14.304822 (Thread-3): 16:28:14  finished collecting timing info
2022-03-03 16:28:14.304988 (Thread-3): 16:28:14  Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:28:14.309339 (Thread-3): 16:28:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:14.309443 (Thread-3): 16:28:14  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (

    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.PART_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.PART_PK = stage.PART_PK
                WHERE latest_records.PART_HASHDIFF != stage.PART_HASHDIFF
                OR latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:14.309568 (Thread-3): 16:28:14  Opening a new connection, currently in state closed
2022-03-03 16:28:14.310638 (Thread-5): 16:28:14  finished collecting timing info
2022-03-03 16:28:14.310784 (Thread-5): 16:28:14  Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:28:14.315646 (Thread-5): 16:28:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:14.315750 (Thread-5): 16:28:14  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (

    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.INVENTORY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
                WHERE latest_records.INVENTORY_HASHDIFF != stage.INVENTORY_HASHDIFF
                OR latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:14.315834 (Thread-5): 16:28:14  Opening a new connection, currently in state closed
2022-03-03 16:28:14.491459 (Thread-91): handling poll request
2022-03-03 16:28:14.491844 (Thread-91): 16:28:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d04444c0>]}
2022-03-03 16:28:14.493049 (Thread-91): sending response (<Response 35490 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:16.310745 (Thread-92): handling poll request
2022-03-03 16:28:16.311112 (Thread-92): 16:28:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0444670>]}
2022-03-03 16:28:16.311614 (Thread-92): sending response (<Response 292 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:17.583096 (Thread-6): 16:28:17  SQL status: SUCCESS 1 in 3.29 seconds
2022-03-03 16:28:17.586700 (Thread-6): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:17.586835 (Thread-6): 16:28:17  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
2022-03-03 16:28:17.595315 (Thread-3): 16:28:17  SQL status: SUCCESS 1 in 3.29 seconds
2022-03-03 16:28:17.598220 (Thread-3): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:17.598336 (Thread-3): 16:28:17  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
2022-03-03 16:28:17.750820 (Thread-6): 16:28:17  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:28:17.754261 (Thread-6): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:17.754373 (Thread-6): 16:28:17  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation
2022-03-03 16:28:17.756539 (Thread-3): 16:28:17  SQL status: SUCCESS 13 in 0.16 seconds
2022-03-03 16:28:17.759874 (Thread-3): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:17.759975 (Thread-3): 16:28:17  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details
2022-03-03 16:28:17.832754 (Thread-5): 16:28:17  SQL status: SUCCESS 1 in 3.52 seconds
2022-03-03 16:28:17.836028 (Thread-5): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:17.836186 (Thread-5): 16:28:17  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
2022-03-03 16:28:17.838476 (Thread-4): 16:28:17  SQL status: SUCCESS 1 in 3.54 seconds
2022-03-03 16:28:17.841288 (Thread-4): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:17.841389 (Thread-4): 16:28:17  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
2022-03-03 16:28:17.983300 (Thread-6): 16:28:17  SQL status: SUCCESS 5 in 0.23 seconds
2022-03-03 16:28:17.988300 (Thread-6): 16:28:17  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:17.988421 (Thread-6): 16:28:17  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_SUPPLIER_NATION"
2022-03-03 16:28:18.004366 (Thread-3): 16:28:18  SQL status: SUCCESS 13 in 0.24 seconds
2022-03-03 16:28:18.062448 (Thread-3): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:18.062587 (Thread-3): 16:28:18  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_PART_DETAILS"
2022-03-03 16:28:18.064050 (Thread-4): 16:28:18  SQL status: SUCCESS 5 in 0.22 seconds
2022-03-03 16:28:18.067423 (Thread-4): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:18.067530 (Thread-4): 16:28:18  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory
2022-03-03 16:28:18.068363 (Thread-5): 16:28:18  SQL status: SUCCESS 8 in 0.23 seconds
2022-03-03 16:28:18.071486 (Thread-5): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:18.071589 (Thread-5): 16:28:18  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details
2022-03-03 16:28:18.146191 (Thread-6): 16:28:18  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:28:18.148159 (Thread-6): 16:28:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:18.150222 (Thread-93): handling poll request
2022-03-03 16:28:18.150514 (Thread-93): 16:28:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41c95e0>]}
2022-03-03 16:28:18.151439 (Thread-93): sending response (<Response 14444 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:18.163983 (Thread-6): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:18.164135 (Thread-6): 16:28:18  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
2022-03-03 16:28:18.221555 (Thread-3): 16:28:18  SQL status: SUCCESS 13 in 0.16 seconds
2022-03-03 16:28:18.224204 (Thread-3): 16:28:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:18.248467 (Thread-3): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:18.248613 (Thread-3): 16:28:18  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
2022-03-03 16:28:18.428931 (Thread-6): 16:28:18  SQL status: SUCCESS 1 in 0.26 seconds
2022-03-03 16:28:18.429153 (Thread-6): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:18.429242 (Thread-6): 16:28:18  On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DBT_RAW.DBT_VAULT.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
        );
2022-03-03 16:28:18.486567 (Thread-3): 16:28:18  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-03 16:28:18.486790 (Thread-3): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:18.486885 (Thread-3): 16:28:18  On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DBT_RAW.DBT_VAULT.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
        );
2022-03-03 16:28:18.653057 (Thread-4): 16:28:18  SQL status: SUCCESS 5 in 0.59 seconds
2022-03-03 16:28:18.656707 (Thread-4): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:18.656829 (Thread-4): 16:28:18  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY"
2022-03-03 16:28:18.662081 (Thread-5): 16:28:18  SQL status: SUCCESS 8 in 0.59 seconds
2022-03-03 16:28:18.665386 (Thread-5): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:18.665488 (Thread-5): 16:28:18  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_INVENTORY_DETAILS"
2022-03-03 16:28:18.810338 (Thread-5): 16:28:18  SQL status: SUCCESS 8 in 0.14 seconds
2022-03-03 16:28:18.813001 (Thread-5): 16:28:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:18.826981 (Thread-5): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:18.827119 (Thread-5): 16:28:18  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
2022-03-03 16:28:18.845345 (Thread-6): 16:28:18  SQL status: SUCCESS 0 in 0.42 seconds
2022-03-03 16:28:18.845520 (Thread-6): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:28:18.845603 (Thread-6): 16:28:18  On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
2022-03-03 16:28:18.847766 (Thread-4): 16:28:18  SQL status: SUCCESS 5 in 0.19 seconds
2022-03-03 16:28:18.849843 (Thread-4): 16:28:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:18.863715 (Thread-4): 16:28:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:18.863846 (Thread-4): 16:28:18  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
2022-03-03 16:28:19.028193 (Thread-3): 16:28:19  SQL status: SUCCESS 0 in 0.54 seconds
2022-03-03 16:28:19.028396 (Thread-3): 16:28:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:28:19.028480 (Thread-3): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
2022-03-03 16:28:19.099265 (Thread-5): 16:28:19  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:28:19.099595 (Thread-5): 16:28:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:19.099752 (Thread-5): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DBT_RAW.DBT_VAULT.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
        );
2022-03-03 16:28:19.134742 (Thread-4): 16:28:19  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:28:19.134925 (Thread-4): 16:28:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:19.135015 (Thread-4): 16:28:19  On model.dbtvault_snowflake_demo.link_inventory: insert into DBT_RAW.DBT_VAULT.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
        );
2022-03-03 16:28:19.300083 (Thread-6): 16:28:19  SQL status: SUCCESS 1 in 0.45 seconds
2022-03-03 16:28:19.301615 (Thread-6): 16:28:19  finished collecting timing info
2022-03-03 16:28:19.301778 (Thread-6): 16:28:19  On model.dbtvault_snowflake_demo.link_supplier_nation: Close
2022-03-03 16:28:19.510700 (Thread-5): 16:28:19  SQL status: SUCCESS 0 in 0.41 seconds
2022-03-03 16:28:19.511013 (Thread-5): 16:28:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:28:19.511194 (Thread-5): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
2022-03-03 16:28:19.560349 (Thread-3): 16:28:19  SQL status: SUCCESS 1 in 0.53 seconds
2022-03-03 16:28:19.561892 (Thread-3): 16:28:19  finished collecting timing info
2022-03-03 16:28:19.562049 (Thread-3): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
2022-03-03 16:28:19.694559 (Thread-6): 16:28:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25835bbe0>]}
2022-03-03 16:28:19.695050 (Thread-6): 16:28:19  26 of 31 OK created incremental model DBT_VAULT.link_supplier_nation............ [SUCCESS 1 in 5.54s]
2022-03-03 16:28:19.695201 (Thread-6): 16:28:19  Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:28:19.695351 (Thread-6): 16:28:19  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:28:19.695534 (Thread-6): 16:28:19  29 of 31 START incremental model DBT_VAULT.sat_inv_supp_nation_details.......... [RUN]
2022-03-03 16:28:19.695785 (Thread-6): 16:28:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:19.695874 (Thread-6): 16:28:19  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:28:19.695963 (Thread-6): 16:28:19  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:28:19.712783 (Thread-6): 16:28:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:19.726583 (Thread-6): 16:28:19  finished collecting timing info
2022-03-03 16:28:19.726743 (Thread-6): 16:28:19  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:28:19.731315 (Thread-6): 16:28:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:19.731428 (Thread-6): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:19.731514 (Thread-6): 16:28:19  Opening a new connection, currently in state closed
2022-03-03 16:28:19.835232 (Thread-3): 16:28:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2583053a0>]}
2022-03-03 16:28:19.835668 (Thread-3): 16:28:19  28 of 31 OK created incremental model DBT_VAULT.sat_inv_part_details............ [SUCCESS 1 in 5.63s]
2022-03-03 16:28:19.835801 (Thread-3): 16:28:19  Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:28:19.835943 (Thread-3): 16:28:19  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:28:19.836128 (Thread-3): 16:28:19  30 of 31 START incremental model DBT_VAULT.sat_inv_supp_region_details.......... [RUN]
2022-03-03 16:28:19.836392 (Thread-3): 16:28:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:19.836490 (Thread-3): 16:28:19  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:28:19.836574 (Thread-3): 16:28:19  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:28:19.851333 (Thread-3): 16:28:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:19.865851 (Thread-3): 16:28:19  finished collecting timing info
2022-03-03 16:28:19.866005 (Thread-3): 16:28:19  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:28:19.870697 (Thread-3): 16:28:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:19.870811 (Thread-3): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:19.870898 (Thread-3): 16:28:19  Opening a new connection, currently in state closed
2022-03-03 16:28:19.874556 (Thread-94): handling status request
2022-03-03 16:28:19.874839 (Thread-94): 16:28:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41ca970>]}
2022-03-03 16:28:19.876017 (Thread-94): sending response (<Response 23004 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:19.901914 (Thread-95): handling list request
2022-03-03 16:28:19.902222 (Thread-95): 16:28:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41cac70>]}
2022-03-03 16:28:19.937425 (Thread-95): 16:28:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41ca730>]}
2022-03-03 16:28:19.937752 (Thread-95): 16:28:19  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:28:19.943951 (Thread-95): sending response (<Response 23531 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:19.988702 (Thread-5): 16:28:19  SQL status: SUCCESS 1 in 0.48 seconds
2022-03-03 16:28:19.990175 (Thread-5): 16:28:19  finished collecting timing info
2022-03-03 16:28:19.990385 (Thread-5): 16:28:19  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
2022-03-03 16:28:20.179700 (Thread-4): 16:28:20  SQL status: SUCCESS 0 in 1.04 seconds
2022-03-03 16:28:20.179909 (Thread-4): 16:28:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:28:20.193132 (Thread-96): handling poll request
2022-03-03 16:28:20.193481 (Thread-96): 16:28:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41059a0>]}
2022-03-03 16:28:20.194710 (Thread-96): sending response (<Response 38902 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:20.179999 (Thread-4): 16:28:20  On model.dbtvault_snowflake_demo.link_inventory: commit;
2022-03-03 16:28:20.410728 (Thread-5): 16:28:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258314e80>]}
2022-03-03 16:28:20.411508 (Thread-5): 16:28:20  27 of 31 OK created incremental model DBT_VAULT.sat_inv_inventory_details....... [SUCCESS 1 in 6.25s]
2022-03-03 16:28:20.411693 (Thread-5): 16:28:20  Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:28:20.411863 (Thread-5): 16:28:20  Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:28:20.412085 (Thread-5): 16:28:20  31 of 31 START incremental model DBT_VAULT.sat_inv_supplier_details............. [RUN]
2022-03-03 16:28:20.412480 (Thread-5): 16:28:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:20.412675 (Thread-5): 16:28:20  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:28:20.412836 (Thread-5): 16:28:20  Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:28:20.433582 (Thread-5): 16:28:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:20.446451 (Thread-5): 16:28:20  finished collecting timing info
2022-03-03 16:28:20.446610 (Thread-5): 16:28:20  Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:28:20.453086 (Thread-5): 16:28:20  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:20.453251 (Thread-5): 16:28:20  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_HASHDIFF != stage.SUPPLIER_HASHDIFF
                OR latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:20.453354 (Thread-5): 16:28:20  Opening a new connection, currently in state closed
2022-03-03 16:28:20.751574 (Thread-4): 16:28:20  SQL status: SUCCESS 1 in 0.57 seconds
2022-03-03 16:28:20.753677 (Thread-4): 16:28:20  finished collecting timing info
2022-03-03 16:28:20.753857 (Thread-4): 16:28:20  On model.dbtvault_snowflake_demo.link_inventory: Close
2022-03-03 16:28:21.314415 (Thread-4): 16:28:21  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258373c70>]}
2022-03-03 16:28:21.314884 (Thread-4): 16:28:21  24 of 31 OK created incremental model DBT_VAULT.link_inventory.................. [SUCCESS 1 in 7.17s]
2022-03-03 16:28:21.315063 (Thread-4): 16:28:21  Finished running node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:28:22.724373 (Thread-3): 16:28:22  SQL status: SUCCESS 1 in 2.85 seconds
2022-03-03 16:28:22.728085 (Thread-3): 16:28:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:22.728218 (Thread-3): 16:28:22  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
2022-03-03 16:28:22.930005 (Thread-3): 16:28:22  SQL status: SUCCESS 7 in 0.2 seconds
2022-03-03 16:28:22.934762 (Thread-3): 16:28:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:22.934886 (Thread-3): 16:28:22  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details
2022-03-03 16:28:22.986477 (Thread-6): 16:28:22  SQL status: SUCCESS 1 in 3.25 seconds
2022-03-03 16:28:22.989609 (Thread-6): 16:28:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:22.989721 (Thread-6): 16:28:22  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
2022-03-03 16:28:23.136941 (Thread-3): 16:28:23  SQL status: SUCCESS 7 in 0.2 seconds
2022-03-03 16:28:23.140624 (Thread-3): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:23.140761 (Thread-3): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_REGION_DETAILS"
2022-03-03 16:28:23.177021 (Thread-6): 16:28:23  SQL status: SUCCESS 7 in 0.19 seconds
2022-03-03 16:28:23.180646 (Thread-6): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:23.180822 (Thread-6): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details
2022-03-03 16:28:23.335071 (Thread-3): 16:28:23  SQL status: SUCCESS 7 in 0.19 seconds
2022-03-03 16:28:23.337369 (Thread-3): 16:28:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:23.349454 (Thread-6): 16:28:23  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-03 16:28:23.353284 (Thread-6): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:23.353429 (Thread-6): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_NATION_DETAILS"
2022-03-03 16:28:23.354300 (Thread-3): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:23.354406 (Thread-3): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
2022-03-03 16:28:23.399598 (Thread-5): 16:28:23  SQL status: SUCCESS 1 in 2.95 seconds
2022-03-03 16:28:23.402867 (Thread-5): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:23.402981 (Thread-5): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
2022-03-03 16:28:23.506628 (Thread-6): 16:28:23  SQL status: SUCCESS 7 in 0.15 seconds
2022-03-03 16:28:23.509028 (Thread-6): 16:28:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:23.523984 (Thread-6): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:23.524106 (Thread-6): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
2022-03-03 16:28:23.570883 (Thread-5): 16:28:23  SQL status: SUCCESS 10 in 0.17 seconds
2022-03-03 16:28:23.576696 (Thread-5): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:23.576825 (Thread-5): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details
2022-03-03 16:28:23.626022 (Thread-3): 16:28:23  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:28:23.626224 (Thread-3): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:23.626311 (Thread-3): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
        );
2022-03-03 16:28:23.631099 (Thread-97): handling poll request
2022-03-03 16:28:23.631437 (Thread-97): 16:28:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c40d6190>]}
2022-03-03 16:28:23.632415 (Thread-97): sending response (<Response 27448 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:23.745936 (Thread-5): 16:28:23  SQL status: SUCCESS 10 in 0.17 seconds
2022-03-03 16:28:23.751124 (Thread-5): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:23.751396 (Thread-5): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPPLIER_DETAILS"
2022-03-03 16:28:23.776619 (Thread-6): 16:28:23  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:28:23.776837 (Thread-6): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:23.776923 (Thread-6): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
        );
2022-03-03 16:28:23.912002 (Thread-5): 16:28:23  SQL status: SUCCESS 10 in 0.16 seconds
2022-03-03 16:28:23.914618 (Thread-5): 16:28:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:23.928476 (Thread-5): 16:28:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:23.928604 (Thread-5): 16:28:23  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
2022-03-03 16:28:24.113573 (Thread-3): 16:28:24  SQL status: SUCCESS 0 in 0.49 seconds
2022-03-03 16:28:24.113773 (Thread-3): 16:28:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:28:24.113858 (Thread-3): 16:28:24  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
2022-03-03 16:28:24.209251 (Thread-5): 16:28:24  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-03 16:28:24.209464 (Thread-5): 16:28:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:24.209548 (Thread-5): 16:28:24  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
        );
2022-03-03 16:28:24.223252 (Thread-6): 16:28:24  SQL status: SUCCESS 0 in 0.45 seconds
2022-03-03 16:28:24.223419 (Thread-6): 16:28:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:28:24.223503 (Thread-6): 16:28:24  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
2022-03-03 16:28:24.566978 (Thread-5): 16:28:24  SQL status: SUCCESS 0 in 0.36 seconds
2022-03-03 16:28:24.567179 (Thread-5): 16:28:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:28:24.567262 (Thread-5): 16:28:24  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
2022-03-03 16:28:24.581019 (Thread-3): 16:28:24  SQL status: SUCCESS 1 in 0.47 seconds
2022-03-03 16:28:24.582469 (Thread-3): 16:28:24  finished collecting timing info
2022-03-03 16:28:24.582622 (Thread-3): 16:28:24  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
2022-03-03 16:28:25.033406 (Thread-6): 16:28:25  SQL status: SUCCESS 1 in 0.81 seconds
2022-03-03 16:28:25.034909 (Thread-6): 16:28:25  finished collecting timing info
2022-03-03 16:28:25.035072 (Thread-6): 16:28:25  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
2022-03-03 16:28:25.039737 (Thread-3): 16:28:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25830a4f0>]}
2022-03-03 16:28:25.040091 (Thread-3): 16:28:25  30 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_region_details..... [SUCCESS 1 in 5.20s]
2022-03-03 16:28:25.040217 (Thread-3): 16:28:25  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:28:25.113848 (Thread-5): 16:28:25  SQL status: SUCCESS 1 in 0.55 seconds
2022-03-03 16:28:25.115332 (Thread-5): 16:28:25  finished collecting timing info
2022-03-03 16:28:25.115483 (Thread-5): 16:28:25  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
2022-03-03 16:28:25.373723 (Thread-6): 16:28:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2582b7ca0>]}
2022-03-03 16:28:25.374138 (Thread-6): 16:28:25  29 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_nation_details..... [SUCCESS 1 in 5.68s]
2022-03-03 16:28:25.374264 (Thread-6): 16:28:25  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:28:25.438680 (Thread-5): 16:28:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a9f933-e983-4086-bc5d-f4f89315fa64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25833f820>]}
2022-03-03 16:28:25.439094 (Thread-5): 16:28:25  31 of 31 OK created incremental model DBT_VAULT.sat_inv_supplier_details........ [SUCCESS 1 in 5.03s]
2022-03-03 16:28:25.439228 (Thread-5): 16:28:25  Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:28:25.445688 (Thread-98): handling poll request
2022-03-03 16:28:25.445991 (Thread-98): 16:28:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c40e4370>]}
2022-03-03 16:28:25.446941 (Thread-98): sending response (<Response 17984 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:25.441079 (MainThread): 16:28:25  Acquiring new snowflake connection "master"
2022-03-03 16:28:25.441493 (MainThread): 16:28:25  
2022-03-03 16:28:25.441595 (MainThread): 16:28:25  Finished running 6 table models, 25 incremental models in 34.53s.
2022-03-03 16:28:25.441680 (MainThread): 16:28:25  Connection 'master' was properly closed.
2022-03-03 16:28:25.441748 (MainThread): 16:28:25  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
2022-03-03 16:28:25.441815 (MainThread): 16:28:25  Connection 'model.dbtvault_snowflake_demo.link_inventory' was properly closed.
2022-03-03 16:28:25.441877 (MainThread): 16:28:25  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
2022-03-03 16:28:25.441938 (MainThread): 16:28:25  Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
2022-03-03 16:28:25.549245 (MainThread): 16:28:25  
2022-03-03 16:28:25.549467 (MainThread): 16:28:25  Completed with 1 error and 0 warnings:
2022-03-03 16:28:25.549562 (MainThread): 16:28:25  
2022-03-03 16:28:25.549653 (MainThread): 16:28:25  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
2022-03-03 16:28:25.549731 (MainThread): 16:28:25    001003 (42000): SQL compilation error:
2022-03-03 16:28:25.549800 (MainThread): 16:28:25    syntax error line 239 at position 38 unexpected 'ALL'.
2022-03-03 16:28:25.549868 (MainThread): 16:28:25    compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:28:25.549976 (MainThread): 16:28:25  
2022-03-03 16:28:25.550065 (MainThread): 16:28:25  Done. PASS=13 WARN=0 ERROR=1 SKIP=17 TOTAL=31
2022-03-03 16:28:27.301790 (Thread-99): handling poll request
2022-03-03 16:28:27.302169 (Thread-99): 16:28:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c408b880>]}
2022-03-03 16:28:27.305299 (Thread-99): sending response (<Response 125321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:29.309880 (Thread-100): handling status request
2022-03-03 16:28:29.310252 (Thread-100): 16:28:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c4094220>]}
2022-03-03 16:28:29.311210 (Thread-100): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:29.315341 (Thread-101): handling status request
2022-03-03 16:28:29.315619 (Thread-101): 16:28:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c409a820>]}
2022-03-03 16:28:29.316504 (Thread-101): sending response (<Response 23026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:30.124240 (Thread-102): handling status request
2022-03-03 16:28:30.124611 (Thread-102): 16:28:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c409aa60>]}
2022-03-03 16:28:30.125588 (Thread-102): sending response (<Response 23004 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:30.131654 (Thread-103): handling list request
2022-03-03 16:28:30.132009 (Thread-103): 16:28:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c409acd0>]}
2022-03-03 16:28:30.191026 (Thread-103): 16:28:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c409a2e0>]}
2022-03-03 16:28:30.191382 (Thread-103): 16:28:30  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:28:30.196982 (Thread-103): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:32.026561 (Thread-104): handling status request
2022-03-03 16:28:32.026940 (Thread-104): 16:28:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c40a3310>]}
2022-03-03 16:28:32.027899 (Thread-104): sending response (<Response 23004 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:32.033382 (Thread-105): handling list request
2022-03-03 16:28:32.033649 (Thread-105): 16:28:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c40b5430>]}
2022-03-03 16:28:32.069718 (Thread-105): 16:28:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c409acd0>]}
2022-03-03 16:28:32.070107 (Thread-105): 16:28:32  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:28:32.075095 (Thread-105): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:38.557956 (Thread-106): 16:28:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:28:38.558516 (Thread-106): 16:28:38  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-03 16:28:38.564516 (Thread-106): 16:28:38  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:28:38.595281 (Thread-106): 16:28:38  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:28:38.646771 (Thread-106): 16:28:38  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801f0ee0>]}
2022-03-03 16:28:39.195035 (Thread-107): handling status request
2022-03-03 16:28:39.195435 (Thread-107): 16:28:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d049e070>]}
2022-03-03 16:28:39.195940 (Thread-107): sending response (<Response 1851 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:39.203042 (Thread-108): handling list request
2022-03-03 16:28:39.203307 (Thread-108): 16:28:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c41f3100>]}
2022-03-03 16:28:39.236482 (Thread-108): 16:28:39  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c4113940>]}
2022-03-03 16:28:39.236893 (Thread-108): 16:28:39  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:28:39.242370 (Thread-108): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:40.437119 (Thread-109): handling status request
2022-03-03 16:28:40.437689 (Thread-109): 16:28:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a0056cd0>]}
2022-03-03 16:28:40.438203 (Thread-109): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:40.438804 (Thread-110): handling status request
2022-03-03 16:28:40.439487 (Thread-110): 16:28:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801d27f0>]}
2022-03-03 16:28:40.439969 (Thread-110): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:45.161977 (Thread-111): handling status request
2022-03-03 16:28:45.162331 (Thread-111): 16:28:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c40fb0d0>]}
2022-03-03 16:28:45.162824 (Thread-111): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:45.732544 (Thread-112): handling cli_args request
2022-03-03 16:28:45.733011 (Thread-112): 16:28:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c40fb7c0>]}
2022-03-03 16:28:45.908097 (Thread-113): handling status request
2022-03-03 16:28:45.908958 (Thread-113): 16:28:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0371c70>]}
2022-03-03 16:28:45.909841 (Thread-113): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:47.975932 (Thread-112): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:48.412528 (MainThread): 16:28:48  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:28:48.412988 (MainThread): 16:28:48  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:28:48.421144 (MainThread): 16:28:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b15aacfa0>]}
2022-03-03 16:28:48.458521 (MainThread): 16:28:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b15a8cb20>]}
2022-03-03 16:28:48.458853 (MainThread): 16:28:48  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:28:48.461425 (MainThread): 16:28:48  
2022-03-03 16:28:48.461755 (MainThread): 16:28:48  Acquiring new snowflake connection "master"
2022-03-03 16:28:48.463939 (ThreadPoolExecutor-0_0): 16:28:48  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:28:48.478299 (ThreadPoolExecutor-0_0): 16:28:48  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:28:48.478414 (ThreadPoolExecutor-0_0): 16:28:48  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:28:48.478499 (ThreadPoolExecutor-0_0): 16:28:48  Opening a new connection, currently in state init
2022-03-03 16:28:48.781295 (Thread-114): handling poll request
2022-03-03 16:28:48.781652 (Thread-114): 16:28:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a017a160>]}
2022-03-03 16:28:48.782320 (Thread-114): sending response (<Response 4125 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:49.608326 (ThreadPoolExecutor-0_0): 16:28:49  SQL status: SUCCESS 8 in 1.13 seconds
2022-03-03 16:28:49.610364 (ThreadPoolExecutor-0_0): 16:28:49  On list_DBT_RAW: Close
2022-03-03 16:28:49.893335 (ThreadPoolExecutor-2_0): 16:28:49  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:28:49.902209 (ThreadPoolExecutor-2_0): 16:28:49  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:28:49.902356 (ThreadPoolExecutor-2_0): 16:28:49  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:28:49.902456 (ThreadPoolExecutor-2_0): 16:28:49  Opening a new connection, currently in state closed
2022-03-03 16:28:50.545009 (Thread-115): handling poll request
2022-03-03 16:28:50.545389 (Thread-115): 16:28:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a017a820>]}
2022-03-03 16:28:50.545958 (Thread-115): sending response (<Response 2282 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:50.819137 (ThreadPoolExecutor-2_0): 16:28:50  SQL status: SUCCESS 31 in 0.92 seconds
2022-03-03 16:28:50.821614 (ThreadPoolExecutor-2_0): 16:28:50  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:28:51.048926 (MainThread): 16:28:51  Concurrency: 4 threads (target='default')
2022-03-03 16:28:51.049111 (MainThread): 16:28:51  
2022-03-03 16:28:51.051971 (Thread-3): 16:28:51  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:28:51.052310 (Thread-3): 16:28:51  1 of 31 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-03 16:28:51.052604 (Thread-3): 16:28:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:28:51.052790 (Thread-3): 16:28:51  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:28:51.052942 (Thread-3): 16:28:51  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:28:51.057048 (Thread-4): 16:28:51  Began running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:28:51.057288 (Thread-4): 16:28:51  2 of 31 START table model DBT_VAULT.raw_transactions............................ [RUN]
2022-03-03 16:28:51.057543 (Thread-4): 16:28:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:28:51.057632 (Thread-4): 16:28:51  Began compiling node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:28:51.057722 (Thread-4): 16:28:51  Compiling model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:28:51.061116 (Thread-4): 16:28:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:28:51.063475 (Thread-3): 16:28:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:28:51.075299 (Thread-4): 16:28:51  finished collecting timing info
2022-03-03 16:28:51.075472 (Thread-4): 16:28:51  Began executing node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:28:51.080736 (Thread-3): 16:28:51  finished collecting timing info
2022-03-03 16:28:51.080873 (Thread-3): 16:28:51  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:28:51.116422 (Thread-3): 16:28:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:28:51.119799 (Thread-4): 16:28:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:28:51.136303 (Thread-3): 16:28:51  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:28:51.136432 (Thread-3): 16:28:51  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM DBT_RAW.TPCH_SF10.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:28:51.136526 (Thread-3): 16:28:51  Opening a new connection, currently in state closed
2022-03-03 16:28:51.138269 (Thread-4): 16:28:51  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:28:51.138381 (Thread-4): 16:28:51  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_transactions  as
      (SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM DBT_RAW.TPCH_SF10.ORDERS  AS b
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:28:51.138466 (Thread-4): 16:28:51  Opening a new connection, currently in state init
2022-03-03 16:28:53.491825 (Thread-116): handling poll request
2022-03-03 16:28:53.492192 (Thread-116): 16:28:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801e1610>]}
2022-03-03 16:28:53.493042 (Thread-116): sending response (<Response 14962 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:54.402986 (Thread-4): 16:28:54  SQL status: SUCCESS 1 in 3.26 seconds
2022-03-03 16:28:54.412759 (Thread-4): 16:28:54  finished collecting timing info
2022-03-03 16:28:54.412960 (Thread-4): 16:28:54  On model.dbtvault_snowflake_demo.raw_transactions: Close
2022-03-03 16:28:54.714786 (Thread-4): 16:28:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b141546d0>]}
2022-03-03 16:28:54.715414 (Thread-4): 16:28:54  2 of 31 OK created table model DBT_VAULT.raw_transactions....................... [SUCCESS 1 in 3.66s]
2022-03-03 16:28:54.715626 (Thread-4): 16:28:54  Finished running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:28:54.716485 (Thread-6): 16:28:54  Began running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:54.716777 (Thread-6): 16:28:54  3 of 31 START table model DBT_VAULT.v_stg_transactions.......................... [RUN]
2022-03-03 16:28:54.717064 (Thread-6): 16:28:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:54.717155 (Thread-6): 16:28:54  Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:54.717247 (Thread-6): 16:28:54  Compiling model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:54.750820 (Thread-6): 16:28:54  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:54.750972 (Thread-6): 16:28:54  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-03 16:28:54.751065 (Thread-6): 16:28:54  Opening a new connection, currently in state init
2022-03-03 16:28:55.310291 (Thread-117): handling poll request
2022-03-03 16:28:55.310683 (Thread-117): 16:28:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a017a5e0>]}
2022-03-03 16:28:55.311386 (Thread-117): sending response (<Response 6441 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:55.692898 (Thread-6): 16:28:55  SQL status: SUCCESS 7 in 0.94 seconds
2022-03-03 16:28:55.732420 (Thread-6): 16:28:55  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:55.732697 (Thread-6): 16:28:55  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-03 16:28:56.242599 (Thread-6): 16:28:56  SQL status: SUCCESS 7 in 0.51 seconds
2022-03-03 16:28:56.276387 (Thread-6): 16:28:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:56.289160 (Thread-6): 16:28:56  finished collecting timing info
2022-03-03 16:28:56.289355 (Thread-6): 16:28:56  Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:56.291944 (Thread-6): 16:28:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:56.306477 (Thread-6): 16:28:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:28:56.306609 (Thread-6): 16:28:56  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_transactions  as
      (







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM DBT_RAW.DBT_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
      );
2022-03-03 16:28:57.144019 (Thread-118): handling poll request
2022-03-03 16:28:57.144428 (Thread-118): 16:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801ef2e0>]}
2022-03-03 16:28:57.145070 (Thread-118): sending response (<Response 6258 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:57.271648 (Thread-3): 16:28:57  SQL status: SUCCESS 1 in 6.14 seconds
2022-03-03 16:28:57.273101 (Thread-3): 16:28:57  finished collecting timing info
2022-03-03 16:28:57.273260 (Thread-3): 16:28:57  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:28:57.529261 (Thread-3): 16:28:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b15b85370>]}
2022-03-03 16:28:57.529671 (Thread-3): 16:28:57  1 of 31 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 6.48s]
2022-03-03 16:28:57.529796 (Thread-3): 16:28:57  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:28:57.530586 (Thread-4): 16:28:57  Began running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:57.530853 (Thread-4): 16:28:57  4 of 31 START table model DBT_VAULT.raw_inventory............................... [RUN]
2022-03-03 16:28:57.531113 (Thread-4): 16:28:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:57.531225 (Thread-4): 16:28:57  Began compiling node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:57.531318 (Thread-4): 16:28:57  Compiling model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:57.535667 (Thread-5): 16:28:57  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:57.535902 (Thread-5): 16:28:57  5 of 31 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-03 16:28:57.536195 (Thread-5): 16:28:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:57.536290 (Thread-5): 16:28:57  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:57.536376 (Thread-5): 16:28:57  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:57.541198 (Thread-4): 16:28:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:57.550636 (Thread-5): 16:28:57  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:57.550747 (Thread-5): 16:28:57  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:28:57.550831 (Thread-5): 16:28:57  Opening a new connection, currently in state init
2022-03-03 16:28:57.560477 (Thread-4): 16:28:57  finished collecting timing info
2022-03-03 16:28:57.560653 (Thread-4): 16:28:57  Began executing node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:28:57.563075 (Thread-4): 16:28:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:57.578642 (Thread-4): 16:28:57  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:28:57.578764 (Thread-4): 16:28:57  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.raw_inventory  as
      (SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF10.PARTSUPP AS a
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DBT_RAW.DBT_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
      );
2022-03-03 16:28:57.578851 (Thread-4): 16:28:57  Opening a new connection, currently in state closed
2022-03-03 16:28:58.592268 (Thread-6): 16:28:58  SQL status: SUCCESS 1 in 2.29 seconds
2022-03-03 16:28:58.593772 (Thread-6): 16:28:58  finished collecting timing info
2022-03-03 16:28:58.593935 (Thread-6): 16:28:58  On model.dbtvault_snowflake_demo.v_stg_transactions: Close
2022-03-03 16:28:58.848528 (Thread-6): 16:28:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b1408e640>]}
2022-03-03 16:28:58.848990 (Thread-6): 16:28:58  3 of 31 OK created table model DBT_VAULT.v_stg_transactions..................... [SUCCESS 1 in 4.13s]
2022-03-03 16:28:58.849121 (Thread-6): 16:28:58  Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:28:58.849876 (Thread-3): 16:28:58  Began running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:58.850138 (Thread-3): 16:28:58  6 of 31 START incremental model DBT_VAULT.t_link_transactions................... [RUN]
2022-03-03 16:28:58.850430 (Thread-3): 16:28:58  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:58.850533 (Thread-3): 16:28:58  Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:58.850628 (Thread-3): 16:28:58  Compiling model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:58.914629 (Thread-3): 16:28:58  Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:58.928288 (Thread-3): 16:28:58  finished collecting timing info
2022-03-03 16:28:58.928471 (Thread-3): 16:28:58  Began executing node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:28:58.953701 (Thread-3): 16:28:58  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:28:58.953848 (Thread-3): 16:28:58  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN DBT_RAW.DBT_VAULT.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:28:58.953941 (Thread-3): 16:28:58  Opening a new connection, currently in state closed
2022-03-03 16:28:58.956804 (Thread-5): 16:28:58  SQL status: SUCCESS 37 in 1.41 seconds
2022-03-03 16:28:58.963910 (Thread-5): 16:28:58  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:58.964025 (Thread-5): 16:28:58  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:28:59.006211 (Thread-119): handling poll request
2022-03-03 16:28:59.006568 (Thread-119): 16:28:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518014d0a0>]}
2022-03-03 16:28:59.007477 (Thread-119): sending response (<Response 22615 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:28:59.149344 (Thread-5): 16:28:59  SQL status: SUCCESS 37 in 0.19 seconds
2022-03-03 16:28:59.171042 (Thread-5): 16:28:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:59.200808 (Thread-5): 16:28:59  finished collecting timing info
2022-03-03 16:28:59.201009 (Thread-5): 16:28:59  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:28:59.204433 (Thread-5): 16:28:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:59.285077 (Thread-5): 16:28:59  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:28:59.285334 (Thread-5): 16:28:59  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-03 16:29:00.831248 (Thread-120): handling poll request
2022-03-03 16:29:00.831613 (Thread-120): 16:29:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518014d5b0>]}
2022-03-03 16:29:00.832207 (Thread-120): sending response (<Response 13387 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:01.665473 (Thread-5): 16:29:01  SQL status: SUCCESS 1 in 2.38 seconds
2022-03-03 16:29:01.666960 (Thread-5): 16:29:01  finished collecting timing info
2022-03-03 16:29:01.667129 (Thread-5): 16:29:01  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:29:01.969132 (Thread-3): 16:29:01  SQL status: SUCCESS 1 in 3.02 seconds
2022-03-03 16:29:01.972675 (Thread-3): 16:29:01  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:01.972828 (Thread-3): 16:29:01  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
2022-03-03 16:29:01.990167 (Thread-5): 16:29:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0452fdf0>]}
2022-03-03 16:29:01.990886 (Thread-5): 16:29:01  5 of 31 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 4.45s]
2022-03-03 16:29:01.991106 (Thread-5): 16:29:01  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:29:01.991928 (Thread-6): 16:29:01  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:29:01.992173 (Thread-6): 16:29:01  7 of 31 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-03 16:29:01.992439 (Thread-6): 16:29:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:01.992531 (Thread-6): 16:29:01  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:29:01.992622 (Thread-6): 16:29:01  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:29:01.997016 (Thread-5): 16:29:01  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:29:01.997342 (Thread-5): 16:29:01  8 of 31 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-03 16:29:01.997705 (Thread-5): 16:29:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:01.997854 (Thread-5): 16:29:01  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:29:01.998002 (Thread-5): 16:29:01  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:29:02.051734 (Thread-6): 16:29:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:02.056570 (Thread-5): 16:29:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:02.064178 (Thread-6): 16:29:02  finished collecting timing info
2022-03-03 16:29:02.064348 (Thread-6): 16:29:02  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:29:02.068191 (Thread-6): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:02.068307 (Thread-6): 16:29:02  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:02.068395 (Thread-6): 16:29:02  Opening a new connection, currently in state closed
2022-03-03 16:29:02.069350 (Thread-5): 16:29:02  finished collecting timing info
2022-03-03 16:29:02.069489 (Thread-5): 16:29:02  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:29:02.073190 (Thread-5): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:02.073300 (Thread-5): 16:29:02  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:02.073392 (Thread-5): 16:29:02  Opening a new connection, currently in state closed
2022-03-03 16:29:02.143472 (Thread-3): 16:29:02  SQL status: SUCCESS 10 in 0.17 seconds
2022-03-03 16:29:02.147242 (Thread-3): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:02.147359 (Thread-3): 16:29:02  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions
2022-03-03 16:29:02.327693 (Thread-3): 16:29:02  SQL status: SUCCESS 10 in 0.18 seconds
2022-03-03 16:29:02.341851 (Thread-3): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:02.342019 (Thread-3): 16:29:02  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DBT_RAW"."DBT_VAULT"."T_LINK_TRANSACTIONS"
2022-03-03 16:29:02.527068 (Thread-4): 16:29:02  SQL status: SUCCESS 1 in 4.95 seconds
2022-03-03 16:29:02.528487 (Thread-4): 16:29:02  finished collecting timing info
2022-03-03 16:29:02.528684 (Thread-4): 16:29:02  On model.dbtvault_snowflake_demo.raw_inventory: Close
2022-03-03 16:29:02.530969 (Thread-3): 16:29:02  SQL status: SUCCESS 10 in 0.19 seconds
2022-03-03 16:29:02.547061 (Thread-3): 16:29:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:02.566059 (Thread-3): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:02.566203 (Thread-3): 16:29:02  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
2022-03-03 16:29:02.712877 (Thread-121): handling poll request
2022-03-03 16:29:02.713262 (Thread-121): 16:29:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518013d8e0>]}
2022-03-03 16:29:02.714163 (Thread-121): sending response (<Response 20571 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:02.810075 (Thread-4): 16:29:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b141559a0>]}
2022-03-03 16:29:02.810522 (Thread-4): 16:29:02  4 of 31 OK created table model DBT_VAULT.raw_inventory.......................... [SUCCESS 1 in 5.28s]
2022-03-03 16:29:02.810662 (Thread-4): 16:29:02  Finished running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:29:02.810808 (Thread-4): 16:29:02  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:29:02.810996 (Thread-4): 16:29:02  9 of 31 START incremental model DBT_VAULT.hub_order............................. [RUN]
2022-03-03 16:29:02.811238 (Thread-4): 16:29:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:02.811327 (Thread-4): 16:29:02  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:29:02.811417 (Thread-4): 16:29:02  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:29:02.820688 (Thread-4): 16:29:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:02.834008 (Thread-4): 16:29:02  finished collecting timing info
2022-03-03 16:29:02.834174 (Thread-4): 16:29:02  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:29:02.838493 (Thread-4): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:02.838621 (Thread-4): 16:29:02  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:02.838718 (Thread-4): 16:29:02  Opening a new connection, currently in state closed
2022-03-03 16:29:02.842217 (Thread-3): 16:29:02  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-03 16:29:02.842393 (Thread-3): 16:29:02  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:02.842502 (Thread-3): 16:29:02  On model.dbtvault_snowflake_demo.t_link_transactions: insert into DBT_RAW.DBT_VAULT.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
        );
2022-03-03 16:29:03.497499 (Thread-3): 16:29:03  SQL status: SUCCESS 0 in 0.65 seconds
2022-03-03 16:29:03.497713 (Thread-3): 16:29:03  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:29:03.497803 (Thread-3): 16:29:03  On model.dbtvault_snowflake_demo.t_link_transactions: commit;
2022-03-03 16:29:04.488712 (Thread-3): 16:29:04  SQL status: SUCCESS 1 in 0.99 seconds
2022-03-03 16:29:04.490321 (Thread-3): 16:29:04  finished collecting timing info
2022-03-03 16:29:04.490482 (Thread-3): 16:29:04  On model.dbtvault_snowflake_demo.t_link_transactions: Close
2022-03-03 16:29:04.523092 (Thread-122): handling poll request
2022-03-03 16:29:04.523464 (Thread-122): 16:29:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5180151430>]}
2022-03-03 16:29:04.524167 (Thread-122): sending response (<Response 10879 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:04.576897 (Thread-5): 16:29:04  SQL status: SUCCESS 1 in 2.5 seconds
2022-03-03 16:29:04.580459 (Thread-5): 16:29:04  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:04.580604 (Thread-5): 16:29:04  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp
2022-03-03 16:29:04.771978 (Thread-5): 16:29:04  SQL status: SUCCESS 5 in 0.19 seconds
2022-03-03 16:29:04.775660 (Thread-5): 16:29:04  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:04.775782 (Thread-5): 16:29:04  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.hub_lineitem
2022-03-03 16:29:04.950374 (Thread-5): 16:29:04  SQL status: SUCCESS 5 in 0.17 seconds
2022-03-03 16:29:04.955175 (Thread-5): 16:29:04  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:04.955306 (Thread-5): 16:29:04  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_LINEITEM"
2022-03-03 16:29:05.339390 (Thread-3): 16:29:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0454caf0>]}
2022-03-03 16:29:05.339993 (Thread-3): 16:29:05  6 of 31 OK created incremental model DBT_VAULT.t_link_transactions.............. [SUCCESS 1 in 6.49s]
2022-03-03 16:29:05.340209 (Thread-3): 16:29:05  Finished running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:29:05.340455 (Thread-3): 16:29:05  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:29:05.340798 (Thread-3): 16:29:05  10 of 31 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-03 16:29:05.341132 (Thread-3): 16:29:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:05.341236 (Thread-3): 16:29:05  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:29:05.341329 (Thread-3): 16:29:05  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:29:05.379199 (Thread-3): 16:29:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:05.393474 (Thread-5): 16:29:05  SQL status: SUCCESS 5 in 0.44 seconds
2022-03-03 16:29:05.395734 (Thread-5): 16:29:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:05.395990 (Thread-3): 16:29:05  finished collecting timing info
2022-03-03 16:29:05.396170 (Thread-3): 16:29:05  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:29:05.400326 (Thread-3): 16:29:05  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:05.400441 (Thread-3): 16:29:05  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_customer_nation AS d
    ON a.LINK_CUSTOMER_NATION_PK = d.LINK_CUSTOMER_NATION_PK
    WHERE d.LINK_CUSTOMER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:05.400536 (Thread-3): 16:29:05  Opening a new connection, currently in state closed
2022-03-03 16:29:05.417143 (Thread-5): 16:29:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:05.417297 (Thread-5): 16:29:05  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
2022-03-03 16:29:05.464692 (Thread-4): 16:29:05  SQL status: SUCCESS 1 in 2.63 seconds
2022-03-03 16:29:05.469584 (Thread-4): 16:29:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:05.469767 (Thread-4): 16:29:05  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DBT_RAW.DBT_VAULT.hub_order__dbt_tmp
2022-03-03 16:29:05.665655 (Thread-5): 16:29:05  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:29:05.666020 (Thread-5): 16:29:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:05.666122 (Thread-5): 16:29:05  On model.dbtvault_snowflake_demo.hub_lineitem: insert into DBT_RAW.DBT_VAULT.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp
        );
2022-03-03 16:29:05.784185 (Thread-4): 16:29:05  SQL status: SUCCESS 4 in 0.31 seconds
2022-03-03 16:29:05.788789 (Thread-4): 16:29:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:05.788912 (Thread-4): 16:29:05  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DBT_RAW.DBT_VAULT.hub_order
2022-03-03 16:29:05.973098 (Thread-4): 16:29:05  SQL status: SUCCESS 4 in 0.18 seconds
2022-03-03 16:29:05.976864 (Thread-4): 16:29:05  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:05.977063 (Thread-4): 16:29:05  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_ORDER"
2022-03-03 16:29:06.114119 (Thread-5): 16:29:06  SQL status: SUCCESS 0 in 0.45 seconds
2022-03-03 16:29:06.114320 (Thread-5): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:29:06.114406 (Thread-5): 16:29:06  On model.dbtvault_snowflake_demo.hub_lineitem: commit;
2022-03-03 16:29:06.167234 (Thread-4): 16:29:06  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-03 16:29:06.169328 (Thread-4): 16:29:06  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:06.183658 (Thread-4): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:06.183811 (Thread-4): 16:29:06  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
2022-03-03 16:29:06.407277 (Thread-123): handling poll request
2022-03-03 16:29:06.407640 (Thread-123): 16:29:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518013d7f0>]}
2022-03-03 16:29:06.408546 (Thread-123): sending response (<Response 20787 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:06.531232 (Thread-6): 16:29:06  SQL status: SUCCESS 1 in 4.46 seconds
2022-03-03 16:29:06.536015 (Thread-6): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:06.536181 (Thread-6): 16:29:06  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp
2022-03-03 16:29:06.539101 (Thread-5): 16:29:06  SQL status: SUCCESS 1 in 0.42 seconds
2022-03-03 16:29:06.540412 (Thread-5): 16:29:06  finished collecting timing info
2022-03-03 16:29:06.540562 (Thread-5): 16:29:06  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-03 16:29:06.587692 (Thread-4): 16:29:06  SQL status: SUCCESS 1 in 0.4 seconds
2022-03-03 16:29:06.587866 (Thread-4): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:06.587949 (Thread-4): 16:29:06  On model.dbtvault_snowflake_demo.hub_order: insert into DBT_RAW.DBT_VAULT.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_order__dbt_tmp
        );
2022-03-03 16:29:06.690146 (Thread-6): 16:29:06  SQL status: SUCCESS 4 in 0.15 seconds
2022-03-03 16:29:06.694751 (Thread-6): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:06.694884 (Thread-6): 16:29:06  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DBT_RAW.DBT_VAULT.hub_customer
2022-03-03 16:29:06.881089 (Thread-5): 16:29:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043af5e0>]}
2022-03-03 16:29:06.881518 (Thread-5): 16:29:06  8 of 31 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 4.88s]
2022-03-03 16:29:06.881648 (Thread-5): 16:29:06  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:29:06.881794 (Thread-5): 16:29:06  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:29:06.882023 (Thread-5): 16:29:06  11 of 31 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-03 16:29:06.882272 (Thread-5): 16:29:06  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:06.882362 (Thread-5): 16:29:06  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:29:06.882454 (Thread-5): 16:29:06  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:29:06.891443 (Thread-5): 16:29:06  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:06.904934 (Thread-5): 16:29:06  finished collecting timing info
2022-03-03 16:29:06.905093 (Thread-5): 16:29:06  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:29:06.909155 (Thread-5): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:06.909267 (Thread-5): 16:29:06  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_customer_order AS d
    ON a.ORDER_CUSTOMER_PK = d.ORDER_CUSTOMER_PK
    WHERE d.ORDER_CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:06.909356 (Thread-5): 16:29:06  Opening a new connection, currently in state closed
2022-03-03 16:29:06.912254 (Thread-6): 16:29:06  SQL status: SUCCESS 4 in 0.22 seconds
2022-03-03 16:29:06.917091 (Thread-6): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:06.917214 (Thread-6): 16:29:06  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_CUSTOMER"
2022-03-03 16:29:06.921184 (Thread-4): 16:29:06  SQL status: SUCCESS 0 in 0.33 seconds
2022-03-03 16:29:06.921316 (Thread-4): 16:29:06  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:29:06.921394 (Thread-4): 16:29:06  On model.dbtvault_snowflake_demo.hub_order: commit;
2022-03-03 16:29:07.049305 (Thread-6): 16:29:07  SQL status: SUCCESS 4 in 0.13 seconds
2022-03-03 16:29:07.051540 (Thread-6): 16:29:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:07.066556 (Thread-6): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:07.066678 (Thread-6): 16:29:07  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
2022-03-03 16:29:07.328150 (Thread-4): 16:29:07  SQL status: SUCCESS 1 in 0.41 seconds
2022-03-03 16:29:07.329692 (Thread-4): 16:29:07  finished collecting timing info
2022-03-03 16:29:07.329859 (Thread-4): 16:29:07  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-03 16:29:07.338953 (Thread-6): 16:29:07  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:29:07.339116 (Thread-6): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:07.339200 (Thread-6): 16:29:07  On model.dbtvault_snowflake_demo.hub_customer: insert into DBT_RAW.DBT_VAULT.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp
        );
2022-03-03 16:29:07.466919 (Thread-3): 16:29:07  SQL status: SUCCESS 1 in 2.07 seconds
2022-03-03 16:29:07.470473 (Thread-3): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:07.470606 (Thread-3): 16:29:07  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp
2022-03-03 16:29:07.591616 (Thread-4): 16:29:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043e6910>]}
2022-03-03 16:29:07.592025 (Thread-4): 16:29:07  9 of 31 OK created incremental model DBT_VAULT.hub_order........................ [SUCCESS 1 in 4.78s]
2022-03-03 16:29:07.592154 (Thread-4): 16:29:07  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:29:07.592307 (Thread-4): 16:29:07  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:29:07.592493 (Thread-4): 16:29:07  12 of 31 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-03 16:29:07.592751 (Thread-4): 16:29:07  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:07.592843 (Thread-4): 16:29:07  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:29:07.592933 (Thread-4): 16:29:07  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:29:07.601630 (Thread-4): 16:29:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:07.616803 (Thread-4): 16:29:07  finished collecting timing info
2022-03-03 16:29:07.616951 (Thread-4): 16:29:07  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:29:07.620874 (Thread-4): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:07.620983 (Thread-4): 16:29:07  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory_allocation AS d
    ON a.INVENTORY_ALLOCATION_PK = d.INVENTORY_ALLOCATION_PK
    WHERE d.INVENTORY_ALLOCATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:07.621072 (Thread-4): 16:29:07  Opening a new connection, currently in state closed
2022-03-03 16:29:07.629284 (Thread-3): 16:29:07  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:29:07.632409 (Thread-3): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:07.632512 (Thread-3): 16:29:07  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_nation
2022-03-03 16:29:07.831412 (Thread-6): 16:29:07  SQL status: SUCCESS 0 in 0.49 seconds
2022-03-03 16:29:07.831692 (Thread-6): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:29:07.831825 (Thread-6): 16:29:07  On model.dbtvault_snowflake_demo.hub_customer: commit;
2022-03-03 16:29:07.871213 (Thread-3): 16:29:07  SQL status: SUCCESS 5 in 0.24 seconds
2022-03-03 16:29:07.874734 (Thread-3): 16:29:07  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:07.874857 (Thread-3): 16:29:07  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_CUSTOMER_NATION"
2022-03-03 16:29:08.058587 (Thread-3): 16:29:08  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-03 16:29:08.060796 (Thread-3): 16:29:08  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:08.075143 (Thread-3): 16:29:08  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:08.075351 (Thread-3): 16:29:08  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
begin;
2022-03-03 16:29:08.160400 (Thread-6): 16:29:08  SQL status: SUCCESS 1 in 0.33 seconds
2022-03-03 16:29:08.162409 (Thread-6): 16:29:08  finished collecting timing info
2022-03-03 16:29:08.162583 (Thread-6): 16:29:08  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-03 16:29:08.195273 (Thread-124): handling poll request
2022-03-03 16:29:08.195651 (Thread-124): 16:29:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518016cd90>]}
2022-03-03 16:29:08.196850 (Thread-124): sending response (<Response 34178 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:08.364557 (Thread-3): 16:29:08  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 16:29:08.364816 (Thread-3): 16:29:08  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:08.364907 (Thread-3): 16:29:08  On model.dbtvault_snowflake_demo.link_customer_nation: insert into DBT_RAW.DBT_VAULT.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp
        );
2022-03-03 16:29:08.419938 (Thread-6): 16:29:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b04336fa0>]}
2022-03-03 16:29:08.420360 (Thread-6): 16:29:08  7 of 31 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 6.43s]
2022-03-03 16:29:08.420487 (Thread-6): 16:29:08  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:29:08.420656 (Thread-6): 16:29:08  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:29:08.420851 (Thread-6): 16:29:08  13 of 31 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-03 16:29:08.421097 (Thread-6): 16:29:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:08.421186 (Thread-6): 16:29:08  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:29:08.421275 (Thread-6): 16:29:08  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:29:08.430812 (Thread-6): 16:29:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:08.444160 (Thread-6): 16:29:08  finished collecting timing info
2022-03-03 16:29:08.444322 (Thread-6): 16:29:08  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:29:08.448536 (Thread-6): 16:29:08  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:08.448679 (Thread-6): 16:29:08  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_order_lineitem AS d
    ON a.LINK_LINEITEM_ORDER_PK = d.LINK_LINEITEM_ORDER_PK
    WHERE d.LINK_LINEITEM_ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:08.448775 (Thread-6): 16:29:08  Opening a new connection, currently in state closed
2022-03-03 16:29:08.746897 (Thread-3): 16:29:08  SQL status: SUCCESS 0 in 0.38 seconds
2022-03-03 16:29:08.747106 (Thread-3): 16:29:08  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:29:08.747198 (Thread-3): 16:29:08  On model.dbtvault_snowflake_demo.link_customer_nation: commit;
2022-03-03 16:29:09.294739 (Thread-3): 16:29:09  SQL status: SUCCESS 1 in 0.55 seconds
2022-03-03 16:29:09.296357 (Thread-3): 16:29:09  finished collecting timing info
2022-03-03 16:29:09.296585 (Thread-3): 16:29:09  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-03 16:29:09.499432 (Thread-5): 16:29:09  SQL status: SUCCESS 1 in 2.59 seconds
2022-03-03 16:29:09.502828 (Thread-5): 16:29:09  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:09.502959 (Thread-5): 16:29:09  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp
2022-03-03 16:29:09.813819 (Thread-3): 16:29:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b04414190>]}
2022-03-03 16:29:09.814239 (Thread-3): 16:29:09  10 of 31 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 4.47s]
2022-03-03 16:29:09.814367 (Thread-3): 16:29:09  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:29:09.814515 (Thread-3): 16:29:09  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:29:09.814699 (Thread-3): 16:29:09  14 of 31 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-03 16:29:09.814935 (Thread-3): 16:29:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:09.815022 (Thread-3): 16:29:09  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:29:09.815111 (Thread-3): 16:29:09  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:29:09.855232 (Thread-3): 16:29:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:09.855900 (Thread-5): 16:29:09  SQL status: SUCCESS 5 in 0.35 seconds
2022-03-03 16:29:09.859205 (Thread-5): 16:29:09  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:09.859314 (Thread-5): 16:29:09  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_order
2022-03-03 16:29:09.873022 (Thread-3): 16:29:09  finished collecting timing info
2022-03-03 16:29:09.873191 (Thread-3): 16:29:09  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:29:09.877968 (Thread-3): 16:29:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:09.878078 (Thread-3): 16:29:09  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_NATION_HASHDIFF != stage.CUSTOMER_NATION_HASHDIFF
                OR latest_records.CUSTOMER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:09.878166 (Thread-3): 16:29:09  Opening a new connection, currently in state closed
2022-03-03 16:29:10.050684 (Thread-125): handling poll request
2022-03-03 16:29:10.051048 (Thread-125): 16:29:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801ac0a0>]}
2022-03-03 16:29:10.051948 (Thread-125): sending response (<Response 21987 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:10.142203 (Thread-5): 16:29:10  SQL status: SUCCESS 5 in 0.28 seconds
2022-03-03 16:29:10.145824 (Thread-5): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:10.145949 (Thread-5): 16:29:10  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_CUSTOMER_ORDER"
2022-03-03 16:29:10.273088 (Thread-4): 16:29:10  SQL status: SUCCESS 1 in 2.65 seconds
2022-03-03 16:29:10.276458 (Thread-4): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:10.276586 (Thread-4): 16:29:10  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp
2022-03-03 16:29:10.339751 (Thread-5): 16:29:10  SQL status: SUCCESS 5 in 0.19 seconds
2022-03-03 16:29:10.341914 (Thread-5): 16:29:10  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:10.356275 (Thread-5): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:10.356408 (Thread-5): 16:29:10  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
begin;
2022-03-03 16:29:10.421550 (Thread-4): 16:29:10  SQL status: SUCCESS 6 in 0.14 seconds
2022-03-03 16:29:10.426931 (Thread-4): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:10.427060 (Thread-4): 16:29:10  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory_allocation
2022-03-03 16:29:10.603612 (Thread-5): 16:29:10  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:29:10.603822 (Thread-5): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:10.603908 (Thread-5): 16:29:10  On model.dbtvault_snowflake_demo.link_customer_order: insert into DBT_RAW.DBT_VAULT.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp
        );
2022-03-03 16:29:10.617389 (Thread-4): 16:29:10  SQL status: SUCCESS 6 in 0.19 seconds
2022-03-03 16:29:10.621310 (Thread-4): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:10.621434 (Thread-4): 16:29:10  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY_ALLOCATION"
2022-03-03 16:29:10.793732 (Thread-6): 16:29:10  SQL status: SUCCESS 1 in 2.34 seconds
2022-03-03 16:29:10.797021 (Thread-6): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:10.797138 (Thread-6): 16:29:10  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp
2022-03-03 16:29:10.803508 (Thread-4): 16:29:10  SQL status: SUCCESS 6 in 0.18 seconds
2022-03-03 16:29:10.805586 (Thread-4): 16:29:10  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:10.819933 (Thread-4): 16:29:10  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:10.820143 (Thread-4): 16:29:10  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
begin;
2022-03-03 16:29:11.005979 (Thread-6): 16:29:11  SQL status: SUCCESS 5 in 0.21 seconds
2022-03-03 16:29:11.009866 (Thread-6): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:11.010006 (Thread-6): 16:29:11  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.link_order_lineitem
2022-03-03 16:29:11.063363 (Thread-4): 16:29:11  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-03 16:29:11.063574 (Thread-4): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:11.063660 (Thread-4): 16:29:11  On model.dbtvault_snowflake_demo.link_inventory_allocation: insert into DBT_RAW.DBT_VAULT.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp
        );
2022-03-03 16:29:11.154868 (Thread-5): 16:29:11  SQL status: SUCCESS 0 in 0.55 seconds
2022-03-03 16:29:11.155068 (Thread-5): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:29:11.155155 (Thread-5): 16:29:11  On model.dbtvault_snowflake_demo.link_customer_order: commit;
2022-03-03 16:29:11.181555 (Thread-6): 16:29:11  SQL status: SUCCESS 5 in 0.17 seconds
2022-03-03 16:29:11.185469 (Thread-6): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:11.185602 (Thread-6): 16:29:11  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_ORDER_LINEITEM"
2022-03-03 16:29:11.400984 (Thread-6): 16:29:11  SQL status: SUCCESS 5 in 0.22 seconds
2022-03-03 16:29:11.403227 (Thread-6): 16:29:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:11.418786 (Thread-6): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:11.418912 (Thread-6): 16:29:11  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
begin;
2022-03-03 16:29:11.548883 (Thread-4): 16:29:11  SQL status: SUCCESS 0 in 0.49 seconds
2022-03-03 16:29:11.549083 (Thread-4): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:29:11.549169 (Thread-4): 16:29:11  On model.dbtvault_snowflake_demo.link_inventory_allocation: commit;
2022-03-03 16:29:11.656702 (Thread-6): 16:29:11  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-03 16:29:11.656958 (Thread-6): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:11.657048 (Thread-6): 16:29:11  On model.dbtvault_snowflake_demo.link_order_lineitem: insert into DBT_RAW.DBT_VAULT.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp
        );
2022-03-03 16:29:11.692497 (Thread-5): 16:29:11  SQL status: SUCCESS 1 in 0.54 seconds
2022-03-03 16:29:11.693980 (Thread-5): 16:29:11  finished collecting timing info
2022-03-03 16:29:11.694139 (Thread-5): 16:29:11  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-03 16:29:11.884276 (Thread-4): 16:29:11  SQL status: SUCCESS 1 in 0.33 seconds
2022-03-03 16:29:11.885771 (Thread-4): 16:29:11  finished collecting timing info
2022-03-03 16:29:11.885934 (Thread-4): 16:29:11  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-03 16:29:11.959949 (Thread-5): 16:29:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043d1e20>]}
2022-03-03 16:29:11.960349 (Thread-5): 16:29:11  11 of 31 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 5.08s]
2022-03-03 16:29:11.960476 (Thread-5): 16:29:11  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:29:11.960622 (Thread-5): 16:29:11  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:29:11.960851 (Thread-5): 16:29:11  15 of 31 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-03 16:29:11.961089 (Thread-5): 16:29:11  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:11.961179 (Thread-5): 16:29:11  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:29:11.961271 (Thread-5): 16:29:11  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:29:11.976910 (Thread-5): 16:29:11  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:11.990781 (Thread-5): 16:29:11  finished collecting timing info
2022-03-03 16:29:11.990939 (Thread-5): 16:29:11  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:29:11.995299 (Thread-5): 16:29:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:11.995407 (Thread-5): 16:29:11  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_REGION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_REGION_HASHDIFF != stage.CUSTOMER_REGION_HASHDIFF
                OR latest_records.CUSTOMER_REGION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:11.995494 (Thread-5): 16:29:11  Opening a new connection, currently in state closed
2022-03-03 16:29:12.087285 (Thread-6): 16:29:12  SQL status: SUCCESS 0 in 0.43 seconds
2022-03-03 16:29:12.087470 (Thread-6): 16:29:12  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:29:12.087555 (Thread-6): 16:29:12  On model.dbtvault_snowflake_demo.link_order_lineitem: commit;
2022-03-03 16:29:12.355282 (Thread-6): 16:29:12  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:29:12.356819 (Thread-6): 16:29:12  finished collecting timing info
2022-03-03 16:29:12.356986 (Thread-6): 16:29:12  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-03 16:29:12.693758 (Thread-4): 16:29:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043c4ca0>]}
2022-03-03 16:29:12.694187 (Thread-4): 16:29:12  12 of 31 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 5.10s]
2022-03-03 16:29:12.694318 (Thread-4): 16:29:12  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:29:12.694464 (Thread-4): 16:29:12  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:29:12.694653 (Thread-4): 16:29:12  16 of 31 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-03 16:29:12.694894 (Thread-4): 16:29:12  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:12.694984 (Thread-4): 16:29:12  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:29:12.695074 (Thread-4): 16:29:12  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:29:12.711245 (Thread-4): 16:29:12  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:12.726104 (Thread-4): 16:29:12  finished collecting timing info
2022-03-03 16:29:12.726276 (Thread-4): 16:29:12  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:29:12.730952 (Thread-4): 16:29:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:12.731218 (Thread-4): 16:29:12  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:12.731472 (Thread-4): 16:29:12  Opening a new connection, currently in state closed
2022-03-03 16:29:12.765566 (Thread-6): 16:29:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043c8b50>]}
2022-03-03 16:29:12.766050 (Thread-6): 16:29:12  13 of 31 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 4.34s]
2022-03-03 16:29:12.766198 (Thread-6): 16:29:12  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:29:12.766338 (Thread-6): 16:29:12  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:29:12.766525 (Thread-6): 16:29:12  17 of 31 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-03 16:29:12.766761 (Thread-6): 16:29:12  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:12.766850 (Thread-6): 16:29:12  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:29:12.766938 (Thread-6): 16:29:12  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:29:12.784333 (Thread-6): 16:29:12  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:12.797538 (Thread-6): 16:29:12  finished collecting timing info
2022-03-03 16:29:12.797702 (Thread-6): 16:29:12  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:29:12.803864 (Thread-6): 16:29:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:12.804014 (Thread-6): 16:29:12  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

latest_records AS (

    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINEITEM_PK, current_records.LINEITEM_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.LINEITEM_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINEITEM_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINEITEM_PK = source_records.LINEITEM_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.LINEITEM_PK = stage.LINEITEM_PK
                WHERE latest_records.LINEITEM_HASHDIFF != stage.LINEITEM_HASHDIFF
                OR latest_records.LINEITEM_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:12.804136 (Thread-6): 16:29:12  Opening a new connection, currently in state closed
2022-03-03 16:29:12.806668 (Thread-3): 16:29:12  SQL status: SUCCESS 1 in 2.93 seconds
2022-03-03 16:29:12.809935 (Thread-3): 16:29:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:12.810043 (Thread-3): 16:29:12  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp
2022-03-03 16:29:13.038845 (Thread-3): 16:29:13  SQL status: SUCCESS 7 in 0.23 seconds
2022-03-03 16:29:13.042319 (Thread-3): 16:29:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:13.042442 (Thread-3): 16:29:13  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details
2022-03-03 16:29:13.061831 (Thread-126): handling poll request
2022-03-03 16:29:13.062159 (Thread-126): 16:29:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518018b940>]}
2022-03-03 16:29:13.063556 (Thread-126): sending response (<Response 53520 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:13.322722 (Thread-3): 16:29:13  SQL status: SUCCESS 7 in 0.28 seconds
2022-03-03 16:29:13.326980 (Thread-3): 16:29:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:13.327154 (Thread-3): 16:29:13  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUST_NATION_DETAILS"
2022-03-03 16:29:13.579054 (Thread-3): 16:29:13  SQL status: SUCCESS 7 in 0.25 seconds
2022-03-03 16:29:13.581293 (Thread-3): 16:29:13  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:13.594552 (Thread-3): 16:29:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:13.594682 (Thread-3): 16:29:13  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
begin;
2022-03-03 16:29:13.819774 (Thread-3): 16:29:13  SQL status: SUCCESS 1 in 0.22 seconds
2022-03-03 16:29:13.819991 (Thread-3): 16:29:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:13.820078 (Thread-3): 16:29:13  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: insert into DBT_RAW.DBT_VAULT.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp
        );
2022-03-03 16:29:14.541080 (Thread-3): 16:29:14  SQL status: SUCCESS 0 in 0.72 seconds
2022-03-03 16:29:14.541284 (Thread-3): 16:29:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:29:14.541371 (Thread-3): 16:29:14  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: commit;
2022-03-03 16:29:14.866607 (Thread-127): handling poll request
2022-03-03 16:29:14.866964 (Thread-127): 16:29:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801850d0>]}
2022-03-03 16:29:14.867581 (Thread-127): sending response (<Response 6229 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:14.866147 (Thread-3): 16:29:14  SQL status: SUCCESS 1 in 0.32 seconds
2022-03-03 16:29:14.867714 (Thread-3): 16:29:14  finished collecting timing info
2022-03-03 16:29:14.868041 (Thread-3): 16:29:14  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-03 16:29:15.204252 (Thread-3): 16:29:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b140644c0>]}
2022-03-03 16:29:15.204697 (Thread-3): 16:29:15  14 of 31 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 5.39s]
2022-03-03 16:29:15.204832 (Thread-3): 16:29:15  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:29:15.204974 (Thread-3): 16:29:15  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:29:15.205162 (Thread-3): 16:29:15  18 of 31 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-03 16:29:15.205401 (Thread-3): 16:29:15  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:15.205490 (Thread-3): 16:29:15  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:29:15.205580 (Thread-3): 16:29:15  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:29:15.221042 (Thread-3): 16:29:15  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:15.234605 (Thread-3): 16:29:15  finished collecting timing info
2022-03-03 16:29:15.234751 (Thread-3): 16:29:15  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:29:15.239328 (Thread-3): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:15.239434 (Thread-3): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.ORDER_PK = stage.ORDER_PK
                WHERE latest_records.ORDER_HASHDIFF != stage.ORDER_HASHDIFF
                OR latest_records.ORDER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:15.239521 (Thread-3): 16:29:15  Opening a new connection, currently in state closed
2022-03-03 16:29:15.320987 (Thread-5): 16:29:15  SQL status: SUCCESS 1 in 3.33 seconds
2022-03-03 16:29:15.324091 (Thread-5): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:15.324213 (Thread-5): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp
2022-03-03 16:29:15.492573 (Thread-5): 16:29:15  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-03 16:29:15.496189 (Thread-5): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:15.496315 (Thread-5): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_region_details
2022-03-03 16:29:15.736839 (Thread-5): 16:29:15  SQL status: SUCCESS 7 in 0.24 seconds
2022-03-03 16:29:15.742819 (Thread-5): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:15.742963 (Thread-5): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUST_REGION_DETAILS"
2022-03-03 16:29:15.877189 (Thread-4): 16:29:15  SQL status: SUCCESS 1 in 3.15 seconds
2022-03-03 16:29:15.880450 (Thread-4): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:15.880568 (Thread-4): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp
2022-03-03 16:29:15.883329 (Thread-5): 16:29:15  SQL status: SUCCESS 7 in 0.14 seconds
2022-03-03 16:29:15.885391 (Thread-5): 16:29:15  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:15.897549 (Thread-5): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:15.897664 (Thread-5): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
begin;
2022-03-03 16:29:15.979584 (Thread-6): 16:29:15  SQL status: SUCCESS 1 in 3.18 seconds
2022-03-03 16:29:15.983124 (Thread-6): 16:29:15  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:15.983253 (Thread-6): 16:29:15  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp
2022-03-03 16:29:16.064946 (Thread-4): 16:29:16  SQL status: SUCCESS 12 in 0.18 seconds
2022-03-03 16:29:16.068736 (Thread-4): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:16.068851 (Thread-4): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details
2022-03-03 16:29:16.133576 (Thread-6): 16:29:16  SQL status: SUCCESS 16 in 0.15 seconds
2022-03-03 16:29:16.137579 (Thread-6): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:16.137705 (Thread-6): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_lineitem_details
2022-03-03 16:29:16.217510 (Thread-5): 16:29:16  SQL status: SUCCESS 1 in 0.32 seconds
2022-03-03 16:29:16.217728 (Thread-5): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:16.217813 (Thread-5): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: insert into DBT_RAW.DBT_VAULT.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp
        );
2022-03-03 16:29:16.272490 (Thread-4): 16:29:16  SQL status: SUCCESS 12 in 0.2 seconds
2022-03-03 16:29:16.276483 (Thread-4): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:16.276613 (Thread-4): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
2022-03-03 16:29:16.373874 (Thread-6): 16:29:16  SQL status: SUCCESS 16 in 0.24 seconds
2022-03-03 16:29:16.378138 (Thread-6): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:16.378257 (Thread-6): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_LINEITEM_DETAILS"
2022-03-03 16:29:16.518583 (Thread-4): 16:29:16  SQL status: SUCCESS 12 in 0.24 seconds
2022-03-03 16:29:16.528651 (Thread-4): 16:29:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:16.543517 (Thread-4): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:16.543668 (Thread-4): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
2022-03-03 16:29:16.555207 (Thread-6): 16:29:16  SQL status: SUCCESS 16 in 0.18 seconds
2022-03-03 16:29:16.558101 (Thread-6): 16:29:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:16.572018 (Thread-6): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:16.572146 (Thread-6): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
begin;
2022-03-03 16:29:16.718992 (Thread-128): handling poll request
2022-03-03 16:29:16.719369 (Thread-128): 16:29:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800fb9a0>]}
2022-03-03 16:29:16.720368 (Thread-128): sending response (<Response 28927 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:16.755233 (Thread-5): 16:29:16  SQL status: SUCCESS 0 in 0.54 seconds
2022-03-03 16:29:16.755436 (Thread-5): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:29:16.755520 (Thread-5): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: commit;
2022-03-03 16:29:16.817465 (Thread-6): 16:29:16  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:29:16.817692 (Thread-6): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:16.817783 (Thread-6): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: insert into DBT_RAW.DBT_VAULT.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp
        );
2022-03-03 16:29:16.911827 (Thread-4): 16:29:16  SQL status: SUCCESS 1 in 0.37 seconds
2022-03-03 16:29:16.912086 (Thread-4): 16:29:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:16.912175 (Thread-4): 16:29:16  On model.dbtvault_snowflake_demo.sat_order_customer_details: merge into DBT_RAW.DBT_VAULT.sat_order_customer_details as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ACCBAL" = DBT_INTERNAL_SOURCE."CUSTOMER_ACCBAL","CUSTOMER_MKTSEGMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_MKTSEGMENT","CUSTOMER_COMMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_COMMENT","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 16:29:17.182775 (Thread-5): 16:29:17  SQL status: SUCCESS 1 in 0.43 seconds
2022-03-03 16:29:17.184296 (Thread-5): 16:29:17  finished collecting timing info
2022-03-03 16:29:17.184464 (Thread-5): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-03 16:29:17.314955 (Thread-6): 16:29:17  SQL status: SUCCESS 0 in 0.5 seconds
2022-03-03 16:29:17.315157 (Thread-6): 16:29:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:29:17.315249 (Thread-6): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: commit;
2022-03-03 16:29:17.466727 (Thread-3): 16:29:17  SQL status: SUCCESS 1 in 2.23 seconds
2022-03-03 16:29:17.470441 (Thread-3): 16:29:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:17.470562 (Thread-3): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp
2022-03-03 16:29:17.517766 (Thread-5): 16:29:17  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043532b0>]}
2022-03-03 16:29:17.518166 (Thread-5): 16:29:17  15 of 31 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 5.56s]
2022-03-03 16:29:17.518292 (Thread-5): 16:29:17  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:29:17.518438 (Thread-5): 16:29:17  Began running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:29:17.518627 (Thread-5): 16:29:17  19 of 31 START table model DBT_VAULT.v_stg_inventory............................ [RUN]
2022-03-03 16:29:17.518866 (Thread-5): 16:29:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:29:17.518956 (Thread-5): 16:29:17  Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:29:17.519047 (Thread-5): 16:29:17  Compiling model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:29:17.530670 (Thread-5): 16:29:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:29:17.530787 (Thread-5): 16:29:17  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-03 16:29:17.530874 (Thread-5): 16:29:17  Opening a new connection, currently in state closed
2022-03-03 16:29:17.595493 (Thread-4): 16:29:17  SQL status: SUCCESS 0 in 0.68 seconds
2022-03-03 16:29:17.595696 (Thread-4): 16:29:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:29:17.595784 (Thread-4): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
2022-03-03 16:29:17.612364 (Thread-3): 16:29:17  SQL status: SUCCESS 12 in 0.14 seconds
2022-03-03 16:29:17.616088 (Thread-3): 16:29:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:17.616217 (Thread-3): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_order_details
2022-03-03 16:29:17.680397 (Thread-6): 16:29:17  SQL status: SUCCESS 1 in 0.36 seconds
2022-03-03 16:29:17.681977 (Thread-6): 16:29:17  finished collecting timing info
2022-03-03 16:29:17.682146 (Thread-6): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-03 16:29:17.789300 (Thread-3): 16:29:17  SQL status: SUCCESS 12 in 0.17 seconds
2022-03-03 16:29:17.793170 (Thread-3): 16:29:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:17.793297 (Thread-3): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_ORDER_DETAILS"
2022-03-03 16:29:17.965803 (Thread-4): 16:29:17  SQL status: SUCCESS 1 in 0.37 seconds
2022-03-03 16:29:17.967343 (Thread-4): 16:29:17  finished collecting timing info
2022-03-03 16:29:17.967505 (Thread-4): 16:29:17  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-03 16:29:18.001871 (Thread-3): 16:29:18  SQL status: SUCCESS 12 in 0.21 seconds
2022-03-03 16:29:18.005228 (Thread-3): 16:29:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:18.018517 (Thread-3): 16:29:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:18.018651 (Thread-3): 16:29:18  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
begin;
2022-03-03 16:29:18.027035 (Thread-6): 16:29:18  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b14110a30>]}
2022-03-03 16:29:18.027414 (Thread-6): 16:29:18  17 of 31 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 5.26s]
2022-03-03 16:29:18.027540 (Thread-6): 16:29:18  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:29:18.216037 (Thread-3): 16:29:18  SQL status: SUCCESS 1 in 0.2 seconds
2022-03-03 16:29:18.216272 (Thread-3): 16:29:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:18.216362 (Thread-3): 16:29:18  On model.dbtvault_snowflake_demo.sat_order_order_details: insert into DBT_RAW.DBT_VAULT.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp
        );
2022-03-03 16:29:18.231833 (Thread-4): 16:29:18  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0451fbb0>]}
2022-03-03 16:29:18.232216 (Thread-4): 16:29:18  16 of 31 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 5.54s]
2022-03-03 16:29:18.232341 (Thread-4): 16:29:18  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:29:18.321802 (Thread-5): 16:29:18  SQL status: SUCCESS 24 in 0.79 seconds
2022-03-03 16:29:18.328194 (Thread-5): 16:29:18  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:29:18.328330 (Thread-5): 16:29:18  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-03 16:29:18.475905 (Thread-5): 16:29:18  SQL status: SUCCESS 24 in 0.15 seconds
2022-03-03 16:29:18.490946 (Thread-5): 16:29:18  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:29:18.497380 (Thread-129): handling poll request
2022-03-03 16:29:18.497692 (Thread-129): 16:29:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518010d3d0>]}
2022-03-03 16:29:18.498668 (Thread-129): sending response (<Response 29245 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:18.519820 (Thread-5): 16:29:18  finished collecting timing info
2022-03-03 16:29:18.520028 (Thread-5): 16:29:18  Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:29:18.522860 (Thread-5): 16:29:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:29:18.524497 (Thread-3): 16:29:18  SQL status: SUCCESS 0 in 0.31 seconds
2022-03-03 16:29:18.524691 (Thread-3): 16:29:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:29:18.524784 (Thread-3): 16:29:18  On model.dbtvault_snowflake_demo.sat_order_order_details: commit;
2022-03-03 16:29:18.555129 (Thread-5): 16:29:18  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:29:18.555297 (Thread-5): 16:29:18  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_inventory  as
      (








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
      );
2022-03-03 16:29:18.945051 (Thread-3): 16:29:18  SQL status: SUCCESS 1 in 0.42 seconds
2022-03-03 16:29:18.946620 (Thread-3): 16:29:18  finished collecting timing info
2022-03-03 16:29:18.946776 (Thread-3): 16:29:18  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-03 16:29:19.179328 (Thread-3): 16:29:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043289d0>]}
2022-03-03 16:29:19.179744 (Thread-3): 16:29:19  18 of 31 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 3.97s]
2022-03-03 16:29:19.179872 (Thread-3): 16:29:19  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:29:20.400319 (Thread-130): handling poll request
2022-03-03 16:29:20.400730 (Thread-130): 16:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518010db80>]}
2022-03-03 16:29:20.431591 (Thread-5): 16:29:20  SQL status: SUCCESS 1 in 1.88 seconds
2022-03-03 16:29:20.434598 (Thread-130): sending response (<Response 13698 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:20.433058 (Thread-5): 16:29:20  finished collecting timing info
2022-03-03 16:29:20.433218 (Thread-5): 16:29:20  On model.dbtvault_snowflake_demo.v_stg_inventory: Close
2022-03-03 16:29:20.668565 (Thread-5): 16:29:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0458a940>]}
2022-03-03 16:29:20.669045 (Thread-5): 16:29:20  19 of 31 OK created table model DBT_VAULT.v_stg_inventory....................... [SUCCESS 1 in 3.15s]
2022-03-03 16:29:20.669185 (Thread-5): 16:29:20  Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:29:20.670571 (Thread-6): 16:29:20  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:29:20.670838 (Thread-6): 16:29:20  20 of 31 START incremental model DBT_VAULT.hub_nation........................... [RUN]
2022-03-03 16:29:20.671105 (Thread-6): 16:29:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:20.671200 (Thread-6): 16:29:20  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:29:20.671294 (Thread-6): 16:29:20  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:29:20.675675 (Thread-4): 16:29:20  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:29:20.675931 (Thread-4): 16:29:20  21 of 31 START incremental model DBT_VAULT.hub_part............................. [RUN]
2022-03-03 16:29:20.676193 (Thread-4): 16:29:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:20.676325 (Thread-4): 16:29:20  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:29:20.676456 (Thread-4): 16:29:20  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:29:20.680829 (Thread-3): 16:29:20  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:29:20.681152 (Thread-3): 16:29:20  22 of 31 START incremental model DBT_VAULT.hub_region........................... [RUN]
2022-03-03 16:29:20.681513 (Thread-3): 16:29:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:20.681653 (Thread-3): 16:29:20  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:29:20.681783 (Thread-3): 16:29:20  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:29:20.685837 (Thread-5): 16:29:20  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:29:20.686068 (Thread-5): 16:29:20  23 of 31 START incremental model DBT_VAULT.hub_supplier......................... [RUN]
2022-03-03 16:29:20.686303 (Thread-5): 16:29:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:20.686392 (Thread-5): 16:29:20  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:29:20.686476 (Thread-5): 16:29:20  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:29:20.707665 (Thread-4): 16:29:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:20.715327 (Thread-6): 16:29:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:20.719126 (Thread-3): 16:29:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:20.719651 (Thread-5): 16:29:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:20.727105 (Thread-4): 16:29:20  finished collecting timing info
2022-03-03 16:29:20.727259 (Thread-4): 16:29:20  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:29:20.733394 (Thread-4): 16:29:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:20.733506 (Thread-4): 16:29:20  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:20.733595 (Thread-4): 16:29:20  Opening a new connection, currently in state closed
2022-03-03 16:29:20.738594 (Thread-3): 16:29:20  finished collecting timing info
2022-03-03 16:29:20.738755 (Thread-3): 16:29:20  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:29:20.743225 (Thread-3): 16:29:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:20.743329 (Thread-3): 16:29:20  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:20.743414 (Thread-3): 16:29:20  Opening a new connection, currently in state closed
2022-03-03 16:29:20.744424 (Thread-6): 16:29:20  finished collecting timing info
2022-03-03 16:29:20.744562 (Thread-6): 16:29:20  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:29:20.749178 (Thread-6): 16:29:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:20.749283 (Thread-6): 16:29:20  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:20.749366 (Thread-6): 16:29:20  Opening a new connection, currently in state closed
2022-03-03 16:29:20.750339 (Thread-5): 16:29:20  finished collecting timing info
2022-03-03 16:29:20.750476 (Thread-5): 16:29:20  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:29:20.754702 (Thread-5): 16:29:20  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:20.754806 (Thread-5): 16:29:20  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:20.754890 (Thread-5): 16:29:20  Opening a new connection, currently in state closed
2022-03-03 16:29:22.464706 (Thread-131): handling poll request
2022-03-03 16:29:22.465099 (Thread-131): 16:29:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5180116f10>]}
2022-03-03 16:29:22.466134 (Thread-131): sending response (<Response 27232 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:23.505123 (Thread-6): 16:29:23  SQL status: SUCCESS 1 in 2.76 seconds
2022-03-03 16:29:23.510961 (Thread-6): 16:29:23  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:23.511164 (Thread-6): 16:29:23  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp
2022-03-03 16:29:23.747154 (Thread-6): 16:29:23  SQL status: SUCCESS 4 in 0.24 seconds
2022-03-03 16:29:23.752865 (Thread-6): 16:29:23  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:23.753048 (Thread-6): 16:29:23  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DBT_RAW.DBT_VAULT.hub_nation
2022-03-03 16:29:23.810392 (Thread-5): 16:29:23  SQL status: SUCCESS 1 in 3.06 seconds
2022-03-03 16:29:23.814779 (Thread-5): 16:29:23  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:23.814967 (Thread-5): 16:29:23  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp
2022-03-03 16:29:23.878722 (Thread-6): 16:29:23  SQL status: SUCCESS 4 in 0.13 seconds
2022-03-03 16:29:23.882398 (Thread-6): 16:29:23  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:23.882512 (Thread-6): 16:29:23  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_NATION"
2022-03-03 16:29:23.991965 (Thread-5): 16:29:23  SQL status: SUCCESS 4 in 0.18 seconds
2022-03-03 16:29:23.995588 (Thread-5): 16:29:23  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:23.995704 (Thread-5): 16:29:23  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DBT_RAW.DBT_VAULT.hub_supplier
2022-03-03 16:29:24.095073 (Thread-6): 16:29:24  SQL status: SUCCESS 4 in 0.21 seconds
2022-03-03 16:29:24.097183 (Thread-6): 16:29:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:24.111417 (Thread-6): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:24.111536 (Thread-6): 16:29:24  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
2022-03-03 16:29:24.215910 (Thread-5): 16:29:24  SQL status: SUCCESS 4 in 0.22 seconds
2022-03-03 16:29:24.219316 (Thread-5): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:24.219431 (Thread-5): 16:29:24  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_SUPPLIER"
2022-03-03 16:29:24.252968 (Thread-132): handling poll request
2022-03-03 16:29:24.253314 (Thread-132): 16:29:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5180123ac0>]}
2022-03-03 16:29:24.253976 (Thread-132): sending response (<Response 9570 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:24.364068 (Thread-6): 16:29:24  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:29:24.364275 (Thread-6): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:24.364362 (Thread-6): 16:29:24  On model.dbtvault_snowflake_demo.hub_nation: insert into DBT_RAW.DBT_VAULT.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp
        );
2022-03-03 16:29:24.377207 (Thread-3): 16:29:24  SQL status: SUCCESS 1 in 3.63 seconds
2022-03-03 16:29:24.380547 (Thread-3): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:24.380683 (Thread-3): 16:29:24  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DBT_RAW.DBT_VAULT.hub_region__dbt_tmp
2022-03-03 16:29:24.393505 (Thread-5): 16:29:24  SQL status: SUCCESS 4 in 0.17 seconds
2022-03-03 16:29:24.395403 (Thread-5): 16:29:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:24.411133 (Thread-5): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:24.411251 (Thread-5): 16:29:24  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
2022-03-03 16:29:24.485462 (Thread-4): 16:29:24  SQL status: SUCCESS 1 in 3.75 seconds
2022-03-03 16:29:24.488997 (Thread-4): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:24.489113 (Thread-4): 16:29:24  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DBT_RAW.DBT_VAULT.hub_part__dbt_tmp
2022-03-03 16:29:24.574208 (Thread-3): 16:29:24  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-03 16:29:24.577537 (Thread-3): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:24.577650 (Thread-3): 16:29:24  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DBT_RAW.DBT_VAULT.hub_region
2022-03-03 16:29:24.745994 (Thread-5): 16:29:24  SQL status: SUCCESS 1 in 0.33 seconds
2022-03-03 16:29:24.746213 (Thread-5): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:24.746301 (Thread-5): 16:29:24  On model.dbtvault_snowflake_demo.hub_supplier: insert into DBT_RAW.DBT_VAULT.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp
        );
2022-03-03 16:29:24.767395 (Thread-3): 16:29:24  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-03 16:29:24.770927 (Thread-3): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:24.771048 (Thread-3): 16:29:24  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_REGION"
2022-03-03 16:29:24.779226 (Thread-4): 16:29:24  SQL status: SUCCESS 4 in 0.29 seconds
2022-03-03 16:29:24.784507 (Thread-4): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:24.784672 (Thread-4): 16:29:24  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DBT_RAW.DBT_VAULT.hub_part
2022-03-03 16:29:24.793914 (Thread-6): 16:29:24  SQL status: SUCCESS 0 in 0.43 seconds
2022-03-03 16:29:24.794063 (Thread-6): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:29:24.794145 (Thread-6): 16:29:24  On model.dbtvault_snowflake_demo.hub_nation: commit;
2022-03-03 16:29:24.940285 (Thread-3): 16:29:24  SQL status: SUCCESS 4 in 0.17 seconds
2022-03-03 16:29:24.942431 (Thread-3): 16:29:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:24.957893 (Thread-3): 16:29:24  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:24.958078 (Thread-3): 16:29:24  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
2022-03-03 16:29:25.021561 (Thread-4): 16:29:25  SQL status: SUCCESS 4 in 0.24 seconds
2022-03-03 16:29:25.025057 (Thread-4): 16:29:25  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:25.025174 (Thread-4): 16:29:25  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_PART"
2022-03-03 16:29:25.255788 (Thread-6): 16:29:25  SQL status: SUCCESS 1 in 0.46 seconds
2022-03-03 16:29:25.257365 (Thread-6): 16:29:25  finished collecting timing info
2022-03-03 16:29:25.257533 (Thread-6): 16:29:25  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-03 16:29:25.345495 (Thread-5): 16:29:25  SQL status: SUCCESS 0 in 0.6 seconds
2022-03-03 16:29:25.345693 (Thread-5): 16:29:25  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:29:25.345779 (Thread-5): 16:29:25  On model.dbtvault_snowflake_demo.hub_supplier: commit;
2022-03-03 16:29:25.523275 (Thread-4): 16:29:25  SQL status: SUCCESS 4 in 0.5 seconds
2022-03-03 16:29:25.525458 (Thread-4): 16:29:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:25.540352 (Thread-4): 16:29:25  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:25.540488 (Thread-4): 16:29:25  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
2022-03-03 16:29:25.587144 (Thread-3): 16:29:25  SQL status: SUCCESS 1 in 0.63 seconds
2022-03-03 16:29:25.587327 (Thread-3): 16:29:25  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:25.587412 (Thread-3): 16:29:25  On model.dbtvault_snowflake_demo.hub_region: insert into DBT_RAW.DBT_VAULT.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_region__dbt_tmp
        );
2022-03-03 16:29:25.749214 (Thread-6): 16:29:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b045e27c0>]}
2022-03-03 16:29:25.749655 (Thread-6): 16:29:25  20 of 31 OK created incremental model DBT_VAULT.hub_nation...................... [SUCCESS 1 in 5.08s]
2022-03-03 16:29:25.749792 (Thread-6): 16:29:25  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:29:25.749940 (Thread-6): 16:29:25  Began running node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:29:25.750128 (Thread-6): 16:29:25  24 of 31 START incremental model DBT_VAULT.link_inventory....................... [RUN]
2022-03-03 16:29:25.750369 (Thread-6): 16:29:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:25.750458 (Thread-6): 16:29:25  Began compiling node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:29:25.750550 (Thread-6): 16:29:25  Compiling model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:29:25.759206 (Thread-6): 16:29:25  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:25.772708 (Thread-6): 16:29:25  finished collecting timing info
2022-03-03 16:29:25.772865 (Thread-6): 16:29:25  Began executing node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:29:25.776894 (Thread-6): 16:29:25  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:25.777004 (Thread-6): 16:29:25  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:25.777094 (Thread-6): 16:29:25  Opening a new connection, currently in state closed
2022-03-03 16:29:25.940968 (Thread-5): 16:29:25  SQL status: SUCCESS 1 in 0.6 seconds
2022-03-03 16:29:25.942874 (Thread-5): 16:29:25  finished collecting timing info
2022-03-03 16:29:25.943166 (Thread-5): 16:29:25  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-03 16:29:25.955183 (Thread-4): 16:29:25  SQL status: SUCCESS 1 in 0.41 seconds
2022-03-03 16:29:25.955347 (Thread-4): 16:29:25  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:25.955431 (Thread-4): 16:29:25  On model.dbtvault_snowflake_demo.hub_part: insert into DBT_RAW.DBT_VAULT.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_part__dbt_tmp
        );
2022-03-03 16:29:26.097551 (Thread-3): 16:29:26  SQL status: SUCCESS 0 in 0.51 seconds
2022-03-03 16:29:26.097742 (Thread-3): 16:29:26  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:29:26.097829 (Thread-3): 16:29:26  On model.dbtvault_snowflake_demo.hub_region: commit;
2022-03-03 16:29:26.137064 (Thread-133): handling poll request
2022-03-03 16:29:26.137409 (Thread-133): 16:29:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800bd850>]}
2022-03-03 16:29:26.138501 (Thread-133): sending response (<Response 30378 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:26.359460 (Thread-5): 16:29:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0438d760>]}
2022-03-03 16:29:26.359878 (Thread-5): 16:29:26  23 of 31 OK created incremental model DBT_VAULT.hub_supplier.................... [SUCCESS 1 in 5.67s]
2022-03-03 16:29:26.360010 (Thread-5): 16:29:26  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:29:26.360161 (Thread-5): 16:29:26  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:29:26.360354 (Thread-5): 16:29:26  25 of 31 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-03 16:29:26.360616 (Thread-5): 16:29:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:26.360746 (Thread-5): 16:29:26  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:29:26.360840 (Thread-5): 16:29:26  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:29:26.372819 (Thread-5): 16:29:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:26.385604 (Thread-5): 16:29:26  finished collecting timing info
2022-03-03 16:29:26.385750 (Thread-5): 16:29:26  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:29:26.390219 (Thread-5): 16:29:26  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:26.390326 (Thread-5): 16:29:26  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_nation_region AS d
    ON a.NATION_REGION_PK = d.NATION_REGION_PK
    WHERE d.NATION_REGION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:26.390413 (Thread-5): 16:29:26  Opening a new connection, currently in state closed
2022-03-03 16:29:26.498383 (Thread-4): 16:29:26  SQL status: SUCCESS 0 in 0.54 seconds
2022-03-03 16:29:26.498575 (Thread-4): 16:29:26  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:29:26.498660 (Thread-4): 16:29:26  On model.dbtvault_snowflake_demo.hub_part: commit;
2022-03-03 16:29:26.519600 (Thread-3): 16:29:26  SQL status: SUCCESS 1 in 0.42 seconds
2022-03-03 16:29:26.521157 (Thread-3): 16:29:26  finished collecting timing info
2022-03-03 16:29:26.521314 (Thread-3): 16:29:26  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-03 16:29:26.833428 (Thread-3): 16:29:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b1406cb20>]}
2022-03-03 16:29:26.833866 (Thread-3): 16:29:26  22 of 31 OK created incremental model DBT_VAULT.hub_region...................... [SUCCESS 1 in 6.15s]
2022-03-03 16:29:26.834002 (Thread-3): 16:29:26  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:29:26.834149 (Thread-3): 16:29:26  Began running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:29:26.834339 (Thread-3): 16:29:26  26 of 31 START incremental model DBT_VAULT.link_supplier_nation................. [RUN]
2022-03-03 16:29:26.834587 (Thread-3): 16:29:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:26.834677 (Thread-3): 16:29:26  Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:29:26.834770 (Thread-3): 16:29:26  Compiling model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:29:26.843608 (Thread-3): 16:29:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:26.856898 (Thread-3): 16:29:26  finished collecting timing info
2022-03-03 16:29:26.857048 (Thread-3): 16:29:26  Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:29:26.861019 (Thread-3): 16:29:26  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:26.861127 (Thread-3): 16:29:26  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:26.861214 (Thread-3): 16:29:26  Opening a new connection, currently in state closed
2022-03-03 16:29:26.880677 (Thread-4): 16:29:26  SQL status: SUCCESS 1 in 0.38 seconds
2022-03-03 16:29:26.882443 (Thread-4): 16:29:26  finished collecting timing info
2022-03-03 16:29:26.882590 (Thread-4): 16:29:26  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-03 16:29:27.189042 (Thread-4): 16:29:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b044ae8e0>]}
2022-03-03 16:29:27.189460 (Thread-4): 16:29:27  21 of 31 OK created incremental model DBT_VAULT.hub_part........................ [SUCCESS 1 in 6.51s]
2022-03-03 16:29:27.189591 (Thread-4): 16:29:27  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:29:27.189806 (Thread-4): 16:29:27  Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:29:27.190025 (Thread-4): 16:29:27  27 of 31 START incremental model DBT_VAULT.sat_inv_inventory_details............ [RUN]
2022-03-03 16:29:27.190271 (Thread-4): 16:29:27  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:27.190358 (Thread-4): 16:29:27  Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:29:27.190446 (Thread-4): 16:29:27  Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:29:27.206831 (Thread-4): 16:29:27  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:27.226406 (Thread-4): 16:29:27  finished collecting timing info
2022-03-03 16:29:27.226563 (Thread-4): 16:29:27  Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:29:27.231630 (Thread-4): 16:29:27  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:27.231753 (Thread-4): 16:29:27  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (

    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.INVENTORY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
                WHERE latest_records.INVENTORY_HASHDIFF != stage.INVENTORY_HASHDIFF
                OR latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:27.231840 (Thread-4): 16:29:27  Opening a new connection, currently in state closed
2022-03-03 16:29:27.777839 (Thread-6): 16:29:27  SQL status: SUCCESS 1 in 2.0 seconds
2022-03-03 16:29:27.783378 (Thread-6): 16:29:27  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:27.783583 (Thread-6): 16:29:27  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
2022-03-03 16:29:27.942392 (Thread-6): 16:29:27  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:29:27.946722 (Thread-6): 16:29:27  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:27.946849 (Thread-6): 16:29:27  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory
2022-03-03 16:29:27.981416 (Thread-134): handling poll request
2022-03-03 16:29:27.981980 (Thread-134): 16:29:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800bd6d0>]}
2022-03-03 16:29:27.982966 (Thread-134): sending response (<Response 29227 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:28.117386 (Thread-6): 16:29:28  SQL status: SUCCESS 5 in 0.17 seconds
2022-03-03 16:29:28.124328 (Thread-6): 16:29:28  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:28.124526 (Thread-6): 16:29:28  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY"
2022-03-03 16:29:28.308167 (Thread-6): 16:29:28  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-03 16:29:28.310540 (Thread-6): 16:29:28  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:28.326052 (Thread-6): 16:29:28  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:28.326225 (Thread-6): 16:29:28  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
2022-03-03 16:29:28.514130 (Thread-6): 16:29:28  SQL status: SUCCESS 1 in 0.19 seconds
2022-03-03 16:29:28.514378 (Thread-6): 16:29:28  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:28.514466 (Thread-6): 16:29:28  On model.dbtvault_snowflake_demo.link_inventory: insert into DBT_RAW.DBT_VAULT.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
        );
2022-03-03 16:29:28.934228 (Thread-5): 16:29:28  SQL status: SUCCESS 1 in 2.54 seconds
2022-03-03 16:29:28.937544 (Thread-5): 16:29:28  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:28.937667 (Thread-5): 16:29:28  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp
2022-03-03 16:29:29.177612 (Thread-5): 16:29:29  SQL status: SUCCESS 5 in 0.24 seconds
2022-03-03 16:29:29.181156 (Thread-5): 16:29:29  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:29.181278 (Thread-5): 16:29:29  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DBT_RAW.DBT_VAULT.link_nation_region
2022-03-03 16:29:29.262989 (Thread-6): 16:29:29  SQL status: SUCCESS 0 in 0.75 seconds
2022-03-03 16:29:29.263212 (Thread-6): 16:29:29  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:29:29.263311 (Thread-6): 16:29:29  On model.dbtvault_snowflake_demo.link_inventory: commit;
2022-03-03 16:29:29.389333 (Thread-5): 16:29:29  SQL status: SUCCESS 5 in 0.21 seconds
2022-03-03 16:29:29.393102 (Thread-5): 16:29:29  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:29.393224 (Thread-5): 16:29:29  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_NATION_REGION"
2022-03-03 16:29:29.680206 (Thread-6): 16:29:29  SQL status: SUCCESS 1 in 0.42 seconds
2022-03-03 16:29:29.682241 (Thread-6): 16:29:29  finished collecting timing info
2022-03-03 16:29:29.682512 (Thread-6): 16:29:29  On model.dbtvault_snowflake_demo.link_inventory: Close
2022-03-03 16:29:29.783587 (Thread-135): handling poll request
2022-03-03 16:29:29.783949 (Thread-135): 16:29:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800d4340>]}
2022-03-03 16:29:29.784706 (Thread-135): sending response (<Response 10840 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:29.935800 (Thread-6): 16:29:29  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b140d7850>]}
2022-03-03 16:29:29.936479 (Thread-6): 16:29:29  24 of 31 OK created incremental model DBT_VAULT.link_inventory.................. [SUCCESS 1 in 4.19s]
2022-03-03 16:29:29.936732 (Thread-6): 16:29:29  Finished running node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:29:29.937009 (Thread-6): 16:29:29  Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:29:29.937327 (Thread-6): 16:29:29  28 of 31 START incremental model DBT_VAULT.sat_inv_part_details................. [RUN]
2022-03-03 16:29:29.937688 (Thread-6): 16:29:29  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:29.937792 (Thread-6): 16:29:29  Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:29:29.937887 (Thread-6): 16:29:29  Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:29:29.961231 (Thread-6): 16:29:29  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:29.974666 (Thread-6): 16:29:29  finished collecting timing info
2022-03-03 16:29:29.974844 (Thread-6): 16:29:29  Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:29:29.979669 (Thread-6): 16:29:29  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:29.979788 (Thread-6): 16:29:29  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (

    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.PART_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.PART_PK = stage.PART_PK
                WHERE latest_records.PART_HASHDIFF != stage.PART_HASHDIFF
                OR latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:29.980012 (Thread-6): 16:29:29  Opening a new connection, currently in state closed
2022-03-03 16:29:30.694139 (Thread-3): 16:29:30  SQL status: SUCCESS 1 in 3.83 seconds
2022-03-03 16:29:30.698638 (Thread-3): 16:29:30  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:30.698827 (Thread-3): 16:29:30  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
2022-03-03 16:29:30.709285 (Thread-5): 16:29:30  SQL status: SUCCESS 5 in 1.32 seconds
2022-03-03 16:29:30.712001 (Thread-5): 16:29:30  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:30.725110 (Thread-5): 16:29:30  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:30.725254 (Thread-5): 16:29:30  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
begin;
2022-03-03 16:29:30.858590 (Thread-3): 16:29:30  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:29:30.862266 (Thread-3): 16:29:30  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:30.862382 (Thread-3): 16:29:30  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation
2022-03-03 16:29:30.876266 (Thread-5): 16:29:30  SQL status: SUCCESS 1 in 0.15 seconds
2022-03-03 16:29:30.876425 (Thread-5): 16:29:30  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:30.876508 (Thread-5): 16:29:30  On model.dbtvault_snowflake_demo.link_nation_region: insert into DBT_RAW.DBT_VAULT.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp
        );
2022-03-03 16:29:31.018617 (Thread-3): 16:29:31  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:29:31.022566 (Thread-3): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:31.022693 (Thread-3): 16:29:31  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_SUPPLIER_NATION"
2022-03-03 16:29:31.264571 (Thread-3): 16:29:31  SQL status: SUCCESS 5 in 0.24 seconds
2022-03-03 16:29:31.266687 (Thread-3): 16:29:31  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:31.280080 (Thread-3): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:31.280202 (Thread-3): 16:29:31  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
2022-03-03 16:29:31.483163 (Thread-4): 16:29:31  SQL status: SUCCESS 1 in 4.25 seconds
2022-03-03 16:29:31.486553 (Thread-4): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:31.486671 (Thread-4): 16:29:31  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
2022-03-03 16:29:31.552874 (Thread-3): 16:29:31  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:29:31.553057 (Thread-3): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:31.553142 (Thread-3): 16:29:31  On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DBT_RAW.DBT_VAULT.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
        );
2022-03-03 16:29:31.672833 (Thread-4): 16:29:31  SQL status: SUCCESS 8 in 0.19 seconds
2022-03-03 16:29:31.676614 (Thread-4): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:31.676759 (Thread-4): 16:29:31  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details
2022-03-03 16:29:31.709396 (Thread-136): handling poll request
2022-03-03 16:29:31.709732 (Thread-136): 16:29:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800e4610>]}
2022-03-03 16:29:31.710738 (Thread-136): sending response (<Response 21199 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:31.831683 (Thread-4): 16:29:31  SQL status: SUCCESS 8 in 0.15 seconds
2022-03-03 16:29:31.837407 (Thread-4): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:31.837544 (Thread-4): 16:29:31  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_INVENTORY_DETAILS"
2022-03-03 16:29:31.887906 (Thread-5): 16:29:31  SQL status: SUCCESS 0 in 1.01 seconds
2022-03-03 16:29:31.888078 (Thread-5): 16:29:31  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:29:31.888160 (Thread-5): 16:29:31  On model.dbtvault_snowflake_demo.link_nation_region: commit;
2022-03-03 16:29:32.029228 (Thread-3): 16:29:32  SQL status: SUCCESS 0 in 0.48 seconds
2022-03-03 16:29:32.029422 (Thread-3): 16:29:32  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:29:32.029508 (Thread-3): 16:29:32  On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
2022-03-03 16:29:32.195237 (Thread-4): 16:29:32  SQL status: SUCCESS 8 in 0.36 seconds
2022-03-03 16:29:32.197939 (Thread-4): 16:29:32  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:32.212531 (Thread-4): 16:29:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:32.212710 (Thread-4): 16:29:32  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
2022-03-03 16:29:32.461236 (Thread-4): 16:29:32  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:29:32.461453 (Thread-4): 16:29:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:32.461539 (Thread-4): 16:29:32  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DBT_RAW.DBT_VAULT.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
        );
2022-03-03 16:29:32.566545 (Thread-5): 16:29:32  SQL status: SUCCESS 1 in 0.68 seconds
2022-03-03 16:29:32.568262 (Thread-5): 16:29:32  finished collecting timing info
2022-03-03 16:29:32.568431 (Thread-5): 16:29:32  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-03 16:29:32.641311 (Thread-3): 16:29:32  SQL status: SUCCESS 1 in 0.61 seconds
2022-03-03 16:29:32.642760 (Thread-3): 16:29:32  finished collecting timing info
2022-03-03 16:29:32.642927 (Thread-3): 16:29:32  On model.dbtvault_snowflake_demo.link_supplier_nation: Close
2022-03-03 16:29:32.901641 (Thread-4): 16:29:32  SQL status: SUCCESS 0 in 0.44 seconds
2022-03-03 16:29:32.901846 (Thread-4): 16:29:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:29:32.901933 (Thread-4): 16:29:32  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
2022-03-03 16:29:32.925115 (Thread-5): 16:29:32  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b045a02b0>]}
2022-03-03 16:29:32.925591 (Thread-5): 16:29:32  25 of 31 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 6.56s]
2022-03-03 16:29:32.925734 (Thread-5): 16:29:32  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:29:32.925878 (Thread-5): 16:29:32  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:29:32.926064 (Thread-5): 16:29:32  29 of 31 START incremental model DBT_VAULT.sat_inv_supp_nation_details.......... [RUN]
2022-03-03 16:29:32.926345 (Thread-5): 16:29:32  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:32.926443 (Thread-5): 16:29:32  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:29:32.926601 (Thread-5): 16:29:32  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:29:32.941732 (Thread-5): 16:29:32  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:32.954035 (Thread-3): 16:29:32  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b04371490>]}
2022-03-03 16:29:32.954385 (Thread-3): 16:29:32  26 of 31 OK created incremental model DBT_VAULT.link_supplier_nation............ [SUCCESS 1 in 6.12s]
2022-03-03 16:29:32.954505 (Thread-3): 16:29:32  Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:29:32.954643 (Thread-3): 16:29:32  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:29:32.954823 (Thread-3): 16:29:32  30 of 31 START incremental model DBT_VAULT.sat_inv_supp_region_details.......... [RUN]
2022-03-03 16:29:32.955047 (Thread-3): 16:29:32  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:32.955135 (Thread-3): 16:29:32  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:29:32.955222 (Thread-3): 16:29:32  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:29:32.959621 (Thread-5): 16:29:32  finished collecting timing info
2022-03-03 16:29:32.959781 (Thread-5): 16:29:32  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:29:32.964552 (Thread-5): 16:29:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:32.964692 (Thread-5): 16:29:32  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:32.964839 (Thread-5): 16:29:32  Opening a new connection, currently in state closed
2022-03-03 16:29:32.974679 (Thread-3): 16:29:32  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:32.990332 (Thread-3): 16:29:32  finished collecting timing info
2022-03-03 16:29:32.990491 (Thread-3): 16:29:32  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:29:32.996622 (Thread-3): 16:29:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:32.996852 (Thread-3): 16:29:32  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:32.996988 (Thread-3): 16:29:32  Opening a new connection, currently in state closed
2022-03-03 16:29:33.459672 (Thread-4): 16:29:33  SQL status: SUCCESS 1 in 0.56 seconds
2022-03-03 16:29:33.461348 (Thread-4): 16:29:33  finished collecting timing info
2022-03-03 16:29:33.461524 (Thread-4): 16:29:33  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
2022-03-03 16:29:33.463885 (Thread-6): 16:29:33  SQL status: SUCCESS 1 in 3.48 seconds
2022-03-03 16:29:33.466923 (Thread-6): 16:29:33  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:33.467033 (Thread-6): 16:29:33  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
2022-03-03 16:29:33.618667 (Thread-6): 16:29:33  SQL status: SUCCESS 13 in 0.15 seconds
2022-03-03 16:29:33.624389 (Thread-6): 16:29:33  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:33.624589 (Thread-6): 16:29:33  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details
2022-03-03 16:29:33.746316 (Thread-4): 16:29:33  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b140b2670>]}
2022-03-03 16:29:33.746798 (Thread-4): 16:29:33  27 of 31 OK created incremental model DBT_VAULT.sat_inv_inventory_details....... [SUCCESS 1 in 6.56s]
2022-03-03 16:29:33.746964 (Thread-4): 16:29:33  Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:29:33.747114 (Thread-4): 16:29:33  Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:29:33.747313 (Thread-4): 16:29:33  31 of 31 START incremental model DBT_VAULT.sat_inv_supplier_details............. [RUN]
2022-03-03 16:29:33.747558 (Thread-4): 16:29:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:33.747648 (Thread-4): 16:29:33  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:29:33.747742 (Thread-4): 16:29:33  Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:29:33.764349 (Thread-4): 16:29:33  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:33.777706 (Thread-4): 16:29:33  finished collecting timing info
2022-03-03 16:29:33.777880 (Thread-4): 16:29:33  Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:29:33.782766 (Thread-4): 16:29:33  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:33.783000 (Thread-4): 16:29:33  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_HASHDIFF != stage.SUPPLIER_HASHDIFF
                OR latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:29:33.783110 (Thread-4): 16:29:33  Opening a new connection, currently in state closed
2022-03-03 16:29:33.833274 (Thread-6): 16:29:33  SQL status: SUCCESS 13 in 0.21 seconds
2022-03-03 16:29:33.838308 (Thread-6): 16:29:33  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:33.838543 (Thread-6): 16:29:33  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_PART_DETAILS"
2022-03-03 16:29:34.029606 (Thread-6): 16:29:34  SQL status: SUCCESS 13 in 0.19 seconds
2022-03-03 16:29:34.032524 (Thread-6): 16:29:34  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:34.079777 (Thread-6): 16:29:34  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:34.079930 (Thread-6): 16:29:34  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
2022-03-03 16:29:34.188226 (Thread-137): handling poll request
2022-03-03 16:29:34.188618 (Thread-137): 16:29:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518007c850>]}
2022-03-03 16:29:34.189964 (Thread-137): sending response (<Response 41883 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:34.406587 (Thread-6): 16:29:34  SQL status: SUCCESS 1 in 0.33 seconds
2022-03-03 16:29:34.406812 (Thread-6): 16:29:34  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:34.406900 (Thread-6): 16:29:34  On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DBT_RAW.DBT_VAULT.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
        );
2022-03-03 16:29:34.973209 (Thread-6): 16:29:34  SQL status: SUCCESS 0 in 0.57 seconds
2022-03-03 16:29:34.973408 (Thread-6): 16:29:34  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:29:34.973496 (Thread-6): 16:29:34  On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
2022-03-03 16:29:35.044081 (Thread-5): 16:29:35  SQL status: SUCCESS 1 in 2.08 seconds
2022-03-03 16:29:35.047616 (Thread-5): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:35.047746 (Thread-5): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
2022-03-03 16:29:35.255483 (Thread-5): 16:29:35  SQL status: SUCCESS 7 in 0.21 seconds
2022-03-03 16:29:35.259703 (Thread-5): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:35.259816 (Thread-5): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details
2022-03-03 16:29:35.432823 (Thread-5): 16:29:35  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-03 16:29:35.438178 (Thread-5): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:35.438305 (Thread-5): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_NATION_DETAILS"
2022-03-03 16:29:35.492772 (Thread-6): 16:29:35  SQL status: SUCCESS 1 in 0.52 seconds
2022-03-03 16:29:35.494160 (Thread-6): 16:29:35  finished collecting timing info
2022-03-03 16:29:35.494317 (Thread-6): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
2022-03-03 16:29:35.560965 (Thread-3): 16:29:35  SQL status: SUCCESS 1 in 2.56 seconds
2022-03-03 16:29:35.564060 (Thread-3): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:35.564169 (Thread-3): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
2022-03-03 16:29:35.572849 (Thread-5): 16:29:35  SQL status: SUCCESS 7 in 0.13 seconds
2022-03-03 16:29:35.574990 (Thread-5): 16:29:35  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:35.590110 (Thread-5): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:35.590267 (Thread-5): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
2022-03-03 16:29:35.788316 (Thread-6): 16:29:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043873a0>]}
2022-03-03 16:29:35.810520 (Thread-3): 16:29:35  SQL status: SUCCESS 7 in 0.25 seconds
2022-03-03 16:29:35.814079 (Thread-3): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:35.814192 (Thread-3): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details
2022-03-03 16:29:35.817908 (Thread-6): 16:29:35  28 of 31 OK created incremental model DBT_VAULT.sat_inv_part_details............ [SUCCESS 1 in 5.85s]
2022-03-03 16:29:35.818223 (Thread-6): 16:29:35  Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:29:35.882127 (Thread-5): 16:29:35  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 16:29:35.882356 (Thread-5): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:35.882468 (Thread-5): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
        );
2022-03-03 16:29:35.953779 (Thread-3): 16:29:35  SQL status: SUCCESS 7 in 0.14 seconds
2022-03-03 16:29:35.957557 (Thread-3): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:35.957667 (Thread-3): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_REGION_DETAILS"
2022-03-03 16:29:35.961932 (Thread-138): handling poll request
2022-03-03 16:29:35.962287 (Thread-138): 16:29:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800854f0>]}
2022-03-03 16:29:35.963062 (Thread-138): sending response (<Response 17388 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:35.989982 (Thread-4): 16:29:35  SQL status: SUCCESS 1 in 2.21 seconds
2022-03-03 16:29:35.992982 (Thread-4): 16:29:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:35.993087 (Thread-4): 16:29:35  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
2022-03-03 16:29:36.208947 (Thread-3): 16:29:36  SQL status: SUCCESS 7 in 0.25 seconds
2022-03-03 16:29:36.211154 (Thread-3): 16:29:36  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:36.227433 (Thread-3): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:36.227559 (Thread-3): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
2022-03-03 16:29:36.230097 (Thread-4): 16:29:36  SQL status: SUCCESS 10 in 0.24 seconds
2022-03-03 16:29:36.233659 (Thread-4): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:36.233762 (Thread-4): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details
2022-03-03 16:29:36.306947 (Thread-5): 16:29:36  SQL status: SUCCESS 0 in 0.42 seconds
2022-03-03 16:29:36.307201 (Thread-5): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:29:36.307357 (Thread-5): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
2022-03-03 16:29:36.362887 (Thread-4): 16:29:36  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 16:29:36.366937 (Thread-4): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:36.367040 (Thread-4): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPPLIER_DETAILS"
2022-03-03 16:29:36.394190 (Thread-3): 16:29:36  SQL status: SUCCESS 1 in 0.17 seconds
2022-03-03 16:29:36.394357 (Thread-3): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:36.394439 (Thread-3): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
        );
2022-03-03 16:29:36.654768 (Thread-4): 16:29:36  SQL status: SUCCESS 10 in 0.29 seconds
2022-03-03 16:29:36.657363 (Thread-4): 16:29:36  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:36.671328 (Thread-4): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:36.671462 (Thread-4): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
2022-03-03 16:29:36.772355 (Thread-3): 16:29:36  SQL status: SUCCESS 0 in 0.38 seconds
2022-03-03 16:29:36.772555 (Thread-3): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:29:36.772678 (Thread-3): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
2022-03-03 16:29:36.893523 (Thread-5): 16:29:36  SQL status: SUCCESS 1 in 0.59 seconds
2022-03-03 16:29:36.895124 (Thread-5): 16:29:36  finished collecting timing info
2022-03-03 16:29:36.895294 (Thread-5): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
2022-03-03 16:29:36.978996 (Thread-4): 16:29:36  SQL status: SUCCESS 1 in 0.31 seconds
2022-03-03 16:29:36.979213 (Thread-4): 16:29:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:36.979299 (Thread-4): 16:29:36  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
        );
2022-03-03 16:29:37.275222 (Thread-5): 16:29:37  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b043b0460>]}
2022-03-03 16:29:37.275776 (Thread-5): 16:29:37  29 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_nation_details..... [SUCCESS 1 in 4.35s]
2022-03-03 16:29:37.275938 (Thread-5): 16:29:37  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:29:37.392778 (Thread-3): 16:29:37  SQL status: SUCCESS 1 in 0.62 seconds
2022-03-03 16:29:37.394272 (Thread-3): 16:29:37  finished collecting timing info
2022-03-03 16:29:37.394433 (Thread-3): 16:29:37  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
2022-03-03 16:29:37.554166 (Thread-4): 16:29:37  SQL status: SUCCESS 0 in 0.57 seconds
2022-03-03 16:29:37.554372 (Thread-4): 16:29:37  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:29:37.554458 (Thread-4): 16:29:37  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
2022-03-03 16:29:37.670916 (Thread-3): 16:29:37  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b04592130>]}
2022-03-03 16:29:37.671342 (Thread-3): 16:29:37  30 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_region_details..... [SUCCESS 1 in 4.72s]
2022-03-03 16:29:37.671471 (Thread-3): 16:29:37  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:29:37.996595 (Thread-139): handling poll request
2022-03-03 16:29:37.997071 (Thread-139): 16:29:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5180094820>]}
2022-03-03 16:29:37.997906 (Thread-139): sending response (<Response 19836 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:38.109046 (Thread-4): 16:29:38  SQL status: SUCCESS 1 in 0.55 seconds
2022-03-03 16:29:38.110548 (Thread-4): 16:29:38  finished collecting timing info
2022-03-03 16:29:38.110714 (Thread-4): 16:29:38  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
2022-03-03 16:29:38.474766 (Thread-4): 16:29:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e832a9b6-03a8-45ba-a354-0e24a5cf0e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b045c8400>]}
2022-03-03 16:29:38.475203 (Thread-4): 16:29:38  31 of 31 OK created incremental model DBT_VAULT.sat_inv_supplier_details........ [SUCCESS 1 in 4.73s]
2022-03-03 16:29:38.475337 (Thread-4): 16:29:38  Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:29:38.477043 (MainThread): 16:29:38  Acquiring new snowflake connection "master"
2022-03-03 16:29:38.477447 (MainThread): 16:29:38  
2022-03-03 16:29:38.477550 (MainThread): 16:29:38  Finished running 6 table models, 25 incremental models in 50.02s.
2022-03-03 16:29:38.477633 (MainThread): 16:29:38  Connection 'master' was properly closed.
2022-03-03 16:29:38.477700 (MainThread): 16:29:38  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
2022-03-03 16:29:38.477764 (MainThread): 16:29:38  Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
2022-03-03 16:29:38.477826 (MainThread): 16:29:38  Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
2022-03-03 16:29:38.477890 (MainThread): 16:29:38  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
2022-03-03 16:29:38.561433 (MainThread): 16:29:38  
2022-03-03 16:29:38.561638 (MainThread): 16:29:38  Completed successfully
2022-03-03 16:29:38.561772 (MainThread): 16:29:38  
2022-03-03 16:29:38.561868 (MainThread): 16:29:38  Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
2022-03-03 16:29:39.862690 (Thread-140): handling poll request
2022-03-03 16:29:39.863061 (Thread-140): 16:29:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800940a0>]}
2022-03-03 16:29:39.866701 (Thread-140): sending response (<Response 165281 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:41.880536 (Thread-141): handling status request
2022-03-03 16:29:41.881030 (Thread-141): 16:29:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800ab220>]}
2022-03-03 16:29:41.881558 (Thread-141): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:29:41.992303 (Thread-142): handling status request
2022-03-03 16:29:41.992701 (Thread-142): 16:29:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800b19a0>]}
2022-03-03 16:29:41.993205 (Thread-142): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:33.594942 (Thread-143): 16:30:33  Unable to do partial parsing because a project config has changed
2022-03-03 16:30:33.595316 (Thread-143): 16:30:33  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801e1a00>]}
2022-03-03 16:30:33.942480 (Thread-143): 16:30:33  Parsing macros/adapters.sql
2022-03-03 16:30:33.979881 (Thread-143): 16:30:33  Parsing macros/catalog.sql
2022-03-03 16:30:33.981777 (Thread-143): 16:30:33  Parsing macros/materializations/table.sql
2022-03-03 16:30:33.984810 (Thread-143): 16:30:33  Parsing macros/materializations/seed.sql
2022-03-03 16:30:33.989917 (Thread-143): 16:30:33  Parsing macros/materializations/incremental.sql
2022-03-03 16:30:33.998256 (Thread-143): 16:30:33  Parsing macros/materializations/merge.sql
2022-03-03 16:30:34.001965 (Thread-143): 16:30:34  Parsing macros/materializations/snapshot.sql
2022-03-03 16:30:34.002906 (Thread-143): 16:30:34  Parsing macros/materializations/view.sql
2022-03-03 16:30:34.004322 (Thread-143): 16:30:34  Parsing macros/adapters/metadata.sql
2022-03-03 16:30:34.011228 (Thread-143): 16:30:34  Parsing macros/adapters/columns.sql
2022-03-03 16:30:34.020864 (Thread-143): 16:30:34  Parsing macros/adapters/freshness.sql
2022-03-03 16:30:34.023766 (Thread-143): 16:30:34  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:30:34.028149 (Thread-143): 16:30:34  Parsing macros/adapters/relation.sql
2022-03-03 16:30:34.037397 (Thread-143): 16:30:34  Parsing macros/adapters/schema.sql
2022-03-03 16:30:34.039529 (Thread-143): 16:30:34  Parsing macros/adapters/indexes.sql
2022-03-03 16:30:34.042181 (Thread-143): 16:30:34  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:30:34.044593 (Thread-143): 16:30:34  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:30:34.046152 (Thread-143): 16:30:34  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:30:34.047771 (Thread-143): 16:30:34  Parsing macros/etc/datetime.sql
2022-03-03 16:30:34.055810 (Thread-143): 16:30:34  Parsing macros/etc/statement.sql
2022-03-03 16:30:34.060118 (Thread-143): 16:30:34  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:30:34.060921 (Thread-143): 16:30:34  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:30:34.061494 (Thread-143): 16:30:34  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:30:34.062828 (Thread-143): 16:30:34  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:30:34.063695 (Thread-143): 16:30:34  Parsing macros/materializations/configs.sql
2022-03-03 16:30:34.065971 (Thread-143): 16:30:34  Parsing macros/materializations/hooks.sql
2022-03-03 16:30:34.069688 (Thread-143): 16:30:34  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:30:34.076720 (Thread-143): 16:30:34  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:30:34.079511 (Thread-143): 16:30:34  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:30:34.082119 (Thread-143): 16:30:34  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:30:34.083409 (Thread-143): 16:30:34  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:30:34.085686 (Thread-143): 16:30:34  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:30:34.092421 (Thread-143): 16:30:34  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:30:34.102124 (Thread-143): 16:30:34  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:30:34.116759 (Thread-143): 16:30:34  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:30:34.118256 (Thread-143): 16:30:34  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:30:34.129081 (Thread-143): 16:30:34  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:30:34.133392 (Thread-143): 16:30:34  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:30:34.148989 (Thread-143): 16:30:34  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:30:34.154764 (Thread-143): 16:30:34  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:30:34.156540 (Thread-143): 16:30:34  Parsing macros/materializations/tests/test.sql
2022-03-03 16:30:34.160864 (Thread-143): 16:30:34  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:30:34.162679 (Thread-143): 16:30:34  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:30:34.173511 (Thread-143): 16:30:34  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:30:34.189725 (Thread-143): 16:30:34  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:30:34.191360 (Thread-143): 16:30:34  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:30:34.202307 (Thread-143): 16:30:34  Parsing tests/generic/builtin.sql
2022-03-03 16:30:34.205328 (Thread-143): 16:30:34  Parsing macros/sql/pivot.sql
2022-03-03 16:30:34.209283 (Thread-143): 16:30:34  Parsing macros/sql/star.sql
2022-03-03 16:30:34.213364 (Thread-143): 16:30:34  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:30:34.214755 (Thread-143): 16:30:34  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:30:34.218122 (Thread-143): 16:30:34  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:30:34.220367 (Thread-143): 16:30:34  Parsing macros/sql/date_spine.sql
2022-03-03 16:30:34.224815 (Thread-143): 16:30:34  Parsing macros/sql/get_column_values.sql
2022-03-03 16:30:34.229674 (Thread-143): 16:30:34  Parsing macros/sql/groupby.sql
2022-03-03 16:30:34.231011 (Thread-143): 16:30:34  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:30:34.237020 (Thread-143): 16:30:34  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:30:34.238624 (Thread-143): 16:30:34  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:30:34.240255 (Thread-143): 16:30:34  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:30:34.243590 (Thread-143): 16:30:34  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:30:34.246863 (Thread-143): 16:30:34  Parsing macros/sql/safe_add.sql
2022-03-03 16:30:34.248479 (Thread-143): 16:30:34  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:30:34.254238 (Thread-143): 16:30:34  Parsing macros/sql/unpivot.sql
2022-03-03 16:30:34.261875 (Thread-143): 16:30:34  Parsing macros/sql/generate_series.sql
2022-03-03 16:30:34.266032 (Thread-143): 16:30:34  Parsing macros/sql/nullcheck.sql
2022-03-03 16:30:34.267677 (Thread-143): 16:30:34  Parsing macros/sql/union.sql
2022-03-03 16:30:34.277929 (Thread-143): 16:30:34  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:30:34.301432 (Thread-143): 16:30:34  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:30:34.302822 (Thread-143): 16:30:34  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:30:34.304285 (Thread-143): 16:30:34  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:30:34.305683 (Thread-143): 16:30:34  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:30:34.306835 (Thread-143): 16:30:34  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:30:34.308385 (Thread-143): 16:30:34  Parsing macros/web/get_url_path.sql
2022-03-03 16:30:34.310923 (Thread-143): 16:30:34  Parsing macros/web/get_url_host.sql
2022-03-03 16:30:34.312852 (Thread-143): 16:30:34  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:30:34.314651 (Thread-143): 16:30:34  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:30:34.315896 (Thread-143): 16:30:34  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:30:34.318664 (Thread-143): 16:30:34  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:30:34.320990 (Thread-143): 16:30:34  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:30:34.322362 (Thread-143): 16:30:34  Parsing macros/schema_tests/equality.sql
2022-03-03 16:30:34.326073 (Thread-143): 16:30:34  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:30:34.327554 (Thread-143): 16:30:34  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:30:34.329226 (Thread-143): 16:30:34  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:30:34.331281 (Thread-143): 16:30:34  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:30:34.332736 (Thread-143): 16:30:34  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:30:34.341064 (Thread-143): 16:30:34  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:30:34.343191 (Thread-143): 16:30:34  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:30:34.345572 (Thread-143): 16:30:34  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:30:34.347212 (Thread-143): 16:30:34  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:30:34.349987 (Thread-143): 16:30:34  Parsing macros/schema_tests/recency.sql
2022-03-03 16:30:34.351735 (Thread-143): 16:30:34  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:30:34.353753 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:30:34.355540 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:30:34.357406 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:30:34.358847 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:30:34.362181 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:30:34.364358 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:30:34.365795 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:30:34.367097 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:30:34.368327 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:30:34.369902 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:30:34.371533 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:30:34.372548 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:30:34.373697 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:30:34.375336 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:30:34.384678 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:30:34.387491 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:30:34.393482 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:30:34.395034 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:30:34.396011 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:30:34.397899 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:30:34.402796 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:30:34.404248 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:30:34.405349 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:30:34.407342 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:30:34.410804 (Thread-143): 16:30:34  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:30:34.411892 (Thread-143): 16:30:34  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:30:34.417228 (Thread-143): 16:30:34  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:30:34.422353 (Thread-143): 16:30:34  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:30:34.442627 (Thread-143): 16:30:34  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:30:34.466898 (Thread-143): 16:30:34  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:30:34.471025 (Thread-143): 16:30:34  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:30:34.479622 (Thread-143): 16:30:34  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:30:34.482378 (Thread-143): 16:30:34  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:30:34.484455 (Thread-143): 16:30:34  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:30:34.498502 (Thread-143): 16:30:34  Parsing macros/staging/hash_columns.sql
2022-03-03 16:30:34.502277 (Thread-143): 16:30:34  Parsing macros/staging/stage.sql
2022-03-03 16:30:34.512458 (Thread-143): 16:30:34  Parsing macros/staging/rank_columns.sql
2022-03-03 16:30:34.520984 (Thread-143): 16:30:34  Parsing macros/staging/derive_columns.sql
2022-03-03 16:30:34.526789 (Thread-143): 16:30:34  Parsing macros/staging/source_columns.sql
2022-03-03 16:30:34.528211 (Thread-143): 16:30:34  Parsing macros/internal/alias_all.sql
2022-03-03 16:30:34.530627 (Thread-143): 16:30:34  Parsing macros/internal/alias.sql
2022-03-03 16:30:34.534104 (Thread-143): 16:30:34  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:30:34.534570 (Thread-143): 16:30:34  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:30:34.543641 (Thread-143): 16:30:34  Parsing macros/internal/multikey.sql
2022-03-03 16:30:34.548932 (Thread-143): 16:30:34  Parsing macros/internal/is_checks.sql
2022-03-03 16:30:34.551954 (Thread-143): 16:30:34  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:30:34.555313 (Thread-143): 16:30:34  Parsing macros/internal/as_constant.sql
2022-03-03 16:30:34.557529 (Thread-143): 16:30:34  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:30:34.559232 (Thread-143): 16:30:34  Parsing macros/tables/link.sql
2022-03-03 16:30:34.572185 (Thread-143): 16:30:34  Parsing macros/tables/sat.sql
2022-03-03 16:30:34.581377 (Thread-143): 16:30:34  Parsing macros/tables/eff_sat.sql
2022-03-03 16:30:34.594909 (Thread-143): 16:30:34  Parsing macros/tables/xts.sql
2022-03-03 16:30:34.602407 (Thread-143): 16:30:34  Parsing macros/tables/hub.sql
2022-03-03 16:30:34.613910 (Thread-143): 16:30:34  Parsing macros/tables/ma_sat.sql
2022-03-03 16:30:34.626455 (Thread-143): 16:30:34  Parsing macros/tables/pit.sql
2022-03-03 16:30:34.648041 (Thread-143): 16:30:34  Parsing macros/tables/bridge.sql
2022-03-03 16:30:34.683780 (Thread-143): 16:30:34  Parsing macros/tables/t_link.sql
2022-03-03 16:30:34.689618 (Thread-143): 16:30:34  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:30:34.690679 (Thread-143): 16:30:34  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:30:34.692601 (Thread-143): 16:30:34  Parsing macros/supporting/prefix.sql
2022-03-03 16:30:34.698137 (Thread-143): 16:30:34  Parsing macros/supporting/hash.sql
2022-03-03 16:30:34.705168 (Thread-143): 16:30:34  Parsing macros/supporting/datatypes.sql
2022-03-03 16:30:35.227932 (Thread-144): handling status request
2022-03-03 16:30:35.253810 (Thread-144): 16:30:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603037c0>]}
2022-03-03 16:30:35.259481 (Thread-144): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:35.272212 (Thread-143): 16:30:35  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:30:35.306816 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:30:35.308891 (Thread-143): 16:30:35  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:30:35.325328 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:30:35.327211 (Thread-143): 16:30:35  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:30:35.372627 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:30:35.374055 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:30:35.381602 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:30:35.382836 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:30:35.392130 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:30:35.393386 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:30:35.403647 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:30:35.405438 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:30:35.415543 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:30:35.417343 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:30:35.427098 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:30:35.428870 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:30:35.442343 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:30:35.446654 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:30:35.455876 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:30:35.467403 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:30:35.476266 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:30:35.477596 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:30:35.485064 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:30:35.485611 (Thread-145): handling status request
2022-03-03 16:30:35.486906 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:30:35.487238 (Thread-145): 16:30:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601c7040>]}
2022-03-03 16:30:35.494606 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:30:35.495080 (Thread-145): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:35.496333 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:30:35.504677 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:30:35.505906 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:30:35.513057 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:30:35.514221 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:30:35.520886 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:30:35.522045 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:30:35.530265 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:30:35.531434 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:30:35.538645 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:30:35.540123 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:30:35.550823 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:30:35.552143 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:30:35.561404 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:30:35.562649 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:30:35.575028 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:30:35.576256 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:30:35.587224 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:30:35.588429 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:30:35.597397 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:30:35.598585 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:30:35.607476 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:30:35.608706 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:30:35.619572 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:30:35.620793 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:30:35.632607 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:30:35.633848 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:30:35.644917 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:30:35.646137 (Thread-143): 16:30:35  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:30:35.655165 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:30:35.656490 (Thread-143): 16:30:35  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:30:35.660888 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:30:35.662449 (Thread-143): 16:30:35  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:30:35.669712 (Thread-143): 16:30:35  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:30:35.671372 (Thread-143): 16:30:35  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:30:35.784929 (Thread-143): 16:30:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516033f4c0>]}
2022-03-03 16:30:36.849540 (Thread-146): handling status request
2022-03-03 16:30:36.849919 (Thread-146): 16:30:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601ec970>]}
2022-03-03 16:30:36.851931 (Thread-146): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:37.196845 (Thread-147): handling status request
2022-03-03 16:30:37.197219 (Thread-147): 16:30:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601bcee0>]}
2022-03-03 16:30:37.199177 (Thread-147): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:46.023371 (Thread-148): handling status request
2022-03-03 16:30:46.023762 (Thread-148): 16:30:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51602660a0>]}
2022-03-03 16:30:46.025922 (Thread-148): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:46.310953 (Thread-149): handling status request
2022-03-03 16:30:46.311324 (Thread-149): 16:30:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601774c0>]}
2022-03-03 16:30:46.313404 (Thread-149): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:46.712894 (Thread-150): handling cli_args request
2022-03-03 16:30:46.713276 (Thread-150): 16:30:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516034c1c0>]}
2022-03-03 16:30:49.017091 (Thread-150): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:49.448764 (MainThread): 16:30:49  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:30:49.449201 (MainThread): 16:30:49  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:30:49.456735 (MainThread): 16:30:49  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58741d00>]}
2022-03-03 16:30:49.497808 (MainThread): 16:30:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5909d400>]}
2022-03-03 16:30:49.498138 (MainThread): 16:30:49  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:30:49.500477 (MainThread): 16:30:49  
2022-03-03 16:30:49.500895 (MainThread): 16:30:49  Acquiring new snowflake connection "master"
2022-03-03 16:30:49.503047 (ThreadPoolExecutor-0_0): 16:30:49  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:30:49.516560 (ThreadPoolExecutor-0_0): 16:30:49  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:30:49.516723 (ThreadPoolExecutor-0_0): 16:30:49  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:30:49.516820 (ThreadPoolExecutor-0_0): 16:30:49  Opening a new connection, currently in state init
2022-03-03 16:30:49.816397 (Thread-151): handling poll request
2022-03-03 16:30:49.816919 (Thread-151): 16:30:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601c2a00>]}
2022-03-03 16:30:49.817834 (Thread-151): sending response (<Response 4125 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:50.675594 (ThreadPoolExecutor-0_0): 16:30:50  SQL status: SUCCESS 8 in 1.16 seconds
2022-03-03 16:30:50.677740 (ThreadPoolExecutor-0_0): 16:30:50  On list_DBT_RAW: Close
2022-03-03 16:30:50.958953 (ThreadPoolExecutor-2_0): 16:30:50  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:30:50.966835 (ThreadPoolExecutor-2_0): 16:30:50  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:30:50.966983 (ThreadPoolExecutor-2_0): 16:30:50  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:30:50.967084 (ThreadPoolExecutor-2_0): 16:30:50  Opening a new connection, currently in state closed
2022-03-03 16:30:51.564490 (Thread-152): handling poll request
2022-03-03 16:30:51.564935 (Thread-152): 16:30:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601821c0>]}
2022-03-03 16:30:51.565539 (Thread-152): sending response (<Response 2282 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:52.272154 (ThreadPoolExecutor-2_0): 16:30:52  SQL status: SUCCESS 31 in 1.31 seconds
2022-03-03 16:30:52.274550 (ThreadPoolExecutor-2_0): 16:30:52  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:30:52.548239 (MainThread): 16:30:52  Concurrency: 4 threads (target='default')
2022-03-03 16:30:52.548418 (MainThread): 16:30:52  
2022-03-03 16:30:52.551566 (Thread-3): 16:30:52  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:30:52.551880 (Thread-3): 16:30:52  1 of 31 START table model DBT_VAULT.raw_orders.................................. [RUN]
2022-03-03 16:30:52.552154 (Thread-3): 16:30:52  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:30:52.552261 (Thread-3): 16:30:52  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:30:52.552370 (Thread-3): 16:30:52  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:30:52.556813 (Thread-4): 16:30:52  Began running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:30:52.557130 (Thread-4): 16:30:52  2 of 31 START view model DBT_VAULT.raw_transactions............................. [RUN]
2022-03-03 16:30:52.557455 (Thread-4): 16:30:52  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:30:52.557568 (Thread-4): 16:30:52  Began compiling node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:30:52.557655 (Thread-4): 16:30:52  Compiling model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:30:52.561152 (Thread-4): 16:30:52  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:30:52.563296 (Thread-3): 16:30:52  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:30:52.577155 (Thread-4): 16:30:52  finished collecting timing info
2022-03-03 16:30:52.577318 (Thread-4): 16:30:52  Began executing node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:30:52.582237 (Thread-3): 16:30:52  finished collecting timing info
2022-03-03 16:30:52.582373 (Thread-3): 16:30:52  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:30:52.619953 (Thread-4): 16:30:52  Dropping relation "DBT_RAW"."DBT_VAULT"."RAW_TRANSACTIONS" because it is of type table
2022-03-03 16:30:52.624495 (Thread-3): 16:30:52  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:30:52.627206 (Thread-4): 16:30:52  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:30:52.627322 (Thread-4): 16:30:52  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */
drop table if exists "DBT_RAW"."DBT_VAULT"."RAW_TRANSACTIONS" cascade
2022-03-03 16:30:52.627410 (Thread-4): 16:30:52  Opening a new connection, currently in state init
2022-03-03 16:30:52.644771 (Thread-3): 16:30:52  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:30:52.644922 (Thread-3): 16:30:52  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO
FROM DBT_RAW.TPCH_SF10.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:30:52.645056 (Thread-3): 16:30:52  Opening a new connection, currently in state closed
2022-03-03 16:30:53.373456 (Thread-153): handling poll request
2022-03-03 16:30:53.373821 (Thread-153): 16:30:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160371160>]}
2022-03-03 16:30:53.374652 (Thread-153): sending response (<Response 14338 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:54.048131 (Thread-4): 16:30:54  SQL status: SUCCESS 1 in 1.42 seconds
2022-03-03 16:30:54.057734 (Thread-4): 16:30:54  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:30:54.072310 (Thread-4): 16:30:54  Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
2022-03-03 16:30:54.072432 (Thread-4): 16:30:54  On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DBT_RAW.DBT_VAULT.raw_transactions 
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM DBT_RAW.TPCH_SF10.ORDERS  AS b
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
2022-03-03 16:30:54.709011 (Thread-4): 16:30:54  SQL status: SUCCESS 1 in 0.64 seconds
2022-03-03 16:30:54.717715 (Thread-4): 16:30:54  finished collecting timing info
2022-03-03 16:30:54.717968 (Thread-4): 16:30:54  On model.dbtvault_snowflake_demo.raw_transactions: Close
2022-03-03 16:30:55.006425 (Thread-154): handling poll request
2022-03-03 16:30:55.006779 (Thread-154): 16:30:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603530d0>]}
2022-03-03 16:30:55.007328 (Thread-154): sending response (<Response 3806 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:55.102880 (Thread-4): 16:30:55  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58139d00>]}
2022-03-03 16:30:55.103407 (Thread-4): 16:30:55  2 of 31 OK created view model DBT_VAULT.raw_transactions........................ [SUCCESS 1 in 2.55s]
2022-03-03 16:30:55.103561 (Thread-4): 16:30:55  Finished running node model.dbtvault_snowflake_demo.raw_transactions
2022-03-03 16:30:55.104475 (Thread-6): 16:30:55  Began running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:30:55.104881 (Thread-6): 16:30:55  3 of 31 START table model DBT_VAULT.v_stg_transactions.......................... [RUN]
2022-03-03 16:30:55.105325 (Thread-6): 16:30:55  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:30:55.105489 (Thread-6): 16:30:55  Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:30:55.105637 (Thread-6): 16:30:55  Compiling model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:30:55.152057 (Thread-6): 16:30:55  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:30:55.152199 (Thread-6): 16:30:55  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-03 16:30:55.152291 (Thread-6): 16:30:55  Opening a new connection, currently in state init
2022-03-03 16:30:56.119958 (Thread-6): 16:30:56  SQL status: SUCCESS 7 in 0.97 seconds
2022-03-03 16:30:56.150317 (Thread-6): 16:30:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:30:56.150474 (Thread-6): 16:30:56  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DBT_RAW.DBT_VAULT.raw_transactions
2022-03-03 16:30:56.296357 (Thread-6): 16:30:56  SQL status: SUCCESS 7 in 0.15 seconds
2022-03-03 16:30:56.338604 (Thread-6): 16:30:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:30:56.364490 (Thread-6): 16:30:56  finished collecting timing info
2022-03-03 16:30:56.364763 (Thread-6): 16:30:56  Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:30:56.368731 (Thread-6): 16:30:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:30:56.387290 (Thread-6): 16:30:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
2022-03-03 16:30:56.387432 (Thread-6): 16:30:56  On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_transactions  as
      (







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM DBT_RAW.DBT_VAULT.raw_transactions
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS TRANSACTION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
      );
2022-03-03 16:30:56.779434 (Thread-155): handling poll request
2022-03-03 16:30:56.779791 (Thread-155): 16:30:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160344160>]}
2022-03-03 16:30:56.780507 (Thread-155): sending response (<Response 11227 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:30:58.570484 (Thread-156): handling poll request
2022-03-03 16:30:58.570839 (Thread-156): 16:30:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160344d60>]}
2022-03-03 16:30:58.571323 (Thread-156): sending response (<Response 292 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:00.327022 (Thread-157): handling poll request
2022-03-03 16:31:00.327773 (Thread-157): 16:31:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603530a0>]}
2022-03-03 16:31:00.328260 (Thread-157): sending response (<Response 292 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:01.794988 (Thread-6): 16:31:01  SQL status: SUCCESS 1 in 5.41 seconds
2022-03-03 16:31:01.802230 (Thread-6): 16:31:01  finished collecting timing info
2022-03-03 16:31:01.802486 (Thread-6): 16:31:01  On model.dbtvault_snowflake_demo.v_stg_transactions: Close
2022-03-03 16:31:02.056500 (Thread-6): 16:31:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe503afd30>]}
2022-03-03 16:31:02.057134 (Thread-6): 16:31:02  3 of 31 OK created table model DBT_VAULT.v_stg_transactions..................... [SUCCESS 1 in 6.95s]
2022-03-03 16:31:02.057299 (Thread-6): 16:31:02  Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
2022-03-03 16:31:02.058106 (Thread-4): 16:31:02  Began running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:31:02.058404 (Thread-4): 16:31:02  4 of 31 START incremental model DBT_VAULT.t_link_transactions................... [RUN]
2022-03-03 16:31:02.058752 (Thread-4): 16:31:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:02.058878 (Thread-4): 16:31:02  Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:31:02.058975 (Thread-4): 16:31:02  Compiling model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:31:02.090858 (Thread-158): handling poll request
2022-03-03 16:31:02.091202 (Thread-158): 16:31:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601a3d90>]}
2022-03-03 16:31:02.091836 (Thread-158): sending response (<Response 5156 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:02.128697 (Thread-4): 16:31:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:02.141819 (Thread-4): 16:31:02  finished collecting timing info
2022-03-03 16:31:02.142023 (Thread-4): 16:31:02  Began executing node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:31:02.168015 (Thread-4): 16:31:02  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:02.168178 (Thread-4): 16:31:02  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_transactions
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    LEFT JOIN DBT_RAW.DBT_VAULT.t_link_transactions AS tgt
    ON stg.TRANSACTION_PK = tgt.TRANSACTION_PK
    WHERE tgt.TRANSACTION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:02.168274 (Thread-4): 16:31:02  Opening a new connection, currently in state closed
2022-03-03 16:31:03.858263 (Thread-159): handling poll request
2022-03-03 16:31:03.858622 (Thread-159): 16:31:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516026faf0>]}
2022-03-03 16:31:03.887413 (Thread-159): sending response (<Response 3710 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:04.691859 (Thread-4): 16:31:04  SQL status: SUCCESS 1 in 2.52 seconds
2022-03-03 16:31:04.696047 (Thread-4): 16:31:04  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:04.696248 (Thread-4): 16:31:04  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
2022-03-03 16:31:04.954524 (Thread-4): 16:31:04  SQL status: SUCCESS 10 in 0.26 seconds
2022-03-03 16:31:04.958514 (Thread-4): 16:31:04  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:04.958756 (Thread-4): 16:31:04  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DBT_RAW.DBT_VAULT.t_link_transactions
2022-03-03 16:31:05.204674 (Thread-4): 16:31:05  SQL status: SUCCESS 10 in 0.25 seconds
2022-03-03 16:31:05.212959 (Thread-4): 16:31:05  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:05.213077 (Thread-4): 16:31:05  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DBT_RAW"."DBT_VAULT"."T_LINK_TRANSACTIONS"
2022-03-03 16:31:05.476031 (Thread-4): 16:31:05  SQL status: SUCCESS 10 in 0.26 seconds
2022-03-03 16:31:05.494437 (Thread-4): 16:31:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:05.507467 (Thread-4): 16:31:05  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:05.507600 (Thread-4): 16:31:05  On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
2022-03-03 16:31:05.580128 (Thread-3): 16:31:05  SQL status: SUCCESS 1 in 12.94 seconds
2022-03-03 16:31:05.581822 (Thread-3): 16:31:05  finished collecting timing info
2022-03-03 16:31:05.581985 (Thread-3): 16:31:05  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:31:05.674070 (Thread-160): handling poll request
2022-03-03 16:31:05.674445 (Thread-160): 16:31:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603442b0>]}
2022-03-03 16:31:05.675101 (Thread-160): sending response (<Response 7130 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:05.921824 (Thread-4): 16:31:05  SQL status: SUCCESS 1 in 0.41 seconds
2022-03-03 16:31:05.922158 (Thread-4): 16:31:05  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:05.922330 (Thread-4): 16:31:05  On model.dbtvault_snowflake_demo.t_link_transactions: insert into DBT_RAW.DBT_VAULT.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.t_link_transactions__dbt_tmp
        );
2022-03-03 16:31:05.939900 (Thread-3): 16:31:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58124160>]}
2022-03-03 16:31:05.940419 (Thread-3): 16:31:05  1 of 31 OK created table model DBT_VAULT.raw_orders............................. [SUCCESS 1 in 13.39s]
2022-03-03 16:31:05.940611 (Thread-3): 16:31:05  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:31:05.941529 (Thread-6): 16:31:05  Began running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:31:05.941781 (Thread-6): 16:31:05  5 of 31 START view model DBT_VAULT.raw_inventory................................ [RUN]
2022-03-03 16:31:05.942121 (Thread-6): 16:31:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:31:05.942289 (Thread-6): 16:31:05  Began compiling node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:31:05.942456 (Thread-6): 16:31:05  Compiling model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:31:05.946639 (Thread-5): 16:31:05  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:31:05.946872 (Thread-5): 16:31:05  6 of 31 START table model DBT_VAULT.v_stg_orders................................ [RUN]
2022-03-03 16:31:05.947155 (Thread-5): 16:31:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:31:05.947272 (Thread-5): 16:31:05  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:31:05.947388 (Thread-5): 16:31:05  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:31:05.954877 (Thread-6): 16:31:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:31:05.965055 (Thread-5): 16:31:05  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:31:05.965172 (Thread-5): 16:31:05  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:31:05.965259 (Thread-5): 16:31:05  Opening a new connection, currently in state init
2022-03-03 16:31:05.973217 (Thread-6): 16:31:05  finished collecting timing info
2022-03-03 16:31:05.973368 (Thread-6): 16:31:05  Began executing node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:31:05.975668 (Thread-6): 16:31:05  Dropping relation "DBT_RAW"."DBT_VAULT"."RAW_INVENTORY" because it is of type table
2022-03-03 16:31:05.977575 (Thread-6): 16:31:05  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:31:05.977676 (Thread-6): 16:31:05  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */
drop table if exists "DBT_RAW"."DBT_VAULT"."RAW_INVENTORY" cascade
2022-03-03 16:31:05.977763 (Thread-6): 16:31:05  Opening a new connection, currently in state closed
2022-03-03 16:31:06.668210 (Thread-4): 16:31:06  SQL status: SUCCESS 0 in 0.75 seconds
2022-03-03 16:31:06.668422 (Thread-4): 16:31:06  Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
2022-03-03 16:31:06.668509 (Thread-4): 16:31:06  On model.dbtvault_snowflake_demo.t_link_transactions: commit;
2022-03-03 16:31:07.091663 (Thread-4): 16:31:07  SQL status: SUCCESS 1 in 0.42 seconds
2022-03-03 16:31:07.093282 (Thread-4): 16:31:07  finished collecting timing info
2022-03-03 16:31:07.093487 (Thread-4): 16:31:07  On model.dbtvault_snowflake_demo.t_link_transactions: Close
2022-03-03 16:31:07.154154 (Thread-6): 16:31:07  SQL status: SUCCESS 1 in 1.18 seconds
2022-03-03 16:31:07.155541 (Thread-6): 16:31:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:31:07.173912 (Thread-6): 16:31:07  Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
2022-03-03 16:31:07.174044 (Thread-6): 16:31:07  On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DBT_RAW.DBT_VAULT.raw_inventory 
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF10.PARTSUPP AS a
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DBT_RAW.DBT_VAULT.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
2022-03-03 16:31:07.349589 (Thread-5): 16:31:07  SQL status: SUCCESS 37 in 1.38 seconds
2022-03-03 16:31:07.357212 (Thread-5): 16:31:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:31:07.357348 (Thread-5): 16:31:07  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:31:07.388488 (Thread-4): 16:31:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5035e2b0>]}
2022-03-03 16:31:07.389078 (Thread-4): 16:31:07  4 of 31 OK created incremental model DBT_VAULT.t_link_transactions.............. [SUCCESS 1 in 5.33s]
2022-03-03 16:31:07.389288 (Thread-4): 16:31:07  Finished running node model.dbtvault_snowflake_demo.t_link_transactions
2022-03-03 16:31:07.424255 (Thread-161): handling poll request
2022-03-03 16:31:07.424676 (Thread-161): 16:31:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160347e50>]}
2022-03-03 16:31:07.425612 (Thread-161): sending response (<Response 20127 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:07.548148 (Thread-5): 16:31:07  SQL status: SUCCESS 37 in 0.19 seconds
2022-03-03 16:31:07.575268 (Thread-5): 16:31:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:31:07.597270 (Thread-5): 16:31:07  finished collecting timing info
2022-03-03 16:31:07.597491 (Thread-5): 16:31:07  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:31:07.600468 (Thread-5): 16:31:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:31:07.637813 (Thread-5): 16:31:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:31:07.637984 (Thread-5): 16:31:07  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    EFFECTIVE_TO AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    EFFECTIVE_TO,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-03 16:31:07.783244 (Thread-6): 16:31:07  SQL status: SUCCESS 1 in 0.61 seconds
2022-03-03 16:31:07.785353 (Thread-6): 16:31:07  finished collecting timing info
2022-03-03 16:31:07.785577 (Thread-6): 16:31:07  On model.dbtvault_snowflake_demo.raw_inventory: Close
2022-03-03 16:31:08.332072 (Thread-6): 16:31:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe503bd970>]}
2022-03-03 16:31:08.332496 (Thread-6): 16:31:08  5 of 31 OK created view model DBT_VAULT.raw_inventory........................... [SUCCESS 1 in 2.39s]
2022-03-03 16:31:08.332622 (Thread-6): 16:31:08  Finished running node model.dbtvault_snowflake_demo.raw_inventory
2022-03-03 16:31:08.333440 (Thread-3): 16:31:08  Began running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:31:08.333739 (Thread-3): 16:31:08  7 of 31 START table model DBT_VAULT.v_stg_inventory............................. [RUN]
2022-03-03 16:31:08.334049 (Thread-3): 16:31:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:31:08.334180 (Thread-3): 16:31:08  Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:31:08.334282 (Thread-3): 16:31:08  Compiling model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:31:08.347460 (Thread-3): 16:31:08  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:31:08.347595 (Thread-3): 16:31:08  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-03 16:31:08.347695 (Thread-3): 16:31:08  Opening a new connection, currently in state closed
2022-03-03 16:31:09.195038 (Thread-3): 16:31:09  SQL status: SUCCESS 24 in 0.85 seconds
2022-03-03 16:31:09.201350 (Thread-3): 16:31:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:31:09.201492 (Thread-3): 16:31:09  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DBT_RAW.DBT_VAULT.raw_inventory
2022-03-03 16:31:09.246603 (Thread-162): handling poll request
2022-03-03 16:31:09.246959 (Thread-162): 16:31:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516012d7f0>]}
2022-03-03 16:31:09.247904 (Thread-162): sending response (<Response 20758 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:09.462608 (Thread-3): 16:31:09  SQL status: SUCCESS 24 in 0.26 seconds
2022-03-03 16:31:09.477596 (Thread-3): 16:31:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:31:09.510286 (Thread-3): 16:31:09  finished collecting timing info
2022-03-03 16:31:09.510545 (Thread-3): 16:31:09  Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:31:09.514514 (Thread-3): 16:31:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:31:09.548901 (Thread-3): 16:31:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
2022-03-03 16:31:09.549092 (Thread-3): 16:31:09  On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_inventory  as
      (








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_inventory
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_SUPPLIER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PART_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS SUPPLIER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
      );
2022-03-03 16:31:09.995312 (Thread-5): 16:31:09  SQL status: SUCCESS 1 in 2.36 seconds
2022-03-03 16:31:09.996845 (Thread-5): 16:31:09  finished collecting timing info
2022-03-03 16:31:09.997003 (Thread-5): 16:31:09  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:31:10.358352 (Thread-5): 16:31:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50290cd0>]}
2022-03-03 16:31:10.358779 (Thread-5): 16:31:10  6 of 31 OK created table model DBT_VAULT.v_stg_orders........................... [SUCCESS 1 in 4.41s]
2022-03-03 16:31:10.358910 (Thread-5): 16:31:10  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:31:10.359876 (Thread-6): 16:31:10  Began running node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:31:10.360163 (Thread-6): 16:31:10  8 of 31 START incremental model DBT_VAULT.hub_customer.......................... [RUN]
2022-03-03 16:31:10.360441 (Thread-6): 16:31:10  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:10.360535 (Thread-6): 16:31:10  Began compiling node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:31:10.360626 (Thread-6): 16:31:10  Compiling model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:31:10.364938 (Thread-4): 16:31:10  Began running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:31:10.365162 (Thread-4): 16:31:10  9 of 31 START incremental model DBT_VAULT.hub_lineitem.......................... [RUN]
2022-03-03 16:31:10.365412 (Thread-4): 16:31:10  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:10.365503 (Thread-4): 16:31:10  Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:31:10.365588 (Thread-4): 16:31:10  Compiling model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:31:10.375086 (Thread-5): 16:31:10  Began running node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:31:10.375311 (Thread-5): 16:31:10  10 of 31 START incremental model DBT_VAULT.hub_order............................ [RUN]
2022-03-03 16:31:10.375551 (Thread-5): 16:31:10  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:10.375642 (Thread-5): 16:31:10  Began compiling node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:31:10.375724 (Thread-5): 16:31:10  Compiling model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:31:10.416047 (Thread-4): 16:31:10  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:10.429221 (Thread-5): 16:31:10  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:10.436062 (Thread-6): 16:31:10  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:10.441744 (Thread-4): 16:31:10  finished collecting timing info
2022-03-03 16:31:10.441894 (Thread-4): 16:31:10  Began executing node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:31:10.447358 (Thread-4): 16:31:10  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:10.447466 (Thread-4): 16:31:10  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_lineitem AS d
    ON a.LINEITEM_PK = d.LINEITEM_PK
    WHERE d.LINEITEM_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:10.447556 (Thread-4): 16:31:10  Opening a new connection, currently in state closed
2022-03-03 16:31:10.454012 (Thread-5): 16:31:10  finished collecting timing info
2022-03-03 16:31:10.454160 (Thread-5): 16:31:10  Began executing node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:31:10.457798 (Thread-5): 16:31:10  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:10.457899 (Thread-5): 16:31:10  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_order AS d
    ON a.ORDER_PK = d.ORDER_PK
    WHERE d.ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:10.457983 (Thread-5): 16:31:10  Opening a new connection, currently in state closed
2022-03-03 16:31:10.458715 (Thread-6): 16:31:10  finished collecting timing info
2022-03-03 16:31:10.458850 (Thread-6): 16:31:10  Began executing node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:31:10.462532 (Thread-6): 16:31:10  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:10.462641 (Thread-6): 16:31:10  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_customer AS d
    ON a.CUSTOMER_PK = d.CUSTOMER_PK
    WHERE d.CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:10.462726 (Thread-6): 16:31:10  Opening a new connection, currently in state closed
2022-03-03 16:31:11.100446 (Thread-163): handling poll request
2022-03-03 16:31:11.100829 (Thread-163): 16:31:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516015f520>]}
2022-03-03 16:31:11.102911 (Thread-163): sending response (<Response 29119 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:12.867536 (Thread-164): handling poll request
2022-03-03 16:31:12.867903 (Thread-164): 16:31:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516015f280>]}
2022-03-03 16:31:12.868403 (Thread-164): sending response (<Response 292 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:13.899051 (Thread-5): 16:31:13  SQL status: SUCCESS 1 in 3.44 seconds
2022-03-03 16:31:13.902728 (Thread-5): 16:31:13  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:13.902863 (Thread-5): 16:31:13  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DBT_RAW.DBT_VAULT.hub_order__dbt_tmp
2022-03-03 16:31:14.132898 (Thread-5): 16:31:14  SQL status: SUCCESS 4 in 0.23 seconds
2022-03-03 16:31:14.137568 (Thread-5): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:14.137750 (Thread-5): 16:31:14  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DBT_RAW.DBT_VAULT.hub_order
2022-03-03 16:31:14.341167 (Thread-6): 16:31:14  SQL status: SUCCESS 1 in 3.88 seconds
2022-03-03 16:31:14.344386 (Thread-6): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:14.344506 (Thread-6): 16:31:14  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp
2022-03-03 16:31:14.387994 (Thread-4): 16:31:14  SQL status: SUCCESS 1 in 3.94 seconds
2022-03-03 16:31:14.391009 (Thread-4): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:14.391119 (Thread-4): 16:31:14  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp
2022-03-03 16:31:14.607708 (Thread-4): 16:31:14  SQL status: SUCCESS 5 in 0.22 seconds
2022-03-03 16:31:14.611130 (Thread-4): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:14.611252 (Thread-4): 16:31:14  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.hub_lineitem
2022-03-03 16:31:14.613977 (Thread-6): 16:31:14  SQL status: SUCCESS 4 in 0.27 seconds
2022-03-03 16:31:14.617411 (Thread-6): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:14.617517 (Thread-6): 16:31:14  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DBT_RAW.DBT_VAULT.hub_customer
2022-03-03 16:31:14.675383 (Thread-165): handling poll request
2022-03-03 16:31:14.675734 (Thread-165): 16:31:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603584f0>]}
2022-03-03 16:31:14.676430 (Thread-165): sending response (<Response 7961 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:14.781883 (Thread-5): 16:31:14  SQL status: SUCCESS 4 in 0.64 seconds
2022-03-03 16:31:14.786849 (Thread-5): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:14.786963 (Thread-5): 16:31:14  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_ORDER"
2022-03-03 16:31:14.967790 (Thread-6): 16:31:14  SQL status: SUCCESS 4 in 0.35 seconds
2022-03-03 16:31:14.971406 (Thread-6): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:14.971523 (Thread-6): 16:31:14  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_CUSTOMER"
2022-03-03 16:31:14.972963 (Thread-5): 16:31:14  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-03 16:31:14.975403 (Thread-5): 16:31:14  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:14.989406 (Thread-5): 16:31:14  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:14.989627 (Thread-5): 16:31:14  On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
2022-03-03 16:31:14.997075 (Thread-4): 16:31:14  SQL status: SUCCESS 5 in 0.39 seconds
2022-03-03 16:31:15.000231 (Thread-4): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:15.000335 (Thread-4): 16:31:15  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_LINEITEM"
2022-03-03 16:31:15.162774 (Thread-3): 16:31:15  SQL status: SUCCESS 1 in 5.61 seconds
2022-03-03 16:31:15.164206 (Thread-3): 16:31:15  finished collecting timing info
2022-03-03 16:31:15.164366 (Thread-3): 16:31:15  On model.dbtvault_snowflake_demo.v_stg_inventory: Close
2022-03-03 16:31:15.178527 (Thread-6): 16:31:15  SQL status: SUCCESS 4 in 0.21 seconds
2022-03-03 16:31:15.180500 (Thread-6): 16:31:15  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:15.194327 (Thread-6): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:15.194448 (Thread-6): 16:31:15  On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
2022-03-03 16:31:15.267096 (Thread-4): 16:31:15  SQL status: SUCCESS 5 in 0.27 seconds
2022-03-03 16:31:15.269288 (Thread-4): 16:31:15  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:15.281533 (Thread-4): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:15.281669 (Thread-4): 16:31:15  On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
2022-03-03 16:31:15.469255 (Thread-5): 16:31:15  SQL status: SUCCESS 1 in 0.48 seconds
2022-03-03 16:31:15.469508 (Thread-5): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:15.469604 (Thread-5): 16:31:15  On model.dbtvault_snowflake_demo.hub_order: insert into DBT_RAW.DBT_VAULT.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_order__dbt_tmp
        );
2022-03-03 16:31:15.504354 (Thread-6): 16:31:15  SQL status: SUCCESS 1 in 0.31 seconds
2022-03-03 16:31:15.504539 (Thread-6): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:15.504622 (Thread-6): 16:31:15  On model.dbtvault_snowflake_demo.hub_customer: insert into DBT_RAW.DBT_VAULT.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_customer__dbt_tmp
        );
2022-03-03 16:31:15.534490 (Thread-3): 16:31:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5024b850>]}
2022-03-03 16:31:15.534875 (Thread-3): 16:31:15  7 of 31 OK created table model DBT_VAULT.v_stg_inventory........................ [SUCCESS 1 in 7.20s]
2022-03-03 16:31:15.535001 (Thread-3): 16:31:15  Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
2022-03-03 16:31:15.535153 (Thread-3): 16:31:15  Began running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:31:15.535340 (Thread-3): 16:31:15  11 of 31 START incremental model DBT_VAULT.link_customer_nation................. [RUN]
2022-03-03 16:31:15.535587 (Thread-3): 16:31:15  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:15.535679 (Thread-3): 16:31:15  Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:31:15.535772 (Thread-3): 16:31:15  Compiling model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:31:15.565001 (Thread-3): 16:31:15  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:15.579295 (Thread-3): 16:31:15  finished collecting timing info
2022-03-03 16:31:15.579452 (Thread-3): 16:31:15  Began executing node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:31:15.583768 (Thread-3): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:15.583917 (Thread-3): 16:31:15  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_customer_nation AS d
    ON a.LINK_CUSTOMER_NATION_PK = d.LINK_CUSTOMER_NATION_PK
    WHERE d.LINK_CUSTOMER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:15.584024 (Thread-3): 16:31:15  Opening a new connection, currently in state closed
2022-03-03 16:31:15.615910 (Thread-4): 16:31:15  SQL status: SUCCESS 1 in 0.33 seconds
2022-03-03 16:31:15.616075 (Thread-4): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:15.616158 (Thread-4): 16:31:15  On model.dbtvault_snowflake_demo.hub_lineitem: insert into DBT_RAW.DBT_VAULT.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_lineitem__dbt_tmp
        );
2022-03-03 16:31:15.963260 (Thread-6): 16:31:15  SQL status: SUCCESS 0 in 0.46 seconds
2022-03-03 16:31:15.963550 (Thread-6): 16:31:15  Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
2022-03-03 16:31:15.963700 (Thread-6): 16:31:15  On model.dbtvault_snowflake_demo.hub_customer: commit;
2022-03-03 16:31:16.023265 (Thread-5): 16:31:16  SQL status: SUCCESS 0 in 0.55 seconds
2022-03-03 16:31:16.023475 (Thread-5): 16:31:16  Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
2022-03-03 16:31:16.023560 (Thread-5): 16:31:16  On model.dbtvault_snowflake_demo.hub_order: commit;
2022-03-03 16:31:16.047769 (Thread-4): 16:31:16  SQL status: SUCCESS 0 in 0.43 seconds
2022-03-03 16:31:16.047951 (Thread-4): 16:31:16  Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
2022-03-03 16:31:16.048036 (Thread-4): 16:31:16  On model.dbtvault_snowflake_demo.hub_lineitem: commit;
2022-03-03 16:31:16.429051 (Thread-166): handling poll request
2022-03-03 16:31:16.429409 (Thread-166): 16:31:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516039e6a0>]}
2022-03-03 16:31:16.430437 (Thread-166): sending response (<Response 24507 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:16.551351 (Thread-6): 16:31:16  SQL status: SUCCESS 1 in 0.59 seconds
2022-03-03 16:31:16.552965 (Thread-6): 16:31:16  finished collecting timing info
2022-03-03 16:31:16.553131 (Thread-6): 16:31:16  On model.dbtvault_snowflake_demo.hub_customer: Close
2022-03-03 16:31:16.633383 (Thread-5): 16:31:16  SQL status: SUCCESS 1 in 0.61 seconds
2022-03-03 16:31:16.634804 (Thread-5): 16:31:16  finished collecting timing info
2022-03-03 16:31:16.634961 (Thread-5): 16:31:16  On model.dbtvault_snowflake_demo.hub_order: Close
2022-03-03 16:31:16.639462 (Thread-4): 16:31:16  SQL status: SUCCESS 1 in 0.59 seconds
2022-03-03 16:31:16.640765 (Thread-4): 16:31:16  finished collecting timing info
2022-03-03 16:31:16.640907 (Thread-4): 16:31:16  On model.dbtvault_snowflake_demo.hub_lineitem: Close
2022-03-03 16:31:16.897005 (Thread-6): 16:31:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50074e50>]}
2022-03-03 16:31:16.897488 (Thread-6): 16:31:16  8 of 31 OK created incremental model DBT_VAULT.hub_customer..................... [SUCCESS 1 in 6.54s]
2022-03-03 16:31:16.897624 (Thread-6): 16:31:16  Finished running node model.dbtvault_snowflake_demo.hub_customer
2022-03-03 16:31:16.897776 (Thread-6): 16:31:16  Began running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:31:16.897973 (Thread-6): 16:31:16  12 of 31 START incremental model DBT_VAULT.link_customer_order.................. [RUN]
2022-03-03 16:31:16.898222 (Thread-6): 16:31:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:16.898312 (Thread-6): 16:31:16  Began compiling node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:31:16.898403 (Thread-6): 16:31:16  Compiling model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:31:16.968506 (Thread-6): 16:31:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:16.970829 (Thread-4): 16:31:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50177520>]}
2022-03-03 16:31:16.971282 (Thread-4): 16:31:16  9 of 31 OK created incremental model DBT_VAULT.hub_lineitem..................... [SUCCESS 1 in 6.61s]
2022-03-03 16:31:16.971407 (Thread-4): 16:31:16  Finished running node model.dbtvault_snowflake_demo.hub_lineitem
2022-03-03 16:31:16.971544 (Thread-4): 16:31:16  Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:31:16.971722 (Thread-4): 16:31:16  13 of 31 START incremental model DBT_VAULT.link_inventory_allocation............ [RUN]
2022-03-03 16:31:16.971977 (Thread-4): 16:31:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:16.972079 (Thread-4): 16:31:16  Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:31:16.972169 (Thread-4): 16:31:16  Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:31:16.980404 (Thread-4): 16:31:16  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:16.987588 (Thread-6): 16:31:16  finished collecting timing info
2022-03-03 16:31:16.987794 (Thread-6): 16:31:16  Began executing node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:31:16.991724 (Thread-6): 16:31:16  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:16.991833 (Thread-6): 16:31:16  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_customer_order AS d
    ON a.ORDER_CUSTOMER_PK = d.ORDER_CUSTOMER_PK
    WHERE d.ORDER_CUSTOMER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:16.991922 (Thread-6): 16:31:16  Opening a new connection, currently in state closed
2022-03-03 16:31:16.995447 (Thread-5): 16:31:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50177d90>]}
2022-03-03 16:31:16.995777 (Thread-5): 16:31:16  10 of 31 OK created incremental model DBT_VAULT.hub_order....................... [SUCCESS 1 in 6.62s]
2022-03-03 16:31:16.995896 (Thread-5): 16:31:16  Finished running node model.dbtvault_snowflake_demo.hub_order
2022-03-03 16:31:16.996031 (Thread-5): 16:31:16  Began running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:31:16.996212 (Thread-5): 16:31:16  14 of 31 START incremental model DBT_VAULT.link_order_lineitem.................. [RUN]
2022-03-03 16:31:16.996432 (Thread-5): 16:31:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:16.996520 (Thread-5): 16:31:16  Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:31:16.996603 (Thread-5): 16:31:16  Compiling model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:31:17.000860 (Thread-4): 16:31:17  finished collecting timing info
2022-03-03 16:31:17.000997 (Thread-4): 16:31:17  Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:31:17.004861 (Thread-4): 16:31:17  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:17.004969 (Thread-4): 16:31:17  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory_allocation AS d
    ON a.INVENTORY_ALLOCATION_PK = d.INVENTORY_ALLOCATION_PK
    WHERE d.INVENTORY_ALLOCATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:17.005054 (Thread-4): 16:31:17  Opening a new connection, currently in state closed
2022-03-03 16:31:17.009728 (Thread-5): 16:31:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:17.024750 (Thread-5): 16:31:17  finished collecting timing info
2022-03-03 16:31:17.024909 (Thread-5): 16:31:17  Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:31:17.030279 (Thread-5): 16:31:17  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:17.030412 (Thread-5): 16:31:17  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_order_lineitem AS d
    ON a.LINK_LINEITEM_ORDER_PK = d.LINK_LINEITEM_ORDER_PK
    WHERE d.LINK_LINEITEM_ORDER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:17.030538 (Thread-5): 16:31:17  Opening a new connection, currently in state closed
2022-03-03 16:31:18.234972 (Thread-167): handling poll request
2022-03-03 16:31:18.235323 (Thread-167): 16:31:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160182d60>]}
2022-03-03 16:31:18.236374 (Thread-167): sending response (<Response 25391 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:18.303562 (Thread-3): 16:31:18  SQL status: SUCCESS 1 in 2.72 seconds
2022-03-03 16:31:18.307057 (Thread-3): 16:31:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:18.307189 (Thread-3): 16:31:18  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp
2022-03-03 16:31:18.537520 (Thread-3): 16:31:18  SQL status: SUCCESS 5 in 0.23 seconds
2022-03-03 16:31:18.541743 (Thread-3): 16:31:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:18.541876 (Thread-3): 16:31:18  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_nation
2022-03-03 16:31:18.690337 (Thread-3): 16:31:18  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 16:31:18.694611 (Thread-3): 16:31:18  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:18.694733 (Thread-3): 16:31:18  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_CUSTOMER_NATION"
2022-03-03 16:31:18.983383 (Thread-3): 16:31:18  SQL status: SUCCESS 5 in 0.29 seconds
2022-03-03 16:31:18.985988 (Thread-3): 16:31:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:19.001086 (Thread-3): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:19.001232 (Thread-3): 16:31:19  On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
begin;
2022-03-03 16:31:19.349628 (Thread-3): 16:31:19  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-03 16:31:19.349872 (Thread-3): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:19.349959 (Thread-3): 16:31:19  On model.dbtvault_snowflake_demo.link_customer_nation: insert into DBT_RAW.DBT_VAULT.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_customer_nation__dbt_tmp
        );
2022-03-03 16:31:19.618135 (Thread-4): 16:31:19  SQL status: SUCCESS 1 in 2.61 seconds
2022-03-03 16:31:19.629079 (Thread-4): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:19.629288 (Thread-4): 16:31:19  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp
2022-03-03 16:31:19.778740 (Thread-6): 16:31:19  SQL status: SUCCESS 1 in 2.79 seconds
2022-03-03 16:31:19.782036 (Thread-6): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:19.782151 (Thread-6): 16:31:19  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp
2022-03-03 16:31:19.784765 (Thread-4): 16:31:19  SQL status: SUCCESS 6 in 0.16 seconds
2022-03-03 16:31:19.788020 (Thread-4): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:19.788124 (Thread-4): 16:31:19  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory_allocation
2022-03-03 16:31:19.823322 (Thread-3): 16:31:19  SQL status: SUCCESS 0 in 0.47 seconds
2022-03-03 16:31:19.823481 (Thread-3): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
2022-03-03 16:31:19.823564 (Thread-3): 16:31:19  On model.dbtvault_snowflake_demo.link_customer_nation: commit;
2022-03-03 16:31:19.914823 (Thread-4): 16:31:19  SQL status: SUCCESS 6 in 0.13 seconds
2022-03-03 16:31:19.918819 (Thread-4): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:19.918946 (Thread-4): 16:31:19  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY_ALLOCATION"
2022-03-03 16:31:19.977801 (Thread-6): 16:31:19  SQL status: SUCCESS 5 in 0.2 seconds
2022-03-03 16:31:19.983318 (Thread-6): 16:31:19  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:19.983447 (Thread-6): 16:31:19  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DBT_RAW.DBT_VAULT.link_customer_order
2022-03-03 16:31:20.011496 (Thread-168): handling poll request
2022-03-03 16:31:20.011885 (Thread-168): 16:31:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51600c3340>]}
2022-03-03 16:31:20.012682 (Thread-168): sending response (<Response 15351 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:20.095939 (Thread-4): 16:31:20  SQL status: SUCCESS 6 in 0.18 seconds
2022-03-03 16:31:20.098220 (Thread-4): 16:31:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:20.112367 (Thread-4): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:20.112501 (Thread-4): 16:31:20  On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
begin;
2022-03-03 16:31:20.141859 (Thread-5): 16:31:20  SQL status: SUCCESS 1 in 3.11 seconds
2022-03-03 16:31:20.145273 (Thread-5): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:20.145382 (Thread-5): 16:31:20  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp
2022-03-03 16:31:20.194484 (Thread-6): 16:31:20  SQL status: SUCCESS 5 in 0.21 seconds
2022-03-03 16:31:20.198259 (Thread-6): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:20.198381 (Thread-6): 16:31:20  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_CUSTOMER_ORDER"
2022-03-03 16:31:20.326717 (Thread-3): 16:31:20  SQL status: SUCCESS 1 in 0.5 seconds
2022-03-03 16:31:20.328252 (Thread-3): 16:31:20  finished collecting timing info
2022-03-03 16:31:20.328423 (Thread-3): 16:31:20  On model.dbtvault_snowflake_demo.link_customer_nation: Close
2022-03-03 16:31:20.342915 (Thread-4): 16:31:20  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-03 16:31:20.343104 (Thread-4): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:20.343189 (Thread-4): 16:31:20  On model.dbtvault_snowflake_demo.link_inventory_allocation: insert into DBT_RAW.DBT_VAULT.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory_allocation__dbt_tmp
        );
2022-03-03 16:31:20.351498 (Thread-6): 16:31:20  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 16:31:20.354013 (Thread-6): 16:31:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:20.368445 (Thread-6): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:20.368589 (Thread-6): 16:31:20  On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
begin;
2022-03-03 16:31:20.431102 (Thread-5): 16:31:20  SQL status: SUCCESS 5 in 0.29 seconds
2022-03-03 16:31:20.435094 (Thread-5): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:20.435206 (Thread-5): 16:31:20  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DBT_RAW.DBT_VAULT.link_order_lineitem
2022-03-03 16:31:20.627534 (Thread-5): 16:31:20  SQL status: SUCCESS 5 in 0.19 seconds
2022-03-03 16:31:20.631455 (Thread-5): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:20.631579 (Thread-5): 16:31:20  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_ORDER_LINEITEM"
2022-03-03 16:31:20.643284 (Thread-6): 16:31:20  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:31:20.643448 (Thread-6): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:20.643544 (Thread-6): 16:31:20  On model.dbtvault_snowflake_demo.link_customer_order: insert into DBT_RAW.DBT_VAULT.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_customer_order__dbt_tmp
        );
2022-03-03 16:31:20.681923 (Thread-3): 16:31:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe501749a0>]}
2022-03-03 16:31:20.682341 (Thread-3): 16:31:20  11 of 31 OK created incremental model DBT_VAULT.link_customer_nation............ [SUCCESS 1 in 5.15s]
2022-03-03 16:31:20.682472 (Thread-3): 16:31:20  Finished running node model.dbtvault_snowflake_demo.link_customer_nation
2022-03-03 16:31:20.682623 (Thread-3): 16:31:20  Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:31:20.682811 (Thread-3): 16:31:20  15 of 31 START incremental model DBT_VAULT.sat_order_cust_nation_details........ [RUN]
2022-03-03 16:31:20.683056 (Thread-3): 16:31:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:20.683147 (Thread-3): 16:31:20  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:31:20.683239 (Thread-3): 16:31:20  Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:31:20.723471 (Thread-3): 16:31:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:20.735912 (Thread-3): 16:31:20  finished collecting timing info
2022-03-03 16:31:20.736088 (Thread-3): 16:31:20  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:31:20.741011 (Thread-3): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:20.741136 (Thread-3): 16:31:20  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_NATION_HASHDIFF != stage.CUSTOMER_NATION_HASHDIFF
                OR latest_records.CUSTOMER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:20.741226 (Thread-3): 16:31:20  Opening a new connection, currently in state closed
2022-03-03 16:31:20.813201 (Thread-5): 16:31:20  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-03 16:31:20.815625 (Thread-5): 16:31:20  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:20.830587 (Thread-5): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:20.830788 (Thread-5): 16:31:20  On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
begin;
2022-03-03 16:31:20.859901 (Thread-4): 16:31:20  SQL status: SUCCESS 0 in 0.52 seconds
2022-03-03 16:31:20.860106 (Thread-4): 16:31:20  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
2022-03-03 16:31:20.860201 (Thread-4): 16:31:20  On model.dbtvault_snowflake_demo.link_inventory_allocation: commit;
2022-03-03 16:31:21.209603 (Thread-5): 16:31:21  SQL status: SUCCESS 1 in 0.38 seconds
2022-03-03 16:31:21.209824 (Thread-5): 16:31:21  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:21.209910 (Thread-5): 16:31:21  On model.dbtvault_snowflake_demo.link_order_lineitem: insert into DBT_RAW.DBT_VAULT.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_order_lineitem__dbt_tmp
        );
2022-03-03 16:31:21.250827 (Thread-6): 16:31:21  SQL status: SUCCESS 0 in 0.61 seconds
2022-03-03 16:31:21.251148 (Thread-6): 16:31:21  Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
2022-03-03 16:31:21.251248 (Thread-6): 16:31:21  On model.dbtvault_snowflake_demo.link_customer_order: commit;
2022-03-03 16:31:21.372912 (Thread-4): 16:31:21  SQL status: SUCCESS 1 in 0.51 seconds
2022-03-03 16:31:21.374457 (Thread-4): 16:31:21  finished collecting timing info
2022-03-03 16:31:21.374625 (Thread-4): 16:31:21  On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
2022-03-03 16:31:21.634407 (Thread-4): 16:31:21  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe502f6cd0>]}
2022-03-03 16:31:21.634881 (Thread-4): 16:31:21  13 of 31 OK created incremental model DBT_VAULT.link_inventory_allocation....... [SUCCESS 1 in 4.66s]
2022-03-03 16:31:21.635031 (Thread-4): 16:31:21  Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
2022-03-03 16:31:21.635178 (Thread-4): 16:31:21  Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:31:21.635375 (Thread-4): 16:31:21  16 of 31 START incremental model DBT_VAULT.sat_order_cust_region_details........ [RUN]
2022-03-03 16:31:21.635620 (Thread-4): 16:31:21  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:21.635710 (Thread-4): 16:31:21  Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:31:21.635826 (Thread-4): 16:31:21  Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:31:21.650267 (Thread-4): 16:31:21  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:21.663256 (Thread-4): 16:31:21  finished collecting timing info
2022-03-03 16:31:21.663472 (Thread-4): 16:31:21  Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:31:21.670091 (Thread-4): 16:31:21  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:21.670205 (Thread-4): 16:31:21  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_REGION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_REGION_HASHDIFF != stage.CUSTOMER_REGION_HASHDIFF
                OR latest_records.CUSTOMER_REGION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:21.670295 (Thread-4): 16:31:21  Opening a new connection, currently in state closed
2022-03-03 16:31:21.696558 (Thread-5): 16:31:21  SQL status: SUCCESS 0 in 0.49 seconds
2022-03-03 16:31:21.696756 (Thread-5): 16:31:21  Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
2022-03-03 16:31:21.696889 (Thread-5): 16:31:21  On model.dbtvault_snowflake_demo.link_order_lineitem: commit;
2022-03-03 16:31:21.759430 (Thread-6): 16:31:21  SQL status: SUCCESS 1 in 0.51 seconds
2022-03-03 16:31:21.761623 (Thread-6): 16:31:21  finished collecting timing info
2022-03-03 16:31:21.761858 (Thread-6): 16:31:21  On model.dbtvault_snowflake_demo.link_customer_order: Close
2022-03-03 16:31:21.819464 (Thread-169): handling poll request
2022-03-03 16:31:21.819804 (Thread-169): 16:31:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160344130>]}
2022-03-03 16:31:21.821128 (Thread-169): sending response (<Response 38288 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:22.062372 (Thread-6): 16:31:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe502801c0>]}
2022-03-03 16:31:22.062838 (Thread-6): 16:31:22  12 of 31 OK created incremental model DBT_VAULT.link_customer_order............. [SUCCESS 1 in 5.16s]
2022-03-03 16:31:22.062967 (Thread-6): 16:31:22  Finished running node model.dbtvault_snowflake_demo.link_customer_order
2022-03-03 16:31:22.063115 (Thread-6): 16:31:22  Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:31:22.063305 (Thread-6): 16:31:22  17 of 31 START incremental model DBT_VAULT.sat_order_customer_details........... [RUN]
2022-03-03 16:31:22.063564 (Thread-6): 16:31:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:22.063704 (Thread-6): 16:31:22  Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:31:22.063815 (Thread-6): 16:31:22  Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:31:22.081284 (Thread-6): 16:31:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:22.094940 (Thread-6): 16:31:22  finished collecting timing info
2022-03-03 16:31:22.095095 (Thread-6): 16:31:22  Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:31:22.100259 (Thread-6): 16:31:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:22.100378 (Thread-6): 16:31:22  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:22.100468 (Thread-6): 16:31:22  Opening a new connection, currently in state closed
2022-03-03 16:31:22.181522 (Thread-5): 16:31:22  SQL status: SUCCESS 1 in 0.48 seconds
2022-03-03 16:31:22.184003 (Thread-5): 16:31:22  finished collecting timing info
2022-03-03 16:31:22.184271 (Thread-5): 16:31:22  On model.dbtvault_snowflake_demo.link_order_lineitem: Close
2022-03-03 16:31:22.582858 (Thread-5): 16:31:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50365e50>]}
2022-03-03 16:31:22.583300 (Thread-5): 16:31:22  14 of 31 OK created incremental model DBT_VAULT.link_order_lineitem............. [SUCCESS 1 in 5.59s]
2022-03-03 16:31:22.583435 (Thread-5): 16:31:22  Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
2022-03-03 16:31:22.583582 (Thread-5): 16:31:22  Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:31:22.583768 (Thread-5): 16:31:22  18 of 31 START incremental model DBT_VAULT.sat_order_lineitem_details........... [RUN]
2022-03-03 16:31:22.584047 (Thread-5): 16:31:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:22.584143 (Thread-5): 16:31:22  Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:31:22.584241 (Thread-5): 16:31:22  Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:31:22.604186 (Thread-5): 16:31:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:22.619310 (Thread-5): 16:31:22  finished collecting timing info
2022-03-03 16:31:22.619503 (Thread-5): 16:31:22  Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:31:22.625294 (Thread-5): 16:31:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:22.625422 (Thread-5): 16:31:22  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

latest_records AS (

    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINEITEM_PK, current_records.LINEITEM_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.LINEITEM_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINEITEM_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINEITEM_PK = source_records.LINEITEM_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.LINEITEM_PK = stage.LINEITEM_PK
                WHERE latest_records.LINEITEM_HASHDIFF != stage.LINEITEM_HASHDIFF
                OR latest_records.LINEITEM_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:22.625514 (Thread-5): 16:31:22  Opening a new connection, currently in state closed
2022-03-03 16:31:23.084889 (Thread-3): 16:31:23  SQL status: SUCCESS 1 in 2.34 seconds
2022-03-03 16:31:23.089030 (Thread-3): 16:31:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:23.089177 (Thread-3): 16:31:23  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp
2022-03-03 16:31:23.411499 (Thread-3): 16:31:23  SQL status: SUCCESS 7 in 0.32 seconds
2022-03-03 16:31:23.417208 (Thread-3): 16:31:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:23.417345 (Thread-3): 16:31:23  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_nation_details
2022-03-03 16:31:23.563494 (Thread-170): handling poll request
2022-03-03 16:31:23.563838 (Thread-170): 16:31:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160105c10>]}
2022-03-03 16:31:23.564755 (Thread-170): sending response (<Response 20716 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:23.562872 (Thread-3): 16:31:23  SQL status: SUCCESS 7 in 0.15 seconds
2022-03-03 16:31:23.567686 (Thread-3): 16:31:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:23.567857 (Thread-3): 16:31:23  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUST_NATION_DETAILS"
2022-03-03 16:31:23.774488 (Thread-3): 16:31:23  SQL status: SUCCESS 7 in 0.21 seconds
2022-03-03 16:31:23.777113 (Thread-3): 16:31:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:23.790271 (Thread-3): 16:31:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:23.790407 (Thread-3): 16:31:23  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
begin;
2022-03-03 16:31:24.094448 (Thread-3): 16:31:24  SQL status: SUCCESS 1 in 0.3 seconds
2022-03-03 16:31:24.094671 (Thread-3): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:24.094762 (Thread-3): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: insert into DBT_RAW.DBT_VAULT.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_cust_nation_details__dbt_tmp
        );
2022-03-03 16:31:24.267841 (Thread-4): 16:31:24  SQL status: SUCCESS 1 in 2.6 seconds
2022-03-03 16:31:24.271196 (Thread-4): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:24.271332 (Thread-4): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp
2022-03-03 16:31:24.493085 (Thread-4): 16:31:24  SQL status: SUCCESS 7 in 0.22 seconds
2022-03-03 16:31:24.499861 (Thread-4): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:24.500056 (Thread-4): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_cust_region_details
2022-03-03 16:31:24.561441 (Thread-3): 16:31:24  SQL status: SUCCESS 0 in 0.47 seconds
2022-03-03 16:31:24.561682 (Thread-3): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
2022-03-03 16:31:24.561855 (Thread-3): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: commit;
2022-03-03 16:31:24.755311 (Thread-6): 16:31:24  SQL status: SUCCESS 1 in 2.65 seconds
2022-03-03 16:31:24.759092 (Thread-6): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:24.759222 (Thread-6): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp
2022-03-03 16:31:24.806579 (Thread-4): 16:31:24  SQL status: SUCCESS 7 in 0.31 seconds
2022-03-03 16:31:24.810442 (Thread-4): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:24.810564 (Thread-4): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUST_REGION_DETAILS"
2022-03-03 16:31:24.975703 (Thread-4): 16:31:24  SQL status: SUCCESS 7 in 0.16 seconds
2022-03-03 16:31:24.978212 (Thread-4): 16:31:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:24.992029 (Thread-4): 16:31:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:24.992171 (Thread-4): 16:31:24  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
begin;
2022-03-03 16:31:25.009058 (Thread-6): 16:31:25  SQL status: SUCCESS 12 in 0.25 seconds
2022-03-03 16:31:25.013259 (Thread-6): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:25.013367 (Thread-6): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_customer_details
2022-03-03 16:31:25.087831 (Thread-5): 16:31:25  SQL status: SUCCESS 1 in 2.46 seconds
2022-03-03 16:31:25.090957 (Thread-5): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:25.091078 (Thread-5): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp
2022-03-03 16:31:25.160164 (Thread-3): 16:31:25  SQL status: SUCCESS 1 in 0.6 seconds
2022-03-03 16:31:25.161867 (Thread-3): 16:31:25  finished collecting timing info
2022-03-03 16:31:25.162035 (Thread-3): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
2022-03-03 16:31:25.258948 (Thread-6): 16:31:25  SQL status: SUCCESS 12 in 0.25 seconds
2022-03-03 16:31:25.263168 (Thread-6): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:25.263295 (Thread-6): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_CUSTOMER_DETAILS"
2022-03-03 16:31:25.272306 (Thread-171): handling poll request
2022-03-03 16:31:25.272688 (Thread-171): 16:31:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516039ed00>]}
2022-03-03 16:31:25.273617 (Thread-171): sending response (<Response 18976 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:25.307491 (Thread-4): 16:31:25  SQL status: SUCCESS 1 in 0.32 seconds
2022-03-03 16:31:25.307711 (Thread-4): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:25.307798 (Thread-4): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: insert into DBT_RAW.DBT_VAULT.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_cust_region_details__dbt_tmp
        );
2022-03-03 16:31:25.349063 (Thread-5): 16:31:25  SQL status: SUCCESS 16 in 0.26 seconds
2022-03-03 16:31:25.353234 (Thread-5): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:25.353364 (Thread-5): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_lineitem_details
2022-03-03 16:31:25.534283 (Thread-6): 16:31:25  SQL status: SUCCESS 12 in 0.27 seconds
2022-03-03 16:31:25.547041 (Thread-6): 16:31:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:25.547810 (Thread-5): 16:31:25  SQL status: SUCCESS 16 in 0.19 seconds
2022-03-03 16:31:25.552996 (Thread-5): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:25.553107 (Thread-5): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_LINEITEM_DETAILS"
2022-03-03 16:31:25.566507 (Thread-6): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:25.566651 (Thread-6): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
2022-03-03 16:31:25.612821 (Thread-3): 16:31:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50035430>]}
2022-03-03 16:31:25.613233 (Thread-3): 16:31:25  15 of 31 OK created incremental model DBT_VAULT.sat_order_cust_nation_details... [SUCCESS 1 in 4.93s]
2022-03-03 16:31:25.613361 (Thread-3): 16:31:25  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
2022-03-03 16:31:25.613512 (Thread-3): 16:31:25  Began running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:31:25.613741 (Thread-3): 16:31:25  19 of 31 START incremental model DBT_VAULT.sat_order_order_details.............. [RUN]
2022-03-03 16:31:25.613986 (Thread-3): 16:31:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:25.614079 (Thread-3): 16:31:25  Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:31:25.614168 (Thread-3): 16:31:25  Compiling model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:31:25.630431 (Thread-3): 16:31:25  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:25.644218 (Thread-3): 16:31:25  finished collecting timing info
2022-03-03 16:31:25.644369 (Thread-3): 16:31:25  Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:31:25.648881 (Thread-3): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:25.648991 (Thread-3): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.ORDER_PK = stage.ORDER_PK
                WHERE latest_records.ORDER_HASHDIFF != stage.ORDER_HASHDIFF
                OR latest_records.ORDER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:25.649079 (Thread-3): 16:31:25  Opening a new connection, currently in state closed
2022-03-03 16:31:25.715531 (Thread-5): 16:31:25  SQL status: SUCCESS 16 in 0.16 seconds
2022-03-03 16:31:25.718432 (Thread-5): 16:31:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:25.731809 (Thread-5): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:25.731944 (Thread-5): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
begin;
2022-03-03 16:31:25.739077 (Thread-4): 16:31:25  SQL status: SUCCESS 0 in 0.43 seconds
2022-03-03 16:31:25.739226 (Thread-4): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
2022-03-03 16:31:25.739313 (Thread-4): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: commit;
2022-03-03 16:31:25.820443 (Thread-6): 16:31:25  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:31:25.820725 (Thread-6): 16:31:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:25.820821 (Thread-6): 16:31:25  On model.dbtvault_snowflake_demo.sat_order_customer_details: merge into DBT_RAW.DBT_VAULT.sat_order_customer_details as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_order_customer_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","CUSTOMER_ACCBAL" = DBT_INTERNAL_SOURCE."CUSTOMER_ACCBAL","CUSTOMER_MKTSEGMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_MKTSEGMENT","CUSTOMER_COMMENT" = DBT_INTERNAL_SOURCE."CUSTOMER_COMMENT","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 16:31:26.026024 (Thread-5): 16:31:26  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 16:31:26.026273 (Thread-5): 16:31:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:26.026363 (Thread-5): 16:31:26  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: insert into DBT_RAW.DBT_VAULT.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_lineitem_details__dbt_tmp
        );
2022-03-03 16:31:26.179573 (Thread-4): 16:31:26  SQL status: SUCCESS 1 in 0.44 seconds
2022-03-03 16:31:26.181161 (Thread-4): 16:31:26  finished collecting timing info
2022-03-03 16:31:26.181323 (Thread-4): 16:31:26  On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
2022-03-03 16:31:26.410359 (Thread-6): 16:31:26  SQL status: SUCCESS 0 in 0.59 seconds
2022-03-03 16:31:26.410588 (Thread-6): 16:31:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
2022-03-03 16:31:26.410673 (Thread-6): 16:31:26  On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
2022-03-03 16:31:26.456930 (Thread-4): 16:31:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe500dfbe0>]}
2022-03-03 16:31:26.457521 (Thread-4): 16:31:26  16 of 31 OK created incremental model DBT_VAULT.sat_order_cust_region_details... [SUCCESS 1 in 4.82s]
2022-03-03 16:31:26.457738 (Thread-4): 16:31:26  Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
2022-03-03 16:31:26.457989 (Thread-4): 16:31:26  Began running node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:31:26.458250 (Thread-4): 16:31:26  20 of 31 START incremental model DBT_VAULT.hub_nation........................... [RUN]
2022-03-03 16:31:26.458500 (Thread-4): 16:31:26  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:26.458593 (Thread-4): 16:31:26  Began compiling node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:31:26.458684 (Thread-4): 16:31:26  Compiling model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:31:26.474704 (Thread-4): 16:31:26  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:26.488706 (Thread-4): 16:31:26  finished collecting timing info
2022-03-03 16:31:26.488942 (Thread-4): 16:31:26  Began executing node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:31:26.495464 (Thread-4): 16:31:26  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:26.495636 (Thread-4): 16:31:26  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_nation AS d
    ON a.NATION_PK = d.NATION_PK
    WHERE d.NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:26.495787 (Thread-4): 16:31:26  Opening a new connection, currently in state closed
2022-03-03 16:31:26.519530 (Thread-5): 16:31:26  SQL status: SUCCESS 0 in 0.49 seconds
2022-03-03 16:31:26.519711 (Thread-5): 16:31:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
2022-03-03 16:31:26.519795 (Thread-5): 16:31:26  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: commit;
2022-03-03 16:31:26.869532 (Thread-6): 16:31:26  SQL status: SUCCESS 1 in 0.46 seconds
2022-03-03 16:31:26.871206 (Thread-6): 16:31:26  finished collecting timing info
2022-03-03 16:31:26.871377 (Thread-6): 16:31:26  On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
2022-03-03 16:31:27.034578 (Thread-5): 16:31:27  SQL status: SUCCESS 1 in 0.51 seconds
2022-03-03 16:31:27.036067 (Thread-5): 16:31:27  finished collecting timing info
2022-03-03 16:31:27.036238 (Thread-5): 16:31:27  On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
2022-03-03 16:31:27.059413 (Thread-172): handling poll request
2022-03-03 16:31:27.059760 (Thread-172): 16:31:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516014a4c0>]}
2022-03-03 16:31:27.060949 (Thread-172): sending response (<Response 35450 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:27.114723 (Thread-6): 16:31:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50126400>]}
2022-03-03 16:31:27.115156 (Thread-6): 16:31:27  17 of 31 OK created incremental model DBT_VAULT.sat_order_customer_details...... [SUCCESS 1 in 5.05s]
2022-03-03 16:31:27.115287 (Thread-6): 16:31:27  Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
2022-03-03 16:31:27.115433 (Thread-6): 16:31:27  Began running node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:31:27.115622 (Thread-6): 16:31:27  21 of 31 START incremental model DBT_VAULT.hub_part............................. [RUN]
2022-03-03 16:31:27.115866 (Thread-6): 16:31:27  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:27.115959 (Thread-6): 16:31:27  Began compiling node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:31:27.116049 (Thread-6): 16:31:27  Compiling model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:31:27.126496 (Thread-6): 16:31:27  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:27.140357 (Thread-6): 16:31:27  finished collecting timing info
2022-03-03 16:31:27.140537 (Thread-6): 16:31:27  Began executing node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:31:27.145098 (Thread-6): 16:31:27  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:27.145223 (Thread-6): 16:31:27  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_part AS d
    ON a.PART_PK = d.PART_PK
    WHERE d.PART_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:27.145315 (Thread-6): 16:31:27  Opening a new connection, currently in state closed
2022-03-03 16:31:27.515126 (Thread-5): 16:31:27  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe581bbd90>]}
2022-03-03 16:31:27.515571 (Thread-5): 16:31:27  18 of 31 OK created incremental model DBT_VAULT.sat_order_lineitem_details...... [SUCCESS 1 in 4.93s]
2022-03-03 16:31:27.515707 (Thread-5): 16:31:27  Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
2022-03-03 16:31:27.515851 (Thread-5): 16:31:27  Began running node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:31:27.516036 (Thread-5): 16:31:27  22 of 31 START incremental model DBT_VAULT.hub_region........................... [RUN]
2022-03-03 16:31:27.516308 (Thread-5): 16:31:27  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:27.516401 (Thread-5): 16:31:27  Began compiling node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:31:27.516493 (Thread-5): 16:31:27  Compiling model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:31:27.527470 (Thread-5): 16:31:27  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:27.541849 (Thread-5): 16:31:27  finished collecting timing info
2022-03-03 16:31:27.542028 (Thread-5): 16:31:27  Began executing node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:31:27.546750 (Thread-5): 16:31:27  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:27.546872 (Thread-5): 16:31:27  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_region AS d
    ON a.REGION_PK = d.REGION_PK
    WHERE d.REGION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:27.546963 (Thread-5): 16:31:27  Opening a new connection, currently in state closed
2022-03-03 16:31:27.875997 (Thread-3): 16:31:27  SQL status: SUCCESS 1 in 2.23 seconds
2022-03-03 16:31:27.879373 (Thread-3): 16:31:27  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:27.879491 (Thread-3): 16:31:27  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp
2022-03-03 16:31:28.059001 (Thread-3): 16:31:28  SQL status: SUCCESS 12 in 0.18 seconds
2022-03-03 16:31:28.064831 (Thread-3): 16:31:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:28.065003 (Thread-3): 16:31:28  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_order_order_details
2022-03-03 16:31:28.206944 (Thread-3): 16:31:28  SQL status: SUCCESS 12 in 0.14 seconds
2022-03-03 16:31:28.214354 (Thread-3): 16:31:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:28.214485 (Thread-3): 16:31:28  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_ORDER_ORDER_DETAILS"
2022-03-03 16:31:28.392535 (Thread-3): 16:31:28  SQL status: SUCCESS 12 in 0.18 seconds
2022-03-03 16:31:28.395430 (Thread-3): 16:31:28  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:28.409512 (Thread-3): 16:31:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:28.409661 (Thread-3): 16:31:28  On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
begin;
2022-03-03 16:31:28.775577 (Thread-3): 16:31:28  SQL status: SUCCESS 1 in 0.37 seconds
2022-03-03 16:31:28.775805 (Thread-3): 16:31:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:28.775892 (Thread-3): 16:31:28  On model.dbtvault_snowflake_demo.sat_order_order_details: insert into DBT_RAW.DBT_VAULT.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_order_order_details__dbt_tmp
        );
2022-03-03 16:31:28.828355 (Thread-173): handling poll request
2022-03-03 16:31:28.828732 (Thread-173): 16:31:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160192d60>]}
2022-03-03 16:31:28.829718 (Thread-173): sending response (<Response 22883 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:29.201567 (Thread-3): 16:31:29  SQL status: SUCCESS 0 in 0.43 seconds
2022-03-03 16:31:29.201771 (Thread-3): 16:31:29  Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
2022-03-03 16:31:29.201857 (Thread-3): 16:31:29  On model.dbtvault_snowflake_demo.sat_order_order_details: commit;
2022-03-03 16:31:29.514428 (Thread-4): 16:31:29  SQL status: SUCCESS 1 in 3.02 seconds
2022-03-03 16:31:29.580108 (Thread-4): 16:31:29  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:29.580268 (Thread-4): 16:31:29  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp
2022-03-03 16:31:29.709425 (Thread-6): 16:31:29  SQL status: SUCCESS 1 in 2.56 seconds
2022-03-03 16:31:29.712714 (Thread-6): 16:31:29  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:29.712845 (Thread-6): 16:31:29  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DBT_RAW.DBT_VAULT.hub_part__dbt_tmp
2022-03-03 16:31:29.817441 (Thread-3): 16:31:29  SQL status: SUCCESS 1 in 0.62 seconds
2022-03-03 16:31:29.818964 (Thread-3): 16:31:29  finished collecting timing info
2022-03-03 16:31:29.819131 (Thread-3): 16:31:29  On model.dbtvault_snowflake_demo.sat_order_order_details: Close
2022-03-03 16:31:29.828435 (Thread-4): 16:31:29  SQL status: SUCCESS 4 in 0.25 seconds
2022-03-03 16:31:29.832060 (Thread-4): 16:31:29  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:29.832170 (Thread-4): 16:31:29  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DBT_RAW.DBT_VAULT.hub_nation
2022-03-03 16:31:29.962928 (Thread-6): 16:31:29  SQL status: SUCCESS 4 in 0.25 seconds
2022-03-03 16:31:29.966572 (Thread-6): 16:31:29  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:29.966694 (Thread-6): 16:31:29  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DBT_RAW.DBT_VAULT.hub_part
2022-03-03 16:31:29.999320 (Thread-4): 16:31:29  SQL status: SUCCESS 4 in 0.17 seconds
2022-03-03 16:31:30.003092 (Thread-4): 16:31:30  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:30.003230 (Thread-4): 16:31:30  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_NATION"
2022-03-03 16:31:30.086882 (Thread-6): 16:31:30  SQL status: SUCCESS 4 in 0.12 seconds
2022-03-03 16:31:30.090354 (Thread-6): 16:31:30  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:30.090474 (Thread-6): 16:31:30  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_PART"
2022-03-03 16:31:30.094194 (Thread-3): 16:31:30  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50143310>]}
2022-03-03 16:31:30.094675 (Thread-3): 16:31:30  19 of 31 OK created incremental model DBT_VAULT.sat_order_order_details......... [SUCCESS 1 in 4.48s]
2022-03-03 16:31:30.094843 (Thread-3): 16:31:30  Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
2022-03-03 16:31:30.095003 (Thread-3): 16:31:30  Began running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:31:30.095222 (Thread-3): 16:31:30  23 of 31 START incremental model DBT_VAULT.hub_supplier......................... [RUN]
2022-03-03 16:31:30.095487 (Thread-3): 16:31:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:30.095589 (Thread-3): 16:31:30  Began compiling node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:31:30.095688 (Thread-3): 16:31:30  Compiling model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:31:30.107083 (Thread-3): 16:31:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:30.119968 (Thread-3): 16:31:30  finished collecting timing info
2022-03-03 16:31:30.120120 (Thread-3): 16:31:30  Began executing node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:31:30.124710 (Thread-3): 16:31:30  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:30.124836 (Thread-3): 16:31:30  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.hub_supplier AS d
    ON a.SUPPLIER_PK = d.SUPPLIER_PK
    WHERE d.SUPPLIER_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:30.124935 (Thread-3): 16:31:30  Opening a new connection, currently in state closed
2022-03-03 16:31:30.220572 (Thread-4): 16:31:30  SQL status: SUCCESS 4 in 0.22 seconds
2022-03-03 16:31:30.223338 (Thread-4): 16:31:30  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:30.237653 (Thread-4): 16:31:30  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:30.237847 (Thread-4): 16:31:30  On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
2022-03-03 16:31:30.327211 (Thread-6): 16:31:30  SQL status: SUCCESS 4 in 0.24 seconds
2022-03-03 16:31:30.329310 (Thread-6): 16:31:30  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:30.351016 (Thread-6): 16:31:30  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:30.351159 (Thread-6): 16:31:30  On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
2022-03-03 16:31:30.550133 (Thread-4): 16:31:30  SQL status: SUCCESS 1 in 0.31 seconds
2022-03-03 16:31:30.550465 (Thread-4): 16:31:30  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:30.550601 (Thread-4): 16:31:30  On model.dbtvault_snowflake_demo.hub_nation: insert into DBT_RAW.DBT_VAULT.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_nation__dbt_tmp
        );
2022-03-03 16:31:30.594777 (Thread-174): handling poll request
2022-03-03 16:31:30.595145 (Thread-174): 16:31:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516019d670>]}
2022-03-03 16:31:30.596245 (Thread-174): sending response (<Response 22375 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:31.063841 (Thread-6): 16:31:31  SQL status: SUCCESS 1 in 0.71 seconds
2022-03-03 16:31:31.064063 (Thread-6): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:31.064149 (Thread-6): 16:31:31  On model.dbtvault_snowflake_demo.hub_part: insert into DBT_RAW.DBT_VAULT.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_part__dbt_tmp
        );
2022-03-03 16:31:31.208405 (Thread-4): 16:31:31  SQL status: SUCCESS 0 in 0.66 seconds
2022-03-03 16:31:31.208611 (Thread-4): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
2022-03-03 16:31:31.208732 (Thread-4): 16:31:31  On model.dbtvault_snowflake_demo.hub_nation: commit;
2022-03-03 16:31:31.333521 (Thread-5): 16:31:31  SQL status: SUCCESS 1 in 3.79 seconds
2022-03-03 16:31:31.337601 (Thread-5): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:31.337735 (Thread-5): 16:31:31  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DBT_RAW.DBT_VAULT.hub_region__dbt_tmp
2022-03-03 16:31:31.526611 (Thread-5): 16:31:31  SQL status: SUCCESS 4 in 0.19 seconds
2022-03-03 16:31:31.530326 (Thread-5): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:31.530451 (Thread-5): 16:31:31  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DBT_RAW.DBT_VAULT.hub_region
2022-03-03 16:31:31.548291 (Thread-6): 16:31:31  SQL status: SUCCESS 0 in 0.48 seconds
2022-03-03 16:31:31.548459 (Thread-6): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
2022-03-03 16:31:31.548542 (Thread-6): 16:31:31  On model.dbtvault_snowflake_demo.hub_part: commit;
2022-03-03 16:31:31.689822 (Thread-4): 16:31:31  SQL status: SUCCESS 1 in 0.48 seconds
2022-03-03 16:31:31.691886 (Thread-4): 16:31:31  finished collecting timing info
2022-03-03 16:31:31.692062 (Thread-4): 16:31:31  On model.dbtvault_snowflake_demo.hub_nation: Close
2022-03-03 16:31:31.710385 (Thread-5): 16:31:31  SQL status: SUCCESS 4 in 0.18 seconds
2022-03-03 16:31:31.715323 (Thread-5): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:31.715435 (Thread-5): 16:31:31  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_REGION"
2022-03-03 16:31:31.909186 (Thread-6): 16:31:31  SQL status: SUCCESS 1 in 0.36 seconds
2022-03-03 16:31:31.910736 (Thread-6): 16:31:31  finished collecting timing info
2022-03-03 16:31:31.910900 (Thread-6): 16:31:31  On model.dbtvault_snowflake_demo.hub_part: Close
2022-03-03 16:31:31.945679 (Thread-4): 16:31:31  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5015adc0>]}
2022-03-03 16:31:31.946096 (Thread-4): 16:31:31  20 of 31 OK created incremental model DBT_VAULT.hub_nation...................... [SUCCESS 1 in 5.49s]
2022-03-03 16:31:31.946239 (Thread-4): 16:31:31  Finished running node model.dbtvault_snowflake_demo.hub_nation
2022-03-03 16:31:31.946388 (Thread-4): 16:31:31  Began running node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:31:31.946580 (Thread-4): 16:31:31  24 of 31 START incremental model DBT_VAULT.link_inventory....................... [RUN]
2022-03-03 16:31:31.946835 (Thread-4): 16:31:31  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:31.946927 (Thread-4): 16:31:31  Began compiling node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:31:31.947017 (Thread-4): 16:31:31  Compiling model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:31:31.956478 (Thread-4): 16:31:31  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:31.974425 (Thread-4): 16:31:31  finished collecting timing info
2022-03-03 16:31:31.974592 (Thread-4): 16:31:31  Began executing node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:31:31.978927 (Thread-4): 16:31:31  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:31.979039 (Thread-4): 16:31:31  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_inventory AS d
    ON a.INVENTORY_PK = d.INVENTORY_PK
    WHERE d.INVENTORY_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:31.979128 (Thread-4): 16:31:31  Opening a new connection, currently in state closed
2022-03-03 16:31:32.082739 (Thread-5): 16:31:32  SQL status: SUCCESS 4 in 0.37 seconds
2022-03-03 16:31:32.085050 (Thread-5): 16:31:32  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:32.101097 (Thread-5): 16:31:32  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:32.101237 (Thread-5): 16:31:32  On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
2022-03-03 16:31:32.293540 (Thread-6): 16:31:32  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58124190>]}
2022-03-03 16:31:32.294042 (Thread-6): 16:31:32  21 of 31 OK created incremental model DBT_VAULT.hub_part........................ [SUCCESS 1 in 5.18s]
2022-03-03 16:31:32.294190 (Thread-6): 16:31:32  Finished running node model.dbtvault_snowflake_demo.hub_part
2022-03-03 16:31:32.294339 (Thread-6): 16:31:32  Began running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:31:32.294591 (Thread-6): 16:31:32  25 of 31 START incremental model DBT_VAULT.link_nation_region................... [RUN]
2022-03-03 16:31:32.294889 (Thread-6): 16:31:32  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:32.294985 (Thread-6): 16:31:32  Began compiling node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:31:32.295077 (Thread-6): 16:31:32  Compiling model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:31:32.316287 (Thread-6): 16:31:32  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:32.329625 (Thread-5): 16:31:32  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-03 16:31:32.329802 (Thread-5): 16:31:32  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:32.329887 (Thread-5): 16:31:32  On model.dbtvault_snowflake_demo.hub_region: insert into DBT_RAW.DBT_VAULT.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_region__dbt_tmp
        );
2022-03-03 16:31:32.336268 (Thread-6): 16:31:32  finished collecting timing info
2022-03-03 16:31:32.336432 (Thread-6): 16:31:32  Began executing node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:31:32.341257 (Thread-6): 16:31:32  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:32.341364 (Thread-6): 16:31:32  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_nation_region AS d
    ON a.NATION_REGION_PK = d.NATION_REGION_PK
    WHERE d.NATION_REGION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:32.341451 (Thread-6): 16:31:32  Opening a new connection, currently in state closed
2022-03-03 16:31:32.386813 (Thread-175): handling poll request
2022-03-03 16:31:32.387289 (Thread-175): 16:31:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160392d60>]}
2022-03-03 16:31:32.388407 (Thread-175): sending response (<Response 27499 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:32.755046 (Thread-3): 16:31:32  SQL status: SUCCESS 1 in 2.63 seconds
2022-03-03 16:31:32.758542 (Thread-3): 16:31:32  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:32.758658 (Thread-3): 16:31:32  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp
2022-03-03 16:31:32.859390 (Thread-5): 16:31:32  SQL status: SUCCESS 0 in 0.53 seconds
2022-03-03 16:31:32.859591 (Thread-5): 16:31:32  Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
2022-03-03 16:31:32.859675 (Thread-5): 16:31:32  On model.dbtvault_snowflake_demo.hub_region: commit;
2022-03-03 16:31:33.040247 (Thread-3): 16:31:33  SQL status: SUCCESS 4 in 0.28 seconds
2022-03-03 16:31:33.043934 (Thread-3): 16:31:33  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:33.044060 (Thread-3): 16:31:33  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DBT_RAW.DBT_VAULT.hub_supplier
2022-03-03 16:31:33.174415 (Thread-3): 16:31:33  SQL status: SUCCESS 4 in 0.13 seconds
2022-03-03 16:31:33.178165 (Thread-3): 16:31:33  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:33.178295 (Thread-3): 16:31:33  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DBT_RAW"."DBT_VAULT"."HUB_SUPPLIER"
2022-03-03 16:31:33.340338 (Thread-5): 16:31:33  SQL status: SUCCESS 1 in 0.48 seconds
2022-03-03 16:31:33.341904 (Thread-5): 16:31:33  finished collecting timing info
2022-03-03 16:31:33.342071 (Thread-5): 16:31:33  On model.dbtvault_snowflake_demo.hub_region: Close
2022-03-03 16:31:33.465544 (Thread-3): 16:31:33  SQL status: SUCCESS 4 in 0.29 seconds
2022-03-03 16:31:33.467612 (Thread-3): 16:31:33  Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:33.481971 (Thread-3): 16:31:33  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:33.482094 (Thread-3): 16:31:33  On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
2022-03-03 16:31:33.650513 (Thread-5): 16:31:33  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58182370>]}
2022-03-03 16:31:33.650965 (Thread-5): 16:31:33  22 of 31 OK created incremental model DBT_VAULT.hub_region...................... [SUCCESS 1 in 6.13s]
2022-03-03 16:31:33.651104 (Thread-5): 16:31:33  Finished running node model.dbtvault_snowflake_demo.hub_region
2022-03-03 16:31:33.651253 (Thread-5): 16:31:33  Began running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:31:33.651485 (Thread-5): 16:31:33  26 of 31 START incremental model DBT_VAULT.link_supplier_nation................. [RUN]
2022-03-03 16:31:33.651768 (Thread-5): 16:31:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:33.651871 (Thread-5): 16:31:33  Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:31:33.651965 (Thread-5): 16:31:33  Compiling model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:31:33.661107 (Thread-5): 16:31:33  Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:33.673742 (Thread-5): 16:31:33  finished collecting timing info
2022-03-03 16:31:33.673892 (Thread-5): 16:31:33  Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:31:33.677652 (Thread-5): 16:31:33  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:33.677756 (Thread-5): 16:31:33  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN DBT_RAW.DBT_VAULT.link_supplier_nation AS d
    ON a.LINK_SUPPLIER_NATION_PK = d.LINK_SUPPLIER_NATION_PK
    WHERE d.LINK_SUPPLIER_NATION_PK IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:33.677958 (Thread-5): 16:31:33  Opening a new connection, currently in state closed
2022-03-03 16:31:33.767793 (Thread-3): 16:31:33  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 16:31:33.767998 (Thread-3): 16:31:33  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:33.768084 (Thread-3): 16:31:33  On model.dbtvault_snowflake_demo.hub_supplier: insert into DBT_RAW.DBT_VAULT.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.hub_supplier__dbt_tmp
        );
2022-03-03 16:31:34.231490 (Thread-176): handling poll request
2022-03-03 16:31:34.231951 (Thread-176): 16:31:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516033fd00>]}
2022-03-03 16:31:34.232900 (Thread-176): sending response (<Response 16493 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:34.290929 (Thread-3): 16:31:34  SQL status: SUCCESS 0 in 0.52 seconds
2022-03-03 16:31:34.291135 (Thread-3): 16:31:34  Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
2022-03-03 16:31:34.291222 (Thread-3): 16:31:34  On model.dbtvault_snowflake_demo.hub_supplier: commit;
2022-03-03 16:31:34.749181 (Thread-3): 16:31:34  SQL status: SUCCESS 1 in 0.46 seconds
2022-03-03 16:31:34.750733 (Thread-3): 16:31:34  finished collecting timing info
2022-03-03 16:31:34.750901 (Thread-3): 16:31:34  On model.dbtvault_snowflake_demo.hub_supplier: Close
2022-03-03 16:31:34.906967 (Thread-4): 16:31:34  SQL status: SUCCESS 1 in 2.93 seconds
2022-03-03 16:31:34.910649 (Thread-4): 16:31:34  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:34.910767 (Thread-4): 16:31:34  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
2022-03-03 16:31:34.995820 (Thread-6): 16:31:34  SQL status: SUCCESS 1 in 2.65 seconds
2022-03-03 16:31:35.000307 (Thread-6): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:35.000500 (Thread-6): 16:31:35  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp
2022-03-03 16:31:35.008163 (Thread-3): 16:31:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5023c0a0>]}
2022-03-03 16:31:35.008544 (Thread-3): 16:31:35  23 of 31 OK created incremental model DBT_VAULT.hub_supplier.................... [SUCCESS 1 in 4.91s]
2022-03-03 16:31:35.008711 (Thread-3): 16:31:35  Finished running node model.dbtvault_snowflake_demo.hub_supplier
2022-03-03 16:31:35.008866 (Thread-3): 16:31:35  Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:31:35.009066 (Thread-3): 16:31:35  27 of 31 START incremental model DBT_VAULT.sat_inv_inventory_details............ [RUN]
2022-03-03 16:31:35.009307 (Thread-3): 16:31:35  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:35.009399 (Thread-3): 16:31:35  Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:31:35.009489 (Thread-3): 16:31:35  Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:31:35.024276 (Thread-3): 16:31:35  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:35.041484 (Thread-3): 16:31:35  finished collecting timing info
2022-03-03 16:31:35.041729 (Thread-3): 16:31:35  Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:31:35.049430 (Thread-3): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:35.049597 (Thread-3): 16:31:35  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

latest_records AS (

    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.INVENTORY_PK, current_records.INVENTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.INVENTORY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.INVENTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.INVENTORY_PK = source_records.INVENTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.INVENTORY_PK = stage.INVENTORY_PK
                WHERE latest_records.INVENTORY_HASHDIFF != stage.INVENTORY_HASHDIFF
                OR latest_records.INVENTORY_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:35.049770 (Thread-3): 16:31:35  Opening a new connection, currently in state closed
2022-03-03 16:31:35.151700 (Thread-6): 16:31:35  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 16:31:35.156566 (Thread-6): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:35.156720 (Thread-6): 16:31:35  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DBT_RAW.DBT_VAULT.link_nation_region
2022-03-03 16:31:35.234921 (Thread-4): 16:31:35  SQL status: SUCCESS 5 in 0.32 seconds
2022-03-03 16:31:35.238543 (Thread-4): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:35.238662 (Thread-4): 16:31:35  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DBT_RAW.DBT_VAULT.link_inventory
2022-03-03 16:31:35.365088 (Thread-6): 16:31:35  SQL status: SUCCESS 5 in 0.21 seconds
2022-03-03 16:31:35.370185 (Thread-6): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:35.370377 (Thread-6): 16:31:35  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_NATION_REGION"
2022-03-03 16:31:35.389731 (Thread-4): 16:31:35  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 16:31:35.393592 (Thread-4): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:35.393719 (Thread-4): 16:31:35  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_INVENTORY"
2022-03-03 16:31:35.501689 (Thread-6): 16:31:35  SQL status: SUCCESS 5 in 0.13 seconds
2022-03-03 16:31:35.503789 (Thread-6): 16:31:35  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:35.517246 (Thread-4): 16:31:35  SQL status: SUCCESS 5 in 0.12 seconds
2022-03-03 16:31:35.519304 (Thread-4): 16:31:35  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:35.525076 (Thread-6): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:35.525192 (Thread-6): 16:31:35  On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
begin;
2022-03-03 16:31:35.532083 (Thread-4): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:35.532200 (Thread-4): 16:31:35  On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
2022-03-03 16:31:35.817036 (Thread-4): 16:31:35  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-03 16:31:35.817250 (Thread-4): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:35.817335 (Thread-4): 16:31:35  On model.dbtvault_snowflake_demo.link_inventory: insert into DBT_RAW.DBT_VAULT.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_inventory__dbt_tmp
        );
2022-03-03 16:31:35.906685 (Thread-6): 16:31:35  SQL status: SUCCESS 1 in 0.38 seconds
2022-03-03 16:31:35.906900 (Thread-6): 16:31:35  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:35.906985 (Thread-6): 16:31:35  On model.dbtvault_snowflake_demo.link_nation_region: insert into DBT_RAW.DBT_VAULT.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_nation_region__dbt_tmp
        );
2022-03-03 16:31:36.008419 (Thread-5): 16:31:36  SQL status: SUCCESS 1 in 2.33 seconds
2022-03-03 16:31:36.012200 (Thread-5): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:36.012321 (Thread-5): 16:31:36  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
2022-03-03 16:31:36.074270 (Thread-177): handling poll request
2022-03-03 16:31:36.074683 (Thread-177): 16:31:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603534f0>]}
2022-03-03 16:31:36.075834 (Thread-177): sending response (<Response 25817 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:36.232044 (Thread-5): 16:31:36  SQL status: SUCCESS 5 in 0.22 seconds
2022-03-03 16:31:36.235698 (Thread-5): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:36.235813 (Thread-5): 16:31:36  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DBT_RAW.DBT_VAULT.link_supplier_nation
2022-03-03 16:31:36.357066 (Thread-6): 16:31:36  SQL status: SUCCESS 0 in 0.45 seconds
2022-03-03 16:31:36.357264 (Thread-6): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
2022-03-03 16:31:36.357355 (Thread-6): 16:31:36  On model.dbtvault_snowflake_demo.link_nation_region: commit;
2022-03-03 16:31:36.393960 (Thread-5): 16:31:36  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 16:31:36.397613 (Thread-5): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:36.397730 (Thread-5): 16:31:36  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DBT_RAW"."DBT_VAULT"."LINK_SUPPLIER_NATION"
2022-03-03 16:31:36.405316 (Thread-4): 16:31:36  SQL status: SUCCESS 0 in 0.59 seconds
2022-03-03 16:31:36.405460 (Thread-4): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
2022-03-03 16:31:36.405540 (Thread-4): 16:31:36  On model.dbtvault_snowflake_demo.link_inventory: commit;
2022-03-03 16:31:36.629813 (Thread-5): 16:31:36  SQL status: SUCCESS 5 in 0.23 seconds
2022-03-03 16:31:36.632014 (Thread-5): 16:31:36  Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:36.644970 (Thread-5): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:36.645147 (Thread-5): 16:31:36  On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
2022-03-03 16:31:36.859944 (Thread-6): 16:31:36  SQL status: SUCCESS 1 in 0.5 seconds
2022-03-03 16:31:36.861590 (Thread-6): 16:31:36  finished collecting timing info
2022-03-03 16:31:36.861764 (Thread-6): 16:31:36  On model.dbtvault_snowflake_demo.link_nation_region: Close
2022-03-03 16:31:36.918653 (Thread-5): 16:31:36  SQL status: SUCCESS 1 in 0.27 seconds
2022-03-03 16:31:36.918869 (Thread-5): 16:31:36  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:36.918954 (Thread-5): 16:31:36  On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DBT_RAW.DBT_VAULT.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.link_supplier_nation__dbt_tmp
        );
2022-03-03 16:31:36.946343 (Thread-4): 16:31:36  SQL status: SUCCESS 1 in 0.54 seconds
2022-03-03 16:31:36.947916 (Thread-4): 16:31:36  finished collecting timing info
2022-03-03 16:31:36.948076 (Thread-4): 16:31:36  On model.dbtvault_snowflake_demo.link_inventory: Close
2022-03-03 16:31:37.183500 (Thread-6): 16:31:37  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe502e09a0>]}
2022-03-03 16:31:37.183940 (Thread-6): 16:31:37  25 of 31 OK created incremental model DBT_VAULT.link_nation_region.............. [SUCCESS 1 in 4.89s]
2022-03-03 16:31:37.184077 (Thread-6): 16:31:37  Finished running node model.dbtvault_snowflake_demo.link_nation_region
2022-03-03 16:31:37.184227 (Thread-6): 16:31:37  Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:31:37.184423 (Thread-6): 16:31:37  28 of 31 START incremental model DBT_VAULT.sat_inv_part_details................. [RUN]
2022-03-03 16:31:37.184717 (Thread-6): 16:31:37  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:37.184821 (Thread-6): 16:31:37  Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:31:37.184916 (Thread-6): 16:31:37  Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:31:37.201785 (Thread-6): 16:31:37  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:37.220398 (Thread-6): 16:31:37  finished collecting timing info
2022-03-03 16:31:37.220584 (Thread-6): 16:31:37  Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:31:37.225918 (Thread-6): 16:31:37  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:37.226062 (Thread-6): 16:31:37  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.PART_PK IS NOT NULL
),

latest_records AS (

    SELECT a.PART_PK, a.PART_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.PART_PK, current_records.PART_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.PART_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.PART_PK
                FROM source_data
            ) AS source_records
                ON current_records.PART_PK = source_records.PART_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.PART_PK = stage.PART_PK
                WHERE latest_records.PART_HASHDIFF != stage.PART_HASHDIFF
                OR latest_records.PART_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:37.226158 (Thread-6): 16:31:37  Opening a new connection, currently in state closed
2022-03-03 16:31:37.287243 (Thread-4): 16:31:37  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe502af460>]}
2022-03-03 16:31:37.287746 (Thread-4): 16:31:37  24 of 31 OK created incremental model DBT_VAULT.link_inventory.................. [SUCCESS 1 in 5.34s]
2022-03-03 16:31:37.287882 (Thread-4): 16:31:37  Finished running node model.dbtvault_snowflake_demo.link_inventory
2022-03-03 16:31:37.288033 (Thread-4): 16:31:37  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:31:37.288221 (Thread-4): 16:31:37  29 of 31 START incremental model DBT_VAULT.sat_inv_supp_nation_details.......... [RUN]
2022-03-03 16:31:37.288460 (Thread-4): 16:31:37  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:37.288551 (Thread-4): 16:31:37  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:31:37.288739 (Thread-4): 16:31:37  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:31:37.305129 (Thread-4): 16:31:37  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:37.318445 (Thread-4): 16:31:37  finished collecting timing info
2022-03-03 16:31:37.318719 (Thread-4): 16:31:37  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:31:37.324591 (Thread-4): 16:31:37  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:37.324763 (Thread-4): 16:31:37  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:37.324856 (Thread-4): 16:31:37  Opening a new connection, currently in state closed
2022-03-03 16:31:37.512060 (Thread-5): 16:31:37  SQL status: SUCCESS 0 in 0.59 seconds
2022-03-03 16:31:37.512263 (Thread-5): 16:31:37  Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
2022-03-03 16:31:37.512351 (Thread-5): 16:31:37  On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
2022-03-03 16:31:37.827105 (Thread-3): 16:31:37  SQL status: SUCCESS 1 in 2.78 seconds
2022-03-03 16:31:37.830653 (Thread-178): handling poll request
2022-03-03 16:31:37.831025 (Thread-178): 16:31:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160392580>]}
2022-03-03 16:31:37.832053 (Thread-178): sending response (<Response 28096 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:37.830814 (Thread-3): 16:31:37  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:37.830958 (Thread-3): 16:31:37  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
2022-03-03 16:31:38.097890 (Thread-5): 16:31:38  SQL status: SUCCESS 1 in 0.59 seconds
2022-03-03 16:31:38.099356 (Thread-5): 16:31:38  finished collecting timing info
2022-03-03 16:31:38.099523 (Thread-5): 16:31:38  On model.dbtvault_snowflake_demo.link_supplier_nation: Close
2022-03-03 16:31:38.111997 (Thread-3): 16:31:38  SQL status: SUCCESS 8 in 0.28 seconds
2022-03-03 16:31:38.115643 (Thread-3): 16:31:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:38.115748 (Thread-3): 16:31:38  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_inventory_details
2022-03-03 16:31:38.267279 (Thread-3): 16:31:38  SQL status: SUCCESS 8 in 0.15 seconds
2022-03-03 16:31:38.271069 (Thread-3): 16:31:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:38.271281 (Thread-3): 16:31:38  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_INVENTORY_DETAILS"
2022-03-03 16:31:38.457611 (Thread-3): 16:31:38  SQL status: SUCCESS 8 in 0.19 seconds
2022-03-03 16:31:38.459886 (Thread-3): 16:31:38  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:38.476203 (Thread-3): 16:31:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:38.476336 (Thread-3): 16:31:38  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
2022-03-03 16:31:38.533256 (Thread-5): 16:31:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5005b100>]}
2022-03-03 16:31:38.533668 (Thread-5): 16:31:38  26 of 31 OK created incremental model DBT_VAULT.link_supplier_nation............ [SUCCESS 1 in 4.88s]
2022-03-03 16:31:38.533802 (Thread-5): 16:31:38  Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
2022-03-03 16:31:38.533948 (Thread-5): 16:31:38  Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:31:38.534139 (Thread-5): 16:31:38  30 of 31 START incremental model DBT_VAULT.sat_inv_supp_region_details.......... [RUN]
2022-03-03 16:31:38.534382 (Thread-5): 16:31:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:38.534476 (Thread-5): 16:31:38  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:31:38.534589 (Thread-5): 16:31:38  Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:31:38.551188 (Thread-5): 16:31:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:38.563625 (Thread-5): 16:31:38  finished collecting timing info
2022-03-03 16:31:38.563773 (Thread-5): 16:31:38  Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:31:38.568492 (Thread-5): 16:31:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:38.568613 (Thread-5): 16:31:38  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_NATION_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_NATION_HASHDIFF != stage.SUPPLIER_NATION_HASHDIFF
                OR latest_records.SUPPLIER_NATION_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:38.568766 (Thread-5): 16:31:38  Opening a new connection, currently in state closed
2022-03-03 16:31:38.651871 (Thread-3): 16:31:38  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-03 16:31:38.652078 (Thread-3): 16:31:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:38.652164 (Thread-3): 16:31:38  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DBT_RAW.DBT_VAULT.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_inventory_details__dbt_tmp
        );
2022-03-03 16:31:39.048678 (Thread-3): 16:31:39  SQL status: SUCCESS 0 in 0.4 seconds
2022-03-03 16:31:39.048894 (Thread-3): 16:31:39  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
2022-03-03 16:31:39.048982 (Thread-3): 16:31:39  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
2022-03-03 16:31:39.601799 (Thread-179): handling poll request
2022-03-03 16:31:39.602175 (Thread-179): 16:31:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601bcc40>]}
2022-03-03 16:31:39.603043 (Thread-179): sending response (<Response 17801 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:39.922718 (Thread-3): 16:31:39  SQL status: SUCCESS 1 in 0.87 seconds
2022-03-03 16:31:39.924283 (Thread-3): 16:31:39  finished collecting timing info
2022-03-03 16:31:39.924452 (Thread-3): 16:31:39  On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
2022-03-03 16:31:40.217399 (Thread-4): 16:31:40  SQL status: SUCCESS 1 in 2.89 seconds
2022-03-03 16:31:40.222093 (Thread-4): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:40.222297 (Thread-4): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
2022-03-03 16:31:40.239782 (Thread-3): 16:31:40  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5013c490>]}
2022-03-03 16:31:40.240154 (Thread-3): 16:31:40  27 of 31 OK created incremental model DBT_VAULT.sat_inv_inventory_details....... [SUCCESS 1 in 5.23s]
2022-03-03 16:31:40.240283 (Thread-3): 16:31:40  Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
2022-03-03 16:31:40.240430 (Thread-3): 16:31:40  Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:31:40.240625 (Thread-3): 16:31:40  31 of 31 START incremental model DBT_VAULT.sat_inv_supplier_details............. [RUN]
2022-03-03 16:31:40.240908 (Thread-3): 16:31:40  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:40.241001 (Thread-3): 16:31:40  Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:31:40.241092 (Thread-3): 16:31:40  Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:31:40.260323 (Thread-3): 16:31:40  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:40.273560 (Thread-3): 16:31:40  finished collecting timing info
2022-03-03 16:31:40.273778 (Thread-3): 16:31:40  Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:31:40.281238 (Thread-3): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:40.281346 (Thread-3): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_inventory AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SUPPLIER_PK, current_records.SUPPLIER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SUPPLIER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data.SUPPLIER_PK
                FROM source_data
            ) AS source_records
                ON current_records.SUPPLIER_PK = source_records.SUPPLIER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.SUPPLIER_PK = stage.SUPPLIER_PK
                WHERE latest_records.SUPPLIER_HASHDIFF != stage.SUPPLIER_HASHDIFF
                OR latest_records.SUPPLIER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 16:31:40.281436 (Thread-3): 16:31:40  Opening a new connection, currently in state closed
2022-03-03 16:31:40.286022 (Thread-6): 16:31:40  SQL status: SUCCESS 1 in 3.06 seconds
2022-03-03 16:31:40.289030 (Thread-6): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:40.289131 (Thread-6): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
2022-03-03 16:31:40.389541 (Thread-4): 16:31:40  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-03 16:31:40.394484 (Thread-4): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:40.394669 (Thread-4): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details
2022-03-03 16:31:40.453901 (Thread-6): 16:31:40  SQL status: SUCCESS 13 in 0.16 seconds
2022-03-03 16:31:40.457744 (Thread-6): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:40.457876 (Thread-6): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_part_details
2022-03-03 16:31:40.566765 (Thread-4): 16:31:40  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-03 16:31:40.570457 (Thread-4): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:40.570579 (Thread-4): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_NATION_DETAILS"
2022-03-03 16:31:40.658948 (Thread-6): 16:31:40  SQL status: SUCCESS 13 in 0.2 seconds
2022-03-03 16:31:40.664901 (Thread-6): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:40.665074 (Thread-6): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_PART_DETAILS"
2022-03-03 16:31:40.844769 (Thread-4): 16:31:40  SQL status: SUCCESS 7 in 0.27 seconds
2022-03-03 16:31:40.847936 (Thread-4): 16:31:40  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:40.849173 (Thread-6): 16:31:40  SQL status: SUCCESS 13 in 0.18 seconds
2022-03-03 16:31:40.851635 (Thread-6): 16:31:40  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:40.861442 (Thread-4): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:40.861571 (Thread-4): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
2022-03-03 16:31:40.864231 (Thread-6): 16:31:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:40.864355 (Thread-6): 16:31:40  On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
2022-03-03 16:31:41.201814 (Thread-4): 16:31:41  SQL status: SUCCESS 1 in 0.34 seconds
2022-03-03 16:31:41.202121 (Thread-4): 16:31:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:41.202254 (Thread-4): 16:31:41  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_nation_details__dbt_tmp
        );
2022-03-03 16:31:41.501967 (Thread-6): 16:31:41  SQL status: SUCCESS 1 in 0.64 seconds
2022-03-03 16:31:41.502188 (Thread-6): 16:31:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:41.502276 (Thread-6): 16:31:41  On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DBT_RAW.DBT_VAULT.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_part_details__dbt_tmp
        );
2022-03-03 16:31:41.757565 (Thread-5): 16:31:41  SQL status: SUCCESS 1 in 3.19 seconds
2022-03-03 16:31:41.762647 (Thread-5): 16:31:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:41.762789 (Thread-5): 16:31:41  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
2022-03-03 16:31:41.764679 (Thread-4): 16:31:41  SQL status: SUCCESS 0 in 0.56 seconds
2022-03-03 16:31:41.764833 (Thread-4): 16:31:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
2022-03-03 16:31:41.764916 (Thread-4): 16:31:41  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
2022-03-03 16:31:42.002318 (Thread-5): 16:31:42  SQL status: SUCCESS 7 in 0.24 seconds
2022-03-03 16:31:42.006103 (Thread-5): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:42.006230 (Thread-5): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supp_region_details
2022-03-03 16:31:42.037678 (Thread-6): 16:31:42  SQL status: SUCCESS 0 in 0.54 seconds
2022-03-03 16:31:42.037859 (Thread-6): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
2022-03-03 16:31:42.037941 (Thread-6): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
2022-03-03 16:31:42.112316 (Thread-180): handling poll request
2022-03-03 16:31:42.112712 (Thread-180): 16:31:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51602693a0>]}
2022-03-03 16:31:42.113782 (Thread-180): sending response (<Response 29554 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:42.178548 (Thread-5): 16:31:42  SQL status: SUCCESS 7 in 0.17 seconds
2022-03-03 16:31:42.182239 (Thread-5): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:42.182361 (Thread-5): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPP_REGION_DETAILS"
2022-03-03 16:31:42.247699 (Thread-4): 16:31:42  SQL status: SUCCESS 1 in 0.48 seconds
2022-03-03 16:31:42.249842 (Thread-4): 16:31:42  finished collecting timing info
2022-03-03 16:31:42.250079 (Thread-4): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
2022-03-03 16:31:42.422337 (Thread-5): 16:31:42  SQL status: SUCCESS 7 in 0.24 seconds
2022-03-03 16:31:42.424847 (Thread-5): 16:31:42  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:42.442103 (Thread-5): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:42.442233 (Thread-5): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
2022-03-03 16:31:42.469064 (Thread-6): 16:31:42  SQL status: SUCCESS 1 in 0.43 seconds
2022-03-03 16:31:42.470502 (Thread-6): 16:31:42  finished collecting timing info
2022-03-03 16:31:42.470658 (Thread-6): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
2022-03-03 16:31:42.538220 (Thread-4): 16:31:42  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58765850>]}
2022-03-03 16:31:42.561982 (Thread-4): 16:31:42  29 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_nation_details..... [SUCCESS 1 in 5.25s]
2022-03-03 16:31:42.562174 (Thread-4): 16:31:42  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
2022-03-03 16:31:42.607005 (Thread-3): 16:31:42  SQL status: SUCCESS 1 in 2.33 seconds
2022-03-03 16:31:42.610659 (Thread-3): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:42.610772 (Thread-3): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
2022-03-03 16:31:42.690820 (Thread-5): 16:31:42  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 16:31:42.691040 (Thread-5): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:42.691126 (Thread-5): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supp_region_details__dbt_tmp
        );
2022-03-03 16:31:42.756696 (Thread-6): 16:31:42  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50264190>]}
2022-03-03 16:31:42.757119 (Thread-6): 16:31:42  28 of 31 OK created incremental model DBT_VAULT.sat_inv_part_details............ [SUCCESS 1 in 5.57s]
2022-03-03 16:31:42.757248 (Thread-6): 16:31:42  Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
2022-03-03 16:31:42.862491 (Thread-3): 16:31:42  SQL status: SUCCESS 10 in 0.25 seconds
2022-03-03 16:31:42.866701 (Thread-3): 16:31:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:42.866825 (Thread-3): 16:31:42  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DBT_RAW.DBT_VAULT.sat_inv_supplier_details
2022-03-03 16:31:42.997632 (Thread-3): 16:31:42  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 16:31:43.001454 (Thread-3): 16:31:43  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:43.001570 (Thread-3): 16:31:43  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_INV_SUPPLIER_DETAILS"
2022-03-03 16:31:43.062434 (Thread-5): 16:31:43  SQL status: SUCCESS 0 in 0.37 seconds
2022-03-03 16:31:43.062629 (Thread-5): 16:31:43  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
2022-03-03 16:31:43.062711 (Thread-5): 16:31:43  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
2022-03-03 16:31:43.138063 (Thread-3): 16:31:43  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 16:31:43.140912 (Thread-3): 16:31:43  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:43.154958 (Thread-3): 16:31:43  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:43.155082 (Thread-3): 16:31:43  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
2022-03-03 16:31:43.371584 (Thread-3): 16:31:43  SQL status: SUCCESS 1 in 0.22 seconds
2022-03-03 16:31:43.371805 (Thread-3): 16:31:43  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:43.371890 (Thread-3): 16:31:43  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DBT_RAW.DBT_VAULT.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DBT_RAW.DBT_VAULT.sat_inv_supplier_details__dbt_tmp
        );
2022-03-03 16:31:43.432506 (Thread-5): 16:31:43  SQL status: SUCCESS 1 in 0.37 seconds
2022-03-03 16:31:43.434166 (Thread-5): 16:31:43  finished collecting timing info
2022-03-03 16:31:43.434333 (Thread-5): 16:31:43  On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
2022-03-03 16:31:43.738435 (Thread-5): 16:31:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50287e20>]}
2022-03-03 16:31:43.738866 (Thread-5): 16:31:43  30 of 31 OK created incremental model DBT_VAULT.sat_inv_supp_region_details..... [SUCCESS 1 in 5.20s]
2022-03-03 16:31:43.738994 (Thread-5): 16:31:43  Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
2022-03-03 16:31:43.901717 (Thread-3): 16:31:43  SQL status: SUCCESS 0 in 0.53 seconds
2022-03-03 16:31:43.901916 (Thread-3): 16:31:43  Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
2022-03-03 16:31:43.902002 (Thread-3): 16:31:43  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
2022-03-03 16:31:44.115705 (Thread-181): handling poll request
2022-03-03 16:31:44.116070 (Thread-181): 16:31:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601ecac0>]}
2022-03-03 16:31:44.117121 (Thread-181): sending response (<Response 22683 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:44.412583 (Thread-3): 16:31:44  SQL status: SUCCESS 1 in 0.51 seconds
2022-03-03 16:31:44.414156 (Thread-3): 16:31:44  finished collecting timing info
2022-03-03 16:31:44.414334 (Thread-3): 16:31:44  On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
2022-03-03 16:31:44.745375 (Thread-3): 16:31:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5921ea-4fdd-464b-9ca7-eb493bea53f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50120c70>]}
2022-03-03 16:31:44.746295 (Thread-3): 16:31:44  31 of 31 OK created incremental model DBT_VAULT.sat_inv_supplier_details........ [SUCCESS 1 in 4.50s]
2022-03-03 16:31:44.746678 (Thread-3): 16:31:44  Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
2022-03-03 16:31:44.748493 (MainThread): 16:31:44  Acquiring new snowflake connection "master"
2022-03-03 16:31:44.748982 (MainThread): 16:31:44  
2022-03-03 16:31:44.749094 (MainThread): 16:31:44  Finished running 2 view models, 4 table models, 25 incremental models in 55.25s.
2022-03-03 16:31:44.749183 (MainThread): 16:31:44  Connection 'master' was properly closed.
2022-03-03 16:31:44.749253 (MainThread): 16:31:44  Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
2022-03-03 16:31:44.749319 (MainThread): 16:31:44  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
2022-03-03 16:31:44.749387 (MainThread): 16:31:44  Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
2022-03-03 16:31:44.749451 (MainThread): 16:31:44  Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
2022-03-03 16:31:44.839189 (MainThread): 16:31:44  
2022-03-03 16:31:44.839436 (MainThread): 16:31:44  Completed successfully
2022-03-03 16:31:44.839585 (MainThread): 16:31:44  
2022-03-03 16:31:44.839684 (MainThread): 16:31:44  Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
2022-03-03 16:31:46.107946 (Thread-182): handling poll request
2022-03-03 16:31:46.108318 (Thread-182): 16:31:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601efaf0>]}
2022-03-03 16:31:46.111813 (Thread-182): sending response (<Response 165196 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:49.813995 (Thread-183): handling status request
2022-03-03 16:31:49.814366 (Thread-183): 16:31:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601c9880>]}
2022-03-03 16:31:49.816411 (Thread-183): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:31:50.113315 (Thread-184): handling status request
2022-03-03 16:31:50.113692 (Thread-184): 16:31:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601cda00>]}
2022-03-03 16:31:50.115713 (Thread-184): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:39:41.966297 (Thread-185): handling status request
2022-03-03 16:39:41.968070 (Thread-185): 16:39:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601e6940>]}
2022-03-03 16:39:41.970176 (Thread-185): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:39:41.985054 (Thread-186): handling list request
2022-03-03 16:39:41.985333 (Thread-186): 16:39:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160266c40>]}
2022-03-03 16:39:42.016578 (Thread-186): 16:39:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601cdf70>]}
2022-03-03 16:39:42.016931 (Thread-186): 16:39:42  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:39:42.025855 (Thread-186): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:40:54.814777 (Thread-187): handling status request
2022-03-03 16:40:54.816422 (Thread-187): 16:40:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516034a460>]}
2022-03-03 16:40:54.818477 (Thread-187): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:40:54.831385 (Thread-188): handling list request
2022-03-03 16:40:54.831656 (Thread-188): 16:40:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516034b5b0>]}
2022-03-03 16:40:54.887938 (Thread-188): 16:40:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601dbac0>]}
2022-03-03 16:40:54.888313 (Thread-188): 16:40:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:40:54.899988 (Thread-188): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:40:57.188721 (Thread-189): handling status request
2022-03-03 16:40:57.189158 (Thread-189): 16:40:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51800604c0>]}
2022-03-03 16:40:57.191299 (Thread-189): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:40:57.198005 (Thread-190): handling list request
2022-03-03 16:40:57.198395 (Thread-190): 16:40:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516034b610>]}
2022-03-03 16:40:57.230635 (Thread-190): 16:40:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516015fe80>]}
2022-03-03 16:40:57.231009 (Thread-190): 16:40:57  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:40:57.236294 (Thread-190): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:40:57.508054 (Thread-191): handling status request
2022-03-03 16:40:57.508421 (Thread-191): 16:40:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160358820>]}
2022-03-03 16:40:57.510561 (Thread-191): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:40:57.517001 (Thread-192): handling list request
2022-03-03 16:40:57.517267 (Thread-192): 16:40:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160368520>]}
2022-03-03 16:40:57.558159 (Thread-192): 16:40:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160343e20>]}
2022-03-03 16:40:57.558520 (Thread-192): 16:40:57  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:40:57.567179 (Thread-192): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:04.814910 (Thread-193): handling status request
2022-03-03 16:41:04.815299 (Thread-193): 16:41:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160225c40>]}
2022-03-03 16:41:04.817341 (Thread-193): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:04.823978 (Thread-194): handling list request
2022-03-03 16:41:04.824252 (Thread-194): 16:41:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516030c8e0>]}
2022-03-03 16:41:04.862128 (Thread-194): 16:41:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51801164c0>]}
2022-03-03 16:41:04.862490 (Thread-194): 16:41:04  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:41:04.867875 (Thread-194): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:27.534860 (Thread-195): handling status request
2022-03-03 16:41:27.535229 (Thread-195): 16:41:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516034b400>]}
2022-03-03 16:41:27.537320 (Thread-195): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:27.554895 (Thread-196): handling list request
2022-03-03 16:41:27.555279 (Thread-196): 16:41:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51602ff370>]}
2022-03-03 16:41:27.588328 (Thread-196): 16:41:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603683d0>]}
2022-03-03 16:41:27.588753 (Thread-196): 16:41:27  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:41:27.593874 (Thread-196): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:27.849466 (Thread-197): handling status request
2022-03-03 16:41:27.849856 (Thread-197): 16:41:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603a72b0>]}
2022-03-03 16:41:27.851815 (Thread-197): sending response (<Response 64456 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:27.858578 (Thread-198): handling list request
2022-03-03 16:41:27.858865 (Thread-198): 16:41:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516031ff10>]}
2022-03-03 16:41:27.893928 (Thread-198): 16:41:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516031f070>]}
2022-03-03 16:41:27.894351 (Thread-198): 16:41:27  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:41:27.900521 (Thread-198): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:40.273841 (Thread-199): 16:41:40  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:41:40.274381 (Thread-199): 16:41:40  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_orders.sql
2022-03-03 16:41:40.280496 (Thread-199): 16:41:40  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:41:40.287420 (Thread-199): 16:41:40  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:41:40.346380 (Thread-199): 16:41:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516035c400>]}
2022-03-03 16:41:41.013039 (Thread-200): handling status request
2022-03-03 16:41:41.013418 (Thread-200): 16:41:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603e7af0>]}
2022-03-03 16:41:41.013923 (Thread-200): sending response (<Response 1857 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:41.020226 (Thread-201): handling list request
2022-03-03 16:41:41.020540 (Thread-201): 16:41:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160392c40>]}
2022-03-03 16:41:41.060924 (Thread-201): 16:41:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516028fbb0>]}
2022-03-03 16:41:41.061317 (Thread-201): 16:41:41  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:41:41.067409 (Thread-201): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:41.472747 (Thread-202): handling status request
2022-03-03 16:41:41.473131 (Thread-202): 16:41:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d030a190>]}
2022-03-03 16:41:41.473624 (Thread-202): sending response (<Response 1879 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:42.844827 (Thread-203): handling status request
2022-03-03 16:41:42.845209 (Thread-203): 16:41:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ae1c0>]}
2022-03-03 16:41:42.845699 (Thread-203): sending response (<Response 1879 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:45.260624 (Thread-204): handling status request
2022-03-03 16:41:45.261055 (Thread-204): 16:41:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ae4f0>]}
2022-03-03 16:41:45.261563 (Thread-204): sending response (<Response 1857 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:41:45.266579 (Thread-205): handling list request
2022-03-03 16:41:45.266848 (Thread-205): 16:41:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d07f68b0>]}
2022-03-03 16:41:45.304437 (Thread-205): 16:41:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601fc2e0>]}
2022-03-03 16:41:45.304840 (Thread-205): 16:41:45  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:41:45.310393 (Thread-205): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:04.901247 (Thread-206): 16:42:04  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:42:04.901760 (Thread-206): 16:42:04  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-03 16:42:04.908492 (Thread-206): 16:42:04  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:42:04.938843 (Thread-206): 16:42:04  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:42:04.989122 (Thread-206): 16:42:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51045b3ee0>]}
2022-03-03 16:42:05.786039 (Thread-207): handling status request
2022-03-03 16:42:05.786504 (Thread-207): 16:42:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603910a0>]}
2022-03-03 16:42:05.787018 (Thread-207): sending response (<Response 1851 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:05.793415 (Thread-208): handling list request
2022-03-03 16:42:05.793708 (Thread-208): 16:42:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b4b50>]}
2022-03-03 16:42:05.834287 (Thread-208): 16:42:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516028fe80>]}
2022-03-03 16:42:05.834653 (Thread-208): 16:42:05  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:42:05.839893 (Thread-208): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:06.723425 (Thread-209): handling status request
2022-03-03 16:42:06.723797 (Thread-209): 16:42:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160102d60>]}
2022-03-03 16:42:06.730532 (Thread-210): handling status request
2022-03-03 16:42:06.730950 (Thread-210): 16:42:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603b01c0>]}
2022-03-03 16:42:06.751423 (Thread-209): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:06.751855 (Thread-210): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:11.570720 (Thread-211): handling status request
2022-03-03 16:42:11.571110 (Thread-211): 16:42:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603b07c0>]}
2022-03-03 16:42:11.571617 (Thread-211): sending response (<Response 1851 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:11.577084 (Thread-212): handling list request
2022-03-03 16:42:11.577337 (Thread-212): 16:42:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51603b0a00>]}
2022-03-03 16:42:11.615346 (Thread-212): 16:42:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160102d90>]}
2022-03-03 16:42:11.615664 (Thread-212): 16:42:11  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:42:11.621240 (Thread-212): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:32.084741 (Thread-213): handling status request
2022-03-03 16:42:32.085152 (Thread-213): 16:42:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160238910>]}
2022-03-03 16:42:32.085665 (Thread-213): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:32.937774 (Thread-214): handling cli_args request
2022-03-03 16:42:32.938154 (Thread-214): 16:42:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b9df0>]}
2022-03-03 16:42:32.963690 (Thread-215): handling status request
2022-03-03 16:42:32.971004 (Thread-215): 16:42:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b9d60>]}
2022-03-03 16:42:32.972460 (Thread-215): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:35.333068 (Thread-214): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:35.794533 (MainThread): 16:42:35  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:42:35.795052 (MainThread): 16:42:35  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:42:35.806034 (MainThread): 16:42:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2f30b19-f387-4169-bee9-d19fe963dca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faecd7ecf70>]}
2022-03-03 16:42:35.846022 (MainThread): 16:42:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2f30b19-f387-4169-bee9-d19fe963dca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faecd8c2b20>]}
2022-03-03 16:42:35.846506 (MainThread): 16:42:35  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:42:35.848931 (MainThread): 16:42:35  
2022-03-03 16:42:35.849317 (MainThread): 16:42:35  Acquiring new snowflake connection "master"
2022-03-03 16:42:35.850349 (ThreadPoolExecutor-0_0): 16:42:35  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:42:35.863672 (ThreadPoolExecutor-0_0): 16:42:35  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:42:35.863793 (ThreadPoolExecutor-0_0): 16:42:35  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:42:35.863879 (ThreadPoolExecutor-0_0): 16:42:35  Opening a new connection, currently in state init
2022-03-03 16:42:36.131667 (Thread-216): handling poll request
2022-03-03 16:42:36.132044 (Thread-216): 16:42:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b1370>]}
2022-03-03 16:42:36.132773 (Thread-216): sending response (<Response 4154 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:36.923999 (ThreadPoolExecutor-0_0): 16:42:36  SQL status: SUCCESS 8 in 1.06 seconds
2022-03-03 16:42:36.926135 (ThreadPoolExecutor-0_0): 16:42:36  On list_DBT_RAW: Close
2022-03-03 16:42:37.152689 (ThreadPoolExecutor-2_0): 16:42:37  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:42:37.160703 (ThreadPoolExecutor-2_0): 16:42:37  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:42:37.160849 (ThreadPoolExecutor-2_0): 16:42:37  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:42:37.160950 (ThreadPoolExecutor-2_0): 16:42:37  Opening a new connection, currently in state closed
2022-03-03 16:42:38.059961 (ThreadPoolExecutor-2_0): 16:42:38  SQL status: SUCCESS 31 in 0.9 seconds
2022-03-03 16:42:38.062177 (ThreadPoolExecutor-2_0): 16:42:38  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:42:38.305250 (MainThread): 16:42:38  Concurrency: 4 threads (target='default')
2022-03-03 16:42:38.305430 (MainThread): 16:42:38  
2022-03-03 16:42:38.308355 (Thread-3): 16:42:38  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:42:38.308709 (Thread-3): 16:42:38  1 of 1 START table model DBT_VAULT.raw_orders................................... [RUN]
2022-03-03 16:42:38.309012 (Thread-3): 16:42:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:42:38.309121 (Thread-3): 16:42:38  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:42:38.309246 (Thread-3): 16:42:38  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:42:38.316168 (Thread-3): 16:42:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:42:38.330711 (Thread-3): 16:42:38  finished collecting timing info
2022-03-03 16:42:38.330898 (Thread-3): 16:42:38  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:42:38.356267 (Thread-3): 16:42:38  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:42:38.372498 (Thread-3): 16:42:38  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:42:38.372683 (Thread-3): 16:42:38  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF10.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:42:38.372788 (Thread-3): 16:42:38  Opening a new connection, currently in state closed
2022-03-03 16:42:38.968030 (Thread-217): handling poll request
2022-03-03 16:42:38.968419 (Thread-217): 16:42:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ceb50>]}
2022-03-03 16:42:38.969192 (Thread-217): sending response (<Response 10953 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:40.767817 (Thread-218): handling poll request
2022-03-03 16:42:40.768322 (Thread-218): 16:42:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b7940>]}
2022-03-03 16:42:40.769070 (Thread-218): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:42.606698 (Thread-219): handling poll request
2022-03-03 16:42:42.607219 (Thread-219): 16:42:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02cedc0>]}
2022-03-03 16:42:42.607872 (Thread-219): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:44.468179 (Thread-220): handling poll request
2022-03-03 16:42:44.468560 (Thread-220): 16:42:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ce400>]}
2022-03-03 16:42:44.469115 (Thread-220): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:46.269829 (Thread-221): handling poll request
2022-03-03 16:42:46.270202 (Thread-221): 16:42:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0289190>]}
2022-03-03 16:42:46.270693 (Thread-221): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:46.748763 (Thread-3): 16:42:46  SQL status: SUCCESS 1 in 8.38 seconds
2022-03-03 16:42:46.758420 (Thread-3): 16:42:46  finished collecting timing info
2022-03-03 16:42:46.758613 (Thread-3): 16:42:46  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:42:47.008459 (Thread-3): 16:42:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f30b19-f387-4169-bee9-d19fe963dca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faecc16f880>]}
2022-03-03 16:42:47.008977 (Thread-3): 16:42:47  1 of 1 OK created table model DBT_VAULT.raw_orders.............................. [SUCCESS 1 in 8.70s]
2022-03-03 16:42:47.009122 (Thread-3): 16:42:47  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:42:47.010815 (MainThread): 16:42:47  Acquiring new snowflake connection "master"
2022-03-03 16:42:47.011160 (MainThread): 16:42:47  
2022-03-03 16:42:47.011263 (MainThread): 16:42:47  Finished running 1 table model in 11.16s.
2022-03-03 16:42:47.011350 (MainThread): 16:42:47  Connection 'master' was properly closed.
2022-03-03 16:42:47.011420 (MainThread): 16:42:47  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-03 16:42:47.084908 (MainThread): 16:42:47  
2022-03-03 16:42:47.085128 (MainThread): 16:42:47  Completed successfully
2022-03-03 16:42:47.085227 (MainThread): 16:42:47  
2022-03-03 16:42:47.085322 (MainThread): 16:42:47  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 16:42:49.118680 (Thread-222): handling poll request
2022-03-03 16:42:49.119057 (Thread-222): 16:42:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d0343b80>]}
2022-03-03 16:42:49.120447 (Thread-222): sending response (<Response 13091 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:51.911238 (Thread-223): handling status request
2022-03-03 16:42:51.911682 (Thread-223): 16:42:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ceaf0>]}
2022-03-03 16:42:51.912192 (Thread-223): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:52.162271 (Thread-224): handling status request
2022-03-03 16:42:52.162645 (Thread-224): 16:42:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ce6a0>]}
2022-03-03 16:42:52.163139 (Thread-224): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:54.090578 (Thread-225): handling status request
2022-03-03 16:42:54.091035 (Thread-225): 16:42:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b7dc0>]}
2022-03-03 16:42:54.091665 (Thread-225): sending response (<Response 1851 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:42:54.107621 (Thread-226): handling list request
2022-03-03 16:42:54.108029 (Thread-226): 16:42:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02b9df0>]}
2022-03-03 16:42:54.144579 (Thread-226): 16:42:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02ce100>]}
2022-03-03 16:42:54.145009 (Thread-226): 16:42:54  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:42:54.151373 (Thread-226): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:44:53.169701 (Thread-227): handling status request
2022-03-03 16:44:53.171471 (Thread-227): 16:44:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc10b3a0>]}
2022-03-03 16:44:53.171980 (Thread-227): sending response (<Response 1851 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:44:53.178324 (Thread-228): handling list request
2022-03-03 16:44:53.178603 (Thread-228): 16:44:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc10bcd0>]}
2022-03-03 16:44:53.217121 (Thread-228): 16:44:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51046a6850>]}
2022-03-03 16:44:53.217501 (Thread-228): 16:44:53  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:44:53.228684 (Thread-228): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:03.137895 (Thread-229): 16:45:03  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:45:03.140648 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.LINEITEM
2022-03-03 16:45:03.141151 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.CUSTOMER
2022-03-03 16:45:03.141339 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.ORDERS
2022-03-03 16:45:03.141473 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.PARTSUPP
2022-03-03 16:45:03.141581 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.SUPPLIER
2022-03-03 16:45:03.141689 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.PART
2022-03-03 16:45:03.141788 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.NATION
2022-03-03 16:45:03.141884 (Thread-229): 16:45:03  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.REGION
2022-03-03 16:45:03.142020 (Thread-229): 16:45:03  Partial parsing: update schema file: dbtvault_snowflake_demo://models/schema.yml
2022-03-03 16:45:03.149259 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:45:03.162231 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:45:03.164014 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:45:03.174386 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:45:03.176053 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:45:03.185457 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:45:03.186711 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:45:03.196125 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:45:03.197366 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:45:03.206422 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:45:03.207647 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:45:03.218123 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:45:03.219876 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:45:03.230680 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:45:03.232566 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:45:03.244229 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:45:03.245744 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:45:03.258838 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:45:03.260348 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:45:03.271319 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:45:03.272848 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:45:03.282722 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:45:03.284164 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:45:03.296291 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:45:03.297856 (Thread-229): 16:45:03  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:45:03.322947 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:45:03.325035 (Thread-229): 16:45:03  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:45:03.328210 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:45:03.338602 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:45:03.340359 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:45:03.350234 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:45:03.351995 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:45:03.362876 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:45:03.364673 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:45:03.375292 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:45:03.377102 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:45:03.397750 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:45:03.399513 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:45:03.418759 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:45:03.420604 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:45:03.431626 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:45:03.433662 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:45:03.449775 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:45:03.451703 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:45:03.466529 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:45:03.468551 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:45:03.486172 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:45:03.488106 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:45:03.508970 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:45:03.510852 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:45:03.527750 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:45:03.530139 (Thread-229): 16:45:03  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:45:03.576284 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:45:03.578702 (Thread-229): 16:45:03  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:45:03.587960 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:45:03.589810 (Thread-229): 16:45:03  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:45:03.600285 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:45:03.602182 (Thread-229): 16:45:03  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:45:03.618153 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:45:03.619925 (Thread-229): 16:45:03  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:45:03.624870 (Thread-229): 16:45:03  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:45:03.693466 (Thread-229): 16:45:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104271a30>]}
2022-03-03 16:45:04.086332 (Thread-230): handling status request
2022-03-03 16:45:04.086761 (Thread-230): 16:45:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510438d4f0>]}
2022-03-03 16:45:04.087790 (Thread-230): sending response (<Response 23098 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:04.341489 (Thread-231): handling status request
2022-03-03 16:45:04.341868 (Thread-231): 16:45:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510438d310>]}
2022-03-03 16:45:04.342896 (Thread-231): sending response (<Response 23098 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:33.118555 (Thread-232): handling status request
2022-03-03 16:45:33.118942 (Thread-232): 16:45:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042e00d0>]}
2022-03-03 16:45:33.119960 (Thread-232): sending response (<Response 23098 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:33.556065 (Thread-233): handling status request
2022-03-03 16:45:33.556475 (Thread-233): 16:45:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042a2f70>]}
2022-03-03 16:45:33.557543 (Thread-233): sending response (<Response 23098 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:33.810996 (Thread-234): handling cli_args request
2022-03-03 16:45:33.811377 (Thread-234): 16:45:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d03326d0>]}
2022-03-03 16:45:36.057480 (Thread-234): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:36.478324 (MainThread): 16:45:36  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:45:36.478759 (MainThread): 16:45:36  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:45:36.486568 (MainThread): 16:45:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '780b3675-532e-43d5-a7dd-0aca787d4734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1791be80>]}
2022-03-03 16:45:36.521945 (MainThread): 16:45:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '780b3675-532e-43d5-a7dd-0aca787d4734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c17a2a430>]}
2022-03-03 16:45:36.522214 (MainThread): 16:45:36  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:45:36.523942 (MainThread): 16:45:36  
2022-03-03 16:45:36.524251 (MainThread): 16:45:36  Acquiring new snowflake connection "master"
2022-03-03 16:45:36.525062 (ThreadPoolExecutor-0_0): 16:45:36  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:45:36.538518 (ThreadPoolExecutor-0_0): 16:45:36  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:45:36.538626 (ThreadPoolExecutor-0_0): 16:45:36  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:45:36.538708 (ThreadPoolExecutor-0_0): 16:45:36  Opening a new connection, currently in state init
2022-03-03 16:45:36.949674 (Thread-235): handling poll request
2022-03-03 16:45:36.950222 (Thread-235): 16:45:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104230940>]}
2022-03-03 16:45:36.951222 (Thread-235): sending response (<Response 4154 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:37.618452 (ThreadPoolExecutor-0_0): 16:45:37  SQL status: SUCCESS 8 in 1.08 seconds
2022-03-03 16:45:37.620521 (ThreadPoolExecutor-0_0): 16:45:37  On list_DBT_RAW: Close
2022-03-03 16:45:37.870697 (ThreadPoolExecutor-2_0): 16:45:37  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:45:37.879589 (ThreadPoolExecutor-2_0): 16:45:37  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:45:37.879736 (ThreadPoolExecutor-2_0): 16:45:37  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:45:37.879834 (ThreadPoolExecutor-2_0): 16:45:37  Opening a new connection, currently in state closed
2022-03-03 16:45:39.119932 (ThreadPoolExecutor-2_0): 16:45:39  SQL status: SUCCESS 31 in 1.24 seconds
2022-03-03 16:45:39.122189 (ThreadPoolExecutor-2_0): 16:45:39  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:45:39.382398 (MainThread): 16:45:39  Concurrency: 4 threads (target='default')
2022-03-03 16:45:39.382573 (MainThread): 16:45:39  
2022-03-03 16:45:39.385489 (Thread-3): 16:45:39  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:45:39.385812 (Thread-3): 16:45:39  1 of 1 START table model DBT_VAULT.raw_orders................................... [RUN]
2022-03-03 16:45:39.386089 (Thread-3): 16:45:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:45:39.386197 (Thread-3): 16:45:39  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:45:39.386317 (Thread-3): 16:45:39  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:45:39.392483 (Thread-3): 16:45:39  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:45:39.406788 (Thread-3): 16:45:39  finished collecting timing info
2022-03-03 16:45:39.407072 (Thread-3): 16:45:39  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:45:39.432969 (Thread-3): 16:45:39  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:45:39.448172 (Thread-3): 16:45:39  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:45:39.448312 (Thread-3): 16:45:39  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF10.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:45:39.448405 (Thread-3): 16:45:39  Opening a new connection, currently in state closed
2022-03-03 16:45:39.720170 (Thread-236): handling poll request
2022-03-03 16:45:39.720563 (Thread-236): 16:45:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51045afaf0>]}
2022-03-03 16:45:39.748429 (Thread-236): sending response (<Response 10954 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:40.276525 (Thread-3): 16:45:40  Snowflake adapter: Snowflake query id: 01a2aead-0503-bb19-0000-0ed503a5a5f6
2022-03-03 16:45:40.276757 (Thread-3): 16:45:40  Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DBT_RAW.TPCH_SF10' does not exist or not authorized.
2022-03-03 16:45:40.276942 (Thread-3): 16:45:40  finished collecting timing info
2022-03-03 16:45:40.277084 (Thread-3): 16:45:40  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:45:40.506312 (Thread-3): 16:45:40  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  002003 (02000): SQL compilation error:
  Schema 'DBT_RAW.TPCH_SF10' does not exist or not authorized.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-03 16:45:40.506618 (Thread-3): 16:45:40  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780b3675-532e-43d5-a7dd-0aca787d4734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1454a070>]}
2022-03-03 16:45:40.507010 (Thread-3): 16:45:40  1 of 1 ERROR creating table model DBT_VAULT.raw_orders.......................... [ERROR in 1.12s]
2022-03-03 16:45:40.507136 (Thread-3): 16:45:40  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:45:40.508904 (MainThread): 16:45:40  Acquiring new snowflake connection "master"
2022-03-03 16:45:40.509240 (MainThread): 16:45:40  
2022-03-03 16:45:40.509348 (MainThread): 16:45:40  Finished running 1 table model in 3.99s.
2022-03-03 16:45:40.509436 (MainThread): 16:45:40  Connection 'master' was properly closed.
2022-03-03 16:45:40.509506 (MainThread): 16:45:40  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-03 16:45:40.571760 (MainThread): 16:45:40  
2022-03-03 16:45:40.571974 (MainThread): 16:45:40  Completed with 1 error and 0 warnings:
2022-03-03 16:45:40.572066 (MainThread): 16:45:40  
2022-03-03 16:45:40.572160 (MainThread): 16:45:40  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
2022-03-03 16:45:40.572237 (MainThread): 16:45:40    002003 (02000): SQL compilation error:
2022-03-03 16:45:40.572306 (MainThread): 16:45:40    Schema 'DBT_RAW.TPCH_SF10' does not exist or not authorized.
2022-03-03 16:45:40.572373 (MainThread): 16:45:40    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-03 16:45:40.572448 (MainThread): 16:45:40  
2022-03-03 16:45:40.572538 (MainThread): 16:45:40  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 16:45:41.537498 (Thread-237): handling poll request
2022-03-03 16:45:41.537909 (Thread-237): 16:45:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044bf670>]}
2022-03-03 16:45:41.539027 (Thread-237): sending response (<Response 16508 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:43.552537 (Thread-238): handling status request
2022-03-03 16:45:43.552989 (Thread-238): 16:45:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044bf790>]}
2022-03-03 16:45:43.554148 (Thread-238): sending response (<Response 23098 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:43.572513 (Thread-239): handling status request
2022-03-03 16:45:43.572888 (Thread-239): 16:45:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104271b20>]}
2022-03-03 16:45:43.573824 (Thread-239): sending response (<Response 23098 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:50.738953 (Thread-240): handling status request
2022-03-03 16:45:50.739348 (Thread-240): 16:45:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104271760>]}
2022-03-03 16:45:50.740325 (Thread-240): sending response (<Response 23076 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:50.746222 (Thread-241): handling list request
2022-03-03 16:45:50.746497 (Thread-241): 16:45:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104271bb0>]}
2022-03-03 16:45:50.780435 (Thread-241): 16:45:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104271130>]}
2022-03-03 16:45:50.780834 (Thread-241): 16:45:50  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:45:50.786494 (Thread-241): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:55.634190 (Thread-242): handling status request
2022-03-03 16:45:55.634571 (Thread-242): 16:45:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104271d00>]}
2022-03-03 16:45:55.635569 (Thread-242): sending response (<Response 23076 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:45:55.641548 (Thread-243): handling list request
2022-03-03 16:45:55.641800 (Thread-243): 16:45:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044bfcd0>]}
2022-03-03 16:45:55.673384 (Thread-243): 16:45:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042712b0>]}
2022-03-03 16:45:55.673678 (Thread-243): 16:45:55  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:45:55.681101 (Thread-243): sending response (<Response 23532 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:02.695246 (Thread-244): handling status request
2022-03-03 16:46:02.695624 (Thread-244): 16:46:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042bfa90>]}
2022-03-03 16:46:02.696608 (Thread-244): sending response (<Response 23076 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:02.702467 (Thread-245): handling list request
2022-03-03 16:46:02.702733 (Thread-245): 16:46:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104228820>]}
2022-03-03 16:46:02.733688 (Thread-245): 16:46:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042be910>]}
2022-03-03 16:46:02.734032 (Thread-245): 16:46:02  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:46:02.739055 (Thread-245): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:17.216477 (Thread-246): handling status request
2022-03-03 16:46:17.216913 (Thread-246): 16:46:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044bf910>]}
2022-03-03 16:46:17.217891 (Thread-246): sending response (<Response 23076 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:17.227195 (Thread-247): handling list request
2022-03-03 16:46:17.227496 (Thread-247): 16:46:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042be7f0>]}
2022-03-03 16:46:17.260903 (Thread-247): 16:46:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104228a30>]}
2022-03-03 16:46:17.261270 (Thread-247): 16:46:17  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:46:17.266483 (Thread-247): sending response (<Response 16923 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:22.705658 (Thread-248): 16:46:22  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:46:22.707604 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.LINEITEM
2022-03-03 16:46:22.707929 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.CUSTOMER
2022-03-03 16:46:22.708045 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.ORDERS
2022-03-03 16:46:22.708995 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.PARTSUPP
2022-03-03 16:46:22.709107 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.SUPPLIER
2022-03-03 16:46:22.709205 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.PART
2022-03-03 16:46:22.709300 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.NATION
2022-03-03 16:46:22.709392 (Thread-248): 16:46:22  Partial parsing: deleted source source.dbtvault_snowflake_demo.tpch_sample.REGION
2022-03-03 16:46:22.709529 (Thread-248): 16:46:22  Partial parsing: update schema file: dbtvault_snowflake_demo://models/schema.yml
2022-03-03 16:46:22.880133 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:46:22.889458 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:46:22.890703 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:46:22.898574 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:46:22.899788 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:46:22.908906 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:46:22.910072 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:46:22.917932 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:46:22.920952 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:46:22.927551 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:46:22.936013 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:46:22.944210 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:46:22.945457 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:46:22.952456 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:46:22.953705 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:46:22.963904 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:46:22.965165 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:46:22.976555 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:46:22.977899 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:46:22.986800 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:46:22.988083 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:46:22.997891 (Thread-248): 16:46:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:46:22.999099 (Thread-248): 16:46:22  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:46:23.009102 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:46:23.010406 (Thread-248): 16:46:23  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:46:23.032684 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:46:23.034356 (Thread-248): 16:46:23  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:46:23.036568 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:46:23.043544 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:46:23.044713 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:46:23.051269 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:46:23.052446 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:46:23.058575 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:46:23.059699 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:46:23.066303 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:46:23.067430 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:46:23.074021 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:46:23.075145 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:46:23.082791 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:46:23.083948 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:46:23.090570 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:46:23.091730 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:46:23.100419 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:46:23.101667 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:46:23.110444 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:46:23.111863 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:46:23.123482 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:46:23.124676 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:46:23.136485 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:46:23.137773 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:46:23.148598 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:46:23.149844 (Thread-248): 16:46:23  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:46:23.181398 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:46:23.183265 (Thread-248): 16:46:23  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:46:23.190700 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:46:23.192138 (Thread-248): 16:46:23  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:46:23.199787 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:46:23.201005 (Thread-248): 16:46:23  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:46:23.211463 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:46:23.212796 (Thread-248): 16:46:23  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:46:23.217199 (Thread-248): 16:46:23  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:46:23.789719 (Thread-249): handling status request
2022-03-03 16:46:23.790109 (Thread-249): 16:46:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51045795b0>]}
2022-03-03 16:46:23.791171 (Thread-249): sending response (<Response 22800 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:24.114434 (Thread-250): handling status request
2022-03-03 16:46:24.114809 (Thread-250): 16:46:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042aa8e0>]}
2022-03-03 16:46:24.115824 (Thread-250): sending response (<Response 22800 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:25.688761 (Thread-251): handling status request
2022-03-03 16:46:25.689123 (Thread-251): 16:46:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104639e80>]}
2022-03-03 16:46:25.690167 (Thread-251): sending response (<Response 22778 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:27.230741 (Thread-252): handling status request
2022-03-03 16:46:27.231109 (Thread-252): 16:46:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104204d00>]}
2022-03-03 16:46:27.232124 (Thread-252): sending response (<Response 22778 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:27.554780 (Thread-253): handling status request
2022-03-03 16:46:27.555205 (Thread-253): 16:46:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510422c370>]}
2022-03-03 16:46:27.556416 (Thread-253): sending response (<Response 22800 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:28.029467 (Thread-254): handling compile_sql request
2022-03-03 16:46:28.029852 (Thread-254): 16:46:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51046a64c0>]}
2022-03-03 16:46:28.030274 (Thread-254): sending response (<Response 623 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:46:59.677472 (Thread-255): 16:46:59  Unable to do partial parsing because a project config has changed
2022-03-03 16:46:59.677804 (Thread-255): 16:46:59  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104210bb0>]}
2022-03-03 16:46:59.895236 (Thread-255): 16:46:59  Parsing macros/adapters.sql
2022-03-03 16:46:59.933957 (Thread-255): 16:46:59  Parsing macros/catalog.sql
2022-03-03 16:46:59.935969 (Thread-255): 16:46:59  Parsing macros/materializations/table.sql
2022-03-03 16:46:59.939205 (Thread-255): 16:46:59  Parsing macros/materializations/seed.sql
2022-03-03 16:46:59.944471 (Thread-255): 16:46:59  Parsing macros/materializations/incremental.sql
2022-03-03 16:46:59.953492 (Thread-255): 16:46:59  Parsing macros/materializations/merge.sql
2022-03-03 16:46:59.957277 (Thread-255): 16:46:59  Parsing macros/materializations/snapshot.sql
2022-03-03 16:46:59.958215 (Thread-255): 16:46:59  Parsing macros/materializations/view.sql
2022-03-03 16:46:59.959605 (Thread-255): 16:46:59  Parsing macros/adapters/metadata.sql
2022-03-03 16:46:59.966571 (Thread-255): 16:46:59  Parsing macros/adapters/columns.sql
2022-03-03 16:46:59.976069 (Thread-255): 16:46:59  Parsing macros/adapters/freshness.sql
2022-03-03 16:46:59.978913 (Thread-255): 16:46:59  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:46:59.983304 (Thread-255): 16:46:59  Parsing macros/adapters/relation.sql
2022-03-03 16:46:59.992673 (Thread-255): 16:46:59  Parsing macros/adapters/schema.sql
2022-03-03 16:46:59.994831 (Thread-255): 16:46:59  Parsing macros/adapters/indexes.sql
2022-03-03 16:46:59.997623 (Thread-255): 16:46:59  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:46:59.999997 (Thread-255): 16:46:59  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:47:00.001533 (Thread-255): 16:47:00  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:47:00.003067 (Thread-255): 16:47:00  Parsing macros/etc/datetime.sql
2022-03-03 16:47:00.011593 (Thread-255): 16:47:00  Parsing macros/etc/statement.sql
2022-03-03 16:47:00.016279 (Thread-255): 16:47:00  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:47:00.017030 (Thread-255): 16:47:00  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:47:00.017596 (Thread-255): 16:47:00  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:47:00.019010 (Thread-255): 16:47:00  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:47:00.019931 (Thread-255): 16:47:00  Parsing macros/materializations/configs.sql
2022-03-03 16:47:00.022216 (Thread-255): 16:47:00  Parsing macros/materializations/hooks.sql
2022-03-03 16:47:00.026248 (Thread-255): 16:47:00  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:47:00.033485 (Thread-255): 16:47:00  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:47:00.036693 (Thread-255): 16:47:00  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:47:00.039377 (Thread-255): 16:47:00  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:47:00.040688 (Thread-255): 16:47:00  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:47:00.043073 (Thread-255): 16:47:00  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:47:00.050258 (Thread-255): 16:47:00  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:47:00.059660 (Thread-255): 16:47:00  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:47:00.074551 (Thread-255): 16:47:00  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:47:00.076067 (Thread-255): 16:47:00  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:47:00.086834 (Thread-255): 16:47:00  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:47:00.091153 (Thread-255): 16:47:00  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:47:00.106763 (Thread-255): 16:47:00  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:47:00.112613 (Thread-255): 16:47:00  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:47:00.114430 (Thread-255): 16:47:00  Parsing macros/materializations/tests/test.sql
2022-03-03 16:47:00.118804 (Thread-255): 16:47:00  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:47:00.120608 (Thread-255): 16:47:00  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:47:00.131337 (Thread-255): 16:47:00  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:47:00.147672 (Thread-255): 16:47:00  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:47:00.149335 (Thread-255): 16:47:00  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:47:00.160456 (Thread-255): 16:47:00  Parsing tests/generic/builtin.sql
2022-03-03 16:47:00.163488 (Thread-255): 16:47:00  Parsing macros/sql/pivot.sql
2022-03-03 16:47:00.167444 (Thread-255): 16:47:00  Parsing macros/sql/star.sql
2022-03-03 16:47:00.171567 (Thread-255): 16:47:00  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:47:00.177937 (Thread-255): 16:47:00  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:47:00.181511 (Thread-255): 16:47:00  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:47:00.183871 (Thread-255): 16:47:00  Parsing macros/sql/date_spine.sql
2022-03-03 16:47:00.196094 (Thread-255): 16:47:00  Parsing macros/sql/get_column_values.sql
2022-03-03 16:47:00.201512 (Thread-255): 16:47:00  Parsing macros/sql/groupby.sql
2022-03-03 16:47:00.202864 (Thread-255): 16:47:00  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:47:00.209199 (Thread-255): 16:47:00  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:47:00.210838 (Thread-255): 16:47:00  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:47:00.212464 (Thread-255): 16:47:00  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:47:00.215851 (Thread-255): 16:47:00  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:47:00.219290 (Thread-255): 16:47:00  Parsing macros/sql/safe_add.sql
2022-03-03 16:47:00.221064 (Thread-255): 16:47:00  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:47:00.226970 (Thread-255): 16:47:00  Parsing macros/sql/unpivot.sql
2022-03-03 16:47:00.234613 (Thread-255): 16:47:00  Parsing macros/sql/generate_series.sql
2022-03-03 16:47:00.238769 (Thread-255): 16:47:00  Parsing macros/sql/nullcheck.sql
2022-03-03 16:47:00.240395 (Thread-255): 16:47:00  Parsing macros/sql/union.sql
2022-03-03 16:47:00.250357 (Thread-255): 16:47:00  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:47:00.274245 (Thread-255): 16:47:00  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:47:00.275523 (Thread-255): 16:47:00  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:47:00.276752 (Thread-255): 16:47:00  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:47:00.277883 (Thread-255): 16:47:00  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:47:00.278994 (Thread-255): 16:47:00  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:47:00.280531 (Thread-255): 16:47:00  Parsing macros/web/get_url_path.sql
2022-03-03 16:47:00.283098 (Thread-255): 16:47:00  Parsing macros/web/get_url_host.sql
2022-03-03 16:47:00.285106 (Thread-255): 16:47:00  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:47:00.286911 (Thread-255): 16:47:00  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:47:00.288148 (Thread-255): 16:47:00  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:47:00.291186 (Thread-255): 16:47:00  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:47:00.293677 (Thread-255): 16:47:00  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:47:00.294942 (Thread-255): 16:47:00  Parsing macros/schema_tests/equality.sql
2022-03-03 16:47:00.298661 (Thread-255): 16:47:00  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:47:00.300084 (Thread-255): 16:47:00  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:47:00.301742 (Thread-255): 16:47:00  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:47:00.303788 (Thread-255): 16:47:00  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:47:00.305303 (Thread-255): 16:47:00  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:47:00.313917 (Thread-255): 16:47:00  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:47:00.316101 (Thread-255): 16:47:00  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:47:00.318684 (Thread-255): 16:47:00  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:47:00.320363 (Thread-255): 16:47:00  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:47:00.323176 (Thread-255): 16:47:00  Parsing macros/schema_tests/recency.sql
2022-03-03 16:47:00.324995 (Thread-255): 16:47:00  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:47:00.326989 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:47:00.328878 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:47:00.330697 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:47:00.332846 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:47:00.336195 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:47:00.338584 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:47:00.340020 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:47:00.341355 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:47:00.342614 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:47:00.344263 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:47:00.346058 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:47:00.347085 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:47:00.348196 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:47:00.349854 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:47:00.359610 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:47:00.362598 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:47:00.368725 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:47:00.370378 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:47:00.371398 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:47:00.373463 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:47:00.378457 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:47:00.379945 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:47:00.381046 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:47:00.383043 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:47:00.386802 (Thread-255): 16:47:00  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:47:00.387925 (Thread-255): 16:47:00  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:47:00.393400 (Thread-255): 16:47:00  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:47:00.399276 (Thread-255): 16:47:00  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:47:00.417803 (Thread-255): 16:47:00  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:47:00.436409 (Thread-255): 16:47:00  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:47:00.439405 (Thread-255): 16:47:00  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:47:00.446627 (Thread-255): 16:47:00  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:47:00.449985 (Thread-255): 16:47:00  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:47:00.452151 (Thread-255): 16:47:00  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:47:00.466237 (Thread-255): 16:47:00  Parsing macros/staging/hash_columns.sql
2022-03-03 16:47:00.469990 (Thread-255): 16:47:00  Parsing macros/staging/stage.sql
2022-03-03 16:47:00.480198 (Thread-255): 16:47:00  Parsing macros/staging/rank_columns.sql
2022-03-03 16:47:00.488801 (Thread-255): 16:47:00  Parsing macros/staging/derive_columns.sql
2022-03-03 16:47:00.494542 (Thread-255): 16:47:00  Parsing macros/staging/source_columns.sql
2022-03-03 16:47:00.495867 (Thread-255): 16:47:00  Parsing macros/internal/alias_all.sql
2022-03-03 16:47:00.498291 (Thread-255): 16:47:00  Parsing macros/internal/alias.sql
2022-03-03 16:47:00.501761 (Thread-255): 16:47:00  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:47:00.502191 (Thread-255): 16:47:00  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:47:00.511526 (Thread-255): 16:47:00  Parsing macros/internal/multikey.sql
2022-03-03 16:47:00.516726 (Thread-255): 16:47:00  Parsing macros/internal/is_checks.sql
2022-03-03 16:47:00.519624 (Thread-255): 16:47:00  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:47:00.522775 (Thread-255): 16:47:00  Parsing macros/internal/as_constant.sql
2022-03-03 16:47:00.524884 (Thread-255): 16:47:00  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:47:00.526498 (Thread-255): 16:47:00  Parsing macros/tables/link.sql
2022-03-03 16:47:00.539574 (Thread-255): 16:47:00  Parsing macros/tables/sat.sql
2022-03-03 16:47:00.548507 (Thread-255): 16:47:00  Parsing macros/tables/eff_sat.sql
2022-03-03 16:47:00.562330 (Thread-255): 16:47:00  Parsing macros/tables/xts.sql
2022-03-03 16:47:00.569969 (Thread-255): 16:47:00  Parsing macros/tables/hub.sql
2022-03-03 16:47:00.582197 (Thread-255): 16:47:00  Parsing macros/tables/ma_sat.sql
2022-03-03 16:47:00.595589 (Thread-255): 16:47:00  Parsing macros/tables/pit.sql
2022-03-03 16:47:00.616066 (Thread-255): 16:47:00  Parsing macros/tables/bridge.sql
2022-03-03 16:47:00.650996 (Thread-255): 16:47:00  Parsing macros/tables/t_link.sql
2022-03-03 16:47:00.657084 (Thread-255): 16:47:00  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:47:00.658182 (Thread-255): 16:47:00  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:47:00.660736 (Thread-255): 16:47:00  Parsing macros/supporting/prefix.sql
2022-03-03 16:47:00.669148 (Thread-255): 16:47:00  Parsing macros/supporting/hash.sql
2022-03-03 16:47:00.679687 (Thread-255): 16:47:00  Parsing macros/supporting/datatypes.sql
2022-03-03 16:47:01.216825 (Thread-255): 16:47:01  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:47:01.217510 (Thread-256): handling status request
2022-03-03 16:47:01.241487 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:47:01.241821 (Thread-256): 16:47:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4723ee0>]}
2022-03-03 16:47:01.250620 (Thread-255): 16:47:01  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:47:01.251303 (Thread-256): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:01.266385 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:47:01.268350 (Thread-255): 16:47:01  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:47:01.313923 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:47:01.315608 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:47:01.325683 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:47:01.327283 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:47:01.338700 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:47:01.340280 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:47:01.351838 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:47:01.353863 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:47:01.354473 (Thread-257): handling status request
2022-03-03 16:47:01.363853 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:47:01.364191 (Thread-257): 16:47:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46bf2b0>]}
2022-03-03 16:47:01.365784 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:47:01.366261 (Thread-257): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:01.374632 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:47:01.376433 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:47:01.388017 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:47:01.389754 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:47:01.398515 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:47:01.400097 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:47:01.411315 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:47:01.412816 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:47:01.423597 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:47:01.425005 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:47:01.432010 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:47:01.433197 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:47:01.439936 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:47:01.441095 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:47:01.448031 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:47:01.449211 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:47:01.456062 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:47:01.457358 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:47:01.466758 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:47:01.467900 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:47:01.474738 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:47:01.476221 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:47:01.485544 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:47:01.486775 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:47:01.495851 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:47:01.497074 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:47:01.509951 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:47:01.511133 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:47:01.521490 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:47:01.522696 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:47:01.532105 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:47:01.533325 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:47:01.543347 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:47:01.544524 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:47:01.555125 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:47:01.556321 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:47:01.567492 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:47:01.568708 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:47:01.580869 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:47:01.582071 (Thread-255): 16:47:01  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:47:01.593736 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:47:01.595395 (Thread-255): 16:47:01  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:47:01.599390 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:47:01.601250 (Thread-255): 16:47:01  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:47:01.607260 (Thread-255): 16:47:01  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:47:01.608885 (Thread-255): 16:47:01  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:47:04.004795 (Thread-258): handling status request
2022-03-03 16:47:04.005799 (Thread-259): handling status request
2022-03-03 16:47:04.006068 (Thread-258): 16:47:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4566a90>]}
2022-03-03 16:47:04.006371 (Thread-259): 16:47:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e456c220>]}
2022-03-03 16:47:04.008982 (Thread-258): sending response (<Response 64180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:04.010994 (Thread-259): sending response (<Response 64180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:14.103087 (Thread-260): 16:47:14  Unable to do partial parsing because a project config has changed
2022-03-03 16:47:14.103436 (Thread-260): 16:47:14  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4566ee0>]}
2022-03-03 16:47:14.319568 (Thread-260): 16:47:14  Parsing macros/adapters.sql
2022-03-03 16:47:14.357614 (Thread-260): 16:47:14  Parsing macros/catalog.sql
2022-03-03 16:47:14.359493 (Thread-260): 16:47:14  Parsing macros/materializations/table.sql
2022-03-03 16:47:14.362540 (Thread-260): 16:47:14  Parsing macros/materializations/seed.sql
2022-03-03 16:47:14.367541 (Thread-260): 16:47:14  Parsing macros/materializations/incremental.sql
2022-03-03 16:47:14.376503 (Thread-260): 16:47:14  Parsing macros/materializations/merge.sql
2022-03-03 16:47:14.380198 (Thread-260): 16:47:14  Parsing macros/materializations/snapshot.sql
2022-03-03 16:47:14.381173 (Thread-260): 16:47:14  Parsing macros/materializations/view.sql
2022-03-03 16:47:14.382493 (Thread-260): 16:47:14  Parsing macros/adapters/metadata.sql
2022-03-03 16:47:14.389336 (Thread-260): 16:47:14  Parsing macros/adapters/columns.sql
2022-03-03 16:47:14.398790 (Thread-260): 16:47:14  Parsing macros/adapters/freshness.sql
2022-03-03 16:47:14.401615 (Thread-260): 16:47:14  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:47:14.405860 (Thread-260): 16:47:14  Parsing macros/adapters/relation.sql
2022-03-03 16:47:14.415506 (Thread-260): 16:47:14  Parsing macros/adapters/schema.sql
2022-03-03 16:47:14.417673 (Thread-260): 16:47:14  Parsing macros/adapters/indexes.sql
2022-03-03 16:47:14.421219 (Thread-260): 16:47:14  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:47:14.425035 (Thread-260): 16:47:14  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:47:14.427400 (Thread-260): 16:47:14  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:47:14.429754 (Thread-260): 16:47:14  Parsing macros/etc/datetime.sql
2022-03-03 16:47:14.443284 (Thread-260): 16:47:14  Parsing macros/etc/statement.sql
2022-03-03 16:47:14.449083 (Thread-260): 16:47:14  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:47:14.449803 (Thread-260): 16:47:14  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:47:14.450364 (Thread-260): 16:47:14  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:47:14.451920 (Thread-260): 16:47:14  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:47:14.452835 (Thread-260): 16:47:14  Parsing macros/materializations/configs.sql
2022-03-03 16:47:14.455087 (Thread-260): 16:47:14  Parsing macros/materializations/hooks.sql
2022-03-03 16:47:14.458977 (Thread-260): 16:47:14  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:47:14.466150 (Thread-260): 16:47:14  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:47:14.469128 (Thread-260): 16:47:14  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:47:14.471736 (Thread-260): 16:47:14  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:47:14.473162 (Thread-260): 16:47:14  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:47:14.475445 (Thread-260): 16:47:14  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:47:14.482301 (Thread-260): 16:47:14  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:47:14.491956 (Thread-260): 16:47:14  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:47:14.506626 (Thread-260): 16:47:14  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:47:14.508091 (Thread-260): 16:47:14  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:47:14.518755 (Thread-260): 16:47:14  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:47:14.523190 (Thread-260): 16:47:14  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:47:14.539435 (Thread-260): 16:47:14  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:47:14.545290 (Thread-260): 16:47:14  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:47:14.547061 (Thread-260): 16:47:14  Parsing macros/materializations/tests/test.sql
2022-03-03 16:47:14.551294 (Thread-260): 16:47:14  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:47:14.553086 (Thread-260): 16:47:14  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:47:14.564029 (Thread-260): 16:47:14  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:47:14.580505 (Thread-260): 16:47:14  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:47:14.582258 (Thread-260): 16:47:14  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:47:14.593112 (Thread-260): 16:47:14  Parsing tests/generic/builtin.sql
2022-03-03 16:47:14.596269 (Thread-260): 16:47:14  Parsing macros/sql/pivot.sql
2022-03-03 16:47:14.600310 (Thread-260): 16:47:14  Parsing macros/sql/star.sql
2022-03-03 16:47:14.604567 (Thread-260): 16:47:14  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:47:14.605915 (Thread-260): 16:47:14  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:47:14.609362 (Thread-260): 16:47:14  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:47:14.611729 (Thread-260): 16:47:14  Parsing macros/sql/date_spine.sql
2022-03-03 16:47:14.616035 (Thread-260): 16:47:14  Parsing macros/sql/get_column_values.sql
2022-03-03 16:47:14.621139 (Thread-260): 16:47:14  Parsing macros/sql/groupby.sql
2022-03-03 16:47:14.622524 (Thread-260): 16:47:14  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:47:14.628577 (Thread-260): 16:47:14  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:47:14.630272 (Thread-260): 16:47:14  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:47:14.632034 (Thread-260): 16:47:14  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:47:14.635407 (Thread-260): 16:47:14  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:47:14.639839 (Thread-260): 16:47:14  Parsing macros/sql/safe_add.sql
2022-03-03 16:47:14.641735 (Thread-260): 16:47:14  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:47:14.647652 (Thread-260): 16:47:14  Parsing macros/sql/unpivot.sql
2022-03-03 16:47:14.655555 (Thread-260): 16:47:14  Parsing macros/sql/generate_series.sql
2022-03-03 16:47:14.660103 (Thread-260): 16:47:14  Parsing macros/sql/nullcheck.sql
2022-03-03 16:47:14.662026 (Thread-260): 16:47:14  Parsing macros/sql/union.sql
2022-03-03 16:47:14.671845 (Thread-260): 16:47:14  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:47:14.696906 (Thread-260): 16:47:14  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:47:14.699018 (Thread-260): 16:47:14  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:47:14.700993 (Thread-260): 16:47:14  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:47:14.702820 (Thread-260): 16:47:14  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:47:14.704617 (Thread-260): 16:47:14  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:47:14.706630 (Thread-260): 16:47:14  Parsing macros/web/get_url_path.sql
2022-03-03 16:47:14.709182 (Thread-260): 16:47:14  Parsing macros/web/get_url_host.sql
2022-03-03 16:47:14.711102 (Thread-260): 16:47:14  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:47:14.712919 (Thread-260): 16:47:14  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:47:14.714164 (Thread-260): 16:47:14  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:47:14.717078 (Thread-260): 16:47:14  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:47:14.719214 (Thread-260): 16:47:14  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:47:14.720492 (Thread-260): 16:47:14  Parsing macros/schema_tests/equality.sql
2022-03-03 16:47:14.724035 (Thread-260): 16:47:14  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:47:14.725527 (Thread-260): 16:47:14  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:47:14.727179 (Thread-260): 16:47:14  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:47:14.729483 (Thread-260): 16:47:14  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:47:14.730910 (Thread-260): 16:47:14  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:47:14.739328 (Thread-260): 16:47:14  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:47:14.745566 (Thread-260): 16:47:14  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:47:14.748110 (Thread-260): 16:47:14  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:47:14.749915 (Thread-260): 16:47:14  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:47:14.759823 (Thread-260): 16:47:14  Parsing macros/schema_tests/recency.sql
2022-03-03 16:47:14.761590 (Thread-260): 16:47:14  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:47:14.771357 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:47:14.773298 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:47:14.775253 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:47:14.776733 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:47:14.780499 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:47:14.782725 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:47:14.784364 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:47:14.785762 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:47:14.787087 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:47:14.788728 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:47:14.790301 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:47:14.791481 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:47:14.792752 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:47:14.794582 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:47:14.804044 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:47:14.807243 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:47:14.813843 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:47:14.815545 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:47:14.816528 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:47:14.818411 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:47:14.823423 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:47:14.824920 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:47:14.825978 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:47:14.827968 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:47:14.831511 (Thread-260): 16:47:14  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:47:14.832604 (Thread-260): 16:47:14  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:47:14.837963 (Thread-260): 16:47:14  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:47:14.843183 (Thread-260): 16:47:14  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:47:14.861381 (Thread-260): 16:47:14  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:47:14.878693 (Thread-260): 16:47:14  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:47:14.881450 (Thread-260): 16:47:14  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:47:14.888426 (Thread-260): 16:47:14  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:47:14.891060 (Thread-260): 16:47:14  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:47:14.893220 (Thread-260): 16:47:14  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:47:14.907105 (Thread-260): 16:47:14  Parsing macros/staging/hash_columns.sql
2022-03-03 16:47:14.910959 (Thread-260): 16:47:14  Parsing macros/staging/stage.sql
2022-03-03 16:47:14.921009 (Thread-260): 16:47:14  Parsing macros/staging/rank_columns.sql
2022-03-03 16:47:14.929275 (Thread-260): 16:47:14  Parsing macros/staging/derive_columns.sql
2022-03-03 16:47:14.934999 (Thread-260): 16:47:14  Parsing macros/staging/source_columns.sql
2022-03-03 16:47:14.936238 (Thread-260): 16:47:14  Parsing macros/internal/alias_all.sql
2022-03-03 16:47:14.938557 (Thread-260): 16:47:14  Parsing macros/internal/alias.sql
2022-03-03 16:47:14.941913 (Thread-260): 16:47:14  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:47:14.942335 (Thread-260): 16:47:14  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:47:14.951215 (Thread-260): 16:47:14  Parsing macros/internal/multikey.sql
2022-03-03 16:47:14.956339 (Thread-260): 16:47:14  Parsing macros/internal/is_checks.sql
2022-03-03 16:47:14.959235 (Thread-260): 16:47:14  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:47:14.962395 (Thread-260): 16:47:14  Parsing macros/internal/as_constant.sql
2022-03-03 16:47:14.964611 (Thread-260): 16:47:14  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:47:14.966287 (Thread-260): 16:47:14  Parsing macros/tables/link.sql
2022-03-03 16:47:14.978913 (Thread-260): 16:47:14  Parsing macros/tables/sat.sql
2022-03-03 16:47:14.987900 (Thread-260): 16:47:14  Parsing macros/tables/eff_sat.sql
2022-03-03 16:47:15.001234 (Thread-260): 16:47:15  Parsing macros/tables/xts.sql
2022-03-03 16:47:15.008606 (Thread-260): 16:47:15  Parsing macros/tables/hub.sql
2022-03-03 16:47:15.019783 (Thread-260): 16:47:15  Parsing macros/tables/ma_sat.sql
2022-03-03 16:47:15.031992 (Thread-260): 16:47:15  Parsing macros/tables/pit.sql
2022-03-03 16:47:15.051574 (Thread-260): 16:47:15  Parsing macros/tables/bridge.sql
2022-03-03 16:47:15.086527 (Thread-260): 16:47:15  Parsing macros/tables/t_link.sql
2022-03-03 16:47:15.092433 (Thread-260): 16:47:15  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:47:15.093528 (Thread-260): 16:47:15  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:47:15.095337 (Thread-260): 16:47:15  Parsing macros/supporting/prefix.sql
2022-03-03 16:47:15.100832 (Thread-260): 16:47:15  Parsing macros/supporting/hash.sql
2022-03-03 16:47:15.107755 (Thread-260): 16:47:15  Parsing macros/supporting/datatypes.sql
2022-03-03 16:47:15.319281 (Thread-261): handling status request
2022-03-03 16:47:15.335011 (Thread-261): 16:47:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e448bee0>]}
2022-03-03 16:47:15.345779 (Thread-261): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:15.476754 (Thread-262): handling status request
2022-03-03 16:47:15.487355 (Thread-262): 16:47:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4479d00>]}
2022-03-03 16:47:15.500442 (Thread-262): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:15.651978 (Thread-260): 16:47:15  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:47:15.676030 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:47:15.677626 (Thread-260): 16:47:15  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:47:15.688368 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:47:15.689886 (Thread-260): 16:47:15  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:47:15.721048 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:47:15.722444 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:47:15.729491 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:47:15.730744 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:47:15.739886 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:47:15.741222 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:47:15.749741 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:47:15.751008 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:47:15.757678 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:47:15.758810 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:47:15.764902 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:47:15.766049 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:47:15.775018 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:47:15.776141 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:47:15.782323 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:47:15.783443 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:47:15.791401 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:47:15.792525 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:47:15.799066 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:47:15.800196 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:47:15.807156 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:47:15.808284 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:47:15.815896 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:47:15.817075 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:47:15.824263 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:47:15.825454 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:47:15.832439 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:47:15.833604 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:47:15.842271 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:47:15.843399 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:47:15.850096 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:47:15.851322 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:47:15.862183 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:47:15.863347 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:47:15.872341 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:47:15.873552 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:47:15.885499 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:47:15.886681 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:47:15.897333 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:47:15.898501 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:47:15.907295 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:47:15.908533 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:47:15.917410 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:47:15.918563 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:47:15.929442 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:47:15.930601 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:47:15.942544 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:47:15.943731 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:47:15.954937 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:47:15.956098 (Thread-260): 16:47:15  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:47:15.965432 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:47:15.966702 (Thread-260): 16:47:15  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:47:15.970734 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:47:15.972268 (Thread-260): 16:47:15  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:47:15.978907 (Thread-260): 16:47:15  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:47:15.980600 (Thread-260): 16:47:15  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:47:16.081297 (Thread-260): 16:47:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43aa430>]}
2022-03-03 16:47:19.642283 (Thread-263): handling status request
2022-03-03 16:47:19.642751 (Thread-263): 16:47:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44eddf0>]}
2022-03-03 16:47:19.644922 (Thread-263): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:19.651765 (Thread-264): handling status request
2022-03-03 16:47:19.652030 (Thread-264): 16:47:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4421f40>]}
2022-03-03 16:47:19.653944 (Thread-264): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:34.644719 (Thread-265): handling status request
2022-03-03 16:47:34.645099 (Thread-265): 16:47:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46f6640>]}
2022-03-03 16:47:34.647760 (Thread-265): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:35.115928 (Thread-266): handling compile_sql request
2022-03-03 16:47:35.116317 (Thread-266): 16:47:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e438a8b0>]}
2022-03-03 16:47:37.535978 (Thread-266): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:37.569115 (MainThread): 16:47:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60264a87-7577-45a0-aa1c-8d8e92b7115e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039e701d90>]}
2022-03-03 16:47:37.569713 (MainThread): 16:47:37  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:47:37.570365 (Thread-1): 16:47:37  Acquiring new snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-03 16:47:37.570501 (Thread-1): 16:47:37  Began compiling node rpc.dbtvault_snowflake_demo.request
2022-03-03 16:47:37.570600 (Thread-1): 16:47:37  Compiling rpc.dbtvault_snowflake_demo.request
2022-03-03 16:47:37.576240 (Thread-1): 16:47:37  finished collecting timing info
2022-03-03 16:47:37.576388 (Thread-1): 16:47:37  Began executing node rpc.dbtvault_snowflake_demo.request
2022-03-03 16:47:37.576490 (Thread-1): 16:47:37  finished collecting timing info
2022-03-03 16:47:38.297836 (Thread-267): handling poll request
2022-03-03 16:47:38.298320 (Thread-267): 16:47:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e440deb0>]}
2022-03-03 16:47:38.299702 (Thread-267): sending response (<Response 14729 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:45.002110 (Thread-268): handling status request
2022-03-03 16:47:45.002518 (Thread-268): 16:47:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e440d700>]}
2022-03-03 16:47:45.006013 (Thread-268): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:45.443264 (Thread-269): handling status request
2022-03-03 16:47:45.443696 (Thread-269): 16:47:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43df9a0>]}
2022-03-03 16:47:45.445856 (Thread-269): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:45.704527 (Thread-270): handling cli_args request
2022-03-03 16:47:45.704955 (Thread-270): 16:47:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43aa430>]}
2022-03-03 16:47:47.977443 (Thread-270): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:48.286484 (MainThread): 16:47:48  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:47:48.286935 (MainThread): 16:47:48  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:47:48.294842 (MainThread): 16:47:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a8325d8-b24a-42e5-bc31-f593856bc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28743d30>]}
2022-03-03 16:47:48.324165 (MainThread): 16:47:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a8325d8-b24a-42e5-bc31-f593856bc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e288a7520>]}
2022-03-03 16:47:48.324506 (MainThread): 16:47:48  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:47:48.326305 (MainThread): 16:47:48  
2022-03-03 16:47:48.326645 (MainThread): 16:47:48  Acquiring new snowflake connection "master"
2022-03-03 16:47:48.327519 (ThreadPoolExecutor-0_0): 16:47:48  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:47:48.340827 (ThreadPoolExecutor-0_0): 16:47:48  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:47:48.340947 (ThreadPoolExecutor-0_0): 16:47:48  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:47:48.341034 (ThreadPoolExecutor-0_0): 16:47:48  Opening a new connection, currently in state init
2022-03-03 16:47:48.752737 (Thread-271): handling poll request
2022-03-03 16:47:48.753225 (Thread-271): 16:47:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4437040>]}
2022-03-03 16:47:48.754179 (Thread-271): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:49.645544 (ThreadPoolExecutor-0_0): 16:47:49  SQL status: SUCCESS 8 in 1.3 seconds
2022-03-03 16:47:49.648439 (ThreadPoolExecutor-0_0): 16:47:49  On list_DBT_RAW: Close
2022-03-03 16:47:49.989863 (ThreadPoolExecutor-2_0): 16:47:49  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:47:49.998326 (ThreadPoolExecutor-2_0): 16:47:49  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:47:49.998477 (ThreadPoolExecutor-2_0): 16:47:49  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:47:49.998599 (ThreadPoolExecutor-2_0): 16:47:49  Opening a new connection, currently in state closed
2022-03-03 16:47:50.531928 (Thread-272): handling poll request
2022-03-03 16:47:50.532301 (Thread-272): 16:47:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e442fd30>]}
2022-03-03 16:47:50.532921 (Thread-272): sending response (<Response 2316 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:50.977332 (ThreadPoolExecutor-2_0): 16:47:50  SQL status: SUCCESS 31 in 0.98 seconds
2022-03-03 16:47:50.980317 (ThreadPoolExecutor-2_0): 16:47:50  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:47:51.230109 (MainThread): 16:47:51  Concurrency: 4 threads (target='default')
2022-03-03 16:47:51.230354 (MainThread): 16:47:51  
2022-03-03 16:47:51.233469 (Thread-3): 16:47:51  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:47:51.233788 (Thread-3): 16:47:51  1 of 1 START table model DBT_VAULT.raw_orders................................... [RUN]
2022-03-03 16:47:51.234176 (Thread-3): 16:47:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:47:51.234321 (Thread-3): 16:47:51  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:47:51.234467 (Thread-3): 16:47:51  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:47:51.241041 (Thread-3): 16:47:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:47:51.255415 (Thread-3): 16:47:51  finished collecting timing info
2022-03-03 16:47:51.255579 (Thread-3): 16:47:51  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:47:51.280203 (Thread-3): 16:47:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:47:51.294572 (Thread-3): 16:47:51  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:47:51.294692 (Thread-3): 16:47:51  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1, 10, 100, 1000, 10000.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:47:51.294782 (Thread-3): 16:47:51  Opening a new connection, currently in state closed
2022-03-03 16:47:52.157864 (Thread-3): 16:47:52  Snowflake adapter: Snowflake query id: 01a2aeaf-0503-bb19-0000-0ed503a5a616
2022-03-03 16:47:52.158035 (Thread-3): 16:47:52  Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 23 unexpected '10'.
syntax error line 41 at position 27 unexpected '100'.
syntax error line 41 at position 32 unexpected '1000'.
syntax error line 41 at position 38 unexpected '10000.'.
syntax error line 42 at position 28 unexpected '10'.
syntax error line 42 at position 32 unexpected '100'.
syntax error line 42 at position 37 unexpected '1000'.
syntax error line 42 at position 43 unexpected '10000.'.
syntax error line 43 at position 7 unexpected 'a'.
2022-03-03 16:47:52.158206 (Thread-3): 16:47:52  finished collecting timing info
2022-03-03 16:47:52.158352 (Thread-3): 16:47:52  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:47:52.344166 (Thread-273): handling poll request
2022-03-03 16:47:52.344543 (Thread-273): 16:47:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e435f550>]}
2022-03-03 16:47:52.345342 (Thread-273): sending response (<Response 11237 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:52.419077 (Thread-3): 16:47:52  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 23 unexpected '10'.
  syntax error line 41 at position 27 unexpected '100'.
  syntax error line 41 at position 32 unexpected '1000'.
  syntax error line 41 at position 38 unexpected '10000.'.
  syntax error line 42 at position 28 unexpected '10'.
  syntax error line 42 at position 32 unexpected '100'.
  syntax error line 42 at position 37 unexpected '1000'.
  syntax error line 42 at position 43 unexpected '10000.'.
  syntax error line 43 at position 7 unexpected 'a'.
  compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-03 16:47:52.419554 (Thread-3): 16:47:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8325d8-b24a-42e5-bc31-f593856bc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e28038fd0>]}
2022-03-03 16:47:52.419960 (Thread-3): 16:47:52  1 of 1 ERROR creating table model DBT_VAULT.raw_orders.......................... [ERROR in 1.19s]
2022-03-03 16:47:52.420092 (Thread-3): 16:47:52  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:47:52.421680 (MainThread): 16:47:52  Acquiring new snowflake connection "master"
2022-03-03 16:47:52.422126 (MainThread): 16:47:52  
2022-03-03 16:47:52.422237 (MainThread): 16:47:52  Finished running 1 table model in 4.10s.
2022-03-03 16:47:52.422328 (MainThread): 16:47:52  Connection 'master' was properly closed.
2022-03-03 16:47:52.422397 (MainThread): 16:47:52  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-03 16:47:52.488833 (MainThread): 16:47:52  
2022-03-03 16:47:52.489070 (MainThread): 16:47:52  Completed with 1 error and 0 warnings:
2022-03-03 16:47:52.489170 (MainThread): 16:47:52  
2022-03-03 16:47:52.489266 (MainThread): 16:47:52  Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
2022-03-03 16:47:52.489345 (MainThread): 16:47:52    001003 (42000): SQL compilation error:
2022-03-03 16:47:52.489416 (MainThread): 16:47:52    syntax error line 41 at position 23 unexpected '10'.
2022-03-03 16:47:52.489485 (MainThread): 16:47:52    syntax error line 41 at position 27 unexpected '100'.
2022-03-03 16:47:52.489551 (MainThread): 16:47:52    syntax error line 41 at position 32 unexpected '1000'.
2022-03-03 16:47:52.489616 (MainThread): 16:47:52    syntax error line 41 at position 38 unexpected '10000.'.
2022-03-03 16:47:52.489682 (MainThread): 16:47:52    syntax error line 42 at position 28 unexpected '10'.
2022-03-03 16:47:52.489748 (MainThread): 16:47:52    syntax error line 42 at position 32 unexpected '100'.
2022-03-03 16:47:52.489812 (MainThread): 16:47:52    syntax error line 42 at position 37 unexpected '1000'.
2022-03-03 16:47:52.489876 (MainThread): 16:47:52    syntax error line 42 at position 43 unexpected '10000.'.
2022-03-03 16:47:52.489940 (MainThread): 16:47:52    syntax error line 43 at position 7 unexpected 'a'.
2022-03-03 16:47:52.490004 (MainThread): 16:47:52    compiled SQL at target/run/dbtvault_snowflake_demo/models/raw_stage/raw_orders.sql
2022-03-03 16:47:52.490080 (MainThread): 16:47:52  
2022-03-03 16:47:52.490166 (MainThread): 16:47:52  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 16:47:54.127237 (Thread-274): handling poll request
2022-03-03 16:47:54.127605 (Thread-274): 16:47:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44ddaf0>]}
2022-03-03 16:47:54.128783 (Thread-274): sending response (<Response 19939 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:56.056750 (Thread-275): handling status request
2022-03-03 16:47:56.057112 (Thread-275): 16:47:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43b41c0>]}
2022-03-03 16:47:56.060954 (Thread-275): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:47:56.076006 (Thread-276): handling status request
2022-03-03 16:47:56.076302 (Thread-276): 16:47:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4437c70>]}
2022-03-03 16:47:56.078219 (Thread-276): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:09.795042 (Thread-277): 16:49:09  Unable to do partial parsing because a project config has changed
2022-03-03 16:49:09.796806 (Thread-277): 16:49:09  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45631f0>]}
2022-03-03 16:49:10.094285 (Thread-277): 16:49:10  Parsing macros/adapters.sql
2022-03-03 16:49:10.131313 (Thread-277): 16:49:10  Parsing macros/catalog.sql
2022-03-03 16:49:10.133189 (Thread-277): 16:49:10  Parsing macros/materializations/table.sql
2022-03-03 16:49:10.136429 (Thread-277): 16:49:10  Parsing macros/materializations/seed.sql
2022-03-03 16:49:10.141400 (Thread-277): 16:49:10  Parsing macros/materializations/incremental.sql
2022-03-03 16:49:10.149764 (Thread-277): 16:49:10  Parsing macros/materializations/merge.sql
2022-03-03 16:49:10.153477 (Thread-277): 16:49:10  Parsing macros/materializations/snapshot.sql
2022-03-03 16:49:10.154407 (Thread-277): 16:49:10  Parsing macros/materializations/view.sql
2022-03-03 16:49:10.155854 (Thread-277): 16:49:10  Parsing macros/adapters/metadata.sql
2022-03-03 16:49:10.163019 (Thread-277): 16:49:10  Parsing macros/adapters/columns.sql
2022-03-03 16:49:10.172674 (Thread-277): 16:49:10  Parsing macros/adapters/freshness.sql
2022-03-03 16:49:10.175709 (Thread-277): 16:49:10  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:49:10.180194 (Thread-277): 16:49:10  Parsing macros/adapters/relation.sql
2022-03-03 16:49:10.189879 (Thread-277): 16:49:10  Parsing macros/adapters/schema.sql
2022-03-03 16:49:10.192037 (Thread-277): 16:49:10  Parsing macros/adapters/indexes.sql
2022-03-03 16:49:10.194894 (Thread-277): 16:49:10  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:49:10.197369 (Thread-277): 16:49:10  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:49:10.198898 (Thread-277): 16:49:10  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:49:10.200442 (Thread-277): 16:49:10  Parsing macros/etc/datetime.sql
2022-03-03 16:49:10.208756 (Thread-277): 16:49:10  Parsing macros/etc/statement.sql
2022-03-03 16:49:10.213279 (Thread-277): 16:49:10  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:49:10.214025 (Thread-277): 16:49:10  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:49:10.214613 (Thread-277): 16:49:10  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:49:10.216009 (Thread-277): 16:49:10  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:49:10.216944 (Thread-277): 16:49:10  Parsing macros/materializations/configs.sql
2022-03-03 16:49:10.219237 (Thread-277): 16:49:10  Parsing macros/materializations/hooks.sql
2022-03-03 16:49:10.222961 (Thread-277): 16:49:10  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:49:10.230025 (Thread-277): 16:49:10  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:49:10.232815 (Thread-277): 16:49:10  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:49:10.235367 (Thread-277): 16:49:10  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:49:10.236840 (Thread-277): 16:49:10  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:49:10.239155 (Thread-277): 16:49:10  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:49:10.246226 (Thread-277): 16:49:10  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:49:10.255872 (Thread-277): 16:49:10  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:49:10.270651 (Thread-277): 16:49:10  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:49:10.272112 (Thread-277): 16:49:10  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:49:10.283014 (Thread-277): 16:49:10  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:49:10.287594 (Thread-277): 16:49:10  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:49:10.303304 (Thread-277): 16:49:10  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:49:10.309049 (Thread-277): 16:49:10  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:49:10.310758 (Thread-277): 16:49:10  Parsing macros/materializations/tests/test.sql
2022-03-03 16:49:10.315184 (Thread-277): 16:49:10  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:49:10.316998 (Thread-277): 16:49:10  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:49:10.327834 (Thread-277): 16:49:10  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:49:10.344453 (Thread-277): 16:49:10  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:49:10.346065 (Thread-277): 16:49:10  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:49:10.357343 (Thread-277): 16:49:10  Parsing tests/generic/builtin.sql
2022-03-03 16:49:10.360231 (Thread-277): 16:49:10  Parsing macros/sql/pivot.sql
2022-03-03 16:49:10.364138 (Thread-277): 16:49:10  Parsing macros/sql/star.sql
2022-03-03 16:49:10.368366 (Thread-277): 16:49:10  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:49:10.369698 (Thread-277): 16:49:10  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:49:10.373067 (Thread-277): 16:49:10  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:49:10.375314 (Thread-277): 16:49:10  Parsing macros/sql/date_spine.sql
2022-03-03 16:49:10.379419 (Thread-277): 16:49:10  Parsing macros/sql/get_column_values.sql
2022-03-03 16:49:10.384802 (Thread-277): 16:49:10  Parsing macros/sql/groupby.sql
2022-03-03 16:49:10.386192 (Thread-277): 16:49:10  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:49:10.392405 (Thread-277): 16:49:10  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:49:10.394062 (Thread-277): 16:49:10  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:49:10.395712 (Thread-277): 16:49:10  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:49:10.399281 (Thread-277): 16:49:10  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:49:10.404781 (Thread-277): 16:49:10  Parsing macros/sql/safe_add.sql
2022-03-03 16:49:10.406746 (Thread-277): 16:49:10  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:49:10.414221 (Thread-277): 16:49:10  Parsing macros/sql/unpivot.sql
2022-03-03 16:49:10.424774 (Thread-277): 16:49:10  Parsing macros/sql/generate_series.sql
2022-03-03 16:49:10.430813 (Thread-277): 16:49:10  Parsing macros/sql/nullcheck.sql
2022-03-03 16:49:10.432834 (Thread-277): 16:49:10  Parsing macros/sql/union.sql
2022-03-03 16:49:10.447315 (Thread-277): 16:49:10  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:49:10.471568 (Thread-277): 16:49:10  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:49:10.472835 (Thread-277): 16:49:10  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:49:10.474059 (Thread-277): 16:49:10  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:49:10.475289 (Thread-277): 16:49:10  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:49:10.476563 (Thread-277): 16:49:10  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:49:10.478195 (Thread-277): 16:49:10  Parsing macros/web/get_url_path.sql
2022-03-03 16:49:10.481188 (Thread-277): 16:49:10  Parsing macros/web/get_url_host.sql
2022-03-03 16:49:10.483151 (Thread-277): 16:49:10  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:49:10.484949 (Thread-277): 16:49:10  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:49:10.486240 (Thread-277): 16:49:10  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:49:10.489340 (Thread-277): 16:49:10  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:49:10.491448 (Thread-277): 16:49:10  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:49:10.492703 (Thread-277): 16:49:10  Parsing macros/schema_tests/equality.sql
2022-03-03 16:49:10.496326 (Thread-277): 16:49:10  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:49:10.497762 (Thread-277): 16:49:10  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:49:10.499358 (Thread-277): 16:49:10  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:49:10.501409 (Thread-277): 16:49:10  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:49:10.502819 (Thread-277): 16:49:10  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:49:10.511187 (Thread-277): 16:49:10  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:49:10.513423 (Thread-277): 16:49:10  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:49:10.515886 (Thread-277): 16:49:10  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:49:10.517526 (Thread-277): 16:49:10  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:49:10.520261 (Thread-277): 16:49:10  Parsing macros/schema_tests/recency.sql
2022-03-03 16:49:10.521989 (Thread-277): 16:49:10  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:49:10.524013 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:49:10.525910 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:49:10.527741 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:49:10.529245 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:49:10.532941 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:49:10.535113 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:49:10.536520 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:49:10.537825 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:49:10.539072 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:49:10.540649 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:49:10.542217 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:49:10.543216 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:49:10.544328 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:49:10.545969 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:49:10.555265 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:49:10.558017 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:49:10.571997 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:49:10.573614 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:49:10.582225 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:49:10.584067 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:49:10.589116 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:49:10.590582 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:49:10.591749 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:49:10.593779 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:49:10.597202 (Thread-277): 16:49:10  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:49:10.598274 (Thread-277): 16:49:10  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:49:10.603853 (Thread-277): 16:49:10  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:49:10.609085 (Thread-277): 16:49:10  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:49:10.627305 (Thread-277): 16:49:10  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:49:10.644567 (Thread-277): 16:49:10  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:49:10.647321 (Thread-277): 16:49:10  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:49:10.653694 (Thread-277): 16:49:10  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:49:10.656395 (Thread-277): 16:49:10  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:49:10.658443 (Thread-277): 16:49:10  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:49:10.672306 (Thread-277): 16:49:10  Parsing macros/staging/hash_columns.sql
2022-03-03 16:49:10.676069 (Thread-277): 16:49:10  Parsing macros/staging/stage.sql
2022-03-03 16:49:10.686174 (Thread-277): 16:49:10  Parsing macros/staging/rank_columns.sql
2022-03-03 16:49:10.694474 (Thread-277): 16:49:10  Parsing macros/staging/derive_columns.sql
2022-03-03 16:49:10.700211 (Thread-277): 16:49:10  Parsing macros/staging/source_columns.sql
2022-03-03 16:49:10.701479 (Thread-277): 16:49:10  Parsing macros/internal/alias_all.sql
2022-03-03 16:49:10.703809 (Thread-277): 16:49:10  Parsing macros/internal/alias.sql
2022-03-03 16:49:10.707218 (Thread-277): 16:49:10  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:49:10.707640 (Thread-277): 16:49:10  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:49:10.717072 (Thread-277): 16:49:10  Parsing macros/internal/multikey.sql
2022-03-03 16:49:10.721942 (Thread-277): 16:49:10  Parsing macros/internal/is_checks.sql
2022-03-03 16:49:10.724859 (Thread-277): 16:49:10  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:49:10.727973 (Thread-277): 16:49:10  Parsing macros/internal/as_constant.sql
2022-03-03 16:49:10.730059 (Thread-277): 16:49:10  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:49:10.731639 (Thread-277): 16:49:10  Parsing macros/tables/link.sql
2022-03-03 16:49:10.744156 (Thread-277): 16:49:10  Parsing macros/tables/sat.sql
2022-03-03 16:49:10.753164 (Thread-277): 16:49:10  Parsing macros/tables/eff_sat.sql
2022-03-03 16:49:10.766384 (Thread-277): 16:49:10  Parsing macros/tables/xts.sql
2022-03-03 16:49:10.773734 (Thread-277): 16:49:10  Parsing macros/tables/hub.sql
2022-03-03 16:49:10.785013 (Thread-277): 16:49:10  Parsing macros/tables/ma_sat.sql
2022-03-03 16:49:10.804941 (Thread-277): 16:49:10  Parsing macros/tables/pit.sql
2022-03-03 16:49:10.824438 (Thread-277): 16:49:10  Parsing macros/tables/bridge.sql
2022-03-03 16:49:10.860487 (Thread-277): 16:49:10  Parsing macros/tables/t_link.sql
2022-03-03 16:49:10.865993 (Thread-277): 16:49:10  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:49:10.867004 (Thread-277): 16:49:10  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:49:10.868875 (Thread-277): 16:49:10  Parsing macros/supporting/prefix.sql
2022-03-03 16:49:10.874168 (Thread-277): 16:49:10  Parsing macros/supporting/hash.sql
2022-03-03 16:49:10.880984 (Thread-277): 16:49:10  Parsing macros/supporting/datatypes.sql
2022-03-03 16:49:11.150499 (Thread-278): handling status request
2022-03-03 16:49:11.171246 (Thread-278): 16:49:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45fdaf0>]}
2022-03-03 16:49:11.176935 (Thread-278): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:11.416396 (Thread-277): 16:49:11  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:49:11.427454 (Thread-279): handling status request
2022-03-03 16:49:11.441238 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:49:11.441643 (Thread-279): 16:49:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51040fc8b0>]}
2022-03-03 16:49:11.442935 (Thread-277): 16:49:11  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:49:11.443413 (Thread-279): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:11.453639 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:49:11.455378 (Thread-277): 16:49:11  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:49:11.485557 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:49:11.486880 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:49:11.494551 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:49:11.495704 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:49:11.503850 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:49:11.505019 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:49:11.512914 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:49:11.514317 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:49:11.520474 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:49:11.521628 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:49:11.527865 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:49:11.529024 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:49:11.538150 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:49:11.539266 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:49:11.545558 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:49:11.546688 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:49:11.554660 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:49:11.555787 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:49:11.562496 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:49:11.563634 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:49:11.571536 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:49:11.572696 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:49:11.579488 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:49:11.580993 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:49:11.588160 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:49:11.589314 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:49:11.596219 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:49:11.597386 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:49:11.605776 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:49:11.606966 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:49:11.615807 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:49:11.617012 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:49:11.626663 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:49:11.627831 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:49:11.637173 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:49:11.638343 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:49:11.651211 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:49:11.652464 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:49:11.663694 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:49:11.664949 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:49:11.674620 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:49:11.675837 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:49:11.685360 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:49:11.686674 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:49:11.699464 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:49:11.700713 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:49:11.711859 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:49:11.713097 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:49:11.724390 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:49:11.725700 (Thread-277): 16:49:11  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:49:11.734739 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:49:11.735943 (Thread-277): 16:49:11  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:49:11.741063 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:49:11.742702 (Thread-277): 16:49:11  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:49:11.748912 (Thread-277): 16:49:11  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:49:11.750433 (Thread-277): 16:49:11  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:49:11.869959 (Thread-277): 16:49:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46c9970>]}
2022-03-03 16:49:14.174885 (Thread-280): handling status request
2022-03-03 16:49:14.175513 (Thread-280): 16:49:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510418ec10>]}
2022-03-03 16:49:14.178108 (Thread-280): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:14.178631 (Thread-281): handling status request
2022-03-03 16:49:14.179353 (Thread-281): 16:49:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042f5040>]}
2022-03-03 16:49:14.181486 (Thread-281): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:17.088006 (Thread-282): handling status request
2022-03-03 16:49:17.088370 (Thread-282): 16:49:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510418ec70>]}
2022-03-03 16:49:17.090646 (Thread-282): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:17.511460 (Thread-283): handling status request
2022-03-03 16:49:17.511833 (Thread-283): 16:49:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510418e460>]}
2022-03-03 16:49:17.514080 (Thread-283): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:17.729246 (Thread-284): handling cli_args request
2022-03-03 16:49:17.729615 (Thread-284): 16:49:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510418e3d0>]}
2022-03-03 16:49:20.011838 (Thread-284): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:20.306513 (MainThread): 16:49:20  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:49:20.306950 (MainThread): 16:49:20  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:49:20.314599 (MainThread): 16:49:20  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d716a32-49b1-4518-ac2a-4a561e89d6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efced081d60>]}
2022-03-03 16:49:20.346420 (MainThread): 16:49:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d716a32-49b1-4518-ac2a-4a561e89d6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efced9e64c0>]}
2022-03-03 16:49:20.346693 (MainThread): 16:49:20  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:49:20.348299 (MainThread): 16:49:20  
2022-03-03 16:49:20.348605 (MainThread): 16:49:20  Acquiring new snowflake connection "master"
2022-03-03 16:49:20.349435 (ThreadPoolExecutor-0_0): 16:49:20  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:49:20.362305 (ThreadPoolExecutor-0_0): 16:49:20  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:49:20.362415 (ThreadPoolExecutor-0_0): 16:49:20  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:49:20.362501 (ThreadPoolExecutor-0_0): 16:49:20  Opening a new connection, currently in state init
2022-03-03 16:49:20.783251 (Thread-285): handling poll request
2022-03-03 16:49:20.783699 (Thread-285): 16:49:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510418e640>]}
2022-03-03 16:49:20.784618 (Thread-285): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:21.659199 (ThreadPoolExecutor-0_0): 16:49:21  SQL status: SUCCESS 8 in 1.3 seconds
2022-03-03 16:49:21.661913 (ThreadPoolExecutor-0_0): 16:49:21  On list_DBT_RAW: Close
2022-03-03 16:49:21.894828 (ThreadPoolExecutor-2_0): 16:49:21  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:49:21.902629 (ThreadPoolExecutor-2_0): 16:49:21  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:49:21.902771 (ThreadPoolExecutor-2_0): 16:49:21  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:49:21.902876 (ThreadPoolExecutor-2_0): 16:49:21  Opening a new connection, currently in state closed
2022-03-03 16:49:22.537826 (Thread-286): handling poll request
2022-03-03 16:49:22.538206 (Thread-286): 16:49:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e475a2b0>]}
2022-03-03 16:49:22.538789 (Thread-286): sending response (<Response 2316 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:22.974875 (ThreadPoolExecutor-2_0): 16:49:22  SQL status: SUCCESS 31 in 1.07 seconds
2022-03-03 16:49:22.977013 (ThreadPoolExecutor-2_0): 16:49:22  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:49:23.192299 (MainThread): 16:49:23  Concurrency: 4 threads (target='default')
2022-03-03 16:49:23.192472 (MainThread): 16:49:23  
2022-03-03 16:49:23.195368 (Thread-3): 16:49:23  Began running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:49:23.195713 (Thread-3): 16:49:23  1 of 1 START table model DBT_VAULT.raw_orders................................... [RUN]
2022-03-03 16:49:23.195986 (Thread-3): 16:49:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:49:23.196092 (Thread-3): 16:49:23  Began compiling node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:49:23.196199 (Thread-3): 16:49:23  Compiling model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:49:23.202820 (Thread-3): 16:49:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:49:23.215028 (Thread-3): 16:49:23  finished collecting timing info
2022-03-03 16:49:23.215177 (Thread-3): 16:49:23  Began executing node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:49:23.239860 (Thread-3): 16:49:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:49:23.254520 (Thread-3): 16:49:23  Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
2022-03-03 16:49:23.254637 (Thread-3): 16:49:23  On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_orders  as
      (

SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
      );
2022-03-03 16:49:23.254727 (Thread-3): 16:49:23  Opening a new connection, currently in state closed
2022-03-03 16:49:24.324104 (Thread-287): handling poll request
2022-03-03 16:49:24.324480 (Thread-287): 16:49:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4757dc0>]}
2022-03-03 16:49:24.325323 (Thread-287): sending response (<Response 8968 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:26.098975 (Thread-288): handling poll request
2022-03-03 16:49:26.099368 (Thread-288): 16:49:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4757100>]}
2022-03-03 16:49:26.099870 (Thread-288): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:27.927698 (Thread-289): handling poll request
2022-03-03 16:49:27.928167 (Thread-289): 16:49:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510406a310>]}
2022-03-03 16:49:27.928762 (Thread-289): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:29.729853 (Thread-290): handling poll request
2022-03-03 16:49:29.730237 (Thread-290): 16:49:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510459cac0>]}
2022-03-03 16:49:29.730724 (Thread-290): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:31.534515 (Thread-291): handling poll request
2022-03-03 16:49:31.534901 (Thread-291): 16:49:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510459cfd0>]}
2022-03-03 16:49:31.561008 (Thread-291): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:31.733768 (Thread-3): 16:49:31  SQL status: SUCCESS 1 in 8.48 seconds
2022-03-03 16:49:31.743155 (Thread-3): 16:49:31  finished collecting timing info
2022-03-03 16:49:31.743323 (Thread-3): 16:49:31  On model.dbtvault_snowflake_demo.raw_orders: Close
2022-03-03 16:49:31.990726 (Thread-3): 16:49:31  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d716a32-49b1-4518-ac2a-4a561e89d6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcedade790>]}
2022-03-03 16:49:31.991161 (Thread-3): 16:49:31  1 of 1 OK created table model DBT_VAULT.raw_orders.............................. [SUCCESS 1 in 8.79s]
2022-03-03 16:49:31.991296 (Thread-3): 16:49:31  Finished running node model.dbtvault_snowflake_demo.raw_orders
2022-03-03 16:49:31.992910 (MainThread): 16:49:31  Acquiring new snowflake connection "master"
2022-03-03 16:49:31.993235 (MainThread): 16:49:31  
2022-03-03 16:49:31.993340 (MainThread): 16:49:31  Finished running 1 table model in 11.64s.
2022-03-03 16:49:31.993427 (MainThread): 16:49:31  Connection 'master' was properly closed.
2022-03-03 16:49:31.993500 (MainThread): 16:49:31  Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
2022-03-03 16:49:32.054470 (MainThread): 16:49:32  
2022-03-03 16:49:32.054686 (MainThread): 16:49:32  Completed successfully
2022-03-03 16:49:32.054799 (MainThread): 16:49:32  
2022-03-03 16:49:32.054898 (MainThread): 16:49:32  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 16:49:33.319831 (Thread-292): handling poll request
2022-03-03 16:49:33.320221 (Thread-292): 16:49:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510459c2b0>]}
2022-03-03 16:49:33.321338 (Thread-292): sending response (<Response 13097 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:34.752793 (Thread-293): handling status request
2022-03-03 16:49:34.753174 (Thread-293): 16:49:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510429fb80>]}
2022-03-03 16:49:34.756154 (Thread-293): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:49:35.043388 (Thread-294): handling status request
2022-03-03 16:49:35.043775 (Thread-294): 16:49:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510429fdf0>]}
2022-03-03 16:49:35.046023 (Thread-294): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:27.232066 (Thread-295): handling status request
2022-03-03 16:50:27.232485 (Thread-295): 16:50:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042c4d30>]}
2022-03-03 16:50:27.234620 (Thread-295): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:29.119359 (Thread-296): handling cli_args request
2022-03-03 16:50:29.119735 (Thread-296): 16:50:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510429f310>]}
2022-03-03 16:50:29.125076 (Thread-297): handling status request
2022-03-03 16:50:29.125540 (Thread-297): 16:50:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51040654f0>]}
2022-03-03 16:50:29.127946 (Thread-297): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:31.365821 (Thread-296): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:31.662311 (MainThread): 16:50:31  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:50:31.662746 (MainThread): 16:50:31  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:50:31.670384 (MainThread): 16:50:31  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b98897-6a5f-4aec-bd07-1c544192a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4084dc0d90>]}
2022-03-03 16:50:31.704646 (MainThread): 16:50:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b98897-6a5f-4aec-bd07-1c544192a203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40857265e0>]}
2022-03-03 16:50:31.704959 (MainThread): 16:50:31  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:50:31.705463 (MainThread): 16:50:31  The selection criterion 'stg_orders' does not match any nodes
2022-03-03 16:50:31.706718 (MainThread): 16:50:31  
2022-03-03 16:50:31.706831 (MainThread): 16:50:31  [WARNING]: Nothing to do. Try checking your model configs and model specification args
2022-03-03 16:50:32.206889 (Thread-298): handling poll request
2022-03-03 16:50:32.207337 (Thread-298): 16:50:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510429f3a0>]}
2022-03-03 16:50:32.208229 (Thread-298): sending response (<Response 3255 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:34.258221 (Thread-299): handling status request
2022-03-03 16:50:34.258607 (Thread-299): 16:50:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510406a670>]}
2022-03-03 16:50:34.261799 (Thread-299): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:34.285507 (Thread-300): handling status request
2022-03-03 16:50:34.285819 (Thread-300): 16:50:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510429f4f0>]}
2022-03-03 16:50:34.287856 (Thread-300): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:45.463085 (Thread-301): handling status request
2022-03-03 16:50:45.463617 (Thread-301): 16:50:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4757880>]}
2022-03-03 16:50:45.465951 (Thread-301): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:45.916750 (Thread-302): handling status request
2022-03-03 16:50:45.917177 (Thread-302): 16:50:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042d6f40>]}
2022-03-03 16:50:45.919375 (Thread-302): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:46.146778 (Thread-303): handling cli_args request
2022-03-03 16:50:46.147224 (Thread-303): 16:50:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042d94f0>]}
2022-03-03 16:50:48.445080 (Thread-303): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:48.724929 (MainThread): 16:50:48  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:50:48.725357 (MainThread): 16:50:48  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:50:48.733104 (MainThread): 16:50:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ca18acc-933c-40f6-bd1f-96602b43c37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f055a741d00>]}
2022-03-03 16:50:48.767424 (MainThread): 16:50:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ca18acc-933c-40f6-bd1f-96602b43c37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f055b0a1400>]}
2022-03-03 16:50:48.767692 (MainThread): 16:50:48  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:50:48.769405 (MainThread): 16:50:48  
2022-03-03 16:50:48.769702 (MainThread): 16:50:48  Acquiring new snowflake connection "master"
2022-03-03 16:50:48.770474 (ThreadPoolExecutor-0_0): 16:50:48  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:50:48.783516 (ThreadPoolExecutor-0_0): 16:50:48  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:50:48.783623 (ThreadPoolExecutor-0_0): 16:50:48  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:50:48.783708 (ThreadPoolExecutor-0_0): 16:50:48  Opening a new connection, currently in state init
2022-03-03 16:50:49.228999 (Thread-304): handling poll request
2022-03-03 16:50:49.229463 (Thread-304): 16:50:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510429f310>]}
2022-03-03 16:50:49.230369 (Thread-304): sending response (<Response 4152 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:50.254688 (ThreadPoolExecutor-0_0): 16:50:50  SQL status: SUCCESS 8 in 1.47 seconds
2022-03-03 16:50:50.256810 (ThreadPoolExecutor-0_0): 16:50:50  On list_DBT_RAW: Close
2022-03-03 16:50:50.524305 (ThreadPoolExecutor-2_0): 16:50:50  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:50:50.532342 (ThreadPoolExecutor-2_0): 16:50:50  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:50:50.532497 (ThreadPoolExecutor-2_0): 16:50:50  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:50:50.532598 (ThreadPoolExecutor-2_0): 16:50:50  Opening a new connection, currently in state closed
2022-03-03 16:50:51.028347 (Thread-305): handling poll request
2022-03-03 16:50:51.028768 (Thread-305): 16:50:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041fcb20>]}
2022-03-03 16:50:51.029407 (Thread-305): sending response (<Response 2304 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:51.869354 (ThreadPoolExecutor-2_0): 16:50:51  SQL status: SUCCESS 31 in 1.34 seconds
2022-03-03 16:50:51.871510 (ThreadPoolExecutor-2_0): 16:50:51  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:50:52.312265 (MainThread): 16:50:52  Concurrency: 4 threads (target='default')
2022-03-03 16:50:52.312455 (MainThread): 16:50:52  
2022-03-03 16:50:52.315559 (Thread-3): 16:50:52  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:50:52.315875 (Thread-3): 16:50:52  1 of 1 START table model DBT_VAULT.v_stg_orders................................. [RUN]
2022-03-03 16:50:52.316153 (Thread-3): 16:50:52  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:50:52.316270 (Thread-3): 16:50:52  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:50:52.316384 (Thread-3): 16:50:52  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:50:52.357236 (Thread-3): 16:50:52  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:50:52.357395 (Thread-3): 16:50:52  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:50:52.357499 (Thread-3): 16:50:52  Opening a new connection, currently in state closed
2022-03-03 16:50:53.010753 (Thread-306): handling poll request
2022-03-03 16:50:53.011134 (Thread-306): 16:50:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51601b80d0>]}
2022-03-03 16:50:53.011823 (Thread-306): sending response (<Response 4940 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:53.482935 (Thread-3): 16:50:53  SQL status: SUCCESS 36 in 1.13 seconds
2022-03-03 16:50:53.515548 (Thread-3): 16:50:53  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:50:53.515706 (Thread-3): 16:50:53  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:50:53.719684 (Thread-3): 16:50:53  SQL status: SUCCESS 36 in 0.2 seconds
2022-03-03 16:50:53.772470 (Thread-3): 16:50:53  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:50:53.796487 (Thread-3): 16:50:53  finished collecting timing info
2022-03-03 16:50:53.796790 (Thread-3): 16:50:53  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:50:53.821254 (Thread-3): 16:50:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:50:53.864531 (Thread-3): 16:50:53  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:50:53.864772 (Thread-3): 16:50:53  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-03 16:50:54.174212 (Thread-3): 16:50:54  Snowflake adapter: Snowflake query id: 01a2aeb2-0503-bb19-0000-0ed503a5a64a
2022-03-03 16:50:54.174490 (Thread-3): 16:50:54  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 103 at position 12
invalid identifier 'A.L_RECEIPTDATE'
2022-03-03 16:50:54.174761 (Thread-3): 16:50:54  finished collecting timing info
2022-03-03 16:50:54.175007 (Thread-3): 16:50:54  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:50:54.455938 (Thread-3): 16:50:54  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  000904 (42000): SQL compilation error: error line 103 at position 12
  invalid identifier 'A.L_RECEIPTDATE'
  compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:50:54.456400 (Thread-3): 16:50:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca18acc-933c-40f6-bd1f-96602b43c37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0558414610>]}
2022-03-03 16:50:54.456820 (Thread-3): 16:50:54  1 of 1 ERROR creating table model DBT_VAULT.v_stg_orders........................ [ERROR in 2.14s]
2022-03-03 16:50:54.456952 (Thread-3): 16:50:54  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:50:54.458552 (MainThread): 16:50:54  Acquiring new snowflake connection "master"
2022-03-03 16:50:54.458869 (MainThread): 16:50:54  
2022-03-03 16:50:54.458975 (MainThread): 16:50:54  Finished running 1 table model in 5.69s.
2022-03-03 16:50:54.459063 (MainThread): 16:50:54  Connection 'master' was properly closed.
2022-03-03 16:50:54.459134 (MainThread): 16:50:54  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 16:50:54.524827 (MainThread): 16:50:54  
2022-03-03 16:50:54.525042 (MainThread): 16:50:54  Completed with 1 error and 0 warnings:
2022-03-03 16:50:54.525138 (MainThread): 16:50:54  
2022-03-03 16:50:54.525231 (MainThread): 16:50:54  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
2022-03-03 16:50:54.525309 (MainThread): 16:50:54    000904 (42000): SQL compilation error: error line 103 at position 12
2022-03-03 16:50:54.525378 (MainThread): 16:50:54    invalid identifier 'A.L_RECEIPTDATE'
2022-03-03 16:50:54.525445 (MainThread): 16:50:54    compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:50:54.525520 (MainThread): 16:50:54  
2022-03-03 16:50:54.525606 (MainThread): 16:50:54  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 16:50:54.772794 (Thread-307): handling poll request
2022-03-03 16:50:54.773168 (Thread-307): 16:50:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510426d670>]}
2022-03-03 16:50:54.774483 (Thread-307): sending response (<Response 39301 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:56.679163 (Thread-308): handling status request
2022-03-03 16:50:56.679542 (Thread-308): 16:50:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510426d490>]}
2022-03-03 16:50:56.682538 (Thread-308): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:50:56.683701 (Thread-309): handling status request
2022-03-03 16:50:56.684060 (Thread-309): 16:50:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51045b3dc0>]}
2022-03-03 16:50:56.686453 (Thread-309): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:48.108781 (Thread-310): handling status request
2022-03-03 16:51:48.109199 (Thread-310): 16:51:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51045b3610>]}
2022-03-03 16:51:48.111692 (Thread-310): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:48.567909 (Thread-311): handling status request
2022-03-03 16:51:48.568274 (Thread-311): 16:51:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d033cc10>]}
2022-03-03 16:51:48.570450 (Thread-311): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:49.337286 (Thread-312): handling cli_args request
2022-03-03 16:51:49.337661 (Thread-312): 16:51:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d033c2b0>]}
2022-03-03 16:51:51.686508 (Thread-312): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:51.969643 (MainThread): 16:51:51  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:51:51.970087 (MainThread): 16:51:51  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:51:51.977839 (MainThread): 16:51:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6474e6d3-d281-4dcc-98e4-0111f3736bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425c540d00>]}
2022-03-03 16:51:52.015442 (MainThread): 16:51:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6474e6d3-d281-4dcc-98e4-0111f3736bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425ce9d400>]}
2022-03-03 16:51:52.015739 (MainThread): 16:51:52  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:51:52.017529 (MainThread): 16:51:52  
2022-03-03 16:51:52.017859 (MainThread): 16:51:52  Acquiring new snowflake connection "master"
2022-03-03 16:51:52.018711 (ThreadPoolExecutor-0_0): 16:51:52  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:51:52.031793 (ThreadPoolExecutor-0_0): 16:51:52  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:51:52.031901 (ThreadPoolExecutor-0_0): 16:51:52  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:51:52.031986 (ThreadPoolExecutor-0_0): 16:51:52  Opening a new connection, currently in state init
2022-03-03 16:51:52.486647 (Thread-313): handling poll request
2022-03-03 16:51:52.487105 (Thread-313): 16:51:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104065cd0>]}
2022-03-03 16:51:52.488055 (Thread-313): sending response (<Response 4167 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:53.240593 (ThreadPoolExecutor-0_0): 16:51:53  SQL status: SUCCESS 8 in 1.21 seconds
2022-03-03 16:51:53.242663 (ThreadPoolExecutor-0_0): 16:51:53  On list_DBT_RAW: Close
2022-03-03 16:51:53.541957 (ThreadPoolExecutor-2_0): 16:51:53  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:51:53.549961 (ThreadPoolExecutor-2_0): 16:51:53  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:51:53.550114 (ThreadPoolExecutor-2_0): 16:51:53  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:51:53.550233 (ThreadPoolExecutor-2_0): 16:51:53  Opening a new connection, currently in state closed
2022-03-03 16:51:54.284588 (ThreadPoolExecutor-2_0): 16:51:54  SQL status: SUCCESS 31 in 0.73 seconds
2022-03-03 16:51:54.286770 (ThreadPoolExecutor-2_0): 16:51:54  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:51:54.537132 (MainThread): 16:51:54  Concurrency: 4 threads (target='default')
2022-03-03 16:51:54.537307 (MainThread): 16:51:54  
2022-03-03 16:51:54.540151 (Thread-3): 16:51:54  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:51:54.540471 (Thread-3): 16:51:54  1 of 1 START table model DBT_VAULT.v_stg_orders................................. [RUN]
2022-03-03 16:51:54.540798 (Thread-3): 16:51:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:51:54.540918 (Thread-3): 16:51:54  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:51:54.541030 (Thread-3): 16:51:54  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:51:54.580998 (Thread-3): 16:51:54  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:51:54.581138 (Thread-3): 16:51:54  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:51:54.581231 (Thread-3): 16:51:54  Opening a new connection, currently in state closed
2022-03-03 16:51:55.129116 (Thread-314): handling poll request
2022-03-03 16:51:55.129516 (Thread-314): 16:51:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5160222e50>]}
2022-03-03 16:51:55.130256 (Thread-314): sending response (<Response 6954 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:55.890291 (Thread-3): 16:51:55  SQL status: SUCCESS 36 in 1.31 seconds
2022-03-03 16:51:55.922173 (Thread-3): 16:51:55  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:51:55.922326 (Thread-3): 16:51:55  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:51:56.027710 (Thread-3): 16:51:56  SQL status: SUCCESS 36 in 0.11 seconds
2022-03-03 16:51:56.076943 (Thread-3): 16:51:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:51:56.105474 (Thread-3): 16:51:56  finished collecting timing info
2022-03-03 16:51:56.105885 (Thread-3): 16:51:56  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:51:56.130443 (Thread-3): 16:51:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:51:56.166747 (Thread-3): 16:51:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:51:56.166896 (Thread-3): 16:51:56  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */


      create or replace transient table DBT_RAW.DBT_VAULT.v_stg_orders  as
      (







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
      );
2022-03-03 16:51:56.330761 (Thread-3): 16:51:56  Snowflake adapter: Snowflake query id: 01a2aeb3-0503-b8b2-0000-0ed503a5963a
2022-03-03 16:51:56.330931 (Thread-3): 16:51:56  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 103 at position 12
invalid identifier 'A.L_RECEIPTDATE'
2022-03-03 16:51:56.331105 (Thread-3): 16:51:56  finished collecting timing info
2022-03-03 16:51:56.331248 (Thread-3): 16:51:56  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:51:56.565145 (Thread-3): 16:51:56  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  000904 (42000): SQL compilation error: error line 103 at position 12
  invalid identifier 'A.L_RECEIPTDATE'
  compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:51:56.565601 (Thread-3): 16:51:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6474e6d3-d281-4dcc-98e4-0111f3736bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42541d8cd0>]}
2022-03-03 16:51:56.566047 (Thread-3): 16:51:56  1 of 1 ERROR creating table model DBT_VAULT.v_stg_orders........................ [ERROR in 2.02s]
2022-03-03 16:51:56.566190 (Thread-3): 16:51:56  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:51:56.567771 (MainThread): 16:51:56  Acquiring new snowflake connection "master"
2022-03-03 16:51:56.568088 (MainThread): 16:51:56  
2022-03-03 16:51:56.568197 (MainThread): 16:51:56  Finished running 1 table model in 4.55s.
2022-03-03 16:51:56.568284 (MainThread): 16:51:56  Connection 'master' was properly closed.
2022-03-03 16:51:56.568353 (MainThread): 16:51:56  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 16:51:56.640325 (MainThread): 16:51:56  
2022-03-03 16:51:56.640550 (MainThread): 16:51:56  Completed with 1 error and 0 warnings:
2022-03-03 16:51:56.640674 (MainThread): 16:51:56  
2022-03-03 16:51:56.640779 (MainThread): 16:51:56  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
2022-03-03 16:51:56.640860 (MainThread): 16:51:56    000904 (42000): SQL compilation error: error line 103 at position 12
2022-03-03 16:51:56.640930 (MainThread): 16:51:56    invalid identifier 'A.L_RECEIPTDATE'
2022-03-03 16:51:56.640997 (MainThread): 16:51:56    compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:51:56.641072 (MainThread): 16:51:56  
2022-03-03 16:51:56.641160 (MainThread): 16:51:56  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 16:51:57.101327 (Thread-315): handling poll request
2022-03-03 16:51:57.101706 (Thread-315): 16:51:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516017d9a0>]}
2022-03-03 16:51:57.103009 (Thread-315): sending response (<Response 39318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:58.954812 (Thread-316): handling status request
2022-03-03 16:51:58.955181 (Thread-316): 16:51:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516017dc10>]}
2022-03-03 16:51:58.960413 (Thread-316): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:51:59.147521 (Thread-317): handling status request
2022-03-03 16:51:59.147890 (Thread-317): 16:51:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041cbd30>]}
2022-03-03 16:51:59.150124 (Thread-317): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:29.158056 (Thread-318): 16:52:29  Unable to do partial parsing because a project config has changed
2022-03-03 16:52:29.158442 (Thread-318): 16:52:29  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51602985e0>]}
2022-03-03 16:52:29.386344 (Thread-318): 16:52:29  Parsing macros/adapters.sql
2022-03-03 16:52:29.426937 (Thread-318): 16:52:29  Parsing macros/catalog.sql
2022-03-03 16:52:29.429114 (Thread-318): 16:52:29  Parsing macros/materializations/table.sql
2022-03-03 16:52:29.432386 (Thread-318): 16:52:29  Parsing macros/materializations/seed.sql
2022-03-03 16:52:29.437984 (Thread-318): 16:52:29  Parsing macros/materializations/incremental.sql
2022-03-03 16:52:29.447616 (Thread-318): 16:52:29  Parsing macros/materializations/merge.sql
2022-03-03 16:52:29.451804 (Thread-318): 16:52:29  Parsing macros/materializations/snapshot.sql
2022-03-03 16:52:29.452935 (Thread-318): 16:52:29  Parsing macros/materializations/view.sql
2022-03-03 16:52:29.454560 (Thread-318): 16:52:29  Parsing macros/adapters/metadata.sql
2022-03-03 16:52:29.462391 (Thread-318): 16:52:29  Parsing macros/adapters/columns.sql
2022-03-03 16:52:29.473186 (Thread-318): 16:52:29  Parsing macros/adapters/freshness.sql
2022-03-03 16:52:29.476418 (Thread-318): 16:52:29  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:52:29.481522 (Thread-318): 16:52:29  Parsing macros/adapters/relation.sql
2022-03-03 16:52:29.491666 (Thread-318): 16:52:29  Parsing macros/adapters/schema.sql
2022-03-03 16:52:29.493947 (Thread-318): 16:52:29  Parsing macros/adapters/indexes.sql
2022-03-03 16:52:29.496703 (Thread-318): 16:52:29  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:52:29.499249 (Thread-318): 16:52:29  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:52:29.500782 (Thread-318): 16:52:29  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:52:29.502373 (Thread-318): 16:52:29  Parsing macros/etc/datetime.sql
2022-03-03 16:52:29.510891 (Thread-318): 16:52:29  Parsing macros/etc/statement.sql
2022-03-03 16:52:29.515331 (Thread-318): 16:52:29  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:52:29.516070 (Thread-318): 16:52:29  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:52:29.516686 (Thread-318): 16:52:29  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:52:29.518091 (Thread-318): 16:52:29  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:52:29.518973 (Thread-318): 16:52:29  Parsing macros/materializations/configs.sql
2022-03-03 16:52:29.521321 (Thread-318): 16:52:29  Parsing macros/materializations/hooks.sql
2022-03-03 16:52:29.525195 (Thread-318): 16:52:29  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:52:29.532601 (Thread-318): 16:52:29  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:52:29.535640 (Thread-318): 16:52:29  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:52:29.538444 (Thread-318): 16:52:29  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:52:29.539808 (Thread-318): 16:52:29  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:52:29.542287 (Thread-318): 16:52:29  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:52:29.549346 (Thread-318): 16:52:29  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:52:29.559289 (Thread-318): 16:52:29  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:52:29.574430 (Thread-318): 16:52:29  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:52:29.575998 (Thread-318): 16:52:29  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:52:29.587113 (Thread-318): 16:52:29  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:52:29.591537 (Thread-318): 16:52:29  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:52:29.607964 (Thread-318): 16:52:29  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:52:29.613995 (Thread-318): 16:52:29  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:52:29.615808 (Thread-318): 16:52:29  Parsing macros/materializations/tests/test.sql
2022-03-03 16:52:29.620215 (Thread-318): 16:52:29  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:52:29.622080 (Thread-318): 16:52:29  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:52:29.633289 (Thread-318): 16:52:29  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:52:29.659470 (Thread-318): 16:52:29  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:52:29.662009 (Thread-318): 16:52:29  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:52:29.676725 (Thread-318): 16:52:29  Parsing tests/generic/builtin.sql
2022-03-03 16:52:29.679849 (Thread-318): 16:52:29  Parsing macros/sql/pivot.sql
2022-03-03 16:52:29.683899 (Thread-318): 16:52:29  Parsing macros/sql/star.sql
2022-03-03 16:52:29.688122 (Thread-318): 16:52:29  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:52:29.689454 (Thread-318): 16:52:29  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:52:29.692932 (Thread-318): 16:52:29  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:52:29.695393 (Thread-318): 16:52:29  Parsing macros/sql/date_spine.sql
2022-03-03 16:52:29.699789 (Thread-318): 16:52:29  Parsing macros/sql/get_column_values.sql
2022-03-03 16:52:29.705083 (Thread-318): 16:52:29  Parsing macros/sql/groupby.sql
2022-03-03 16:52:29.706465 (Thread-318): 16:52:29  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:52:29.712989 (Thread-318): 16:52:29  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:52:29.714660 (Thread-318): 16:52:29  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:52:29.716452 (Thread-318): 16:52:29  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:52:29.719800 (Thread-318): 16:52:29  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:52:29.723304 (Thread-318): 16:52:29  Parsing macros/sql/safe_add.sql
2022-03-03 16:52:29.725354 (Thread-318): 16:52:29  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:52:29.731479 (Thread-318): 16:52:29  Parsing macros/sql/unpivot.sql
2022-03-03 16:52:29.739162 (Thread-318): 16:52:29  Parsing macros/sql/generate_series.sql
2022-03-03 16:52:29.743420 (Thread-318): 16:52:29  Parsing macros/sql/nullcheck.sql
2022-03-03 16:52:29.745114 (Thread-318): 16:52:29  Parsing macros/sql/union.sql
2022-03-03 16:52:29.755477 (Thread-318): 16:52:29  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:52:29.780289 (Thread-318): 16:52:29  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:52:29.781755 (Thread-318): 16:52:29  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:52:29.783003 (Thread-318): 16:52:29  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:52:29.784162 (Thread-318): 16:52:29  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:52:29.785420 (Thread-318): 16:52:29  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:52:29.797338 (Thread-318): 16:52:29  Parsing macros/web/get_url_path.sql
2022-03-03 16:52:29.801371 (Thread-318): 16:52:29  Parsing macros/web/get_url_host.sql
2022-03-03 16:52:29.805124 (Thread-318): 16:52:29  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:52:29.837713 (Thread-318): 16:52:29  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:52:29.839254 (Thread-318): 16:52:29  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:52:29.842823 (Thread-318): 16:52:29  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:52:29.845023 (Thread-318): 16:52:29  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:52:29.846412 (Thread-318): 16:52:29  Parsing macros/schema_tests/equality.sql
2022-03-03 16:52:29.850144 (Thread-318): 16:52:29  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:52:29.851682 (Thread-318): 16:52:29  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:52:29.853360 (Thread-318): 16:52:29  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:52:29.855406 (Thread-318): 16:52:29  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:52:29.856870 (Thread-318): 16:52:29  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:52:29.865810 (Thread-318): 16:52:29  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:52:29.868197 (Thread-318): 16:52:29  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:52:29.870720 (Thread-318): 16:52:29  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:52:29.872682 (Thread-318): 16:52:29  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:52:29.875600 (Thread-318): 16:52:29  Parsing macros/schema_tests/recency.sql
2022-03-03 16:52:29.877627 (Thread-318): 16:52:29  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:52:29.880189 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:52:29.882242 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:52:29.884847 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:52:29.886445 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:52:29.890090 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:52:29.892273 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:52:29.893712 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:52:29.894992 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:52:29.896272 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:52:29.897738 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:52:29.899525 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:52:29.900563 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:52:29.901722 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:52:29.903344 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:52:29.912766 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:52:29.915590 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:52:29.921635 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:52:29.923169 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:52:29.924124 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:52:29.925997 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:52:29.930920 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:52:29.932377 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:52:29.933461 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:52:29.935788 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:52:29.939241 (Thread-318): 16:52:29  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:52:29.940355 (Thread-318): 16:52:29  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:52:29.945653 (Thread-318): 16:52:29  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:52:29.951012 (Thread-318): 16:52:29  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:52:29.968903 (Thread-318): 16:52:29  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:52:29.986622 (Thread-318): 16:52:29  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:52:29.989381 (Thread-318): 16:52:29  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:52:29.996602 (Thread-318): 16:52:29  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:52:29.999246 (Thread-318): 16:52:29  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:52:30.001317 (Thread-318): 16:52:30  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:52:30.015379 (Thread-318): 16:52:30  Parsing macros/staging/hash_columns.sql
2022-03-03 16:52:30.019104 (Thread-318): 16:52:30  Parsing macros/staging/stage.sql
2022-03-03 16:52:30.029367 (Thread-318): 16:52:30  Parsing macros/staging/rank_columns.sql
2022-03-03 16:52:30.037847 (Thread-318): 16:52:30  Parsing macros/staging/derive_columns.sql
2022-03-03 16:52:30.043550 (Thread-318): 16:52:30  Parsing macros/staging/source_columns.sql
2022-03-03 16:52:30.044831 (Thread-318): 16:52:30  Parsing macros/internal/alias_all.sql
2022-03-03 16:52:30.047148 (Thread-318): 16:52:30  Parsing macros/internal/alias.sql
2022-03-03 16:52:30.050679 (Thread-318): 16:52:30  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:52:30.051111 (Thread-318): 16:52:30  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:52:30.060175 (Thread-318): 16:52:30  Parsing macros/internal/multikey.sql
2022-03-03 16:52:30.065323 (Thread-318): 16:52:30  Parsing macros/internal/is_checks.sql
2022-03-03 16:52:30.068228 (Thread-318): 16:52:30  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:52:30.071611 (Thread-318): 16:52:30  Parsing macros/internal/as_constant.sql
2022-03-03 16:52:30.073734 (Thread-318): 16:52:30  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:52:30.075373 (Thread-318): 16:52:30  Parsing macros/tables/link.sql
2022-03-03 16:52:30.088700 (Thread-318): 16:52:30  Parsing macros/tables/sat.sql
2022-03-03 16:52:30.101651 (Thread-318): 16:52:30  Parsing macros/tables/eff_sat.sql
2022-03-03 16:52:30.115155 (Thread-318): 16:52:30  Parsing macros/tables/xts.sql
2022-03-03 16:52:30.122603 (Thread-318): 16:52:30  Parsing macros/tables/hub.sql
2022-03-03 16:52:30.133954 (Thread-318): 16:52:30  Parsing macros/tables/ma_sat.sql
2022-03-03 16:52:30.146380 (Thread-318): 16:52:30  Parsing macros/tables/pit.sql
2022-03-03 16:52:30.166214 (Thread-318): 16:52:30  Parsing macros/tables/bridge.sql
2022-03-03 16:52:30.200807 (Thread-318): 16:52:30  Parsing macros/tables/t_link.sql
2022-03-03 16:52:30.206421 (Thread-318): 16:52:30  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:52:30.207457 (Thread-318): 16:52:30  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:52:30.209321 (Thread-318): 16:52:30  Parsing macros/supporting/prefix.sql
2022-03-03 16:52:30.214609 (Thread-318): 16:52:30  Parsing macros/supporting/hash.sql
2022-03-03 16:52:30.221427 (Thread-318): 16:52:30  Parsing macros/supporting/datatypes.sql
2022-03-03 16:52:30.756276 (Thread-318): 16:52:30  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:52:30.783275 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:52:30.784865 (Thread-318): 16:52:30  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:52:30.799548 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:52:30.801423 (Thread-318): 16:52:30  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:52:30.844905 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:52:30.845634 (Thread-319): handling status request
2022-03-03 16:52:30.847147 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:52:30.847502 (Thread-319): 16:52:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4607610>]}
2022-03-03 16:52:30.856224 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:52:30.856837 (Thread-319): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:30.858177 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:52:30.868239 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:52:30.869666 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:52:30.878570 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:52:30.879997 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:52:30.886911 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:52:30.888372 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:52:30.895275 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:52:30.896603 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:52:30.906448 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:52:30.907761 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:52:30.915029 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:52:30.916217 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:52:30.925129 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:52:30.926406 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:52:30.933830 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:52:30.935011 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:52:30.943918 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:52:30.945149 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:52:30.952025 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:52:30.953305 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:52:30.960268 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:52:30.961465 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:52:30.968160 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:52:30.969414 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:52:30.977887 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:52:30.979066 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:52:30.987020 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:52:30.988222 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:52:30.997912 (Thread-318): 16:52:30  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:52:30.999497 (Thread-318): 16:52:30  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:52:31.008886 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:52:31.010221 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:52:31.023077 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:52:31.024379 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:52:31.036787 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:52:31.038150 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:52:31.048662 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:52:31.050172 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:52:31.060089 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:52:31.061705 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:52:31.075236 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:52:31.076777 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:52:31.089075 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:52:31.090473 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:52:31.102142 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:52:31.103687 (Thread-318): 16:52:31  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:52:31.113456 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:52:31.115263 (Thread-318): 16:52:31  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:52:31.121081 (Thread-320): handling status request
2022-03-03 16:52:31.121362 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:52:31.121670 (Thread-320): 16:52:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51040c0880>]}
2022-03-03 16:52:31.123282 (Thread-318): 16:52:31  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:52:31.123786 (Thread-320): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:31.130470 (Thread-318): 16:52:31  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:52:31.132601 (Thread-318): 16:52:31  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:52:31.236466 (Thread-318): 16:52:31  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44eedf0>]}
2022-03-03 16:52:33.705861 (Thread-321): handling status request
2022-03-03 16:52:33.706242 (Thread-321): 16:52:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47c5730>]}
2022-03-03 16:52:33.708303 (Thread-321): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:33.729271 (Thread-322): handling status request
2022-03-03 16:52:33.729650 (Thread-322): 16:52:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e436b520>]}
2022-03-03 16:52:33.731682 (Thread-322): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:37.348443 (Thread-323): 16:52:37  Unable to do partial parsing because a project config has changed
2022-03-03 16:52:37.348812 (Thread-323): 16:52:37  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47c5820>]}
2022-03-03 16:52:37.561000 (Thread-323): 16:52:37  Parsing macros/adapters.sql
2022-03-03 16:52:37.600098 (Thread-323): 16:52:37  Parsing macros/catalog.sql
2022-03-03 16:52:37.602096 (Thread-323): 16:52:37  Parsing macros/materializations/table.sql
2022-03-03 16:52:37.605360 (Thread-323): 16:52:37  Parsing macros/materializations/seed.sql
2022-03-03 16:52:37.610781 (Thread-323): 16:52:37  Parsing macros/materializations/incremental.sql
2022-03-03 16:52:37.619420 (Thread-323): 16:52:37  Parsing macros/materializations/merge.sql
2022-03-03 16:52:37.623385 (Thread-323): 16:52:37  Parsing macros/materializations/snapshot.sql
2022-03-03 16:52:37.624412 (Thread-323): 16:52:37  Parsing macros/materializations/view.sql
2022-03-03 16:52:37.625887 (Thread-323): 16:52:37  Parsing macros/adapters/metadata.sql
2022-03-03 16:52:37.633070 (Thread-323): 16:52:37  Parsing macros/adapters/columns.sql
2022-03-03 16:52:37.642863 (Thread-323): 16:52:37  Parsing macros/adapters/freshness.sql
2022-03-03 16:52:37.645829 (Thread-323): 16:52:37  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:52:37.650173 (Thread-323): 16:52:37  Parsing macros/adapters/relation.sql
2022-03-03 16:52:37.659477 (Thread-323): 16:52:37  Parsing macros/adapters/schema.sql
2022-03-03 16:52:37.661693 (Thread-323): 16:52:37  Parsing macros/adapters/indexes.sql
2022-03-03 16:52:37.664346 (Thread-323): 16:52:37  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:52:37.666814 (Thread-323): 16:52:37  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:52:37.668277 (Thread-323): 16:52:37  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:52:37.669872 (Thread-323): 16:52:37  Parsing macros/etc/datetime.sql
2022-03-03 16:52:37.677960 (Thread-323): 16:52:37  Parsing macros/etc/statement.sql
2022-03-03 16:52:37.682287 (Thread-323): 16:52:37  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:52:37.683026 (Thread-323): 16:52:37  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:52:37.683594 (Thread-323): 16:52:37  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:52:37.684986 (Thread-323): 16:52:37  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:52:37.685868 (Thread-323): 16:52:37  Parsing macros/materializations/configs.sql
2022-03-03 16:52:37.688202 (Thread-323): 16:52:37  Parsing macros/materializations/hooks.sql
2022-03-03 16:52:37.691996 (Thread-323): 16:52:37  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:52:37.699306 (Thread-323): 16:52:37  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:52:37.702232 (Thread-323): 16:52:37  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:52:37.704850 (Thread-323): 16:52:37  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:52:37.706156 (Thread-323): 16:52:37  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:52:37.708442 (Thread-323): 16:52:37  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:52:37.715373 (Thread-323): 16:52:37  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:52:37.725140 (Thread-323): 16:52:37  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:52:37.740120 (Thread-323): 16:52:37  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:52:37.741683 (Thread-323): 16:52:37  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:52:37.752619 (Thread-323): 16:52:37  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:52:37.757072 (Thread-323): 16:52:37  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:52:37.772896 (Thread-323): 16:52:37  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:52:37.778736 (Thread-323): 16:52:37  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:52:37.780474 (Thread-323): 16:52:37  Parsing macros/materializations/tests/test.sql
2022-03-03 16:52:37.784858 (Thread-323): 16:52:37  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:52:37.786651 (Thread-323): 16:52:37  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:52:37.797521 (Thread-323): 16:52:37  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:52:37.813813 (Thread-323): 16:52:37  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:52:37.815442 (Thread-323): 16:52:37  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:52:37.836140 (Thread-323): 16:52:37  Parsing tests/generic/builtin.sql
2022-03-03 16:52:37.842744 (Thread-323): 16:52:37  Parsing macros/sql/pivot.sql
2022-03-03 16:52:37.846773 (Thread-323): 16:52:37  Parsing macros/sql/star.sql
2022-03-03 16:52:37.850971 (Thread-323): 16:52:37  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:52:37.852238 (Thread-323): 16:52:37  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:52:37.855719 (Thread-323): 16:52:37  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:52:37.858260 (Thread-323): 16:52:37  Parsing macros/sql/date_spine.sql
2022-03-03 16:52:37.862442 (Thread-323): 16:52:37  Parsing macros/sql/get_column_values.sql
2022-03-03 16:52:37.867569 (Thread-323): 16:52:37  Parsing macros/sql/groupby.sql
2022-03-03 16:52:37.868966 (Thread-323): 16:52:37  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:52:37.875113 (Thread-323): 16:52:37  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:52:37.876764 (Thread-323): 16:52:37  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:52:37.878406 (Thread-323): 16:52:37  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:52:37.881825 (Thread-323): 16:52:37  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:52:37.885246 (Thread-323): 16:52:37  Parsing macros/sql/safe_add.sql
2022-03-03 16:52:37.886930 (Thread-323): 16:52:37  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:52:37.892758 (Thread-323): 16:52:37  Parsing macros/sql/unpivot.sql
2022-03-03 16:52:37.900473 (Thread-323): 16:52:37  Parsing macros/sql/generate_series.sql
2022-03-03 16:52:37.904753 (Thread-323): 16:52:37  Parsing macros/sql/nullcheck.sql
2022-03-03 16:52:37.906425 (Thread-323): 16:52:37  Parsing macros/sql/union.sql
2022-03-03 16:52:37.916033 (Thread-323): 16:52:37  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:52:37.946313 (Thread-323): 16:52:37  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:52:37.948317 (Thread-323): 16:52:37  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:52:37.950451 (Thread-323): 16:52:37  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:52:37.951986 (Thread-323): 16:52:37  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:52:37.953525 (Thread-323): 16:52:37  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:52:37.955662 (Thread-323): 16:52:37  Parsing macros/web/get_url_path.sql
2022-03-03 16:52:37.959241 (Thread-323): 16:52:37  Parsing macros/web/get_url_host.sql
2022-03-03 16:52:37.961823 (Thread-323): 16:52:37  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:52:37.964518 (Thread-323): 16:52:37  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:52:37.966271 (Thread-323): 16:52:37  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:52:37.970260 (Thread-323): 16:52:37  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:52:37.973494 (Thread-323): 16:52:37  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:52:37.975338 (Thread-323): 16:52:37  Parsing macros/schema_tests/equality.sql
2022-03-03 16:52:37.980542 (Thread-323): 16:52:37  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:52:37.982610 (Thread-323): 16:52:37  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:52:37.985058 (Thread-323): 16:52:37  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:52:37.987959 (Thread-323): 16:52:37  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:52:37.989993 (Thread-323): 16:52:37  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:52:38.002058 (Thread-323): 16:52:38  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:52:38.004754 (Thread-323): 16:52:38  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:52:38.007484 (Thread-323): 16:52:38  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:52:38.010166 (Thread-323): 16:52:38  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:52:38.013961 (Thread-323): 16:52:38  Parsing macros/schema_tests/recency.sql
2022-03-03 16:52:38.016373 (Thread-323): 16:52:38  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:52:38.019170 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:52:38.021510 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:52:38.024196 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:52:38.026238 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:52:38.030163 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:52:38.032432 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:52:38.033906 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:52:38.035207 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:52:38.036505 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:52:38.038136 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:52:38.039723 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:52:38.040777 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:52:38.041908 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:52:38.043577 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:52:38.053138 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:52:38.055973 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:52:38.062033 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:52:38.063625 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:52:38.064606 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:52:38.066537 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:52:38.071647 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:52:38.073212 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:52:38.074284 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:52:38.076337 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:52:38.079819 (Thread-323): 16:52:38  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:52:38.080961 (Thread-323): 16:52:38  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:52:38.086665 (Thread-323): 16:52:38  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:52:38.091834 (Thread-323): 16:52:38  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:52:38.109928 (Thread-323): 16:52:38  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:52:38.127649 (Thread-323): 16:52:38  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:52:38.130385 (Thread-323): 16:52:38  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:52:38.136919 (Thread-323): 16:52:38  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:52:38.146677 (Thread-323): 16:52:38  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:52:38.148804 (Thread-323): 16:52:38  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:52:38.163063 (Thread-323): 16:52:38  Parsing macros/staging/hash_columns.sql
2022-03-03 16:52:38.166896 (Thread-323): 16:52:38  Parsing macros/staging/stage.sql
2022-03-03 16:52:38.177212 (Thread-323): 16:52:38  Parsing macros/staging/rank_columns.sql
2022-03-03 16:52:38.185677 (Thread-323): 16:52:38  Parsing macros/staging/derive_columns.sql
2022-03-03 16:52:38.191300 (Thread-323): 16:52:38  Parsing macros/staging/source_columns.sql
2022-03-03 16:52:38.192570 (Thread-323): 16:52:38  Parsing macros/internal/alias_all.sql
2022-03-03 16:52:38.194952 (Thread-323): 16:52:38  Parsing macros/internal/alias.sql
2022-03-03 16:52:38.198390 (Thread-323): 16:52:38  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:52:38.198833 (Thread-323): 16:52:38  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:52:38.208078 (Thread-323): 16:52:38  Parsing macros/internal/multikey.sql
2022-03-03 16:52:38.213528 (Thread-323): 16:52:38  Parsing macros/internal/is_checks.sql
2022-03-03 16:52:38.216581 (Thread-323): 16:52:38  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:52:38.219833 (Thread-323): 16:52:38  Parsing macros/internal/as_constant.sql
2022-03-03 16:52:38.222173 (Thread-323): 16:52:38  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:52:38.223839 (Thread-323): 16:52:38  Parsing macros/tables/link.sql
2022-03-03 16:52:38.237166 (Thread-323): 16:52:38  Parsing macros/tables/sat.sql
2022-03-03 16:52:38.246731 (Thread-323): 16:52:38  Parsing macros/tables/eff_sat.sql
2022-03-03 16:52:38.261883 (Thread-323): 16:52:38  Parsing macros/tables/xts.sql
2022-03-03 16:52:38.274270 (Thread-323): 16:52:38  Parsing macros/tables/hub.sql
2022-03-03 16:52:38.295400 (Thread-323): 16:52:38  Parsing macros/tables/ma_sat.sql
2022-03-03 16:52:38.309849 (Thread-323): 16:52:38  Parsing macros/tables/pit.sql
2022-03-03 16:52:38.330332 (Thread-323): 16:52:38  Parsing macros/tables/bridge.sql
2022-03-03 16:52:38.366533 (Thread-323): 16:52:38  Parsing macros/tables/t_link.sql
2022-03-03 16:52:38.372371 (Thread-323): 16:52:38  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:52:38.373524 (Thread-323): 16:52:38  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:52:38.375323 (Thread-323): 16:52:38  Parsing macros/supporting/prefix.sql
2022-03-03 16:52:38.380832 (Thread-323): 16:52:38  Parsing macros/supporting/hash.sql
2022-03-03 16:52:38.389964 (Thread-323): 16:52:38  Parsing macros/supporting/datatypes.sql
2022-03-03 16:52:38.809624 (Thread-324): handling status request
2022-03-03 16:52:38.825417 (Thread-324): 16:52:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42ac910>]}
2022-03-03 16:52:38.831054 (Thread-324): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:38.930926 (Thread-325): handling status request
2022-03-03 16:52:38.946606 (Thread-325): 16:52:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41af520>]}
2022-03-03 16:52:38.949015 (Thread-323): 16:52:38  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:52:38.949515 (Thread-325): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:38.973940 (Thread-323): 16:52:38  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:52:38.975323 (Thread-323): 16:52:38  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:52:38.985482 (Thread-323): 16:52:38  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:52:38.986694 (Thread-323): 16:52:38  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:52:39.016684 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:52:39.018017 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:52:39.025094 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:52:39.026329 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:52:39.034402 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:52:39.035523 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:52:39.043319 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:52:39.044737 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:52:39.050797 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:52:39.051945 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:52:39.058906 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:52:39.060022 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:52:39.067934 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:52:39.069120 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:52:39.075299 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:52:39.076520 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:52:39.084542 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:52:39.085703 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:52:39.092480 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:52:39.093635 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:52:39.101209 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:52:39.102328 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:52:39.108877 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:52:39.109998 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:52:39.116795 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:52:39.117928 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:52:39.124513 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:52:39.125663 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:52:39.133763 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:52:39.134893 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:52:39.142282 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:52:39.143519 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:52:39.152902 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:52:39.154068 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:52:39.162798 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:52:39.163963 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:52:39.176793 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:52:39.178007 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:52:39.187787 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:52:39.189005 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:52:39.197777 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:52:39.198929 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:52:39.207862 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:52:39.209033 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:52:39.399696 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:52:39.401118 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:52:39.412706 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:52:39.413994 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:52:39.425652 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:52:39.426870 (Thread-323): 16:52:39  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:52:39.436024 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:52:39.437414 (Thread-323): 16:52:39  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:52:39.442269 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:52:39.443823 (Thread-323): 16:52:39  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:52:39.449969 (Thread-323): 16:52:39  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:52:39.451542 (Thread-323): 16:52:39  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:52:39.551396 (Thread-323): 16:52:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47bdd90>]}
2022-03-03 16:52:40.951609 (Thread-326): handling status request
2022-03-03 16:52:40.951999 (Thread-326): 16:52:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e411c5b0>]}
2022-03-03 16:52:40.954426 (Thread-326): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:40.963234 (Thread-327): handling status request
2022-03-03 16:52:40.963553 (Thread-327): 16:52:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4212a90>]}
2022-03-03 16:52:40.965756 (Thread-327): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:53.634350 (Thread-328): handling status request
2022-03-03 16:52:53.634712 (Thread-328): 16:52:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104191880>]}
2022-03-03 16:52:53.637028 (Thread-328): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:53.928329 (Thread-329): handling status request
2022-03-03 16:52:53.928724 (Thread-329): 16:52:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041917c0>]}
2022-03-03 16:52:53.930999 (Thread-329): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:54.215866 (Thread-330): handling cli_args request
2022-03-03 16:52:54.216220 (Thread-330): 16:52:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104191700>]}
2022-03-03 16:52:56.440360 (Thread-330): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:56.730059 (MainThread): 16:52:56  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:52:56.730496 (MainThread): 16:52:56  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:52:56.738030 (MainThread): 16:52:56  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80916995-b608-4d5b-a660-435e80418a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a77c2d60>]}
2022-03-03 16:52:56.787232 (MainThread): 16:52:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80916995-b608-4d5b-a660-435e80418a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ac15d4c0>]}
2022-03-03 16:52:56.787524 (MainThread): 16:52:56  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:52:56.789193 (MainThread): 16:52:56  
2022-03-03 16:52:56.789494 (MainThread): 16:52:56  Acquiring new snowflake connection "master"
2022-03-03 16:52:56.790299 (ThreadPoolExecutor-0_0): 16:52:56  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:52:56.803299 (ThreadPoolExecutor-0_0): 16:52:56  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:52:56.803432 (ThreadPoolExecutor-0_0): 16:52:56  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:52:56.803524 (ThreadPoolExecutor-0_0): 16:52:56  Opening a new connection, currently in state init
2022-03-03 16:52:57.166194 (Thread-331): handling poll request
2022-03-03 16:52:57.166663 (Thread-331): 16:52:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e456a0d0>]}
2022-03-03 16:52:57.167650 (Thread-331): sending response (<Response 4152 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:52:57.998563 (ThreadPoolExecutor-0_0): 16:52:57  SQL status: SUCCESS 8 in 1.19 seconds
2022-03-03 16:52:58.000609 (ThreadPoolExecutor-0_0): 16:52:58  On list_DBT_RAW: Close
2022-03-03 16:52:58.274071 (ThreadPoolExecutor-2_0): 16:52:58  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:52:58.281840 (ThreadPoolExecutor-2_0): 16:52:58  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:52:58.281989 (ThreadPoolExecutor-2_0): 16:52:58  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:52:58.282091 (ThreadPoolExecutor-2_0): 16:52:58  Opening a new connection, currently in state closed
2022-03-03 16:52:59.485422 (ThreadPoolExecutor-2_0): 16:52:59  SQL status: SUCCESS 31 in 1.2 seconds
2022-03-03 16:52:59.488353 (ThreadPoolExecutor-2_0): 16:52:59  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:52:59.732163 (MainThread): 16:52:59  Concurrency: 4 threads (target='default')
2022-03-03 16:52:59.732341 (MainThread): 16:52:59  
2022-03-03 16:52:59.735362 (Thread-3): 16:52:59  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:52:59.735684 (Thread-3): 16:52:59  1 of 1 START view model DBT_VAULT.v_stg_orders.................................. [RUN]
2022-03-03 16:52:59.735979 (Thread-3): 16:52:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:52:59.736095 (Thread-3): 16:52:59  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:52:59.736204 (Thread-3): 16:52:59  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:52:59.776710 (Thread-3): 16:52:59  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:52:59.776849 (Thread-3): 16:52:59  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:52:59.776941 (Thread-3): 16:52:59  Opening a new connection, currently in state closed
2022-03-03 16:52:59.950339 (Thread-332): handling poll request
2022-03-03 16:52:59.950721 (Thread-332): 16:52:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042ea3a0>]}
2022-03-03 16:52:59.951526 (Thread-332): sending response (<Response 6937 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:00.696713 (Thread-3): 16:53:00  SQL status: SUCCESS 36 in 0.92 seconds
2022-03-03 16:53:00.729280 (Thread-3): 16:53:00  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:00.729432 (Thread-3): 16:53:00  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:53:00.924768 (Thread-3): 16:53:00  SQL status: SUCCESS 36 in 0.2 seconds
2022-03-03 16:53:00.976324 (Thread-3): 16:53:00  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:01.010747 (Thread-3): 16:53:01  finished collecting timing info
2022-03-03 16:53:01.010969 (Thread-3): 16:53:01  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:01.033417 (Thread-3): 16:53:01  Dropping relation "DBT_RAW"."DBT_VAULT"."V_STG_ORDERS" because it is of type table
2022-03-03 16:53:01.038139 (Thread-3): 16:53:01  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:01.038264 (Thread-3): 16:53:01  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */
drop table if exists "DBT_RAW"."DBT_VAULT"."V_STG_ORDERS" cascade
2022-03-03 16:53:01.329655 (Thread-3): 16:53:01  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 16:53:01.340579 (Thread-3): 16:53:01  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:01.377566 (Thread-3): 16:53:01  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:01.377727 (Thread-3): 16:53:01  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_orders 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(a.L_RECEIPTDATE) OVER (PARTITION BY b.O_CUSTKEY ORDER BY a.L_RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
2022-03-03 16:53:01.752422 (Thread-3): 16:53:01  Snowflake adapter: Snowflake query id: 01a2aeb5-0503-badd-0000-0ed503a58d22
2022-03-03 16:53:01.752600 (Thread-3): 16:53:01  Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 105 at position 12
invalid identifier 'A.L_RECEIPTDATE'
2022-03-03 16:53:01.752820 (Thread-3): 16:53:01  finished collecting timing info
2022-03-03 16:53:01.752963 (Thread-3): 16:53:01  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:53:01.804772 (Thread-333): handling poll request
2022-03-03 16:53:01.805119 (Thread-333): 16:53:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43b4d90>]}
2022-03-03 16:53:01.805903 (Thread-333): sending response (<Response 18100 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:02.005853 (Thread-3): 16:53:02  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  000904 (42000): SQL compilation error: error line 105 at position 12
  invalid identifier 'A.L_RECEIPTDATE'
  compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:53:02.006313 (Thread-3): 16:53:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80916995-b608-4d5b-a660-435e80418a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a4482730>]}
2022-03-03 16:53:02.006697 (Thread-3): 16:53:02  1 of 1 ERROR creating view model DBT_VAULT.v_stg_orders......................... [ERROR in 2.27s]
2022-03-03 16:53:02.006829 (Thread-3): 16:53:02  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:02.008369 (MainThread): 16:53:02  Acquiring new snowflake connection "master"
2022-03-03 16:53:02.008705 (MainThread): 16:53:02  
2022-03-03 16:53:02.008815 (MainThread): 16:53:02  Finished running 1 view model in 5.22s.
2022-03-03 16:53:02.008902 (MainThread): 16:53:02  Connection 'master' was properly closed.
2022-03-03 16:53:02.008973 (MainThread): 16:53:02  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 16:53:02.070597 (MainThread): 16:53:02  
2022-03-03 16:53:02.070802 (MainThread): 16:53:02  Completed with 1 error and 0 warnings:
2022-03-03 16:53:02.070895 (MainThread): 16:53:02  
2022-03-03 16:53:02.070987 (MainThread): 16:53:02  Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
2022-03-03 16:53:02.071066 (MainThread): 16:53:02    000904 (42000): SQL compilation error: error line 105 at position 12
2022-03-03 16:53:02.071136 (MainThread): 16:53:02    invalid identifier 'A.L_RECEIPTDATE'
2022-03-03 16:53:02.071225 (MainThread): 16:53:02    compiled SQL at target/run/dbtvault_snowflake_demo/models/stage/v_stg_orders.sql
2022-03-03 16:53:02.071309 (MainThread): 16:53:02  
2022-03-03 16:53:02.071399 (MainThread): 16:53:02  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 16:53:03.643975 (Thread-334): handling poll request
2022-03-03 16:53:03.644418 (Thread-334): 16:53:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43b45b0>]}
2022-03-03 16:53:03.645832 (Thread-334): sending response (<Response 23174 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:05.156905 (Thread-335): handling status request
2022-03-03 16:53:05.157267 (Thread-335): 16:53:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42ef400>]}
2022-03-03 16:53:05.160847 (Thread-335): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:05.546296 (Thread-336): handling status request
2022-03-03 16:53:05.546726 (Thread-336): 16:53:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4414340>]}
2022-03-03 16:53:05.549049 (Thread-336): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:28.934026 (Thread-337): 16:53:28  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 16:53:28.934600 (Thread-337): 16:53:28  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_orders.sql
2022-03-03 16:53:28.941353 (Thread-337): 16:53:28  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:53:28.973968 (Thread-337): 16:53:28  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:53:29.024760 (Thread-337): 16:53:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104689a00>]}
2022-03-03 16:53:30.004171 (Thread-338): handling status request
2022-03-03 16:53:30.004579 (Thread-338): 16:53:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4138fd0>]}
2022-03-03 16:53:30.005188 (Thread-338): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:30.746558 (Thread-339): handling status request
2022-03-03 16:53:30.746926 (Thread-339): 16:53:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4138700>]}
2022-03-03 16:53:30.747492 (Thread-339): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:40.148361 (Thread-340): handling status request
2022-03-03 16:53:40.148775 (Thread-340): 16:53:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4215550>]}
2022-03-03 16:53:40.149286 (Thread-340): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:40.864824 (Thread-341): handling cli_args request
2022-03-03 16:53:40.865204 (Thread-341): 16:53:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42156d0>]}
2022-03-03 16:53:41.196477 (Thread-342): handling status request
2022-03-03 16:53:41.197367 (Thread-342): 16:53:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510427a730>]}
2022-03-03 16:53:41.198262 (Thread-342): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:43.117136 (Thread-341): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:43.409665 (MainThread): 16:53:43  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:53:43.410095 (MainThread): 16:53:43  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:53:43.417658 (MainThread): 16:53:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca492be7-1d4f-4bb0-9aed-bf8ba1fd128d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba12aecd90>]}
2022-03-03 16:53:43.450815 (MainThread): 16:53:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca492be7-1d4f-4bb0-9aed-bf8ba1fd128d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba12bc2af0>]}
2022-03-03 16:53:43.451091 (MainThread): 16:53:43  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:53:43.452741 (MainThread): 16:53:43  
2022-03-03 16:53:43.453049 (MainThread): 16:53:43  Acquiring new snowflake connection "master"
2022-03-03 16:53:43.453865 (ThreadPoolExecutor-0_0): 16:53:43  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:53:43.466696 (ThreadPoolExecutor-0_0): 16:53:43  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:53:43.466803 (ThreadPoolExecutor-0_0): 16:53:43  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:53:43.466886 (ThreadPoolExecutor-0_0): 16:53:43  Opening a new connection, currently in state init
2022-03-03 16:53:44.036161 (Thread-343): handling poll request
2022-03-03 16:53:44.036561 (Thread-343): 16:53:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4215dc0>]}
2022-03-03 16:53:44.037399 (Thread-343): sending response (<Response 4157 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:44.405910 (ThreadPoolExecutor-0_0): 16:53:44  SQL status: SUCCESS 8 in 0.94 seconds
2022-03-03 16:53:44.407972 (ThreadPoolExecutor-0_0): 16:53:44  On list_DBT_RAW: Close
2022-03-03 16:53:44.655042 (ThreadPoolExecutor-2_0): 16:53:44  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:53:44.663045 (ThreadPoolExecutor-2_0): 16:53:44  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:53:44.663185 (ThreadPoolExecutor-2_0): 16:53:44  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:53:44.663287 (ThreadPoolExecutor-2_0): 16:53:44  Opening a new connection, currently in state closed
2022-03-03 16:53:45.681752 (ThreadPoolExecutor-2_0): 16:53:45  SQL status: SUCCESS 30 in 1.02 seconds
2022-03-03 16:53:45.683878 (ThreadPoolExecutor-2_0): 16:53:45  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:53:45.921428 (MainThread): 16:53:45  Concurrency: 4 threads (target='default')
2022-03-03 16:53:45.921603 (MainThread): 16:53:45  
2022-03-03 16:53:45.925972 (Thread-344): handling poll request
2022-03-03 16:53:45.926319 (Thread-344): 16:53:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41455e0>]}
2022-03-03 16:53:45.926942 (Thread-344): sending response (<Response 3459 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:45.924480 (Thread-3): 16:53:45  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:45.924842 (Thread-3): 16:53:45  1 of 1 START view model DBT_VAULT.v_stg_orders.................................. [RUN]
2022-03-03 16:53:45.925141 (Thread-3): 16:53:45  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:45.925251 (Thread-3): 16:53:45  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:45.925362 (Thread-3): 16:53:45  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:45.965123 (Thread-3): 16:53:45  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:45.965264 (Thread-3): 16:53:45  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:53:45.965354 (Thread-3): 16:53:45  Opening a new connection, currently in state closed
2022-03-03 16:53:46.659577 (Thread-3): 16:53:46  SQL status: SUCCESS 36 in 0.69 seconds
2022-03-03 16:53:46.691868 (Thread-3): 16:53:46  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:46.692033 (Thread-3): 16:53:46  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:53:46.861276 (Thread-3): 16:53:46  SQL status: SUCCESS 36 in 0.17 seconds
2022-03-03 16:53:46.910387 (Thread-3): 16:53:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:46.936887 (Thread-3): 16:53:46  finished collecting timing info
2022-03-03 16:53:46.937110 (Thread-3): 16:53:46  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:46.969463 (Thread-3): 16:53:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:47.004459 (Thread-3): 16:53:47  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:53:47.004615 (Thread-3): 16:53:47  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_orders 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(RECEIPTDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
2022-03-03 16:53:47.530154 (Thread-3): 16:53:47  SQL status: SUCCESS 1 in 0.53 seconds
2022-03-03 16:53:47.537010 (Thread-3): 16:53:47  finished collecting timing info
2022-03-03 16:53:47.537189 (Thread-3): 16:53:47  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:53:47.743796 (Thread-3): 16:53:47  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca492be7-1d4f-4bb0-9aed-bf8ba1fd128d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba106fd160>]}
2022-03-03 16:53:47.744225 (Thread-3): 16:53:47  1 of 1 OK created view model DBT_VAULT.v_stg_orders............................. [SUCCESS 1 in 1.82s]
2022-03-03 16:53:47.744348 (Thread-3): 16:53:47  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:53:47.745999 (MainThread): 16:53:47  Acquiring new snowflake connection "master"
2022-03-03 16:53:47.746328 (MainThread): 16:53:47  
2022-03-03 16:53:47.746438 (MainThread): 16:53:47  Finished running 1 view model in 4.29s.
2022-03-03 16:53:47.746523 (MainThread): 16:53:47  Connection 'master' was properly closed.
2022-03-03 16:53:47.746597 (MainThread): 16:53:47  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 16:53:47.761772 (Thread-345): handling poll request
2022-03-03 16:53:47.762140 (Thread-345): 16:53:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042a1640>]}
2022-03-03 16:53:47.763068 (Thread-345): sending response (<Response 22212 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:47.807737 (MainThread): 16:53:47  
2022-03-03 16:53:47.807958 (MainThread): 16:53:47  Completed successfully
2022-03-03 16:53:47.808062 (MainThread): 16:53:47  
2022-03-03 16:53:47.808160 (MainThread): 16:53:47  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 16:53:49.552459 (Thread-346): handling poll request
2022-03-03 16:53:49.552851 (Thread-346): 16:53:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042a1250>]}
2022-03-03 16:53:49.553875 (Thread-346): sending response (<Response 17353 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:51.463698 (Thread-347): handling status request
2022-03-03 16:53:51.464085 (Thread-347): 16:53:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042a1af0>]}
2022-03-03 16:53:51.464601 (Thread-347): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:53:51.471484 (Thread-348): handling status request
2022-03-03 16:53:51.471754 (Thread-348): 16:53:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042a1190>]}
2022-03-03 16:53:51.472170 (Thread-348): sending response (<Response 1873 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:55:20.413257 (Thread-349): 16:55:20  Unable to do partial parsing because a project config has changed
2022-03-03 16:55:20.414916 (Thread-349): 16:55:20  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43f76a0>]}
2022-03-03 16:55:20.729057 (Thread-349): 16:55:20  Parsing macros/adapters.sql
2022-03-03 16:55:20.765714 (Thread-349): 16:55:20  Parsing macros/catalog.sql
2022-03-03 16:55:20.767563 (Thread-349): 16:55:20  Parsing macros/materializations/table.sql
2022-03-03 16:55:20.770520 (Thread-349): 16:55:20  Parsing macros/materializations/seed.sql
2022-03-03 16:55:20.775400 (Thread-349): 16:55:20  Parsing macros/materializations/incremental.sql
2022-03-03 16:55:20.783683 (Thread-349): 16:55:20  Parsing macros/materializations/merge.sql
2022-03-03 16:55:20.787497 (Thread-349): 16:55:20  Parsing macros/materializations/snapshot.sql
2022-03-03 16:55:20.788424 (Thread-349): 16:55:20  Parsing macros/materializations/view.sql
2022-03-03 16:55:20.789769 (Thread-349): 16:55:20  Parsing macros/adapters/metadata.sql
2022-03-03 16:55:20.796697 (Thread-349): 16:55:20  Parsing macros/adapters/columns.sql
2022-03-03 16:55:20.806080 (Thread-349): 16:55:20  Parsing macros/adapters/freshness.sql
2022-03-03 16:55:20.808886 (Thread-349): 16:55:20  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:55:20.813082 (Thread-349): 16:55:20  Parsing macros/adapters/relation.sql
2022-03-03 16:55:20.827333 (Thread-349): 16:55:20  Parsing macros/adapters/schema.sql
2022-03-03 16:55:20.830688 (Thread-349): 16:55:20  Parsing macros/adapters/indexes.sql
2022-03-03 16:55:20.835091 (Thread-349): 16:55:20  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:55:20.838959 (Thread-349): 16:55:20  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:55:20.841292 (Thread-349): 16:55:20  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:55:20.843518 (Thread-349): 16:55:20  Parsing macros/etc/datetime.sql
2022-03-03 16:55:20.852041 (Thread-349): 16:55:20  Parsing macros/etc/statement.sql
2022-03-03 16:55:20.856398 (Thread-349): 16:55:20  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:55:20.857137 (Thread-349): 16:55:20  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:55:20.857704 (Thread-349): 16:55:20  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:55:20.859060 (Thread-349): 16:55:20  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:55:20.859918 (Thread-349): 16:55:20  Parsing macros/materializations/configs.sql
2022-03-03 16:55:20.862185 (Thread-349): 16:55:20  Parsing macros/materializations/hooks.sql
2022-03-03 16:55:20.865890 (Thread-349): 16:55:20  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:55:20.873121 (Thread-349): 16:55:20  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:55:20.875962 (Thread-349): 16:55:20  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:55:20.878608 (Thread-349): 16:55:20  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:55:20.879942 (Thread-349): 16:55:20  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:55:20.882492 (Thread-349): 16:55:20  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:55:20.889511 (Thread-349): 16:55:20  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:55:20.899593 (Thread-349): 16:55:20  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:55:20.914173 (Thread-349): 16:55:20  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:55:20.915607 (Thread-349): 16:55:20  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:55:20.926532 (Thread-349): 16:55:20  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:55:20.930937 (Thread-349): 16:55:20  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:55:20.946867 (Thread-349): 16:55:20  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:55:20.952962 (Thread-349): 16:55:20  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:55:20.954775 (Thread-349): 16:55:20  Parsing macros/materializations/tests/test.sql
2022-03-03 16:55:20.959223 (Thread-349): 16:55:20  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:55:20.961282 (Thread-349): 16:55:20  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:55:20.973162 (Thread-349): 16:55:20  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:55:20.990322 (Thread-349): 16:55:20  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:55:20.992050 (Thread-349): 16:55:20  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:55:21.003317 (Thread-349): 16:55:21  Parsing tests/generic/builtin.sql
2022-03-03 16:55:21.006903 (Thread-349): 16:55:21  Parsing macros/sql/pivot.sql
2022-03-03 16:55:21.011050 (Thread-349): 16:55:21  Parsing macros/sql/star.sql
2022-03-03 16:55:21.015440 (Thread-349): 16:55:21  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:55:21.016911 (Thread-349): 16:55:21  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:55:21.020392 (Thread-349): 16:55:21  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:55:21.022709 (Thread-349): 16:55:21  Parsing macros/sql/date_spine.sql
2022-03-03 16:55:21.027108 (Thread-349): 16:55:21  Parsing macros/sql/get_column_values.sql
2022-03-03 16:55:21.032007 (Thread-349): 16:55:21  Parsing macros/sql/groupby.sql
2022-03-03 16:55:21.033483 (Thread-349): 16:55:21  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:55:21.040264 (Thread-349): 16:55:21  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:55:21.041924 (Thread-349): 16:55:21  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:55:21.043566 (Thread-349): 16:55:21  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:55:21.046892 (Thread-349): 16:55:21  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:55:21.050243 (Thread-349): 16:55:21  Parsing macros/sql/safe_add.sql
2022-03-03 16:55:21.051859 (Thread-349): 16:55:21  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:55:21.057861 (Thread-349): 16:55:21  Parsing macros/sql/unpivot.sql
2022-03-03 16:55:21.065319 (Thread-349): 16:55:21  Parsing macros/sql/generate_series.sql
2022-03-03 16:55:21.069487 (Thread-349): 16:55:21  Parsing macros/sql/nullcheck.sql
2022-03-03 16:55:21.071115 (Thread-349): 16:55:21  Parsing macros/sql/union.sql
2022-03-03 16:55:21.080990 (Thread-349): 16:55:21  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:55:21.103709 (Thread-349): 16:55:21  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:55:21.104965 (Thread-349): 16:55:21  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:55:21.106260 (Thread-349): 16:55:21  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:55:21.107509 (Thread-349): 16:55:21  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:55:21.108661 (Thread-349): 16:55:21  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:55:21.110215 (Thread-349): 16:55:21  Parsing macros/web/get_url_path.sql
2022-03-03 16:55:21.112714 (Thread-349): 16:55:21  Parsing macros/web/get_url_host.sql
2022-03-03 16:55:21.114617 (Thread-349): 16:55:21  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:55:21.116395 (Thread-349): 16:55:21  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:55:21.117669 (Thread-349): 16:55:21  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:55:21.120711 (Thread-349): 16:55:21  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:55:21.122823 (Thread-349): 16:55:21  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:55:21.124061 (Thread-349): 16:55:21  Parsing macros/schema_tests/equality.sql
2022-03-03 16:55:21.127602 (Thread-349): 16:55:21  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:55:21.129062 (Thread-349): 16:55:21  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:55:21.130683 (Thread-349): 16:55:21  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:55:21.132767 (Thread-349): 16:55:21  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:55:21.141518 (Thread-349): 16:55:21  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:55:21.149797 (Thread-349): 16:55:21  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:55:21.159916 (Thread-349): 16:55:21  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:55:21.162268 (Thread-349): 16:55:21  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:55:21.163884 (Thread-349): 16:55:21  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:55:21.166646 (Thread-349): 16:55:21  Parsing macros/schema_tests/recency.sql
2022-03-03 16:55:21.168365 (Thread-349): 16:55:21  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:55:21.170307 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:55:21.172092 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:55:21.173947 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:55:21.175390 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:55:21.178711 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:55:21.180941 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:55:21.182349 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:55:21.183632 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:55:21.184904 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:55:21.186481 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:55:21.188022 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:55:21.189068 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:55:21.190190 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:55:21.191808 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:55:21.201412 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:55:21.204107 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:55:21.211036 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:55:21.213302 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:55:21.214366 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:55:21.216324 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:55:21.221645 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:55:21.223152 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:55:21.224250 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:55:21.226393 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:55:21.229887 (Thread-349): 16:55:21  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:55:21.230958 (Thread-349): 16:55:21  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:55:21.236136 (Thread-349): 16:55:21  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:55:21.241597 (Thread-349): 16:55:21  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:55:21.265618 (Thread-349): 16:55:21  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:55:21.289980 (Thread-349): 16:55:21  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:55:21.293539 (Thread-349): 16:55:21  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:55:21.302813 (Thread-349): 16:55:21  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:55:21.306580 (Thread-349): 16:55:21  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:55:21.309358 (Thread-349): 16:55:21  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:55:21.328562 (Thread-349): 16:55:21  Parsing macros/staging/hash_columns.sql
2022-03-03 16:55:21.333691 (Thread-349): 16:55:21  Parsing macros/staging/stage.sql
2022-03-03 16:55:21.346828 (Thread-349): 16:55:21  Parsing macros/staging/rank_columns.sql
2022-03-03 16:55:21.357181 (Thread-349): 16:55:21  Parsing macros/staging/derive_columns.sql
2022-03-03 16:55:21.363258 (Thread-349): 16:55:21  Parsing macros/staging/source_columns.sql
2022-03-03 16:55:21.364610 (Thread-349): 16:55:21  Parsing macros/internal/alias_all.sql
2022-03-03 16:55:21.367086 (Thread-349): 16:55:21  Parsing macros/internal/alias.sql
2022-03-03 16:55:21.370610 (Thread-349): 16:55:21  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:55:21.371051 (Thread-349): 16:55:21  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:55:21.380448 (Thread-349): 16:55:21  Parsing macros/internal/multikey.sql
2022-03-03 16:55:21.385857 (Thread-349): 16:55:21  Parsing macros/internal/is_checks.sql
2022-03-03 16:55:21.389008 (Thread-349): 16:55:21  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:55:21.392352 (Thread-349): 16:55:21  Parsing macros/internal/as_constant.sql
2022-03-03 16:55:21.394593 (Thread-349): 16:55:21  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:55:21.396260 (Thread-349): 16:55:21  Parsing macros/tables/link.sql
2022-03-03 16:55:21.411227 (Thread-349): 16:55:21  Parsing macros/tables/sat.sql
2022-03-03 16:55:21.421132 (Thread-349): 16:55:21  Parsing macros/tables/eff_sat.sql
2022-03-03 16:55:21.434510 (Thread-349): 16:55:21  Parsing macros/tables/xts.sql
2022-03-03 16:55:21.447611 (Thread-349): 16:55:21  Parsing macros/tables/hub.sql
2022-03-03 16:55:21.466415 (Thread-349): 16:55:21  Parsing macros/tables/ma_sat.sql
2022-03-03 16:55:21.480108 (Thread-349): 16:55:21  Parsing macros/tables/pit.sql
2022-03-03 16:55:21.504620 (Thread-349): 16:55:21  Parsing macros/tables/bridge.sql
2022-03-03 16:55:21.548277 (Thread-349): 16:55:21  Parsing macros/tables/t_link.sql
2022-03-03 16:55:21.555028 (Thread-349): 16:55:21  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:55:21.556475 (Thread-349): 16:55:21  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:55:21.558915 (Thread-349): 16:55:21  Parsing macros/supporting/prefix.sql
2022-03-03 16:55:21.565102 (Thread-349): 16:55:21  Parsing macros/supporting/hash.sql
2022-03-03 16:55:21.572969 (Thread-349): 16:55:21  Parsing macros/supporting/datatypes.sql
2022-03-03 16:55:22.080296 (Thread-350): handling status request
2022-03-03 16:55:22.090881 (Thread-350): 16:55:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47de820>]}
2022-03-03 16:55:22.096623 (Thread-350): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:55:22.162248 (Thread-349): 16:55:22  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:55:22.186552 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:55:22.189731 (Thread-349): 16:55:22  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:55:22.199791 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:55:22.205447 (Thread-349): 16:55:22  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:55:22.235844 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:55:22.237325 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:55:22.244737 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:55:22.245959 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:55:22.254655 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:55:22.255855 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:55:22.264277 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:55:22.265474 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:55:22.271717 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:55:22.272889 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:55:22.279952 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:55:22.281107 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:55:22.289210 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:55:22.290339 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:55:22.296598 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:55:22.297756 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:55:22.305860 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:55:22.307002 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:55:22.313746 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:55:22.314863 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:55:22.322423 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:55:22.323541 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:55:22.330174 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:55:22.331291 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:55:22.338037 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:55:22.339158 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:55:22.345653 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:55:22.346793 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:55:22.354967 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:55:22.356163 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:55:22.363607 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:55:22.364796 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:55:22.374138 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:55:22.375316 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:55:22.384082 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:55:22.385291 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:55:22.398125 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:55:22.399284 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:55:22.409028 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:55:22.410199 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:55:22.419049 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:55:22.420202 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:55:22.429135 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:55:22.430302 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:55:22.441927 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:55:22.443094 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:55:22.454145 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:55:22.455343 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:55:22.466164 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:55:22.467340 (Thread-349): 16:55:22  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:55:22.477313 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:55:22.478494 (Thread-349): 16:55:22  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:55:22.482246 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:55:22.483758 (Thread-349): 16:55:22  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:55:22.490172 (Thread-349): 16:55:22  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:55:22.491828 (Thread-349): 16:55:22  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:55:22.591042 (Thread-349): 16:55:22  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47de5e0>]}
2022-03-03 16:55:22.749247 (Thread-351): handling status request
2022-03-03 16:55:22.749622 (Thread-351): 16:55:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e478b2b0>]}
2022-03-03 16:55:22.751862 (Thread-351): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:55:25.033932 (Thread-352): handling status request
2022-03-03 16:55:25.034421 (Thread-352): 16:55:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e477c130>]}
2022-03-03 16:55:25.036560 (Thread-352): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:56:31.883253 (MainThread): 16:56:31  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc16abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5210f235e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fc197160>]}
2022-03-03 16:56:31.883590 (MainThread): 16:56:31  Flushing usage events
2022-03-03 16:56:31.928057 (MainThread): Runtime Error
  at path []: Additional properties are not allowed ('hash' was unexpected)

Error encountered in /usr/src/develop/user-59625/environment-68995/repository-56256/dbt_project.yml
2022-03-03 16:57:59.050656 (MainThread): Running with dbt=1.0.3
2022-03-03 16:57:59.080914 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-03-03 16:57:59.082186 (MainThread): Tracking: tracking
2022-03-03 16:57:59.082362 (MainThread): 16:57:59  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042be9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47a97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47a9610>]}
2022-03-03 16:57:59.082610 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-03-03 16:57:59.082797 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-03-03 16:57:59.082914 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-03-03 16:57:59.142252 (Thread-353): 16:57:59  Unable to do partial parsing because a project config has changed
2022-03-03 16:57:59.142580 (Thread-353): 16:57:59  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510468fb20>]}
2022-03-03 16:57:59.429993 (Thread-353): 16:57:59  Parsing macros/adapters.sql
2022-03-03 16:57:59.466801 (Thread-353): 16:57:59  Parsing macros/catalog.sql
2022-03-03 16:57:59.468628 (Thread-353): 16:57:59  Parsing macros/materializations/table.sql
2022-03-03 16:57:59.471582 (Thread-353): 16:57:59  Parsing macros/materializations/seed.sql
2022-03-03 16:57:59.476546 (Thread-353): 16:57:59  Parsing macros/materializations/incremental.sql
2022-03-03 16:57:59.484873 (Thread-353): 16:57:59  Parsing macros/materializations/merge.sql
2022-03-03 16:57:59.488512 (Thread-353): 16:57:59  Parsing macros/materializations/snapshot.sql
2022-03-03 16:57:59.489446 (Thread-353): 16:57:59  Parsing macros/materializations/view.sql
2022-03-03 16:57:59.490754 (Thread-353): 16:57:59  Parsing macros/adapters/metadata.sql
2022-03-03 16:57:59.497596 (Thread-353): 16:57:59  Parsing macros/adapters/columns.sql
2022-03-03 16:57:59.507156 (Thread-353): 16:57:59  Parsing macros/adapters/freshness.sql
2022-03-03 16:57:59.509988 (Thread-353): 16:57:59  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:57:59.514250 (Thread-353): 16:57:59  Parsing macros/adapters/relation.sql
2022-03-03 16:57:59.523646 (Thread-353): 16:57:59  Parsing macros/adapters/schema.sql
2022-03-03 16:57:59.525821 (Thread-353): 16:57:59  Parsing macros/adapters/indexes.sql
2022-03-03 16:57:59.528501 (Thread-353): 16:57:59  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:57:59.530975 (Thread-353): 16:57:59  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:57:59.532418 (Thread-353): 16:57:59  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:57:59.533963 (Thread-353): 16:57:59  Parsing macros/etc/datetime.sql
2022-03-03 16:57:59.542102 (Thread-353): 16:57:59  Parsing macros/etc/statement.sql
2022-03-03 16:57:59.546332 (Thread-353): 16:57:59  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:57:59.547042 (Thread-353): 16:57:59  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:57:59.547577 (Thread-353): 16:57:59  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:57:59.548908 (Thread-353): 16:57:59  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:57:59.549749 (Thread-353): 16:57:59  Parsing macros/materializations/configs.sql
2022-03-03 16:57:59.551962 (Thread-353): 16:57:59  Parsing macros/materializations/hooks.sql
2022-03-03 16:57:59.555640 (Thread-353): 16:57:59  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:57:59.563101 (Thread-353): 16:57:59  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:57:59.565954 (Thread-353): 16:57:59  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:57:59.568504 (Thread-353): 16:57:59  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:57:59.569788 (Thread-353): 16:57:59  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:57:59.571995 (Thread-353): 16:57:59  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:57:59.578762 (Thread-353): 16:57:59  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:57:59.588169 (Thread-353): 16:57:59  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:57:59.602831 (Thread-353): 16:57:59  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:57:59.604899 (Thread-353): 16:57:59  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:57:59.616814 (Thread-353): 16:57:59  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:57:59.621669 (Thread-353): 16:57:59  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:57:59.638830 (Thread-353): 16:57:59  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:57:59.645531 (Thread-353): 16:57:59  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:57:59.647303 (Thread-353): 16:57:59  Parsing macros/materializations/tests/test.sql
2022-03-03 16:57:59.651533 (Thread-353): 16:57:59  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:57:59.653313 (Thread-353): 16:57:59  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:57:59.671990 (Thread-353): 16:57:59  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:57:59.692037 (Thread-353): 16:57:59  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:57:59.693676 (Thread-353): 16:57:59  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:57:59.704671 (Thread-353): 16:57:59  Parsing tests/generic/builtin.sql
2022-03-03 16:57:59.707599 (Thread-353): 16:57:59  Parsing macros/sql/pivot.sql
2022-03-03 16:57:59.711517 (Thread-353): 16:57:59  Parsing macros/sql/star.sql
2022-03-03 16:57:59.715572 (Thread-353): 16:57:59  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:57:59.716843 (Thread-353): 16:57:59  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:57:59.720120 (Thread-353): 16:57:59  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:57:59.722383 (Thread-353): 16:57:59  Parsing macros/sql/date_spine.sql
2022-03-03 16:57:59.726532 (Thread-353): 16:57:59  Parsing macros/sql/get_column_values.sql
2022-03-03 16:57:59.731649 (Thread-353): 16:57:59  Parsing macros/sql/groupby.sql
2022-03-03 16:57:59.732994 (Thread-353): 16:57:59  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:57:59.739216 (Thread-353): 16:57:59  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:57:59.740873 (Thread-353): 16:57:59  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:57:59.742568 (Thread-353): 16:57:59  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:57:59.745944 (Thread-353): 16:57:59  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:57:59.749248 (Thread-353): 16:57:59  Parsing macros/sql/safe_add.sql
2022-03-03 16:57:59.750867 (Thread-353): 16:57:59  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:57:59.757350 (Thread-353): 16:57:59  Parsing macros/sql/unpivot.sql
2022-03-03 16:57:59.764767 (Thread-353): 16:57:59  Parsing macros/sql/generate_series.sql
2022-03-03 16:57:59.768929 (Thread-353): 16:57:59  Parsing macros/sql/nullcheck.sql
2022-03-03 16:57:59.770597 (Thread-353): 16:57:59  Parsing macros/sql/union.sql
2022-03-03 16:57:59.780100 (Thread-353): 16:57:59  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:57:59.803335 (Thread-353): 16:57:59  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:57:59.804669 (Thread-353): 16:57:59  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:57:59.805858 (Thread-353): 16:57:59  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:57:59.806970 (Thread-353): 16:57:59  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:57:59.808059 (Thread-353): 16:57:59  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:57:59.809614 (Thread-353): 16:57:59  Parsing macros/web/get_url_path.sql
2022-03-03 16:57:59.812026 (Thread-353): 16:57:59  Parsing macros/web/get_url_host.sql
2022-03-03 16:57:59.813907 (Thread-353): 16:57:59  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:57:59.815639 (Thread-353): 16:57:59  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:57:59.816889 (Thread-353): 16:57:59  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:57:59.819761 (Thread-353): 16:57:59  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:57:59.821883 (Thread-353): 16:57:59  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:57:59.823106 (Thread-353): 16:57:59  Parsing macros/schema_tests/equality.sql
2022-03-03 16:57:59.826682 (Thread-353): 16:57:59  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:57:59.828080 (Thread-353): 16:57:59  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:57:59.829693 (Thread-353): 16:57:59  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:57:59.831718 (Thread-353): 16:57:59  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:57:59.833143 (Thread-353): 16:57:59  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:57:59.841776 (Thread-353): 16:57:59  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:57:59.843868 (Thread-353): 16:57:59  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:57:59.846212 (Thread-353): 16:57:59  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:57:59.847823 (Thread-353): 16:57:59  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:57:59.850573 (Thread-353): 16:57:59  Parsing macros/schema_tests/recency.sql
2022-03-03 16:57:59.852288 (Thread-353): 16:57:59  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:57:59.854290 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:57:59.856055 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:57:59.857898 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:57:59.859328 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:57:59.862648 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:57:59.864932 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:57:59.866323 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:57:59.867582 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:57:59.868866 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:57:59.870411 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:57:59.871928 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:57:59.872949 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:57:59.874042 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:57:59.875633 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:57:59.885402 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:57:59.888127 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:57:59.894092 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:57:59.895585 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:57:59.896528 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:57:59.898392 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:57:59.903263 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:57:59.904711 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:57:59.905748 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:57:59.907811 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:57:59.918047 (Thread-353): 16:57:59  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:57:59.924940 (Thread-353): 16:57:59  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:57:59.930151 (Thread-353): 16:57:59  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:57:59.938871 (Thread-353): 16:57:59  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:57:59.960369 (Thread-353): 16:57:59  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:57:59.977502 (Thread-353): 16:57:59  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:57:59.980177 (Thread-353): 16:57:59  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:57:59.986663 (Thread-353): 16:57:59  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:57:59.989371 (Thread-353): 16:57:59  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:57:59.991370 (Thread-353): 16:57:59  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:58:00.005207 (Thread-353): 16:58:00  Parsing macros/staging/hash_columns.sql
2022-03-03 16:58:00.008953 (Thread-353): 16:58:00  Parsing macros/staging/stage.sql
2022-03-03 16:58:00.019324 (Thread-353): 16:58:00  Parsing macros/staging/rank_columns.sql
2022-03-03 16:58:00.027704 (Thread-353): 16:58:00  Parsing macros/staging/derive_columns.sql
2022-03-03 16:58:00.033294 (Thread-353): 16:58:00  Parsing macros/staging/source_columns.sql
2022-03-03 16:58:00.034531 (Thread-353): 16:58:00  Parsing macros/internal/alias_all.sql
2022-03-03 16:58:00.036869 (Thread-353): 16:58:00  Parsing macros/internal/alias.sql
2022-03-03 16:58:00.040165 (Thread-353): 16:58:00  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:58:00.040561 (Thread-353): 16:58:00  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:58:00.049466 (Thread-353): 16:58:00  Parsing macros/internal/multikey.sql
2022-03-03 16:58:00.054792 (Thread-353): 16:58:00  Parsing macros/internal/is_checks.sql
2022-03-03 16:58:00.064508 (Thread-353): 16:58:00  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:58:00.067702 (Thread-353): 16:58:00  Parsing macros/internal/as_constant.sql
2022-03-03 16:58:00.075954 (Thread-353): 16:58:00  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:58:00.086137 (Thread-353): 16:58:00  Parsing macros/tables/link.sql
2022-03-03 16:58:00.099149 (Thread-353): 16:58:00  Parsing macros/tables/sat.sql
2022-03-03 16:58:00.110351 (Thread-353): 16:58:00  Parsing macros/tables/eff_sat.sql
2022-03-03 16:58:00.124247 (Thread-353): 16:58:00  Parsing macros/tables/xts.sql
2022-03-03 16:58:00.131922 (Thread-353): 16:58:00  Parsing macros/tables/hub.sql
2022-03-03 16:58:00.143957 (Thread-353): 16:58:00  Parsing macros/tables/ma_sat.sql
2022-03-03 16:58:00.156538 (Thread-353): 16:58:00  Parsing macros/tables/pit.sql
2022-03-03 16:58:00.176453 (Thread-353): 16:58:00  Parsing macros/tables/bridge.sql
2022-03-03 16:58:00.212059 (Thread-353): 16:58:00  Parsing macros/tables/t_link.sql
2022-03-03 16:58:00.217837 (Thread-353): 16:58:00  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:58:00.218899 (Thread-353): 16:58:00  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:58:00.220617 (Thread-353): 16:58:00  Parsing macros/supporting/prefix.sql
2022-03-03 16:58:00.226026 (Thread-353): 16:58:00  Parsing macros/supporting/hash.sql
2022-03-03 16:58:00.232930 (Thread-353): 16:58:00  Parsing macros/supporting/datatypes.sql
2022-03-03 16:58:00.770810 (Thread-353): 16:58:00  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:58:00.792652 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:58:00.793982 (Thread-353): 16:58:00  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:58:00.803803 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:58:00.805036 (Thread-353): 16:58:00  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:58:00.838327 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:58:00.840092 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:58:00.849340 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:58:00.851045 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:58:00.862232 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:58:00.863812 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:58:00.873199 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:58:00.874359 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:58:00.883462 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:58:00.884891 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:58:00.893059 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:58:00.894554 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:58:00.905057 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:58:00.906611 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:58:00.913310 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:58:00.914481 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:58:00.923384 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:58:00.924558 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:58:00.931196 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:58:00.932356 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:58:00.939272 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:58:00.940448 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:58:00.947185 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:58:00.948348 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:58:00.955283 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:58:00.956468 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:58:00.964156 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:58:00.965337 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:58:00.973301 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:58:00.974474 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:58:00.981059 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:58:00.982249 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:58:00.991394 (Thread-353): 16:58:00  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:58:00.992574 (Thread-353): 16:58:00  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:58:01.002380 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:58:01.003659 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:58:01.014988 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:58:01.016296 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:58:01.026058 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:58:01.027336 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:58:01.036130 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:58:01.037389 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:58:01.046823 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:58:01.048012 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:58:01.058320 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:58:01.059524 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:58:01.070202 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:58:01.071478 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:58:01.083431 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:58:01.084698 (Thread-353): 16:58:01  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:58:01.093493 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:58:01.095126 (Thread-353): 16:58:01  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:58:01.099008 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:58:01.100537 (Thread-353): 16:58:01  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:58:01.107091 (Thread-353): 16:58:01  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:58:01.108910 (Thread-353): 16:58:01  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:58:01.361845 (Thread-354): handling status request
2022-03-03 16:58:01.372841 (Thread-354): 16:58:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e457c1c0>]}
2022-03-03 16:58:01.373285 (Thread-354): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:01.416874 (Thread-353): 16:58:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47b8eb0>]}
2022-03-03 16:58:02.389488 (Thread-355): handling status request
2022-03-03 16:58:02.389825 (Thread-355): 16:58:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47b8ac0>]}
2022-03-03 16:58:02.392144 (Thread-355): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:06.599604 (Thread-356): handling status request
2022-03-03 16:58:06.599941 (Thread-356): 16:58:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4141340>]}
2022-03-03 16:58:06.602163 (Thread-356): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:33.427839 (Thread-357): handling status request
2022-03-03 16:58:33.428198 (Thread-357): 16:58:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e40b3af0>]}
2022-03-03 16:58:33.430559 (Thread-357): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:34.224420 (Thread-358): handling status request
2022-03-03 16:58:34.225202 (Thread-359): handling cli_args request
2022-03-03 16:58:34.225570 (Thread-358): 16:58:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e40b3c40>]}
2022-03-03 16:58:34.225821 (Thread-359): 16:58:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e407fc70>]}
2022-03-03 16:58:34.228132 (Thread-358): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:36.509116 (Thread-359): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:36.805076 (MainThread): 16:58:36  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:58:36.805529 (MainThread): 16:58:36  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:58:36.813716 (MainThread): 16:58:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d796139-0f4d-472b-917b-c5c692edf33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f94301ca0>]}
2022-03-03 16:58:36.848731 (MainThread): 16:58:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d796139-0f4d-472b-917b-c5c692edf33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f94c60c10>]}
2022-03-03 16:58:36.849062 (MainThread): 16:58:36  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:58:36.850843 (MainThread): 16:58:36  
2022-03-03 16:58:36.851199 (MainThread): 16:58:36  Acquiring new snowflake connection "master"
2022-03-03 16:58:36.852114 (ThreadPoolExecutor-0_0): 16:58:36  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:58:36.866365 (ThreadPoolExecutor-0_0): 16:58:36  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:58:36.866509 (ThreadPoolExecutor-0_0): 16:58:36  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:58:36.866600 (ThreadPoolExecutor-0_0): 16:58:36  Opening a new connection, currently in state init
2022-03-03 16:58:37.281070 (Thread-360): handling poll request
2022-03-03 16:58:37.281515 (Thread-360): 16:58:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e40821f0>]}
2022-03-03 16:58:37.282512 (Thread-360): sending response (<Response 4158 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:38.910539 (ThreadPoolExecutor-0_0): 16:58:38  SQL status: SUCCESS 8 in 2.04 seconds
2022-03-03 16:58:38.912650 (ThreadPoolExecutor-0_0): 16:58:38  On list_DBT_RAW: Close
2022-03-03 16:58:39.137399 (ThreadPoolExecutor-2_0): 16:58:39  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:58:39.145594 (ThreadPoolExecutor-2_0): 16:58:39  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:58:39.145750 (ThreadPoolExecutor-2_0): 16:58:39  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:58:39.145854 (ThreadPoolExecutor-2_0): 16:58:39  Opening a new connection, currently in state closed
2022-03-03 16:58:40.052523 (ThreadPoolExecutor-2_0): 16:58:40  SQL status: SUCCESS 31 in 0.91 seconds
2022-03-03 16:58:40.054684 (ThreadPoolExecutor-2_0): 16:58:40  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:58:40.094770 (Thread-361): handling poll request
2022-03-03 16:58:40.095105 (Thread-361): 16:58:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e40ad040>]}
2022-03-03 16:58:40.095706 (Thread-361): sending response (<Response 2894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:40.256383 (MainThread): 16:58:40  Concurrency: 4 threads (target='default')
2022-03-03 16:58:40.256561 (MainThread): 16:58:40  
2022-03-03 16:58:40.259427 (Thread-3): 16:58:40  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:58:40.259749 (Thread-3): 16:58:40  1 of 1 START view model DBT_VAULT.v_stg_orders.................................. [RUN]
2022-03-03 16:58:40.260030 (Thread-3): 16:58:40  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:58:40.260139 (Thread-3): 16:58:40  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:58:40.260251 (Thread-3): 16:58:40  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:58:40.300013 (Thread-3): 16:58:40  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:58:40.300164 (Thread-3): 16:58:40  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:58:40.300256 (Thread-3): 16:58:40  Opening a new connection, currently in state closed
2022-03-03 16:58:41.289251 (Thread-3): 16:58:41  SQL status: SUCCESS 36 in 0.99 seconds
2022-03-03 16:58:41.322402 (Thread-3): 16:58:41  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:58:41.322566 (Thread-3): 16:58:41  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:58:41.545972 (Thread-3): 16:58:41  SQL status: SUCCESS 36 in 0.22 seconds
2022-03-03 16:58:41.596111 (Thread-3): 16:58:41  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:58:41.618967 (Thread-3): 16:58:41  finished collecting timing info
2022-03-03 16:58:41.619190 (Thread-3): 16:58:41  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:58:41.644959 (Thread-3): 16:58:41  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:58:41.680548 (Thread-3): 16:58:41  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:58:41.680774 (Thread-3): 16:58:41  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_orders 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(RECEIPTDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINK_CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS CUSTOMER_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS NATION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(16)) AS REGION_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS NATION_REGION_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS ORDER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS ORDER_CUSTOMER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS LINEITEM_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS LINK_LINEITEM_ORDER_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(16)) AS PART_PK,
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(16)) AS SUPPLIER_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS INVENTORY_PK,
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS INVENTORY_ALLOCATION_PK,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS LINEITEM_HASHDIFF,
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
2022-03-03 16:58:41.841873 (Thread-362): handling poll request
2022-03-03 16:58:41.842224 (Thread-362): 16:58:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42d0c70>]}
2022-03-03 16:58:41.843094 (Thread-362): sending response (<Response 18805 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:42.523714 (Thread-3): 16:58:42  SQL status: SUCCESS 1 in 0.84 seconds
2022-03-03 16:58:42.530902 (Thread-3): 16:58:42  finished collecting timing info
2022-03-03 16:58:42.531085 (Thread-3): 16:58:42  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:58:42.755437 (Thread-3): 16:58:42  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d796139-0f4d-472b-917b-c5c692edf33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f8c786730>]}
2022-03-03 16:58:42.755885 (Thread-3): 16:58:42  1 of 1 OK created view model DBT_VAULT.v_stg_orders............................. [SUCCESS 1 in 2.50s]
2022-03-03 16:58:42.756016 (Thread-3): 16:58:42  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:58:42.757715 (MainThread): 16:58:42  Acquiring new snowflake connection "master"
2022-03-03 16:58:42.758041 (MainThread): 16:58:42  
2022-03-03 16:58:42.758152 (MainThread): 16:58:42  Finished running 1 view model in 5.91s.
2022-03-03 16:58:42.758241 (MainThread): 16:58:42  Connection 'master' was properly closed.
2022-03-03 16:58:42.758315 (MainThread): 16:58:42  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 16:58:42.824713 (MainThread): 16:58:42  
2022-03-03 16:58:42.824938 (MainThread): 16:58:42  Completed successfully
2022-03-03 16:58:42.825042 (MainThread): 16:58:42  
2022-03-03 16:58:42.825139 (MainThread): 16:58:42  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 16:58:43.702476 (Thread-363): handling poll request
2022-03-03 16:58:43.702825 (Thread-363): 16:58:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4044460>]}
2022-03-03 16:58:43.703980 (Thread-363): sending response (<Response 21337 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:45.346797 (Thread-364): handling status request
2022-03-03 16:58:45.347148 (Thread-364): 16:58:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4044910>]}
2022-03-03 16:58:45.350564 (Thread-364): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:58:45.629054 (Thread-365): handling status request
2022-03-03 16:58:45.629396 (Thread-365): 16:58:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42d0490>]}
2022-03-03 16:58:45.631901 (Thread-365): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:20.645265 (Thread-366): 16:59:20  Unable to do partial parsing because a project config has changed
2022-03-03 16:59:20.645590 (Thread-366): 16:59:20  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4da1be0>]}
2022-03-03 16:59:20.869677 (Thread-366): 16:59:20  Parsing macros/adapters.sql
2022-03-03 16:59:20.921001 (Thread-366): 16:59:20  Parsing macros/catalog.sql
2022-03-03 16:59:20.923380 (Thread-366): 16:59:20  Parsing macros/materializations/table.sql
2022-03-03 16:59:20.927803 (Thread-366): 16:59:20  Parsing macros/materializations/seed.sql
2022-03-03 16:59:20.935090 (Thread-366): 16:59:20  Parsing macros/materializations/incremental.sql
2022-03-03 16:59:20.946673 (Thread-366): 16:59:20  Parsing macros/materializations/merge.sql
2022-03-03 16:59:20.950545 (Thread-366): 16:59:20  Parsing macros/materializations/snapshot.sql
2022-03-03 16:59:20.951534 (Thread-366): 16:59:20  Parsing macros/materializations/view.sql
2022-03-03 16:59:20.953291 (Thread-366): 16:59:20  Parsing macros/adapters/metadata.sql
2022-03-03 16:59:20.964470 (Thread-366): 16:59:20  Parsing macros/adapters/columns.sql
2022-03-03 16:59:20.974365 (Thread-366): 16:59:20  Parsing macros/adapters/freshness.sql
2022-03-03 16:59:20.977306 (Thread-366): 16:59:20  Parsing macros/adapters/persist_docs.sql
2022-03-03 16:59:20.981572 (Thread-366): 16:59:20  Parsing macros/adapters/relation.sql
2022-03-03 16:59:20.991212 (Thread-366): 16:59:20  Parsing macros/adapters/schema.sql
2022-03-03 16:59:20.993453 (Thread-366): 16:59:20  Parsing macros/adapters/indexes.sql
2022-03-03 16:59:20.996163 (Thread-366): 16:59:20  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 16:59:20.998722 (Thread-366): 16:59:20  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 16:59:21.000226 (Thread-366): 16:59:21  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 16:59:21.001818 (Thread-366): 16:59:21  Parsing macros/etc/datetime.sql
2022-03-03 16:59:21.010233 (Thread-366): 16:59:21  Parsing macros/etc/statement.sql
2022-03-03 16:59:21.014725 (Thread-366): 16:59:21  Parsing macros/generic_test_sql/unique.sql
2022-03-03 16:59:21.015427 (Thread-366): 16:59:21  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 16:59:21.015956 (Thread-366): 16:59:21  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 16:59:21.017315 (Thread-366): 16:59:21  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 16:59:21.018155 (Thread-366): 16:59:21  Parsing macros/materializations/configs.sql
2022-03-03 16:59:21.020368 (Thread-366): 16:59:21  Parsing macros/materializations/hooks.sql
2022-03-03 16:59:21.024076 (Thread-366): 16:59:21  Parsing macros/materializations/models/table/table.sql
2022-03-03 16:59:21.031263 (Thread-366): 16:59:21  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 16:59:21.034067 (Thread-366): 16:59:21  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 16:59:21.036648 (Thread-366): 16:59:21  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 16:59:21.037921 (Thread-366): 16:59:21  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 16:59:21.040118 (Thread-366): 16:59:21  Parsing macros/materializations/models/view/view.sql
2022-03-03 16:59:21.046851 (Thread-366): 16:59:21  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 16:59:21.056349 (Thread-366): 16:59:21  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 16:59:21.071846 (Thread-366): 16:59:21  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 16:59:21.073337 (Thread-366): 16:59:21  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 16:59:21.084188 (Thread-366): 16:59:21  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 16:59:21.088469 (Thread-366): 16:59:21  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 16:59:21.104236 (Thread-366): 16:59:21  Parsing macros/materializations/seeds/seed.sql
2022-03-03 16:59:21.110055 (Thread-366): 16:59:21  Parsing macros/materializations/tests/helpers.sql
2022-03-03 16:59:21.111737 (Thread-366): 16:59:21  Parsing macros/materializations/tests/test.sql
2022-03-03 16:59:21.116112 (Thread-366): 16:59:21  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 16:59:21.117902 (Thread-366): 16:59:21  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 16:59:21.129394 (Thread-366): 16:59:21  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 16:59:21.145780 (Thread-366): 16:59:21  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 16:59:21.147522 (Thread-366): 16:59:21  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 16:59:21.158773 (Thread-366): 16:59:21  Parsing tests/generic/builtin.sql
2022-03-03 16:59:21.162117 (Thread-366): 16:59:21  Parsing macros/sql/pivot.sql
2022-03-03 16:59:21.166345 (Thread-366): 16:59:21  Parsing macros/sql/star.sql
2022-03-03 16:59:21.170517 (Thread-366): 16:59:21  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 16:59:21.171769 (Thread-366): 16:59:21  Parsing macros/sql/surrogate_key.sql
2022-03-03 16:59:21.175465 (Thread-366): 16:59:21  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 16:59:21.177737 (Thread-366): 16:59:21  Parsing macros/sql/date_spine.sql
2022-03-03 16:59:21.181765 (Thread-366): 16:59:21  Parsing macros/sql/get_column_values.sql
2022-03-03 16:59:21.186916 (Thread-366): 16:59:21  Parsing macros/sql/groupby.sql
2022-03-03 16:59:21.188383 (Thread-366): 16:59:21  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 16:59:21.194514 (Thread-366): 16:59:21  Parsing macros/sql/nullcheck_table.sql
2022-03-03 16:59:21.196080 (Thread-366): 16:59:21  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 16:59:21.197717 (Thread-366): 16:59:21  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 16:59:21.200949 (Thread-366): 16:59:21  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 16:59:21.204133 (Thread-366): 16:59:21  Parsing macros/sql/safe_add.sql
2022-03-03 16:59:21.205725 (Thread-366): 16:59:21  Parsing macros/sql/haversine_distance.sql
2022-03-03 16:59:21.211437 (Thread-366): 16:59:21  Parsing macros/sql/unpivot.sql
2022-03-03 16:59:21.218920 (Thread-366): 16:59:21  Parsing macros/sql/generate_series.sql
2022-03-03 16:59:21.223335 (Thread-366): 16:59:21  Parsing macros/sql/nullcheck.sql
2022-03-03 16:59:21.224958 (Thread-366): 16:59:21  Parsing macros/sql/union.sql
2022-03-03 16:59:21.234511 (Thread-366): 16:59:21  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 16:59:21.258491 (Thread-366): 16:59:21  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 16:59:21.259812 (Thread-366): 16:59:21  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 16:59:21.261007 (Thread-366): 16:59:21  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 16:59:21.262127 (Thread-366): 16:59:21  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 16:59:21.263268 (Thread-366): 16:59:21  Parsing macros/web/get_url_parameter.sql
2022-03-03 16:59:21.264995 (Thread-366): 16:59:21  Parsing macros/web/get_url_path.sql
2022-03-03 16:59:21.268985 (Thread-366): 16:59:21  Parsing macros/web/get_url_host.sql
2022-03-03 16:59:21.271958 (Thread-366): 16:59:21  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 16:59:21.274788 (Thread-366): 16:59:21  Parsing macros/schema_tests/not_constant.sql
2022-03-03 16:59:21.276609 (Thread-366): 16:59:21  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 16:59:21.280204 (Thread-366): 16:59:21  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 16:59:21.283647 (Thread-366): 16:59:21  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 16:59:21.303587 (Thread-366): 16:59:21  Parsing macros/schema_tests/equality.sql
2022-03-03 16:59:21.309940 (Thread-366): 16:59:21  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 16:59:21.320296 (Thread-366): 16:59:21  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 16:59:21.323045 (Thread-366): 16:59:21  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 16:59:21.326652 (Thread-366): 16:59:21  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 16:59:21.329244 (Thread-366): 16:59:21  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 16:59:21.344521 (Thread-366): 16:59:21  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 16:59:21.348300 (Thread-366): 16:59:21  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 16:59:21.352423 (Thread-366): 16:59:21  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 16:59:21.355202 (Thread-366): 16:59:21  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 16:59:21.359987 (Thread-366): 16:59:21  Parsing macros/schema_tests/recency.sql
2022-03-03 16:59:21.363055 (Thread-366): 16:59:21  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 16:59:21.366410 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 16:59:21.369469 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 16:59:21.372264 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/length.sql
2022-03-03 16:59:21.374645 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 16:59:21.378874 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/right.sql
2022-03-03 16:59:21.381143 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/hash.sql
2022-03-03 16:59:21.382562 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 16:59:21.383826 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/replace.sql
2022-03-03 16:59:21.385105 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 16:59:21.386689 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 16:59:21.388239 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/concat.sql
2022-03-03 16:59:21.389241 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 16:59:21.390347 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 16:59:21.391971 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 16:59:21.401500 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 16:59:21.404273 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 16:59:21.410561 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/position.sql
2022-03-03 16:59:21.412081 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/literal.sql
2022-03-03 16:59:21.413047 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 16:59:21.414909 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 16:59:21.419992 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 16:59:21.421472 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/except.sql
2022-03-03 16:59:21.422526 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 16:59:21.424520 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 16:59:21.428049 (Thread-366): 16:59:21  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 16:59:21.429137 (Thread-366): 16:59:21  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 16:59:21.434257 (Thread-366): 16:59:21  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 16:59:21.439605 (Thread-366): 16:59:21  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 16:59:21.457323 (Thread-366): 16:59:21  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 16:59:21.474844 (Thread-366): 16:59:21  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 16:59:21.477514 (Thread-366): 16:59:21  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 16:59:21.483885 (Thread-366): 16:59:21  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 16:59:21.486506 (Thread-366): 16:59:21  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 16:59:21.488525 (Thread-366): 16:59:21  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 16:59:21.502807 (Thread-366): 16:59:21  Parsing macros/staging/hash_columns.sql
2022-03-03 16:59:21.506979 (Thread-366): 16:59:21  Parsing macros/staging/stage.sql
2022-03-03 16:59:21.517340 (Thread-366): 16:59:21  Parsing macros/staging/rank_columns.sql
2022-03-03 16:59:21.525890 (Thread-366): 16:59:21  Parsing macros/staging/derive_columns.sql
2022-03-03 16:59:21.531511 (Thread-366): 16:59:21  Parsing macros/staging/source_columns.sql
2022-03-03 16:59:21.532751 (Thread-366): 16:59:21  Parsing macros/internal/alias_all.sql
2022-03-03 16:59:21.535044 (Thread-366): 16:59:21  Parsing macros/internal/alias.sql
2022-03-03 16:59:21.538495 (Thread-366): 16:59:21  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 16:59:21.538893 (Thread-366): 16:59:21  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 16:59:21.547972 (Thread-366): 16:59:21  Parsing macros/internal/multikey.sql
2022-03-03 16:59:21.553194 (Thread-366): 16:59:21  Parsing macros/internal/is_checks.sql
2022-03-03 16:59:21.556086 (Thread-366): 16:59:21  Parsing macros/internal/expand_column_list.sql
2022-03-03 16:59:21.559227 (Thread-366): 16:59:21  Parsing macros/internal/as_constant.sql
2022-03-03 16:59:21.561403 (Thread-366): 16:59:21  Parsing macros/internal/check_required_parameters.sql
2022-03-03 16:59:21.563010 (Thread-366): 16:59:21  Parsing macros/tables/link.sql
2022-03-03 16:59:21.575964 (Thread-366): 16:59:21  Parsing macros/tables/sat.sql
2022-03-03 16:59:21.585181 (Thread-366): 16:59:21  Parsing macros/tables/eff_sat.sql
2022-03-03 16:59:21.599044 (Thread-366): 16:59:21  Parsing macros/tables/xts.sql
2022-03-03 16:59:21.606691 (Thread-366): 16:59:21  Parsing macros/tables/hub.sql
2022-03-03 16:59:21.618700 (Thread-366): 16:59:21  Parsing macros/tables/ma_sat.sql
2022-03-03 16:59:21.631350 (Thread-366): 16:59:21  Parsing macros/tables/pit.sql
2022-03-03 16:59:21.652147 (Thread-366): 16:59:21  Parsing macros/tables/bridge.sql
2022-03-03 16:59:21.687343 (Thread-366): 16:59:21  Parsing macros/tables/t_link.sql
2022-03-03 16:59:21.693031 (Thread-366): 16:59:21  Parsing macros/supporting/max_datetime.sql
2022-03-03 16:59:21.694201 (Thread-366): 16:59:21  Parsing macros/supporting/current_timestamp.sql
2022-03-03 16:59:21.696076 (Thread-366): 16:59:21  Parsing macros/supporting/prefix.sql
2022-03-03 16:59:21.701582 (Thread-366): 16:59:21  Parsing macros/supporting/hash.sql
2022-03-03 16:59:21.708334 (Thread-366): 16:59:21  Parsing macros/supporting/datatypes.sql
2022-03-03 16:59:22.251042 (Thread-366): 16:59:22  1603: static parser failed on stage/v_stg_inventory.sql
2022-03-03 16:59:22.273754 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on stage/v_stg_inventory.sql
2022-03-03 16:59:22.275078 (Thread-366): 16:59:22  1603: static parser failed on stage/v_stg_transactions.sql
2022-03-03 16:59:22.285427 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on stage/v_stg_transactions.sql
2022-03-03 16:59:22.286681 (Thread-366): 16:59:22  1603: static parser failed on stage/v_stg_orders.sql
2022-03-03 16:59:22.316061 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on stage/v_stg_orders.sql
2022-03-03 16:59:22.317463 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:59:22.324905 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/t_links/t_link_transactions.sql
2022-03-03 16:59:22.326103 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:59:22.334702 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_supplier.sql
2022-03-03 16:59:22.335912 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_region.sql
2022-03-03 16:59:22.344604 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_region.sql
2022-03-03 16:59:22.345863 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_order.sql
2022-03-03 16:59:22.352450 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
2022-03-03 16:59:22.353706 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_customer.sql
2022-03-03 16:59:22.360027 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_customer.sql
2022-03-03 16:59:22.361205 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_nation.sql
2022-03-03 16:59:22.369189 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_nation.sql
2022-03-03 16:59:22.373395 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:59:22.379919 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_lineitem.sql
2022-03-03 16:59:22.390006 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/hubs/hub_part.sql
2022-03-03 16:59:22.399495 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/hubs/hub_part.sql
2022-03-03 16:59:22.400708 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_customer_order.sql
2022-03-03 16:59:22.407320 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_order.sql
2022-03-03 16:59:22.408454 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:59:22.415208 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory_allocation.sql
2022-03-03 16:59:22.416351 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_inventory.sql
2022-03-03 16:59:22.422974 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_inventory.sql
2022-03-03 16:59:22.424387 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_customer_nation.sql
2022-03-03 16:59:22.432387 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_customer_nation.sql
2022-03-03 16:59:22.433565 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:59:22.440021 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_order_lineitem.sql
2022-03-03 16:59:22.441207 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_nation_region.sql
2022-03-03 16:59:22.449735 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_nation_region.sql
2022-03-03 16:59:22.451124 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:59:22.457771 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/links/link_supplier_nation.sql
2022-03-03 16:59:22.458949 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:59:22.468302 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 16:59:22.469573 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:59:22.479549 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 16:59:22.480759 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:59:22.491775 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 16:59:22.492978 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:59:22.502423 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 16:59:22.503614 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:59:22.513345 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 16:59:22.514582 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:59:22.523066 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 16:59:22.524235 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:59:22.534433 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 16:59:22.535628 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:59:22.546594 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 16:59:22.547821 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:59:22.559118 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 16:59:22.560319 (Thread-366): 16:59:22  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:59:22.569220 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 16:59:22.570584 (Thread-366): 16:59:22  1603: static parser failed on raw_stage/raw_transactions.sql
2022-03-03 16:59:22.577291 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_stage/raw_transactions.sql
2022-03-03 16:59:22.579765 (Thread-366): 16:59:22  1603: static parser failed on raw_stage/raw_orders.sql
2022-03-03 16:59:22.586133 (Thread-366): 16:59:22  1602: parser fallback to jinja rendering on raw_stage/raw_orders.sql
2022-03-03 16:59:22.587789 (Thread-366): 16:59:22  1699: static parser successfully parsed raw_stage/raw_inventory.sql
2022-03-03 16:59:22.608212 (Thread-367): handling status request
2022-03-03 16:59:22.613494 (Thread-367): 16:59:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4e816a0>]}
2022-03-03 16:59:22.613950 (Thread-367): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:22.645913 (Thread-368): handling status request
2022-03-03 16:59:22.655852 (Thread-368): 16:59:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45e9100>]}
2022-03-03 16:59:22.656386 (Thread-368): sending response (<Response 185 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:22.699674 (Thread-366): 16:59:22  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4158250>]}
2022-03-03 16:59:25.428937 (Thread-369): handling status request
2022-03-03 16:59:25.429273 (Thread-369): 16:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104322190>]}
2022-03-03 16:59:25.431446 (Thread-369): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:25.441488 (Thread-370): handling status request
2022-03-03 16:59:25.441798 (Thread-370): 16:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104089d60>]}
2022-03-03 16:59:25.443723 (Thread-370): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:27.413369 (Thread-371): handling status request
2022-03-03 16:59:27.413712 (Thread-371): 16:59:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47da850>]}
2022-03-03 16:59:27.415874 (Thread-371): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:27.842082 (Thread-372): handling status request
2022-03-03 16:59:27.842420 (Thread-372): 16:59:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042f2610>]}
2022-03-03 16:59:27.844543 (Thread-372): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:28.070375 (Thread-373): handling cli_args request
2022-03-03 16:59:28.070709 (Thread-373): 16:59:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4200e50>]}
2022-03-03 16:59:30.367194 (Thread-373): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:30.665260 (MainThread): 16:59:30  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 16:59:30.665719 (MainThread): 16:59:30  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 16:59:30.673938 (MainThread): 16:59:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b6b6043-af87-4598-add2-48a8e5daa07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0e8c1d00>]}
2022-03-03 16:59:30.709260 (MainThread): 16:59:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b6b6043-af87-4598-add2-48a8e5daa07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0f226400>]}
2022-03-03 16:59:30.709598 (MainThread): 16:59:30  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 16:59:30.711363 (MainThread): 16:59:30  
2022-03-03 16:59:30.711712 (MainThread): 16:59:30  Acquiring new snowflake connection "master"
2022-03-03 16:59:30.712605 (ThreadPoolExecutor-0_0): 16:59:30  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 16:59:30.726635 (ThreadPoolExecutor-0_0): 16:59:30  Using snowflake connection "list_DBT_RAW"
2022-03-03 16:59:30.726769 (ThreadPoolExecutor-0_0): 16:59:30  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 16:59:30.726861 (ThreadPoolExecutor-0_0): 16:59:30  Opening a new connection, currently in state init
2022-03-03 16:59:31.141954 (Thread-374): handling poll request
2022-03-03 16:59:31.142383 (Thread-374): 16:59:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044cc820>]}
2022-03-03 16:59:31.143373 (Thread-374): sending response (<Response 4158 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:31.685547 (ThreadPoolExecutor-0_0): 16:59:31  SQL status: SUCCESS 8 in 0.96 seconds
2022-03-03 16:59:31.687612 (ThreadPoolExecutor-0_0): 16:59:31  On list_DBT_RAW: Close
2022-03-03 16:59:31.966792 (ThreadPoolExecutor-2_0): 16:59:31  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:59:31.975085 (ThreadPoolExecutor-2_0): 16:59:31  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 16:59:31.975239 (ThreadPoolExecutor-2_0): 16:59:31  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 16:59:31.975389 (ThreadPoolExecutor-2_0): 16:59:31  Opening a new connection, currently in state closed
2022-03-03 16:59:32.827151 (ThreadPoolExecutor-2_0): 16:59:32  SQL status: SUCCESS 31 in 0.85 seconds
2022-03-03 16:59:32.830600 (ThreadPoolExecutor-2_0): 16:59:32  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 16:59:33.082853 (MainThread): 16:59:33  Concurrency: 4 threads (target='default')
2022-03-03 16:59:33.083040 (MainThread): 16:59:33  
2022-03-03 16:59:33.086015 (Thread-3): 16:59:33  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:59:33.086391 (Thread-3): 16:59:33  1 of 1 START view model DBT_VAULT.v_stg_orders.................................. [RUN]
2022-03-03 16:59:33.086704 (Thread-3): 16:59:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:59:33.086814 (Thread-3): 16:59:33  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:59:33.112221 (Thread-375): handling poll request
2022-03-03 16:59:33.086923 (Thread-3): 16:59:33  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:59:33.112938 (Thread-375): 16:59:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4ddfee0>]}
2022-03-03 16:59:33.113733 (Thread-375): sending response (<Response 5648 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:33.130434 (Thread-3): 16:59:33  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:59:33.130604 (Thread-3): 16:59:33  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:59:33.130702 (Thread-3): 16:59:33  Opening a new connection, currently in state closed
2022-03-03 16:59:34.068971 (Thread-3): 16:59:34  SQL status: SUCCESS 36 in 0.94 seconds
2022-03-03 16:59:34.101555 (Thread-3): 16:59:34  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:59:34.101721 (Thread-3): 16:59:34  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 16:59:34.306002 (Thread-3): 16:59:34  SQL status: SUCCESS 36 in 0.2 seconds
2022-03-03 16:59:34.357111 (Thread-3): 16:59:34  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:59:34.382852 (Thread-3): 16:59:34  finished collecting timing info
2022-03-03 16:59:34.383079 (Thread-3): 16:59:34  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:59:34.409282 (Thread-3): 16:59:34  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:59:34.448858 (Thread-3): 16:59:34  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 16:59:34.449036 (Thread-3): 16:59:34  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_orders 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(RECEIPTDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS LINK_CUSTOMER_NATION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_NATION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_REGION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS NATION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS REGION_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS NATION_REGION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS ORDER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS ORDER_CUSTOMER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS LINEITEM_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(32)) AS LINK_LINEITEM_ORDER_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(32)) AS PART_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS SUPPLIER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS INVENTORY_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(32)) AS INVENTORY_ALLOCATION_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS LINEITEM_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
2022-03-03 16:59:34.921307 (Thread-3): 16:59:34  SQL status: SUCCESS 1 in 0.47 seconds
2022-03-03 16:59:34.928126 (Thread-3): 16:59:34  finished collecting timing info
2022-03-03 16:59:34.928302 (Thread-3): 16:59:34  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 16:59:35.135298 (Thread-376): handling poll request
2022-03-03 16:59:35.135648 (Thread-376): 16:59:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4607160>]}
2022-03-03 16:59:35.136463 (Thread-376): sending response (<Response 17240 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:35.813052 (Thread-3): 16:59:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b6b6043-af87-4598-add2-48a8e5daa07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0c597e50>]}
2022-03-03 16:59:35.813500 (Thread-3): 16:59:35  1 of 1 OK created view model DBT_VAULT.v_stg_orders............................. [SUCCESS 1 in 2.73s]
2022-03-03 16:59:35.813636 (Thread-3): 16:59:35  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 16:59:35.815284 (MainThread): 16:59:35  Acquiring new snowflake connection "master"
2022-03-03 16:59:35.815611 (MainThread): 16:59:35  
2022-03-03 16:59:35.815718 (MainThread): 16:59:35  Finished running 1 view model in 5.10s.
2022-03-03 16:59:35.815806 (MainThread): 16:59:35  Connection 'master' was properly closed.
2022-03-03 16:59:35.815880 (MainThread): 16:59:35  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 16:59:35.879462 (MainThread): 16:59:35  
2022-03-03 16:59:35.879694 (MainThread): 16:59:35  Completed successfully
2022-03-03 16:59:35.879815 (MainThread): 16:59:35  
2022-03-03 16:59:35.879925 (MainThread): 16:59:35  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 16:59:37.108164 (Thread-377): handling poll request
2022-03-03 16:59:37.108509 (Thread-377): 16:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104639dc0>]}
2022-03-03 16:59:37.109681 (Thread-377): sending response (<Response 20186 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:40.088723 (Thread-378): handling status request
2022-03-03 16:59:40.089075 (Thread-378): 16:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518005ec70>]}
2022-03-03 16:59:40.092363 (Thread-378): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 16:59:40.095661 (Thread-379): handling status request
2022-03-03 16:59:40.095898 (Thread-379): 16:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041d8280>]}
2022-03-03 16:59:40.121318 (Thread-379): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:15:59.587589 (Thread-380): handling status request
2022-03-03 17:15:59.589455 (Thread-380): 17:15:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510403cdc0>]}
2022-03-03 17:15:59.591733 (Thread-380): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:00.478833 (Thread-381): handling status request
2022-03-03 17:16:00.479176 (Thread-381): 17:16:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43a2eb0>]}
2022-03-03 17:16:00.481384 (Thread-381): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:00.492119 (Thread-382): handling cli_args request
2022-03-03 17:16:00.492380 (Thread-382): 17:16:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43a2fa0>]}
2022-03-03 17:16:02.776090 (Thread-382): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:03.287309 (MainThread): 17:16:03  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:16:03.287748 (MainThread): 17:16:03  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:16:03.295682 (MainThread): 17:16:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b81f237-8673-43e0-ab8b-85d6e50d8e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c2042ca0>]}
2022-03-03 17:16:03.337176 (MainThread): 17:16:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b81f237-8673-43e0-ab8b-85d6e50d8e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c29a5c10>]}
2022-03-03 17:16:03.337486 (MainThread): 17:16:03  Found 31 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:16:03.339143 (MainThread): 17:16:03  
2022-03-03 17:16:03.339469 (MainThread): 17:16:03  Acquiring new snowflake connection "master"
2022-03-03 17:16:03.340328 (ThreadPoolExecutor-0_0): 17:16:03  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:16:03.353892 (ThreadPoolExecutor-0_0): 17:16:03  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:16:03.354004 (ThreadPoolExecutor-0_0): 17:16:03  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:16:03.354089 (ThreadPoolExecutor-0_0): 17:16:03  Opening a new connection, currently in state init
2022-03-03 17:16:03.516953 (Thread-383): handling poll request
2022-03-03 17:16:03.517394 (Thread-383): 17:16:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02892b0>]}
2022-03-03 17:16:03.518417 (Thread-383): sending response (<Response 4158 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:04.412060 (ThreadPoolExecutor-0_0): 17:16:04  SQL status: SUCCESS 8 in 1.06 seconds
2022-03-03 17:16:04.414251 (ThreadPoolExecutor-0_0): 17:16:04  On list_DBT_RAW: Close
2022-03-03 17:16:04.650579 (ThreadPoolExecutor-2_0): 17:16:04  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:16:04.659337 (ThreadPoolExecutor-2_0): 17:16:04  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:16:04.659528 (ThreadPoolExecutor-2_0): 17:16:04  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:16:04.659671 (ThreadPoolExecutor-2_0): 17:16:04  Opening a new connection, currently in state closed
2022-03-03 17:16:05.275567 (Thread-384): handling poll request
2022-03-03 17:16:05.275905 (Thread-384): 17:16:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104292670>]}
2022-03-03 17:16:05.276502 (Thread-384): sending response (<Response 2310 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:06.139576 (ThreadPoolExecutor-2_0): 17:16:06  SQL status: SUCCESS 31 in 1.48 seconds
2022-03-03 17:16:06.141885 (ThreadPoolExecutor-2_0): 17:16:06  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:16:06.519306 (MainThread): 17:16:06  Concurrency: 4 threads (target='default')
2022-03-03 17:16:06.519486 (MainThread): 17:16:06  
2022-03-03 17:16:06.522299 (Thread-3): 17:16:06  Began running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 17:16:06.522610 (Thread-3): 17:16:06  1 of 1 START view model DBT_VAULT.v_stg_orders.................................. [RUN]
2022-03-03 17:16:06.522913 (Thread-3): 17:16:06  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 17:16:06.523024 (Thread-3): 17:16:06  Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 17:16:06.523130 (Thread-3): 17:16:06  Compiling model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 17:16:06.563919 (Thread-3): 17:16:06  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 17:16:06.564071 (Thread-3): 17:16:06  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 17:16:06.564161 (Thread-3): 17:16:06  Opening a new connection, currently in state closed
2022-03-03 17:16:07.019735 (Thread-385): handling poll request
2022-03-03 17:16:07.020079 (Thread-385): 17:16:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43db2b0>]}
2022-03-03 17:16:07.020775 (Thread-385): sending response (<Response 4945 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:07.354788 (Thread-3): 17:16:07  SQL status: SUCCESS 36 in 0.79 seconds
2022-03-03 17:16:07.388702 (Thread-3): 17:16:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 17:16:07.388860 (Thread-3): 17:16:07  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 17:16:07.608896 (Thread-3): 17:16:07  SQL status: SUCCESS 36 in 0.22 seconds
2022-03-03 17:16:07.659365 (Thread-3): 17:16:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 17:16:07.691892 (Thread-3): 17:16:07  finished collecting timing info
2022-03-03 17:16:07.692110 (Thread-3): 17:16:07  Began executing node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 17:16:07.720481 (Thread-3): 17:16:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 17:16:07.765645 (Thread-3): 17:16:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
2022-03-03 17:16:07.765818 (Thread-3): 17:16:07  On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_orders 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    RECEIPTDATE AS EFFECTIVE_FROM,
    NVL(LAG(RECEIPTDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY RECEIPTDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS LINK_CUSTOMER_NATION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_NATION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_REGION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS NATION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''))) AS BINARY(32)) AS REGION_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS NATION_REGION_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS ORDER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS ORDER_CUSTOMER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS LINEITEM_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(32)) AS LINK_LINEITEM_ORDER_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''))) AS BINARY(32)) AS PART_PK,
    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS SUPPLIER_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(32)) AS INVENTORY_PK,
    CAST(SHA2_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(32)) AS INVENTORY_ALLOCATION_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_NATION_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_REGION_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS LINEITEM_HASHDIFF,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
2022-03-03 17:16:08.322535 (Thread-3): 17:16:08  SQL status: SUCCESS 1 in 0.56 seconds
2022-03-03 17:16:08.329494 (Thread-3): 17:16:08  finished collecting timing info
2022-03-03 17:16:08.329675 (Thread-3): 17:16:08  On model.dbtvault_snowflake_demo.v_stg_orders: Close
2022-03-03 17:16:08.667066 (Thread-3): 17:16:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b81f237-8673-43e0-ab8b-85d6e50d8e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c04ea730>]}
2022-03-03 17:16:08.667524 (Thread-3): 17:16:08  1 of 1 OK created view model DBT_VAULT.v_stg_orders............................. [SUCCESS 1 in 2.14s]
2022-03-03 17:16:08.667655 (Thread-3): 17:16:08  Finished running node model.dbtvault_snowflake_demo.v_stg_orders
2022-03-03 17:16:08.669666 (MainThread): 17:16:08  Acquiring new snowflake connection "master"
2022-03-03 17:16:08.670153 (MainThread): 17:16:08  
2022-03-03 17:16:08.670326 (MainThread): 17:16:08  Finished running 1 view model in 5.33s.
2022-03-03 17:16:08.670476 (MainThread): 17:16:08  Connection 'master' was properly closed.
2022-03-03 17:16:08.670602 (MainThread): 17:16:08  Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
2022-03-03 17:16:08.766745 (MainThread): 17:16:08  
2022-03-03 17:16:08.766973 (MainThread): 17:16:08  Completed successfully
2022-03-03 17:16:08.767078 (MainThread): 17:16:08  
2022-03-03 17:16:08.767176 (MainThread): 17:16:08  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:16:08.904895 (Thread-386): handling poll request
2022-03-03 17:16:08.905236 (Thread-386): 17:16:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104264220>]}
2022-03-03 17:16:08.906125 (Thread-386): sending response (<Response 20396 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:10.718112 (Thread-387): handling poll request
2022-03-03 17:16:10.718450 (Thread-387): 17:16:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104264ac0>]}
2022-03-03 17:16:10.719389 (Thread-387): sending response (<Response 15738 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:14.015653 (Thread-388): handling status request
2022-03-03 17:16:14.016047 (Thread-388): 17:16:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041b2970>]}
2022-03-03 17:16:14.019110 (Thread-388): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:16:14.314779 (Thread-389): handling status request
2022-03-03 17:16:14.315118 (Thread-389): 17:16:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042647c0>]}
2022-03-03 17:16:14.317298 (Thread-389): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:23:59.219933 (Thread-390): handling status request
2022-03-03 17:23:59.220267 (Thread-390): 17:23:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042583d0>]}
2022-03-03 17:23:59.222472 (Thread-390): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:23:59.428432 (Thread-391): handling ps request
2022-03-03 17:23:59.428804 (Thread-391): 17:23:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4607d60>]}
2022-03-03 17:23:59.429475 (Thread-391): sending response (<Response 1390 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:24:01.376765 (Thread-392): handling poll request
2022-03-03 17:24:01.377147 (Thread-392): 17:24:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104639640>]}
2022-03-03 17:24:01.378511 (Thread-392): sending response (<Response 46301 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:24:04.862603 (Thread-393): handling status request
2022-03-03 17:24:04.862958 (Thread-393): 17:24:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104210520>]}
2022-03-03 17:24:04.865129 (Thread-393): sending response (<Response 64478 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:24:24.478447 (Thread-394): 17:24:24  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-03-03 17:24:24.479122 (Thread-394): 17:24:24  Partial parsing: added file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 17:24:24.488003 (Thread-394): 17:24:24  1699: static parser successfully parsed stage/v_stg_customer_demo.sql
2022-03-03 17:24:24.565398 (Thread-394): 17:24:24  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4bd9220>]}
2022-03-03 17:24:25.776930 (Thread-395): handling status request
2022-03-03 17:24:25.777271 (Thread-395): 17:24:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4c80700>]}
2022-03-03 17:24:25.777781 (Thread-395): sending response (<Response 1587 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:24:26.070523 (Thread-396): handling status request
2022-03-03 17:24:26.070913 (Thread-396): 17:24:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4c80490>]}
2022-03-03 17:24:26.071422 (Thread-396): sending response (<Response 1587 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:16.005775 (Thread-397): 17:27:16  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:27:16.007644 (Thread-397): 17:27:16  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 17:27:16.013501 (Thread-397): 17:27:16  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 17:27:16.024849 (Thread-397): 17:27:16  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 17:27:16.081083 (Thread-397): 17:27:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4a62850>]}
2022-03-03 17:27:17.177716 (Thread-398): handling status request
2022-03-03 17:27:17.178058 (Thread-398): 17:27:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4c81bb0>]}
2022-03-03 17:27:17.178577 (Thread-398): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:17.502160 (Thread-399): handling status request
2022-03-03 17:27:17.502494 (Thread-399): 17:27:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4eb9eb0>]}
2022-03-03 17:27:17.502972 (Thread-399): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:50.525088 (Thread-400): handling status request
2022-03-03 17:27:50.525429 (Thread-400): 17:27:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4eb9970>]}
2022-03-03 17:27:50.525943 (Thread-400): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:51.320321 (Thread-401): handling cli_args request
2022-03-03 17:27:51.320736 (Thread-401): 17:27:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4a59850>]}
2022-03-03 17:27:51.322368 (Thread-402): handling status request
2022-03-03 17:27:51.323646 (Thread-402): 17:27:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4a599d0>]}
2022-03-03 17:27:51.324172 (Thread-402): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:53.579216 (Thread-401): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:53.866839 (MainThread): 17:27:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:27:53.867290 (MainThread): 17:27:53  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:27:53.875238 (MainThread): 17:27:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '058dc914-f110-4478-bfec-c36c65b0614d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb86af910>]}
2022-03-03 17:27:53.907655 (MainThread): 17:27:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '058dc914-f110-4478-bfec-c36c65b0614d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb8797820>]}
2022-03-03 17:27:53.907974 (MainThread): 17:27:53  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:27:53.909723 (MainThread): 17:27:53  
2022-03-03 17:27:53.910053 (MainThread): 17:27:53  Acquiring new snowflake connection "master"
2022-03-03 17:27:53.910874 (ThreadPoolExecutor-0_0): 17:27:53  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:27:53.924401 (ThreadPoolExecutor-0_0): 17:27:53  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:27:53.924519 (ThreadPoolExecutor-0_0): 17:27:53  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:27:53.924607 (ThreadPoolExecutor-0_0): 17:27:53  Opening a new connection, currently in state init
2022-03-03 17:27:54.372883 (Thread-403): handling poll request
2022-03-03 17:27:54.373379 (Thread-403): 17:27:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41477c0>]}
2022-03-03 17:27:54.374354 (Thread-403): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:55.513807 (ThreadPoolExecutor-0_0): 17:27:55  SQL status: SUCCESS 8 in 1.59 seconds
2022-03-03 17:27:55.516071 (ThreadPoolExecutor-0_0): 17:27:55  On list_DBT_RAW: Close
2022-03-03 17:27:55.753624 (ThreadPoolExecutor-2_0): 17:27:55  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:27:55.825783 (ThreadPoolExecutor-2_0): 17:27:55  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:27:55.825961 (ThreadPoolExecutor-2_0): 17:27:55  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:27:55.826065 (ThreadPoolExecutor-2_0): 17:27:55  Opening a new connection, currently in state closed
2022-03-03 17:27:56.233996 (Thread-404): handling poll request
2022-03-03 17:27:56.234356 (Thread-404): 17:27:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4a59970>]}
2022-03-03 17:27:56.234971 (Thread-404): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:56.892075 (ThreadPoolExecutor-2_0): 17:27:56  SQL status: SUCCESS 31 in 1.07 seconds
2022-03-03 17:27:56.894275 (ThreadPoolExecutor-2_0): 17:27:56  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:27:57.439970 (MainThread): 17:27:57  Concurrency: 4 threads (target='default')
2022-03-03 17:27:57.440166 (MainThread): 17:27:57  
2022-03-03 17:27:57.442993 (Thread-3): 17:27:57  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:27:57.443319 (Thread-3): 17:27:57  1 of 1 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 17:27:57.443599 (Thread-3): 17:27:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:27:57.443705 (Thread-3): 17:27:57  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:27:57.443814 (Thread-3): 17:27:57  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:27:57.479690 (Thread-3): 17:27:57  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:27:57.479855 (Thread-3): 17:27:57  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 17:27:57.479950 (Thread-3): 17:27:57  Opening a new connection, currently in state closed
2022-03-03 17:27:58.079531 (Thread-405): handling poll request
2022-03-03 17:27:58.079906 (Thread-405): 17:27:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4cb4af0>]}
2022-03-03 17:27:58.080609 (Thread-405): sending response (<Response 5078 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:58.437062 (Thread-3): 17:27:58  SQL status: SUCCESS 36 in 0.96 seconds
2022-03-03 17:27:58.469741 (Thread-3): 17:27:58  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:27:58.469911 (Thread-3): 17:27:58  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 17:27:58.701950 (Thread-3): 17:27:58  SQL status: SUCCESS 36 in 0.23 seconds
2022-03-03 17:27:58.739396 (Thread-3): 17:27:58  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:27:58.760777 (Thread-3): 17:27:58  finished collecting timing info
2022-03-03 17:27:58.761007 (Thread-3): 17:27:58  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:27:58.787819 (Thread-3): 17:27:58  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:27:58.807054 (Thread-3): 17:27:58  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:27:58.807236 (Thread-3): 17:27:58  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 17:27:59.846175 (Thread-406): handling poll request
2022-03-03 17:27:59.846535 (Thread-406): 17:27:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4b86340>]}
2022-03-03 17:27:59.847219 (Thread-406): sending response (<Response 9055 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:27:59.926018 (Thread-3): 17:27:59  SQL status: SUCCESS 1 in 1.12 seconds
2022-03-03 17:27:59.932802 (Thread-3): 17:27:59  finished collecting timing info
2022-03-03 17:27:59.932989 (Thread-3): 17:27:59  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 17:28:00.131198 (Thread-3): 17:28:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '058dc914-f110-4478-bfec-c36c65b0614d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb80447f0>]}
2022-03-03 17:28:00.131863 (Thread-3): 17:28:00  1 of 1 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 2.69s]
2022-03-03 17:28:00.132008 (Thread-3): 17:28:00  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:28:00.133569 (MainThread): 17:28:00  Acquiring new snowflake connection "master"
2022-03-03 17:28:00.133890 (MainThread): 17:28:00  
2022-03-03 17:28:00.133993 (MainThread): 17:28:00  Finished running 1 view model in 6.22s.
2022-03-03 17:28:00.134103 (MainThread): 17:28:00  Connection 'master' was properly closed.
2022-03-03 17:28:00.134205 (MainThread): 17:28:00  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 17:28:00.200691 (MainThread): 17:28:00  
2022-03-03 17:28:00.200919 (MainThread): 17:28:00  Completed successfully
2022-03-03 17:28:00.201027 (MainThread): 17:28:00  
2022-03-03 17:28:00.201125 (MainThread): 17:28:00  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:28:01.622253 (Thread-407): handling poll request
2022-03-03 17:28:01.622608 (Thread-407): 17:28:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4b86ca0>]}
2022-03-03 17:28:01.623765 (Thread-407): sending response (<Response 13960 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:28:03.021636 (Thread-408): handling status request
2022-03-03 17:28:03.021986 (Thread-408): 17:28:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4b86e50>]}
2022-03-03 17:28:03.022526 (Thread-408): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:28:03.458381 (Thread-409): handling status request
2022-03-03 17:28:03.458942 (Thread-409): 17:28:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4b86a00>]}
2022-03-03 17:28:03.485521 (Thread-409): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:29:54.374894 (Thread-410): 17:29:54  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:29:54.376739 (Thread-410): 17:29:54  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 17:29:54.383535 (Thread-410): 17:29:54  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 17:29:54.396024 (Thread-410): 17:29:54  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 17:29:54.456957 (Thread-410): 17:29:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c48b3e80>]}
2022-03-03 17:29:55.498606 (Thread-411): handling status request
2022-03-03 17:29:55.498952 (Thread-411): 17:29:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c49a35e0>]}
2022-03-03 17:29:55.499436 (Thread-411): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:29:55.748376 (Thread-412): handling status request
2022-03-03 17:29:55.748868 (Thread-412): 17:29:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c49a3310>]}
2022-03-03 17:29:55.749353 (Thread-412): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:07.408341 (Thread-413): handling status request
2022-03-03 17:30:07.408729 (Thread-413): 17:30:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4a56bb0>]}
2022-03-03 17:30:07.409232 (Thread-413): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:07.846458 (Thread-414): handling run_sql request
2022-03-03 17:30:07.846819 (Thread-414): 17:30:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c48f0f10>]}
2022-03-03 17:30:10.076018 (Thread-414): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:10.183983 (MainThread): 17:30:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3619f9fa-9d79-406b-aaff-fe447355eb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9f7806a0>]}
2022-03-03 17:30:10.184559 (MainThread): 17:30:10  Found 32 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:30:10.185179 (Thread-1): 17:30:10  Acquiring new snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-03 17:30:10.185308 (Thread-1): 17:30:10  Began compiling node rpc.dbtvault_snowflake_demo.request
2022-03-03 17:30:10.185399 (Thread-1): 17:30:10  Compiling rpc.dbtvault_snowflake_demo.request
2022-03-03 17:30:10.211685 (Thread-1): 17:30:10  Parsing macros/adapters.sql
2022-03-03 17:30:10.248577 (Thread-1): 17:30:10  Parsing macros/catalog.sql
2022-03-03 17:30:10.250613 (Thread-1): 17:30:10  Parsing macros/materializations/table.sql
2022-03-03 17:30:10.253766 (Thread-1): 17:30:10  Parsing macros/materializations/seed.sql
2022-03-03 17:30:10.258818 (Thread-1): 17:30:10  Parsing macros/materializations/incremental.sql
2022-03-03 17:30:10.267449 (Thread-1): 17:30:10  Parsing macros/materializations/merge.sql
2022-03-03 17:30:10.271237 (Thread-1): 17:30:10  Parsing macros/materializations/snapshot.sql
2022-03-03 17:30:10.272296 (Thread-1): 17:30:10  Parsing macros/materializations/view.sql
2022-03-03 17:30:10.274963 (Thread-1): 17:30:10  Parsing macros/adapters/metadata.sql
2022-03-03 17:30:10.282009 (Thread-1): 17:30:10  Parsing macros/adapters/columns.sql
2022-03-03 17:30:10.291666 (Thread-1): 17:30:10  Parsing macros/adapters/freshness.sql
2022-03-03 17:30:10.294882 (Thread-1): 17:30:10  Parsing macros/adapters/persist_docs.sql
2022-03-03 17:30:10.299448 (Thread-1): 17:30:10  Parsing macros/adapters/relation.sql
2022-03-03 17:30:10.308934 (Thread-1): 17:30:10  Parsing macros/adapters/schema.sql
2022-03-03 17:30:10.311240 (Thread-1): 17:30:10  Parsing macros/adapters/indexes.sql
2022-03-03 17:30:10.314045 (Thread-1): 17:30:10  Parsing macros/get_custom_name/get_custom_schema.sql
2022-03-03 17:30:10.316580 (Thread-1): 17:30:10  Parsing macros/get_custom_name/get_custom_alias.sql
2022-03-03 17:30:10.318207 (Thread-1): 17:30:10  Parsing macros/get_custom_name/get_custom_database.sql
2022-03-03 17:30:10.319866 (Thread-1): 17:30:10  Parsing macros/etc/datetime.sql
2022-03-03 17:30:10.328177 (Thread-1): 17:30:10  Parsing macros/etc/statement.sql
2022-03-03 17:30:10.332742 (Thread-1): 17:30:10  Parsing macros/generic_test_sql/unique.sql
2022-03-03 17:30:10.333576 (Thread-1): 17:30:10  Parsing macros/generic_test_sql/not_null.sql
2022-03-03 17:30:10.334252 (Thread-1): 17:30:10  Parsing macros/generic_test_sql/accepted_values.sql
2022-03-03 17:30:10.335702 (Thread-1): 17:30:10  Parsing macros/generic_test_sql/relationships.sql
2022-03-03 17:30:10.336722 (Thread-1): 17:30:10  Parsing macros/materializations/configs.sql
2022-03-03 17:30:10.339104 (Thread-1): 17:30:10  Parsing macros/materializations/hooks.sql
2022-03-03 17:30:10.343043 (Thread-1): 17:30:10  Parsing macros/materializations/models/table/table.sql
2022-03-03 17:30:10.351478 (Thread-1): 17:30:10  Parsing macros/materializations/models/table/create_table_as.sql
2022-03-03 17:30:10.355911 (Thread-1): 17:30:10  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-03-03 17:30:10.360511 (Thread-1): 17:30:10  Parsing macros/materializations/models/view/helpers.sql
2022-03-03 17:30:10.362578 (Thread-1): 17:30:10  Parsing macros/materializations/models/view/create_view_as.sql
2022-03-03 17:30:10.366094 (Thread-1): 17:30:10  Parsing macros/materializations/models/view/view.sql
2022-03-03 17:30:10.377750 (Thread-1): 17:30:10  Parsing macros/materializations/models/incremental/incremental.sql
2022-03-03 17:30:10.393524 (Thread-1): 17:30:10  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-03-03 17:30:10.412956 (Thread-1): 17:30:10  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-03-03 17:30:10.414735 (Thread-1): 17:30:10  Parsing macros/materializations/models/incremental/merge.sql
2022-03-03 17:30:10.426187 (Thread-1): 17:30:10  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-03-03 17:30:10.430756 (Thread-1): 17:30:10  Parsing macros/materializations/seeds/helpers.sql
2022-03-03 17:30:10.447160 (Thread-1): 17:30:10  Parsing macros/materializations/seeds/seed.sql
2022-03-03 17:30:10.453359 (Thread-1): 17:30:10  Parsing macros/materializations/tests/helpers.sql
2022-03-03 17:30:10.455314 (Thread-1): 17:30:10  Parsing macros/materializations/tests/test.sql
2022-03-03 17:30:10.459840 (Thread-1): 17:30:10  Parsing macros/materializations/tests/where_subquery.sql
2022-03-03 17:30:10.461915 (Thread-1): 17:30:10  Parsing macros/materializations/snapshots/helpers.sql
2022-03-03 17:30:10.473047 (Thread-1): 17:30:10  Parsing macros/materializations/snapshots/strategies.sql
2022-03-03 17:30:10.490014 (Thread-1): 17:30:10  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-03-03 17:30:10.491880 (Thread-1): 17:30:10  Parsing macros/materializations/snapshots/snapshot.sql
2022-03-03 17:30:10.509589 (Thread-1): 17:30:10  Parsing macros/sql/pivot.sql
2022-03-03 17:30:10.514873 (Thread-1): 17:30:10  Parsing macros/sql/star.sql
2022-03-03 17:30:10.520320 (Thread-1): 17:30:10  Parsing macros/sql/get_table_types_sql.sql
2022-03-03 17:30:10.522710 (Thread-1): 17:30:10  Parsing macros/sql/surrogate_key.sql
2022-03-03 17:30:10.527233 (Thread-1): 17:30:10  Parsing macros/sql/get_query_results_as_dict.sql
2022-03-03 17:30:10.530574 (Thread-1): 17:30:10  Parsing macros/sql/date_spine.sql
2022-03-03 17:30:10.535835 (Thread-1): 17:30:10  Parsing macros/sql/get_column_values.sql
2022-03-03 17:30:10.542036 (Thread-1): 17:30:10  Parsing macros/sql/groupby.sql
2022-03-03 17:30:10.544505 (Thread-1): 17:30:10  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-03-03 17:30:10.552045 (Thread-1): 17:30:10  Parsing macros/sql/nullcheck_table.sql
2022-03-03 17:30:10.554778 (Thread-1): 17:30:10  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-03-03 17:30:10.557577 (Thread-1): 17:30:10  Parsing macros/sql/get_relations_by_pattern.sql
2022-03-03 17:30:10.562013 (Thread-1): 17:30:10  Parsing macros/sql/get_relations_by_prefix.sql
2022-03-03 17:30:10.566422 (Thread-1): 17:30:10  Parsing macros/sql/safe_add.sql
2022-03-03 17:30:10.569152 (Thread-1): 17:30:10  Parsing macros/sql/haversine_distance.sql
2022-03-03 17:30:10.576192 (Thread-1): 17:30:10  Parsing macros/sql/unpivot.sql
2022-03-03 17:30:10.584914 (Thread-1): 17:30:10  Parsing macros/sql/generate_series.sql
2022-03-03 17:30:10.590289 (Thread-1): 17:30:10  Parsing macros/sql/nullcheck.sql
2022-03-03 17:30:10.593211 (Thread-1): 17:30:10  Parsing macros/sql/union.sql
2022-03-03 17:30:10.604342 (Thread-1): 17:30:10  Parsing macros/materializations/insert_by_period_materialization.sql
2022-03-03 17:30:10.628819 (Thread-1): 17:30:10  Parsing macros/jinja_helpers/pretty_time.sql
2022-03-03 17:30:10.631118 (Thread-1): 17:30:10  Parsing macros/jinja_helpers/slugify.sql
2022-03-03 17:30:10.633406 (Thread-1): 17:30:10  Parsing macros/jinja_helpers/log_info.sql
2022-03-03 17:30:10.635605 (Thread-1): 17:30:10  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-03-03 17:30:10.637845 (Thread-1): 17:30:10  Parsing macros/web/get_url_parameter.sql
2022-03-03 17:30:10.640565 (Thread-1): 17:30:10  Parsing macros/web/get_url_path.sql
2022-03-03 17:30:10.644109 (Thread-1): 17:30:10  Parsing macros/web/get_url_host.sql
2022-03-03 17:30:10.647106 (Thread-1): 17:30:10  Parsing macros/schema_tests/expression_is_true.sql
2022-03-03 17:30:10.649969 (Thread-1): 17:30:10  Parsing macros/schema_tests/not_constant.sql
2022-03-03 17:30:10.652294 (Thread-1): 17:30:10  Parsing macros/schema_tests/sequential_values.sql
2022-03-03 17:30:10.656307 (Thread-1): 17:30:10  Parsing macros/schema_tests/not_null_proportion.sql
2022-03-03 17:30:10.659633 (Thread-1): 17:30:10  Parsing macros/schema_tests/at_least_one.sql
2022-03-03 17:30:10.662071 (Thread-1): 17:30:10  Parsing macros/schema_tests/equality.sql
2022-03-03 17:30:10.666723 (Thread-1): 17:30:10  Parsing macros/schema_tests/test_not_null_where.sql
2022-03-03 17:30:10.669387 (Thread-1): 17:30:10  Parsing macros/schema_tests/equal_rowcount.sql
2022-03-03 17:30:10.672075 (Thread-1): 17:30:10  Parsing macros/schema_tests/not_accepted_values.sql
2022-03-03 17:30:10.675330 (Thread-1): 17:30:10  Parsing macros/schema_tests/test_unique_where.sql
2022-03-03 17:30:10.677956 (Thread-1): 17:30:10  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-03-03 17:30:10.688130 (Thread-1): 17:30:10  Parsing macros/schema_tests/relationships_where.sql
2022-03-03 17:30:10.691303 (Thread-1): 17:30:10  Parsing macros/schema_tests/accepted_range.sql
2022-03-03 17:30:10.694768 (Thread-1): 17:30:10  Parsing macros/schema_tests/fewer_rows_than.sql
2022-03-03 17:30:10.697524 (Thread-1): 17:30:10  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-03-03 17:30:10.701274 (Thread-1): 17:30:10  Parsing macros/schema_tests/recency.sql
2022-03-03 17:30:10.704012 (Thread-1): 17:30:10  Parsing macros/schema_tests/cardinality_equality.sql
2022-03-03 17:30:10.707095 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/split_part.sql
2022-03-03 17:30:10.710006 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/escape_single_quotes.sql
2022-03-03 17:30:10.712894 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/length.sql
2022-03-03 17:30:10.715762 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/current_timestamp.sql
2022-03-03 17:30:10.720179 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/right.sql
2022-03-03 17:30:10.723569 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/hash.sql
2022-03-03 17:30:10.726088 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/any_value.sql
2022-03-03 17:30:10.728395 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/replace.sql
2022-03-03 17:30:10.730719 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-03-03 17:30:10.779213 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/bool_or.sql
2022-03-03 17:30:10.782819 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/concat.sql
2022-03-03 17:30:10.785084 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/_is_relation.sql
2022-03-03 17:30:10.787327 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/identifier.sql
2022-03-03 17:30:10.790156 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/datediff.sql
2022-03-03 17:30:10.800974 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/dateadd.sql
2022-03-03 17:30:10.804860 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/datatypes.sql
2022-03-03 17:30:10.812170 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/position.sql
2022-03-03 17:30:10.815053 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/literal.sql
2022-03-03 17:30:10.817187 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-03-03 17:30:10.820239 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/width_bucket.sql
2022-03-03 17:30:10.826864 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/date_trunc.sql
2022-03-03 17:30:10.829474 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/except.sql
2022-03-03 17:30:10.831617 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/safe_cast.sql
2022-03-03 17:30:10.834806 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/last_day.sql
2022-03-03 17:30:10.839518 (Thread-1): 17:30:10  Parsing macros/cross_db_utils/intersect.sql
2022-03-03 17:30:10.846230 (Thread-1): 17:30:10  Parsing macros/materialisations/incremental_pit_materialization.sql
2022-03-03 17:30:10.852745 (Thread-1): 17:30:10  Parsing macros/materialisations/incremental_bridge_materialization.sql
2022-03-03 17:30:10.859335 (Thread-1): 17:30:10  Parsing macros/materialisations/period_mat_helpers.sql
2022-03-03 17:30:10.878700 (Thread-1): 17:30:10  Parsing macros/materialisations/vault_insert_by_period_materialization.sql
2022-03-03 17:30:10.898142 (Thread-1): 17:30:10  Parsing macros/materialisations/incremental_bridge_helpers.sql
2022-03-03 17:30:10.902042 (Thread-1): 17:30:10  Parsing macros/materialisations/rank_mat_helpers.sql
2022-03-03 17:30:10.909845 (Thread-1): 17:30:10  Parsing macros/materialisations/incremental_pit_helper.sql
2022-03-03 17:30:10.913638 (Thread-1): 17:30:10  Parsing macros/materialisations/shared_helpers.sql
2022-03-03 17:30:10.916835 (Thread-1): 17:30:10  Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
2022-03-03 17:30:10.932099 (Thread-1): 17:30:10  Parsing macros/staging/hash_columns.sql
2022-03-03 17:30:10.937203 (Thread-1): 17:30:10  Parsing macros/staging/stage.sql
2022-03-03 17:30:10.948545 (Thread-1): 17:30:10  Parsing macros/staging/rank_columns.sql
2022-03-03 17:30:10.958018 (Thread-1): 17:30:10  Parsing macros/staging/derive_columns.sql
2022-03-03 17:30:10.964739 (Thread-1): 17:30:10  Parsing macros/staging/source_columns.sql
2022-03-03 17:30:10.967034 (Thread-1): 17:30:10  Parsing macros/internal/alias_all.sql
2022-03-03 17:30:10.970354 (Thread-1): 17:30:10  Parsing macros/internal/alias.sql
2022-03-03 17:30:10.974819 (Thread-1): 17:30:10  Parsing macros/internal/prepend_generated_by.sql
2022-03-03 17:30:10.978951 (Thread-415): handling poll request
2022-03-03 17:30:10.979314 (Thread-415): 17:30:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c49aeee0>]}
2022-03-03 17:30:10.981957 (Thread-415): sending response (<Response 40128 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:10.976345 (Thread-1): 17:30:10  Parsing macros/internal/stage_processing_macros.sql
2022-03-03 17:30:10.986494 (Thread-1): 17:30:10  Parsing macros/internal/multikey.sql
2022-03-03 17:30:10.992664 (Thread-1): 17:30:10  Parsing macros/internal/is_checks.sql
2022-03-03 17:30:10.996567 (Thread-1): 17:30:10  Parsing macros/internal/expand_column_list.sql
2022-03-03 17:30:11.000707 (Thread-1): 17:30:11  Parsing macros/internal/as_constant.sql
2022-03-03 17:30:11.003857 (Thread-1): 17:30:11  Parsing macros/internal/check_required_parameters.sql
2022-03-03 17:30:11.006604 (Thread-1): 17:30:11  Parsing macros/tables/link.sql
2022-03-03 17:30:11.020579 (Thread-1): 17:30:11  Parsing macros/tables/sat.sql
2022-03-03 17:30:11.030715 (Thread-1): 17:30:11  Parsing macros/tables/eff_sat.sql
2022-03-03 17:30:11.045286 (Thread-1): 17:30:11  Parsing macros/tables/xts.sql
2022-03-03 17:30:11.053678 (Thread-1): 17:30:11  Parsing macros/tables/hub.sql
2022-03-03 17:30:11.066956 (Thread-1): 17:30:11  Parsing macros/tables/ma_sat.sql
2022-03-03 17:30:11.080761 (Thread-1): 17:30:11  Parsing macros/tables/pit.sql
2022-03-03 17:30:11.101781 (Thread-1): 17:30:11  Parsing macros/tables/bridge.sql
2022-03-03 17:30:11.138727 (Thread-1): 17:30:11  Parsing macros/tables/t_link.sql
2022-03-03 17:30:11.145654 (Thread-1): 17:30:11  Parsing macros/supporting/max_datetime.sql
2022-03-03 17:30:11.147776 (Thread-1): 17:30:11  Parsing macros/supporting/current_timestamp.sql
2022-03-03 17:30:11.150556 (Thread-1): 17:30:11  Parsing macros/supporting/prefix.sql
2022-03-03 17:30:11.157083 (Thread-1): 17:30:11  Parsing macros/supporting/hash.sql
2022-03-03 17:30:11.165062 (Thread-1): 17:30:11  Parsing macros/supporting/datatypes.sql
2022-03-03 17:30:11.180488 (Thread-1): 17:30:11  Using snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-03 17:30:11.180623 (Thread-1): 17:30:11  On rpc.dbtvault_snowflake_demo.request: describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 17:30:11.180738 (Thread-1): 17:30:11  Opening a new connection, currently in state init
2022-03-03 17:30:12.162993 (Thread-1): 17:30:12  SQL status: SUCCESS 36 in 0.98 seconds
2022-03-03 17:30:12.171556 (Thread-1): 17:30:12  Using snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-03 17:30:12.171694 (Thread-1): 17:30:12  On rpc.dbtvault_snowflake_demo.request: describe table DBT_RAW.DBT_VAULT.raw_orders
2022-03-03 17:30:12.329167 (Thread-1): 17:30:12  SQL status: SUCCESS 36 in 0.16 seconds
2022-03-03 17:30:12.336998 (Thread-1): 17:30:12  finished collecting timing info
2022-03-03 17:30:12.337183 (Thread-1): 17:30:12  Began executing node rpc.dbtvault_snowflake_demo.request
2022-03-03 17:30:12.342373 (Thread-1): 17:30:12  Using snowflake connection "rpc.dbtvault_snowflake_demo.request"
2022-03-03 17:30:12.342485 (Thread-1): 17:30:12  On rpc.dbtvault_snowflake_demo.request: WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM DBT_RAW.DBT_VAULT.raw_orders
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
limit 500
/* limit added automatically by dbt cloud */
2022-03-03 17:30:12.827294 (Thread-416): handling poll request
2022-03-03 17:30:12.827637 (Thread-416): 17:30:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4949520>]}
2022-03-03 17:30:12.828468 (Thread-416): sending response (<Response 13853 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:14.587702 (Thread-417): handling poll request
2022-03-03 17:30:14.588126 (Thread-417): 17:30:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c49496d0>]}
2022-03-03 17:30:14.588625 (Thread-417): sending response (<Response 403 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:16.329672 (Thread-418): handling poll request
2022-03-03 17:30:16.330006 (Thread-418): 17:30:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4949940>]}
2022-03-03 17:30:16.330500 (Thread-418): sending response (<Response 403 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:18.147741 (Thread-419): handling poll request
2022-03-03 17:30:18.148099 (Thread-419): 17:30:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4949bb0>]}
2022-03-03 17:30:18.148602 (Thread-419): sending response (<Response 404 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:18.932460 (Thread-1): 17:30:18  SQL status: SUCCESS 500 in 6.59 seconds
2022-03-03 17:30:19.712207 (Thread-1): 17:30:19  finished collecting timing info
2022-03-03 17:30:19.712449 (Thread-1): 17:30:19  On rpc.dbtvault_snowflake_demo.request: Close
2022-03-03 17:30:19.900441 (Thread-420): handling poll request
2022-03-03 17:30:19.900808 (Thread-420): 17:30:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4947040>]}
2022-03-03 17:30:19.901372 (Thread-420): sending response (<Response 1393 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:30:21.647283 (Thread-421): handling poll request
2022-03-03 17:30:21.647636 (Thread-421): 17:30:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4a72a00>]}
2022-03-03 17:30:21.663413 (Thread-421): sending response (<Response 499951 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:32:14.166753 (Thread-422): 17:32:14  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-03-03 17:32:14.168415 (Thread-422): 17:32:14  Partial parsing: added file: dbtvault_snowflake_demo://models/raw_stage/raw_customers.sql
2022-03-03 17:32:14.174459 (Thread-422): 17:32:14  1699: static parser successfully parsed raw_stage/raw_customers.sql
2022-03-03 17:32:14.227263 (Thread-422): 17:32:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104643e80>]}
2022-03-03 17:32:15.192287 (Thread-423): handling status request
2022-03-03 17:32:15.192622 (Thread-423): 17:32:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4896b50>]}
2022-03-03 17:32:15.193153 (Thread-423): sending response (<Response 1583 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:32:15.499539 (Thread-424): handling status request
2022-03-03 17:32:15.499880 (Thread-424): 17:32:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c48963a0>]}
2022-03-03 17:32:15.500355 (Thread-424): sending response (<Response 1583 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:33:38.995898 (Thread-425): 17:33:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:33:38.997677 (Thread-425): 17:33:38  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_stage/raw_customers.sql
2022-03-03 17:33:39.005317 (Thread-425): 17:33:39  1603: static parser failed on raw_stage/raw_customers.sql
2022-03-03 17:33:39.011865 (Thread-425): 17:33:39  1602: parser fallback to jinja rendering on raw_stage/raw_customers.sql
2022-03-03 17:33:39.068721 (Thread-425): 17:33:39  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e467b970>]}
2022-03-03 17:33:40.596627 (Thread-426): handling status request
2022-03-03 17:33:40.597006 (Thread-426): 17:33:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4896880>]}
2022-03-03 17:33:40.597732 (Thread-426): sending response (<Response 1888 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:33:40.598905 (Thread-427): handling status request
2022-03-03 17:33:40.599168 (Thread-427): 17:33:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c48b1430>]}
2022-03-03 17:33:40.599574 (Thread-427): sending response (<Response 1888 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:34:08.331323 (Thread-428): 17:34:08  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:34:08.331815 (Thread-428): 17:34:08  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 17:34:08.338650 (Thread-428): 17:34:08  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 17:34:08.349329 (Thread-428): 17:34:08  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 17:34:08.403297 (Thread-428): 17:34:08  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510432cbb0>]}
2022-03-03 17:34:09.635601 (Thread-429): handling status request
2022-03-03 17:34:09.635949 (Thread-429): 17:34:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4e43850>]}
2022-03-03 17:34:09.636472 (Thread-429): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:34:09.984671 (Thread-430): handling status request
2022-03-03 17:34:09.985006 (Thread-430): 17:34:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4896310>]}
2022-03-03 17:34:09.985491 (Thread-430): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:34:19.187921 (Thread-431): 17:34:19  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:34:19.188443 (Thread-431): 17:34:19  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 17:34:19.194553 (Thread-431): 17:34:19  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 17:34:19.205960 (Thread-431): 17:34:19  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 17:34:19.253157 (Thread-431): 17:34:19  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4e3dbb0>]}
2022-03-03 17:34:20.411744 (Thread-432): handling status request
2022-03-03 17:34:20.412163 (Thread-432): 17:34:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44bddc0>]}
2022-03-03 17:34:20.412790 (Thread-432): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:34:20.475827 (Thread-433): handling status request
2022-03-03 17:34:20.476162 (Thread-433): 17:34:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44bd0a0>]}
2022-03-03 17:34:20.476705 (Thread-433): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:03.351463 (Thread-434): handling status request
2022-03-03 17:35:03.351810 (Thread-434): 17:35:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104217f40>]}
2022-03-03 17:35:03.352299 (Thread-434): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:04.092777 (Thread-435): handling cli_args request
2022-03-03 17:35:04.093106 (Thread-435): 17:35:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4896490>]}
2022-03-03 17:35:04.117422 (Thread-436): handling status request
2022-03-03 17:35:04.125900 (Thread-436): 17:35:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4627370>]}
2022-03-03 17:35:04.127513 (Thread-436): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:06.397514 (Thread-435): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:06.690549 (MainThread): 17:35:06  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:35:06.690987 (MainThread): 17:35:06  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:35:06.699178 (MainThread): 17:35:06  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fea1332e-c243-42d1-a8b2-62f4d34b03a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057dbf4130>]}
2022-03-03 17:35:06.753146 (MainThread): 17:35:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fea1332e-c243-42d1-a8b2-62f4d34b03a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057dcdfc70>]}
2022-03-03 17:35:06.753662 (MainThread): 17:35:06  Found 33 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:35:06.756296 (MainThread): 17:35:06  
2022-03-03 17:35:06.756665 (MainThread): 17:35:06  Acquiring new snowflake connection "master"
2022-03-03 17:35:06.757580 (ThreadPoolExecutor-0_0): 17:35:06  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:35:06.771346 (ThreadPoolExecutor-0_0): 17:35:06  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:35:06.771463 (ThreadPoolExecutor-0_0): 17:35:06  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:35:06.771549 (ThreadPoolExecutor-0_0): 17:35:06  Opening a new connection, currently in state init
2022-03-03 17:35:07.147966 (Thread-437): handling poll request
2022-03-03 17:35:07.148320 (Thread-437): 17:35:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44401f0>]}
2022-03-03 17:35:07.149109 (Thread-437): sending response (<Response 4166 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:07.826792 (ThreadPoolExecutor-0_0): 17:35:07  SQL status: SUCCESS 8 in 1.06 seconds
2022-03-03 17:35:07.828872 (ThreadPoolExecutor-0_0): 17:35:07  On list_DBT_RAW: Close
2022-03-03 17:35:08.138658 (ThreadPoolExecutor-2_0): 17:35:08  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:35:08.197222 (ThreadPoolExecutor-2_0): 17:35:08  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:35:08.197372 (ThreadPoolExecutor-2_0): 17:35:08  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:35:08.197467 (ThreadPoolExecutor-2_0): 17:35:08  Opening a new connection, currently in state closed
2022-03-03 17:35:08.962818 (Thread-438): handling poll request
2022-03-03 17:35:08.963156 (Thread-438): 17:35:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e461b580>]}
2022-03-03 17:35:08.963730 (Thread-438): sending response (<Response 2318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:08.987821 (ThreadPoolExecutor-2_0): 17:35:08  SQL status: SUCCESS 32 in 0.79 seconds
2022-03-03 17:35:08.989983 (ThreadPoolExecutor-2_0): 17:35:08  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:35:09.330777 (MainThread): 17:35:09  Concurrency: 4 threads (target='default')
2022-03-03 17:35:09.330999 (MainThread): 17:35:09  
2022-03-03 17:35:09.334053 (Thread-3): 17:35:09  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 17:35:09.334362 (Thread-3): 17:35:09  1 of 2 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 17:35:09.334640 (Thread-3): 17:35:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 17:35:09.334746 (Thread-3): 17:35:09  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 17:35:09.334857 (Thread-3): 17:35:09  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 17:35:09.340783 (Thread-3): 17:35:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 17:35:09.350527 (Thread-3): 17:35:09  finished collecting timing info
2022-03-03 17:35:09.350674 (Thread-3): 17:35:09  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 17:35:09.375418 (Thread-3): 17:35:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 17:35:09.386570 (Thread-3): 17:35:09  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 17:35:09.386699 (Thread-3): 17:35:09  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 17:35:09.386789 (Thread-3): 17:35:09  Opening a new connection, currently in state closed
2022-03-03 17:35:10.743083 (Thread-439): handling poll request
2022-03-03 17:35:10.743412 (Thread-439): 17:35:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4678670>]}
2022-03-03 17:35:10.769916 (Thread-439): sending response (<Response 9150 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:12.669814 (Thread-440): handling poll request
2022-03-03 17:35:12.670159 (Thread-440): 17:35:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4678550>]}
2022-03-03 17:35:12.670691 (Thread-440): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:14.440855 (Thread-441): handling poll request
2022-03-03 17:35:14.441198 (Thread-441): 17:35:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43e75b0>]}
2022-03-03 17:35:14.441697 (Thread-441): sending response (<Response 322 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:15.422935 (Thread-3): 17:35:15  SQL status: SUCCESS 1 in 6.04 seconds
2022-03-03 17:35:15.432907 (Thread-3): 17:35:15  finished collecting timing info
2022-03-03 17:35:15.433098 (Thread-3): 17:35:15  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 17:35:15.850763 (Thread-3): 17:35:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea1332e-c243-42d1-a8b2-62f4d34b03a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058198d940>]}
2022-03-03 17:35:15.851217 (Thread-3): 17:35:15  1 of 2 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 6.52s]
2022-03-03 17:35:15.851349 (Thread-3): 17:35:15  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 17:35:15.852380 (Thread-5): 17:35:15  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:35:15.852699 (Thread-5): 17:35:15  2 of 2 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 17:35:15.853026 (Thread-5): 17:35:15  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:35:15.853126 (Thread-5): 17:35:15  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:35:15.853221 (Thread-5): 17:35:15  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:35:15.889061 (Thread-5): 17:35:15  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:35:15.889291 (Thread-5): 17:35:15  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 17:35:15.889412 (Thread-5): 17:35:15  Opening a new connection, currently in state init
2022-03-03 17:35:16.290699 (Thread-442): handling poll request
2022-03-03 17:35:16.291043 (Thread-442): 17:35:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042c11c0>]}
2022-03-03 17:35:16.291717 (Thread-442): sending response (<Response 6473 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:17.005699 (Thread-5): 17:35:17  SQL status: SUCCESS 5 in 1.12 seconds
2022-03-03 17:35:17.035085 (Thread-5): 17:35:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:35:17.035250 (Thread-5): 17:35:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 17:35:17.221743 (Thread-5): 17:35:17  SQL status: SUCCESS 5 in 0.19 seconds
2022-03-03 17:35:17.255174 (Thread-5): 17:35:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:35:17.272829 (Thread-5): 17:35:17  finished collecting timing info
2022-03-03 17:35:17.273039 (Thread-5): 17:35:17  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:35:17.292313 (Thread-5): 17:35:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:35:17.309432 (Thread-5): 17:35:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:35:17.309608 (Thread-5): 17:35:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 17:35:17.799881 (Thread-5): 17:35:17  SQL status: SUCCESS 1 in 0.49 seconds
2022-03-03 17:35:17.801382 (Thread-5): 17:35:17  finished collecting timing info
2022-03-03 17:35:17.801549 (Thread-5): 17:35:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 17:35:18.037187 (Thread-5): 17:35:18  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea1332e-c243-42d1-a8b2-62f4d34b03a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056cfd15e0>]}
2022-03-03 17:35:18.037620 (Thread-5): 17:35:18  2 of 2 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 2.18s]
2022-03-03 17:35:18.037751 (Thread-5): 17:35:18  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:35:18.039508 (MainThread): 17:35:18  Acquiring new snowflake connection "master"
2022-03-03 17:35:18.039845 (MainThread): 17:35:18  
2022-03-03 17:35:18.039956 (MainThread): 17:35:18  Finished running 1 table model, 1 view model in 11.28s.
2022-03-03 17:35:18.040045 (MainThread): 17:35:18  Connection 'master' was properly closed.
2022-03-03 17:35:18.040115 (MainThread): 17:35:18  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 17:35:18.040181 (MainThread): 17:35:18  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 17:35:18.091423 (Thread-443): handling poll request
2022-03-03 17:35:18.091753 (Thread-443): 17:35:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104374700>]}
2022-03-03 17:35:18.093830 (Thread-443): sending response (<Response 10767 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:18.111842 (MainThread): 17:35:18  
2022-03-03 17:35:18.112075 (MainThread): 17:35:18  Completed successfully
2022-03-03 17:35:18.112184 (MainThread): 17:35:18  
2022-03-03 17:35:18.112282 (MainThread): 17:35:18  Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-03-03 17:35:19.916241 (Thread-444): handling poll request
2022-03-03 17:35:19.916601 (Thread-444): 17:35:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4627d30>]}
2022-03-03 17:35:19.917727 (Thread-444): sending response (<Response 14593 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:21.903617 (Thread-445): handling status request
2022-03-03 17:35:21.903968 (Thread-445): 17:35:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4627b80>]}
2022-03-03 17:35:21.904476 (Thread-445): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:35:21.910308 (Thread-446): handling status request
2022-03-03 17:35:21.910585 (Thread-446): 17:35:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4627700>]}
2022-03-03 17:35:21.911040 (Thread-446): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:11.727682 (Thread-447): handling status request
2022-03-03 17:39:11.729355 (Thread-447): 17:39:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4627310>]}
2022-03-03 17:39:11.729856 (Thread-447): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:11.983383 (Thread-448): handling status request
2022-03-03 17:39:11.983736 (Thread-448): 17:39:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4678610>]}
2022-03-03 17:39:11.984225 (Thread-448): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:12.272045 (Thread-449): handling cli_args request
2022-03-03 17:39:12.272382 (Thread-449): 17:39:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46789a0>]}
2022-03-03 17:39:14.565141 (Thread-449): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:14.957199 (MainThread): 17:39:14  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:39:14.957636 (MainThread): 17:39:14  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:39:14.965426 (MainThread): 17:39:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc4a7ebb-b616-41e8-a565-a5ff33dbc750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f153ffb5130>]}
2022-03-03 17:39:15.001009 (MainThread): 17:39:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc4a7ebb-b616-41e8-a565-a5ff33dbc750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15440e2b80>]}
2022-03-03 17:39:15.001323 (MainThread): 17:39:15  Found 33 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:39:15.003266 (MainThread): 17:39:15  
2022-03-03 17:39:15.003598 (MainThread): 17:39:15  Acquiring new snowflake connection "master"
2022-03-03 17:39:15.004441 (ThreadPoolExecutor-0_0): 17:39:15  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:39:15.018129 (ThreadPoolExecutor-0_0): 17:39:15  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:39:15.018238 (ThreadPoolExecutor-0_0): 17:39:15  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:39:15.018325 (ThreadPoolExecutor-0_0): 17:39:15  Opening a new connection, currently in state init
2022-03-03 17:39:15.311952 (Thread-450): handling poll request
2022-03-03 17:39:15.312358 (Thread-450): 17:39:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44bd9a0>]}
2022-03-03 17:39:15.313405 (Thread-450): sending response (<Response 4164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:15.920818 (ThreadPoolExecutor-0_0): 17:39:15  SQL status: SUCCESS 8 in 0.9 seconds
2022-03-03 17:39:15.922865 (ThreadPoolExecutor-0_0): 17:39:15  On list_DBT_RAW: Close
2022-03-03 17:39:16.117208 (ThreadPoolExecutor-2_0): 17:39:16  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:39:16.182236 (ThreadPoolExecutor-2_0): 17:39:16  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:39:16.182394 (ThreadPoolExecutor-2_0): 17:39:16  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:39:16.182494 (ThreadPoolExecutor-2_0): 17:39:16  Opening a new connection, currently in state closed
2022-03-03 17:39:17.076057 (Thread-451): handling poll request
2022-03-03 17:39:17.076400 (Thread-451): 17:39:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e460fca0>]}
2022-03-03 17:39:17.077019 (Thread-451): sending response (<Response 2316 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:17.156164 (ThreadPoolExecutor-2_0): 17:39:17  SQL status: SUCCESS 33 in 0.97 seconds
2022-03-03 17:39:17.158645 (ThreadPoolExecutor-2_0): 17:39:17  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:39:17.446239 (MainThread): 17:39:17  Concurrency: 4 threads (target='default')
2022-03-03 17:39:17.446418 (MainThread): 17:39:17  
2022-03-03 17:39:17.449381 (Thread-3): 17:39:17  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:39:17.449756 (Thread-3): 17:39:17  1 of 1 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 17:39:17.450071 (Thread-3): 17:39:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:39:17.450201 (Thread-3): 17:39:17  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:39:17.450338 (Thread-3): 17:39:17  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:39:17.488603 (Thread-3): 17:39:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:39:17.488788 (Thread-3): 17:39:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 17:39:17.488888 (Thread-3): 17:39:17  Opening a new connection, currently in state closed
2022-03-03 17:39:18.167748 (Thread-3): 17:39:18  SQL status: SUCCESS 5 in 0.68 seconds
2022-03-03 17:39:18.198539 (Thread-3): 17:39:18  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:39:18.198697 (Thread-3): 17:39:18  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 17:39:18.318911 (Thread-3): 17:39:18  SQL status: SUCCESS 5 in 0.12 seconds
2022-03-03 17:39:18.353466 (Thread-3): 17:39:18  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:39:18.368694 (Thread-3): 17:39:18  finished collecting timing info
2022-03-03 17:39:18.368911 (Thread-3): 17:39:18  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:39:18.394840 (Thread-3): 17:39:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:39:18.410944 (Thread-3): 17:39:18  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 17:39:18.411096 (Thread-3): 17:39:18  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 17:39:18.814511 (Thread-3): 17:39:18  SQL status: SUCCESS 1 in 0.4 seconds
2022-03-03 17:39:18.821008 (Thread-3): 17:39:18  finished collecting timing info
2022-03-03 17:39:18.821184 (Thread-3): 17:39:18  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 17:39:18.937129 (Thread-452): handling poll request
2022-03-03 17:39:18.937460 (Thread-452): 17:39:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042afd60>]}
2022-03-03 17:39:18.938270 (Thread-452): sending response (<Response 12355 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:19.072214 (Thread-3): 17:39:19  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4a7ebb-b616-41e8-a565-a5ff33dbc750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f153dc76d00>]}
2022-03-03 17:39:19.072686 (Thread-3): 17:39:19  1 of 1 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.62s]
2022-03-03 17:39:19.072829 (Thread-3): 17:39:19  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 17:39:19.074435 (MainThread): 17:39:19  Acquiring new snowflake connection "master"
2022-03-03 17:39:19.074768 (MainThread): 17:39:19  
2022-03-03 17:39:19.074875 (MainThread): 17:39:19  Finished running 1 view model in 4.07s.
2022-03-03 17:39:19.074965 (MainThread): 17:39:19  Connection 'master' was properly closed.
2022-03-03 17:39:19.075044 (MainThread): 17:39:19  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 17:39:19.138326 (MainThread): 17:39:19  
2022-03-03 17:39:19.138544 (MainThread): 17:39:19  Completed successfully
2022-03-03 17:39:19.138651 (MainThread): 17:39:19  
2022-03-03 17:39:19.138748 (MainThread): 17:39:19  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:39:20.698132 (Thread-453): handling poll request
2022-03-03 17:39:20.698454 (Thread-453): 17:39:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042afd30>]}
2022-03-03 17:39:20.699424 (Thread-453): sending response (<Response 10016 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:22.562027 (Thread-454): handling status request
2022-03-03 17:39:22.562372 (Thread-454): 17:39:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042af8b0>]}
2022-03-03 17:39:22.562928 (Thread-454): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:39:22.568513 (Thread-455): handling status request
2022-03-03 17:39:22.568799 (Thread-455): 17:39:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4710bb0>]}
2022-03-03 17:39:22.569214 (Thread-455): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:45:29.575784 (Thread-456): handling status request
2022-03-03 17:45:29.576137 (Thread-456): 17:45:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042eddc0>]}
2022-03-03 17:45:29.576623 (Thread-456): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:45:29.585090 (Thread-457): handling ps request
2022-03-03 17:45:29.585367 (Thread-457): 17:45:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042ed100>]}
2022-03-03 17:45:29.586481 (Thread-457): sending response (<Response 3219 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:45:34.350117 (Thread-458): handling status request
2022-03-03 17:45:34.350535 (Thread-458): 17:45:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51043bbe50>]}
2022-03-03 17:45:34.351048 (Thread-458): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:45:34.353373 (Thread-459): handling poll request
2022-03-03 17:45:34.353604 (Thread-459): 17:45:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042af1c0>]}
2022-03-03 17:45:34.354766 (Thread-459): sending response (<Response 27898 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:45:35.981615 (Thread-460): handling status request
2022-03-03 17:45:35.981948 (Thread-460): 17:45:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042af7c0>]}
2022-03-03 17:45:35.982451 (Thread-460): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:45:35.992075 (Thread-461): handling status request
2022-03-03 17:45:35.992319 (Thread-461): 17:45:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51045b4340>]}
2022-03-03 17:45:35.992790 (Thread-461): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:46:03.040751 (Thread-462): 17:46:03  Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-03-03 17:46:03.041265 (Thread-462): 17:46:03  Partial parsing: added file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:46:03.047667 (Thread-462): 17:46:03  1699: static parser successfully parsed raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:46:03.122620 (Thread-462): 17:46:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c42e8580>]}
2022-03-03 17:46:04.739473 (Thread-463): handling status request
2022-03-03 17:46:04.739822 (Thread-463): 17:46:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042afe50>]}
2022-03-03 17:46:04.740317 (Thread-463): sending response (<Response 1601 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:46:04.746314 (Thread-464): handling status request
2022-03-03 17:46:04.746565 (Thread-464): 17:46:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5204132eb0>]}
2022-03-03 17:46:04.746966 (Thread-464): sending response (<Response 1601 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:50:13.548700 (Thread-465): 17:50:13  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:50:13.550448 (Thread-465): 17:50:13  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:50:13.556263 (Thread-465): 17:50:13  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:50:13.566865 (Thread-465): 17:50:13  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:50:13.620390 (Thread-465): 17:50:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4132b20>]}
2022-03-03 17:50:14.773387 (Thread-466): handling status request
2022-03-03 17:50:14.773732 (Thread-466): 17:50:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c42dfa00>]}
2022-03-03 17:50:14.774237 (Thread-466): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:50:15.007593 (Thread-467): handling status request
2022-03-03 17:50:15.007937 (Thread-467): 17:50:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c42df6a0>]}
2022-03-03 17:50:15.008426 (Thread-467): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:50:44.026491 (Thread-468): 17:50:44  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:50:44.026996 (Thread-468): 17:50:44  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:50:44.033082 (Thread-468): 17:50:44  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:50:44.042735 (Thread-468): 17:50:44  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:50:44.094846 (Thread-468): 17:50:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c40ba700>]}
2022-03-03 17:50:45.318844 (Thread-469): handling status request
2022-03-03 17:50:45.319195 (Thread-469): 17:50:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c42dfd90>]}
2022-03-03 17:50:45.342793 (Thread-469): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:50:45.516492 (Thread-470): handling status request
2022-03-03 17:50:45.516865 (Thread-470): 17:50:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c438b490>]}
2022-03-03 17:50:45.517349 (Thread-470): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:23.910457 (Thread-471): handling status request
2022-03-03 17:51:23.910829 (Thread-471): 17:51:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c42df430>]}
2022-03-03 17:51:23.911359 (Thread-471): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:24.819490 (Thread-472): handling cli_args request
2022-03-03 17:51:24.819828 (Thread-472): 17:51:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4eb97f0>]}
2022-03-03 17:51:24.826460 (Thread-473): handling status request
2022-03-03 17:51:24.826881 (Thread-473): 17:51:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4124a90>]}
2022-03-03 17:51:24.827591 (Thread-473): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:27.099015 (Thread-472): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:27.408472 (MainThread): 17:51:27  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:51:27.408965 (MainThread): 17:51:27  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:51:27.416660 (MainThread): 17:51:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbf083d6-41b3-4db5-8453-c920b95d8056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05acfa9a0>]}
2022-03-03 17:51:27.455014 (MainThread): 17:51:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbf083d6-41b3-4db5-8453-c920b95d8056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05ade1df0>]}
2022-03-03 17:51:27.455345 (MainThread): 17:51:27  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:51:27.457249 (MainThread): 17:51:27  
2022-03-03 17:51:27.457597 (MainThread): 17:51:27  Acquiring new snowflake connection "master"
2022-03-03 17:51:27.458516 (ThreadPoolExecutor-0_0): 17:51:27  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:51:27.472380 (ThreadPoolExecutor-0_0): 17:51:27  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:51:27.472502 (ThreadPoolExecutor-0_0): 17:51:27  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:51:27.472589 (ThreadPoolExecutor-0_0): 17:51:27  Opening a new connection, currently in state init
2022-03-03 17:51:27.924615 (Thread-474): handling poll request
2022-03-03 17:51:27.925080 (Thread-474): 17:51:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c43092e0>]}
2022-03-03 17:51:27.926039 (Thread-474): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:28.433399 (ThreadPoolExecutor-0_0): 17:51:28  SQL status: SUCCESS 8 in 0.96 seconds
2022-03-03 17:51:28.435473 (ThreadPoolExecutor-0_0): 17:51:28  On list_DBT_RAW: Close
2022-03-03 17:51:28.636175 (ThreadPoolExecutor-2_0): 17:51:28  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:51:28.703613 (ThreadPoolExecutor-2_0): 17:51:28  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:51:28.703770 (ThreadPoolExecutor-2_0): 17:51:28  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:51:28.703868 (ThreadPoolExecutor-2_0): 17:51:28  Opening a new connection, currently in state closed
2022-03-03 17:51:29.678131 (ThreadPoolExecutor-2_0): 17:51:29  SQL status: SUCCESS 33 in 0.97 seconds
2022-03-03 17:51:29.680433 (ThreadPoolExecutor-2_0): 17:51:29  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:51:29.772071 (Thread-475): handling poll request
2022-03-03 17:51:29.772432 (Thread-475): 17:51:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c40ba580>]}
2022-03-03 17:51:29.773079 (Thread-475): sending response (<Response 2899 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:30.192893 (MainThread): 17:51:30  Concurrency: 4 threads (target='default')
2022-03-03 17:51:30.193091 (MainThread): 17:51:30  
2022-03-03 17:51:30.195875 (Thread-3): 17:51:30  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:51:30.196189 (Thread-3): 17:51:30  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:51:30.196472 (Thread-3): 17:51:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:51:30.196605 (Thread-3): 17:51:30  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:51:30.196755 (Thread-3): 17:51:30  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:51:30.279264 (Thread-3): 17:51:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:51:30.288752 (Thread-3): 17:51:30  finished collecting timing info
2022-03-03 17:51:30.288926 (Thread-3): 17:51:30  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:51:30.330727 (Thread-3): 17:51:30  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:51:30.340442 (Thread-3): 17:51:30  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:51:30.340577 (Thread-3): 17:51:30  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:51:30.340694 (Thread-3): 17:51:30  Opening a new connection, currently in state closed
2022-03-03 17:51:31.611455 (Thread-476): handling poll request
2022-03-03 17:51:31.611799 (Thread-476): 17:51:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4301a30>]}
2022-03-03 17:51:31.612544 (Thread-476): sending response (<Response 6778 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:32.703768 (Thread-3): 17:51:32  SQL status: SUCCESS 1 in 2.36 seconds
2022-03-03 17:51:32.713815 (Thread-3): 17:51:32  finished collecting timing info
2022-03-03 17:51:32.713996 (Thread-3): 17:51:32  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:51:32.917522 (Thread-3): 17:51:32  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbf083d6-41b3-4db5-8453-c920b95d8056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa058143a60>]}
2022-03-03 17:51:32.917978 (Thread-3): 17:51:32  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.72s]
2022-03-03 17:51:32.918115 (Thread-3): 17:51:32  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:51:32.919859 (MainThread): 17:51:32  Acquiring new snowflake connection "master"
2022-03-03 17:51:32.920186 (MainThread): 17:51:32  
2022-03-03 17:51:32.920291 (MainThread): 17:51:32  Finished running 1 incremental model in 5.46s.
2022-03-03 17:51:32.920379 (MainThread): 17:51:32  Connection 'master' was properly closed.
2022-03-03 17:51:32.920454 (MainThread): 17:51:32  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:51:33.000678 (MainThread): 17:51:33  
2022-03-03 17:51:33.000917 (MainThread): 17:51:33  Completed successfully
2022-03-03 17:51:33.001032 (MainThread): 17:51:33  
2022-03-03 17:51:33.001129 (MainThread): 17:51:33  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:51:33.457869 (Thread-477): handling poll request
2022-03-03 17:51:33.458243 (Thread-477): 17:51:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c412aaf0>]}
2022-03-03 17:51:33.459429 (Thread-477): sending response (<Response 9915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:35.512299 (Thread-478): handling status request
2022-03-03 17:51:35.512666 (Thread-478): 17:51:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c412a940>]}
2022-03-03 17:51:35.513212 (Thread-478): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:35.530683 (Thread-479): handling status request
2022-03-03 17:51:35.530967 (Thread-479): 17:51:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c412a550>]}
2022-03-03 17:51:35.531457 (Thread-479): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:57.478836 (Thread-480): 17:51:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:51:57.479433 (Thread-480): 17:51:57  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:51:57.485918 (Thread-480): 17:51:57  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:51:57.497486 (Thread-480): 17:51:57  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:51:57.551370 (Thread-480): 17:51:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4d4bbe0>]}
2022-03-03 17:51:58.458508 (Thread-481): handling status request
2022-03-03 17:51:58.458844 (Thread-481): 17:51:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e464b1f0>]}
2022-03-03 17:51:58.459335 (Thread-481): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:51:58.711973 (Thread-482): handling status request
2022-03-03 17:51:58.712319 (Thread-482): 17:51:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e464b5b0>]}
2022-03-03 17:51:58.712889 (Thread-482): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:02.554661 (Thread-483): handling status request
2022-03-03 17:52:02.555009 (Thread-483): 17:52:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e464b610>]}
2022-03-03 17:52:02.555490 (Thread-483): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:02.854398 (Thread-484): handling status request
2022-03-03 17:52:02.854738 (Thread-484): 17:52:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104664520>]}
2022-03-03 17:52:02.855220 (Thread-484): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:03.178750 (Thread-485): handling cli_args request
2022-03-03 17:52:03.179092 (Thread-485): 17:52:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51046647f0>]}
2022-03-03 17:52:05.463345 (Thread-485): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:05.770772 (MainThread): 17:52:05  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:52:05.771306 (MainThread): 17:52:05  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:52:05.779201 (MainThread): 17:52:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0fc051-a788-45e9-81be-35556e0bd2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d39b7a880>]}
2022-03-03 17:52:05.808181 (MainThread): 17:52:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0fc051-a788-45e9-81be-35556e0bd2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d39c54fa0>]}
2022-03-03 17:52:05.808466 (MainThread): 17:52:05  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:52:05.810208 (MainThread): 17:52:05  
2022-03-03 17:52:05.810543 (MainThread): 17:52:05  Acquiring new snowflake connection "master"
2022-03-03 17:52:05.811306 (ThreadPoolExecutor-0_0): 17:52:05  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:52:05.824629 (ThreadPoolExecutor-0_0): 17:52:05  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:52:05.824764 (ThreadPoolExecutor-0_0): 17:52:05  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:52:05.824850 (ThreadPoolExecutor-0_0): 17:52:05  Opening a new connection, currently in state init
2022-03-03 17:52:06.257909 (Thread-486): handling poll request
2022-03-03 17:52:06.258317 (Thread-486): 17:52:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042f91f0>]}
2022-03-03 17:52:06.259259 (Thread-486): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:06.738267 (ThreadPoolExecutor-0_0): 17:52:06  SQL status: SUCCESS 8 in 0.91 seconds
2022-03-03 17:52:06.740401 (ThreadPoolExecutor-0_0): 17:52:06  On list_DBT_RAW: Close
2022-03-03 17:52:06.943692 (ThreadPoolExecutor-2_0): 17:52:06  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:52:07.006258 (ThreadPoolExecutor-2_0): 17:52:07  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:52:07.006415 (ThreadPoolExecutor-2_0): 17:52:07  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:52:07.006513 (ThreadPoolExecutor-2_0): 17:52:07  Opening a new connection, currently in state closed
2022-03-03 17:52:07.851933 (ThreadPoolExecutor-2_0): 17:52:07  SQL status: SUCCESS 34 in 0.85 seconds
2022-03-03 17:52:07.854326 (ThreadPoolExecutor-2_0): 17:52:07  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:52:08.036405 (Thread-487): handling poll request
2022-03-03 17:52:08.036818 (Thread-487): 17:52:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042302e0>]}
2022-03-03 17:52:08.037399 (Thread-487): sending response (<Response 2899 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:08.056015 (MainThread): 17:52:08  Concurrency: 4 threads (target='default')
2022-03-03 17:52:08.056191 (MainThread): 17:52:08  
2022-03-03 17:52:08.059062 (Thread-3): 17:52:08  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:52:08.059374 (Thread-3): 17:52:08  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:52:08.059641 (Thread-3): 17:52:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:08.059745 (Thread-3): 17:52:08  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:52:08.059857 (Thread-3): 17:52:08  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:52:08.147209 (Thread-3): 17:52:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:08.163128 (Thread-3): 17:52:08  finished collecting timing info
2022-03-03 17:52:08.163484 (Thread-3): 17:52:08  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:52:08.204508 (Thread-3): 17:52:08  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:08.204682 (Thread-3): 17:52:08  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:52:08.204781 (Thread-3): 17:52:08  Opening a new connection, currently in state closed
2022-03-03 17:52:09.842777 (Thread-488): handling poll request
2022-03-03 17:52:09.843120 (Thread-488): 17:52:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41106a0>]}
2022-03-03 17:52:09.843803 (Thread-488): sending response (<Response 7346 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:10.885737 (Thread-3): 17:52:10  SQL status: SUCCESS 1 in 2.68 seconds
2022-03-03 17:52:10.895026 (Thread-3): 17:52:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:10.895162 (Thread-3): 17:52:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 17:52:11.056203 (Thread-3): 17:52:11  SQL status: SUCCESS 9 in 0.16 seconds
2022-03-03 17:52:11.061016 (Thread-3): 17:52:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:11.061145 (Thread-3): 17:52:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 17:52:11.200579 (Thread-3): 17:52:11  SQL status: SUCCESS 9 in 0.14 seconds
2022-03-03 17:52:11.208984 (Thread-3): 17:52:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:11.209117 (Thread-3): 17:52:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 17:52:11.338500 (Thread-3): 17:52:11  SQL status: SUCCESS 9 in 0.13 seconds
2022-03-03 17:52:11.359475 (Thread-3): 17:52:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:11.372386 (Thread-3): 17:52:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:11.372523 (Thread-3): 17:52:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 17:52:11.513282 (Thread-3): 17:52:11  SQL status: SUCCESS 1 in 0.14 seconds
2022-03-03 17:52:11.513517 (Thread-3): 17:52:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:11.513603 (Thread-3): 17:52:11  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 17:52:11.654995 (Thread-489): handling poll request
2022-03-03 17:52:11.655339 (Thread-489): 17:52:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4fb4070>]}
2022-03-03 17:52:11.656055 (Thread-489): sending response (<Response 8294 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:12.106229 (Thread-3): 17:52:12  SQL status: SUCCESS 0 in 0.59 seconds
2022-03-03 17:52:12.106440 (Thread-3): 17:52:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:52:12.106528 (Thread-3): 17:52:12  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 17:52:12.338594 (Thread-3): 17:52:12  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-03 17:52:12.349264 (Thread-3): 17:52:12  finished collecting timing info
2022-03-03 17:52:12.349456 (Thread-3): 17:52:12  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:52:12.575158 (Thread-3): 17:52:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0fc051-a788-45e9-81be-35556e0bd2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d385859a0>]}
2022-03-03 17:52:12.575619 (Thread-3): 17:52:12  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 4.52s]
2022-03-03 17:52:12.575757 (Thread-3): 17:52:12  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:52:12.577438 (MainThread): 17:52:12  Acquiring new snowflake connection "master"
2022-03-03 17:52:12.577774 (MainThread): 17:52:12  
2022-03-03 17:52:12.577882 (MainThread): 17:52:12  Finished running 1 incremental model in 6.77s.
2022-03-03 17:52:12.577970 (MainThread): 17:52:12  Connection 'master' was properly closed.
2022-03-03 17:52:12.578041 (MainThread): 17:52:12  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:52:12.641908 (MainThread): 17:52:12  
2022-03-03 17:52:12.642114 (MainThread): 17:52:12  Completed successfully
2022-03-03 17:52:12.642215 (MainThread): 17:52:12  
2022-03-03 17:52:12.642311 (MainThread): 17:52:12  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:52:13.491195 (Thread-490): handling poll request
2022-03-03 17:52:13.491542 (Thread-490): 17:52:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516039a1c0>]}
2022-03-03 17:52:13.492701 (Thread-490): sending response (<Response 12254 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:15.183924 (Thread-491): handling status request
2022-03-03 17:52:15.184259 (Thread-491): 17:52:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516039a040>]}
2022-03-03 17:52:15.184838 (Thread-491): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:52:15.444824 (Thread-492): handling status request
2022-03-03 17:52:15.445291 (Thread-492): 17:52:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4fb4af0>]}
2022-03-03 17:52:15.446115 (Thread-492): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:44.125771 (Thread-493): handling status request
2022-03-03 17:53:44.127428 (Thread-493): 17:53:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42efbe0>]}
2022-03-03 17:53:44.127925 (Thread-493): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:44.437447 (Thread-494): handling status request
2022-03-03 17:53:44.437776 (Thread-494): 17:53:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e464b580>]}
2022-03-03 17:53:44.438243 (Thread-494): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:44.752529 (Thread-495): handling cli_args request
2022-03-03 17:53:44.752916 (Thread-495): 17:53:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510457a130>]}
2022-03-03 17:53:47.016734 (Thread-495): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:47.392141 (MainThread): 17:53:47  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:53:47.392586 (MainThread): 17:53:47  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:53:47.400709 (MainThread): 17:53:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03e83e8b-a7b2-4e76-942e-c250d2d93ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee4d3a8e0>]}
2022-03-03 17:53:47.435380 (MainThread): 17:53:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03e83e8b-a7b2-4e76-942e-c250d2d93ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee4e146a0>]}
2022-03-03 17:53:47.435696 (MainThread): 17:53:47  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:53:47.437421 (MainThread): 17:53:47  
2022-03-03 17:53:47.437713 (MainThread): 17:53:47  Acquiring new snowflake connection "master"
2022-03-03 17:53:47.438489 (ThreadPoolExecutor-0_0): 17:53:47  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:53:47.451678 (ThreadPoolExecutor-0_0): 17:53:47  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:53:47.451785 (ThreadPoolExecutor-0_0): 17:53:47  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:53:47.451870 (ThreadPoolExecutor-0_0): 17:53:47  Opening a new connection, currently in state init
2022-03-03 17:53:47.786568 (Thread-496): handling poll request
2022-03-03 17:53:47.787048 (Thread-496): 17:53:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104250460>]}
2022-03-03 17:53:47.787997 (Thread-496): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:48.434201 (ThreadPoolExecutor-0_0): 17:53:48  SQL status: SUCCESS 8 in 0.98 seconds
2022-03-03 17:53:48.437356 (ThreadPoolExecutor-0_0): 17:53:48  On list_DBT_RAW: Close
2022-03-03 17:53:48.674457 (ThreadPoolExecutor-2_0): 17:53:48  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:53:48.741362 (ThreadPoolExecutor-2_0): 17:53:48  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:53:48.741510 (ThreadPoolExecutor-2_0): 17:53:48  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:53:48.741605 (ThreadPoolExecutor-2_0): 17:53:48  Opening a new connection, currently in state closed
2022-03-03 17:53:49.576602 (Thread-497): handling poll request
2022-03-03 17:53:49.576971 (Thread-497): 17:53:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041f5820>]}
2022-03-03 17:53:49.577518 (Thread-497): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:49.676777 (ThreadPoolExecutor-2_0): 17:53:49  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 17:53:49.678984 (ThreadPoolExecutor-2_0): 17:53:49  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:53:49.982367 (MainThread): 17:53:49  Concurrency: 4 threads (target='default')
2022-03-03 17:53:49.982541 (MainThread): 17:53:49  
2022-03-03 17:53:49.985410 (Thread-3): 17:53:49  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:53:49.985726 (Thread-3): 17:53:49  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:53:49.985997 (Thread-3): 17:53:49  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:49.986103 (Thread-3): 17:53:49  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:53:49.986213 (Thread-3): 17:53:49  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:53:50.072145 (Thread-3): 17:53:50  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:50.086353 (Thread-3): 17:53:50  finished collecting timing info
2022-03-03 17:53:50.086548 (Thread-3): 17:53:50  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:53:50.126602 (Thread-3): 17:53:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:50.126733 (Thread-3): 17:53:50  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:53:50.126823 (Thread-3): 17:53:50  Opening a new connection, currently in state closed
2022-03-03 17:53:51.403000 (Thread-498): handling poll request
2022-03-03 17:53:51.403337 (Thread-498): 17:53:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e479d4f0>]}
2022-03-03 17:53:51.404085 (Thread-498): sending response (<Response 7930 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:52.646826 (Thread-3): 17:53:52  SQL status: SUCCESS 1 in 2.52 seconds
2022-03-03 17:53:52.655979 (Thread-3): 17:53:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:52.656122 (Thread-3): 17:53:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 17:53:52.814119 (Thread-3): 17:53:52  SQL status: SUCCESS 9 in 0.16 seconds
2022-03-03 17:53:52.818395 (Thread-3): 17:53:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:52.818514 (Thread-3): 17:53:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 17:53:53.026793 (Thread-3): 17:53:53  SQL status: SUCCESS 9 in 0.21 seconds
2022-03-03 17:53:53.035144 (Thread-3): 17:53:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:53.035263 (Thread-3): 17:53:53  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 17:53:53.193973 (Thread-3): 17:53:53  SQL status: SUCCESS 9 in 0.16 seconds
2022-03-03 17:53:53.209852 (Thread-499): handling poll request
2022-03-03 17:53:53.210162 (Thread-499): 17:53:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041be610>]}
2022-03-03 17:53:53.214703 (Thread-3): 17:53:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:53.233240 (Thread-499): sending response (<Response 5023 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:53.234355 (Thread-3): 17:53:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:53.234492 (Thread-3): 17:53:53  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 17:53:53.389183 (Thread-3): 17:53:53  SQL status: SUCCESS 1 in 0.15 seconds
2022-03-03 17:53:53.389421 (Thread-3): 17:53:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:53.389507 (Thread-3): 17:53:53  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 17:53:54.147737 (Thread-3): 17:53:54  SQL status: SUCCESS 0 in 0.76 seconds
2022-03-03 17:53:54.147942 (Thread-3): 17:53:54  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:53:54.148029 (Thread-3): 17:53:54  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 17:53:54.497562 (Thread-3): 17:53:54  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-03 17:53:54.507346 (Thread-3): 17:53:54  finished collecting timing info
2022-03-03 17:53:54.507514 (Thread-3): 17:53:54  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:53:54.827335 (Thread-3): 17:53:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e83e8b-a7b2-4e76-942e-c250d2d93ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee4d3aeb0>]}
2022-03-03 17:53:54.827776 (Thread-3): 17:53:54  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 4.84s]
2022-03-03 17:53:54.827912 (Thread-3): 17:53:54  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:53:54.829594 (MainThread): 17:53:54  Acquiring new snowflake connection "master"
2022-03-03 17:53:54.829954 (MainThread): 17:53:54  
2022-03-03 17:53:54.830148 (MainThread): 17:53:54  Finished running 1 incremental model in 7.39s.
2022-03-03 17:53:54.830450 (MainThread): 17:53:54  Connection 'master' was properly closed.
2022-03-03 17:53:54.830620 (MainThread): 17:53:54  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:53:54.902085 (MainThread): 17:53:54  
2022-03-03 17:53:54.902307 (MainThread): 17:53:54  Completed successfully
2022-03-03 17:53:54.902496 (MainThread): 17:53:54  
2022-03-03 17:53:54.902678 (MainThread): 17:53:54  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:53:55.035350 (Thread-500): handling poll request
2022-03-03 17:53:55.035683 (Thread-500): 17:53:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4d4bbe0>]}
2022-03-03 17:53:55.036437 (Thread-500): sending response (<Response 10353 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:56.848775 (Thread-501): handling poll request
2022-03-03 17:53:56.849114 (Thread-501): 17:53:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4d4b340>]}
2022-03-03 17:53:56.849980 (Thread-501): sending response (<Response 5492 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:58.848462 (Thread-502): handling status request
2022-03-03 17:53:58.848822 (Thread-502): 17:53:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4d4b460>]}
2022-03-03 17:53:58.849376 (Thread-502): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:53:58.851233 (Thread-503): handling status request
2022-03-03 17:53:58.851514 (Thread-503): 17:53:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4d4bc70>]}
2022-03-03 17:53:58.851922 (Thread-503): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:23.706140 (Thread-504): handling status request
2022-03-03 17:55:23.707847 (Thread-504): 17:55:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4631ac0>]}
2022-03-03 17:55:23.708349 (Thread-504): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:23.998586 (Thread-505): handling status request
2022-03-03 17:55:23.999327 (Thread-505): 17:55:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4d4be50>]}
2022-03-03 17:55:23.999825 (Thread-505): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:24.236352 (Thread-506): handling cli_args request
2022-03-03 17:55:24.236729 (Thread-506): 17:55:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43f7eb0>]}
2022-03-03 17:55:26.463971 (Thread-506): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:26.842581 (MainThread): 17:55:26  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:55:26.843028 (MainThread): 17:55:26  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:55:26.850772 (MainThread): 17:55:26  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2125e060-59e1-43e4-b67b-6dfebbacb247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24da3a940>]}
2022-03-03 17:55:26.885543 (MainThread): 17:55:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2125e060-59e1-43e4-b67b-6dfebbacb247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24db1a700>]}
2022-03-03 17:55:26.885797 (MainThread): 17:55:26  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:55:26.887490 (MainThread): 17:55:26  
2022-03-03 17:55:26.887776 (MainThread): 17:55:26  Acquiring new snowflake connection "master"
2022-03-03 17:55:26.888555 (ThreadPoolExecutor-0_0): 17:55:26  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:55:26.901799 (ThreadPoolExecutor-0_0): 17:55:26  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:55:26.901906 (ThreadPoolExecutor-0_0): 17:55:26  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:55:26.901990 (ThreadPoolExecutor-0_0): 17:55:26  Opening a new connection, currently in state init
2022-03-03 17:55:27.261553 (Thread-507): handling poll request
2022-03-03 17:55:27.261954 (Thread-507): 17:55:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e43f7fd0>]}
2022-03-03 17:55:27.262895 (Thread-507): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:28.095483 (ThreadPoolExecutor-0_0): 17:55:28  SQL status: SUCCESS 8 in 1.19 seconds
2022-03-03 17:55:28.097587 (ThreadPoolExecutor-0_0): 17:55:28  On list_DBT_RAW: Close
2022-03-03 17:55:28.315398 (ThreadPoolExecutor-2_0): 17:55:28  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:55:28.374904 (ThreadPoolExecutor-2_0): 17:55:28  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:55:28.375062 (ThreadPoolExecutor-2_0): 17:55:28  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:55:28.375162 (ThreadPoolExecutor-2_0): 17:55:28  Opening a new connection, currently in state closed
2022-03-03 17:55:29.049458 (Thread-508): handling poll request
2022-03-03 17:55:29.049813 (Thread-508): 17:55:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042504c0>]}
2022-03-03 17:55:29.050416 (Thread-508): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:29.311806 (ThreadPoolExecutor-2_0): 17:55:29  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 17:55:29.314067 (ThreadPoolExecutor-2_0): 17:55:29  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:55:30.732039 (MainThread): 17:55:30  Concurrency: 4 threads (target='default')
2022-03-03 17:55:30.732243 (MainThread): 17:55:30  
2022-03-03 17:55:30.735097 (Thread-3): 17:55:30  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:55:30.735388 (Thread-3): 17:55:30  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:55:30.735637 (Thread-3): 17:55:30  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:30.735737 (Thread-3): 17:55:30  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:55:30.735843 (Thread-3): 17:55:30  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:55:30.821933 (Thread-3): 17:55:30  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:30.836832 (Thread-3): 17:55:30  finished collecting timing info
2022-03-03 17:55:30.837015 (Thread-3): 17:55:30  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:55:30.878124 (Thread-3): 17:55:30  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:30.878286 (Thread-3): 17:55:30  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:55:30.878382 (Thread-3): 17:55:30  Opening a new connection, currently in state closed
2022-03-03 17:55:30.962363 (Thread-509): handling poll request
2022-03-03 17:55:30.962701 (Thread-509): 17:55:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4ce9f70>]}
2022-03-03 17:55:30.963427 (Thread-509): sending response (<Response 7930 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:32.802289 (Thread-510): handling poll request
2022-03-03 17:55:32.802647 (Thread-510): 17:55:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4ce9dc0>]}
2022-03-03 17:55:32.803159 (Thread-510): sending response (<Response 317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:34.668238 (Thread-511): handling poll request
2022-03-03 17:55:34.668580 (Thread-511): 17:55:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4ce9490>]}
2022-03-03 17:55:34.669127 (Thread-511): sending response (<Response 319 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:35.551002 (Thread-3): 17:55:35  SQL status: SUCCESS 1 in 4.67 seconds
2022-03-03 17:55:35.560251 (Thread-3): 17:55:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:35.560402 (Thread-3): 17:55:35  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 17:55:35.976342 (Thread-3): 17:55:35  SQL status: SUCCESS 9 in 0.42 seconds
2022-03-03 17:55:35.980672 (Thread-3): 17:55:35  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:35.980819 (Thread-3): 17:55:35  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 17:55:36.187176 (Thread-3): 17:55:36  SQL status: SUCCESS 9 in 0.21 seconds
2022-03-03 17:55:36.195338 (Thread-3): 17:55:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:36.195470 (Thread-3): 17:55:36  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 17:55:36.316301 (Thread-3): 17:55:36  SQL status: SUCCESS 9 in 0.12 seconds
2022-03-03 17:55:36.337297 (Thread-3): 17:55:36  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:36.355480 (Thread-3): 17:55:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:36.355618 (Thread-3): 17:55:36  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 17:55:36.549391 (Thread-512): handling poll request
2022-03-03 17:55:36.549741 (Thread-512): 17:55:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47c3370>]}
2022-03-03 17:55:36.550404 (Thread-512): sending response (<Response 5950 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:36.682295 (Thread-3): 17:55:36  SQL status: SUCCESS 1 in 0.33 seconds
2022-03-03 17:55:36.682541 (Thread-3): 17:55:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:36.682631 (Thread-3): 17:55:36  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 17:55:37.304857 (Thread-3): 17:55:37  SQL status: SUCCESS 0 in 0.62 seconds
2022-03-03 17:55:37.305057 (Thread-3): 17:55:37  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:55:37.305141 (Thread-3): 17:55:37  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 17:55:37.694855 (Thread-3): 17:55:37  SQL status: SUCCESS 1 in 0.39 seconds
2022-03-03 17:55:37.704772 (Thread-3): 17:55:37  finished collecting timing info
2022-03-03 17:55:37.704946 (Thread-3): 17:55:37  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:55:38.025864 (Thread-3): 17:55:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2125e060-59e1-43e4-b67b-6dfebbacb247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24c3b17f0>]}
2022-03-03 17:55:38.026311 (Thread-3): 17:55:38  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 7.29s]
2022-03-03 17:55:38.026443 (Thread-3): 17:55:38  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:55:38.028108 (MainThread): 17:55:38  Acquiring new snowflake connection "master"
2022-03-03 17:55:38.028458 (MainThread): 17:55:38  
2022-03-03 17:55:38.028562 (MainThread): 17:55:38  Finished running 1 incremental model in 11.14s.
2022-03-03 17:55:38.028683 (MainThread): 17:55:38  Connection 'master' was properly closed.
2022-03-03 17:55:38.028760 (MainThread): 17:55:38  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:55:38.096397 (MainThread): 17:55:38  
2022-03-03 17:55:38.096586 (MainThread): 17:55:38  Completed successfully
2022-03-03 17:55:38.096726 (MainThread): 17:55:38  
2022-03-03 17:55:38.096826 (MainThread): 17:55:38  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:55:38.346487 (Thread-513): handling poll request
2022-03-03 17:55:38.346838 (Thread-513): 17:55:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104115670>]}
2022-03-03 17:55:38.348136 (Thread-513): sending response (<Response 14602 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:40.116233 (Thread-514): handling status request
2022-03-03 17:55:40.116623 (Thread-514): 17:55:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e47c3970>]}
2022-03-03 17:55:40.117206 (Thread-514): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:55:40.343365 (Thread-515): handling status request
2022-03-03 17:55:40.343869 (Thread-515): 17:55:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104115fa0>]}
2022-03-03 17:55:40.344374 (Thread-515): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:56:31.593457 (Thread-516): 17:56:31  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:56:31.593995 (Thread-516): 17:56:31  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:56:31.601163 (Thread-516): 17:56:31  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:56:33.329213 (Thread-517): handling status request
2022-03-03 17:56:33.329556 (Thread-517): 17:56:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104115370>]}
2022-03-03 17:56:33.330039 (Thread-517): sending response (<Response 1335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:56:33.343014 (Thread-518): handling status request
2022-03-03 17:56:33.343243 (Thread-518): 17:56:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510422c1c0>]}
2022-03-03 17:56:33.343631 (Thread-518): sending response (<Response 1335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:56:42.272844 (Thread-519): 17:56:42  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:56:42.273346 (Thread-519): 17:56:42  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:56:42.279147 (Thread-519): 17:56:42  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:56:43.548132 (Thread-520): handling status request
2022-03-03 17:56:43.548505 (Thread-520): 17:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510423ee80>]}
2022-03-03 17:56:43.549028 (Thread-520): sending response (<Response 1335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:56:43.715058 (Thread-521): handling status request
2022-03-03 17:56:43.715399 (Thread-521): 17:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510405ca90>]}
2022-03-03 17:56:43.715880 (Thread-521): sending response (<Response 1335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:56:57.236055 (Thread-522): 17:56:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:56:57.236569 (Thread-522): 17:56:57  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:56:57.243056 (Thread-522): 17:56:57  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:56:58.172481 (Thread-523): handling status request
2022-03-03 17:56:58.172878 (Thread-523): 17:56:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4e702b0>]}
2022-03-03 17:56:58.173364 (Thread-523): sending response (<Response 1335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:56:58.482738 (Thread-524): handling status request
2022-03-03 17:56:58.483085 (Thread-524): 17:56:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4be4b20>]}
2022-03-03 17:56:58.483563 (Thread-524): sending response (<Response 1335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:07.282973 (Thread-525): 17:57:07  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:57:07.283456 (Thread-525): 17:57:07  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:57:07.289384 (Thread-525): 17:57:07  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:57:07.301105 (Thread-525): 17:57:07  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:57:07.351707 (Thread-525): 17:57:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe9b5e0>]}
2022-03-03 17:57:08.476024 (Thread-526): handling status request
2022-03-03 17:57:08.476365 (Thread-526): 17:57:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41cd3a0>]}
2022-03-03 17:57:08.476926 (Thread-526): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:08.984875 (Thread-527): handling status request
2022-03-03 17:57:08.985221 (Thread-527): 17:57:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c413dc70>]}
2022-03-03 17:57:08.985830 (Thread-527): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:14.043872 (Thread-528): handling status request
2022-03-03 17:57:14.044244 (Thread-528): 17:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4eb6be0>]}
2022-03-03 17:57:14.044763 (Thread-528): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:14.827213 (Thread-529): handling cli_args request
2022-03-03 17:57:14.827920 (Thread-530): handling status request
2022-03-03 17:57:14.828278 (Thread-529): 17:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c416d220>]}
2022-03-03 17:57:14.828544 (Thread-530): 17:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff72640>]}
2022-03-03 17:57:14.830075 (Thread-530): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:17.058237 (Thread-529): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:17.346991 (MainThread): 17:57:17  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:57:17.347446 (MainThread): 17:57:17  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:57:17.355241 (MainThread): 17:57:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31b508be-43b4-4cfd-9ee8-af0b0ef2da7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4018f7a8e0>]}
2022-03-03 17:57:17.390754 (MainThread): 17:57:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31b508be-43b4-4cfd-9ee8-af0b0ef2da7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40190546a0>]}
2022-03-03 17:57:17.391023 (MainThread): 17:57:17  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:57:17.392920 (MainThread): 17:57:17  
2022-03-03 17:57:17.393219 (MainThread): 17:57:17  Acquiring new snowflake connection "master"
2022-03-03 17:57:17.394073 (ThreadPoolExecutor-0_0): 17:57:17  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:57:17.407950 (ThreadPoolExecutor-0_0): 17:57:17  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:57:17.408060 (ThreadPoolExecutor-0_0): 17:57:17  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:57:17.408145 (ThreadPoolExecutor-0_0): 17:57:17  Opening a new connection, currently in state init
2022-03-03 17:57:17.932547 (Thread-531): handling poll request
2022-03-03 17:57:17.932987 (Thread-531): 17:57:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff72850>]}
2022-03-03 17:57:17.933936 (Thread-531): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:18.332307 (ThreadPoolExecutor-0_0): 17:57:18  SQL status: SUCCESS 8 in 0.92 seconds
2022-03-03 17:57:18.334361 (ThreadPoolExecutor-0_0): 17:57:18  On list_DBT_RAW: Close
2022-03-03 17:57:18.541849 (ThreadPoolExecutor-2_0): 17:57:18  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:57:18.606368 (ThreadPoolExecutor-2_0): 17:57:18  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:57:18.606531 (ThreadPoolExecutor-2_0): 17:57:18  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:57:18.606639 (ThreadPoolExecutor-2_0): 17:57:18  Opening a new connection, currently in state closed
2022-03-03 17:57:19.288268 (ThreadPoolExecutor-2_0): 17:57:19  SQL status: SUCCESS 34 in 0.68 seconds
2022-03-03 17:57:19.291094 (ThreadPoolExecutor-2_0): 17:57:19  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:57:19.521719 (MainThread): 17:57:19  Concurrency: 4 threads (target='default')
2022-03-03 17:57:19.521890 (MainThread): 17:57:19  
2022-03-03 17:57:19.524726 (Thread-3): 17:57:19  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:57:19.525029 (Thread-3): 17:57:19  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:57:19.525288 (Thread-3): 17:57:19  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:19.525388 (Thread-3): 17:57:19  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:57:19.525509 (Thread-3): 17:57:19  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:57:19.613240 (Thread-3): 17:57:19  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:19.626794 (Thread-3): 17:57:19  finished collecting timing info
2022-03-03 17:57:19.626991 (Thread-3): 17:57:19  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:57:19.668606 (Thread-3): 17:57:19  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:19.668785 (Thread-3): 17:57:19  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:57:19.668877 (Thread-3): 17:57:19  Opening a new connection, currently in state closed
2022-03-03 17:57:19.712034 (Thread-532): handling poll request
2022-03-03 17:57:19.712393 (Thread-532): 17:57:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff37f70>]}
2022-03-03 17:57:19.736329 (Thread-532): sending response (<Response 9929 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:21.612205 (Thread-533): handling poll request
2022-03-03 17:57:21.612539 (Thread-533): 17:57:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff2bc40>]}
2022-03-03 17:57:21.613165 (Thread-533): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:22.960317 (Thread-3): 17:57:22  SQL status: SUCCESS 1 in 3.29 seconds
2022-03-03 17:57:22.969718 (Thread-3): 17:57:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:22.969866 (Thread-3): 17:57:22  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 17:57:23.147963 (Thread-3): 17:57:23  SQL status: SUCCESS 9 in 0.18 seconds
2022-03-03 17:57:23.151900 (Thread-3): 17:57:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:23.152024 (Thread-3): 17:57:23  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 17:57:23.311534 (Thread-3): 17:57:23  SQL status: SUCCESS 9 in 0.16 seconds
2022-03-03 17:57:23.319893 (Thread-3): 17:57:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:23.320023 (Thread-3): 17:57:23  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 17:57:23.409840 (Thread-534): handling poll request
2022-03-03 17:57:23.410239 (Thread-534): 17:57:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff31790>]}
2022-03-03 17:57:23.410852 (Thread-534): sending response (<Response 4293 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:23.444997 (Thread-3): 17:57:23  SQL status: SUCCESS 9 in 0.12 seconds
2022-03-03 17:57:23.466198 (Thread-3): 17:57:23  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:23.479219 (Thread-3): 17:57:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:23.479370 (Thread-3): 17:57:23  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 17:57:23.641993 (Thread-3): 17:57:23  SQL status: SUCCESS 1 in 0.16 seconds
2022-03-03 17:57:23.642374 (Thread-3): 17:57:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:23.642545 (Thread-3): 17:57:23  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 17:57:24.048560 (Thread-3): 17:57:24  SQL status: SUCCESS 0 in 0.41 seconds
2022-03-03 17:57:24.048808 (Thread-3): 17:57:24  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:57:24.048901 (Thread-3): 17:57:24  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 17:57:24.299539 (Thread-3): 17:57:24  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 17:57:24.309683 (Thread-3): 17:57:24  finished collecting timing info
2022-03-03 17:57:24.309870 (Thread-3): 17:57:24  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:57:24.548087 (Thread-3): 17:57:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b508be-43b4-4cfd-9ee8-af0b0ef2da7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40180ecee0>]}
2022-03-03 17:57:24.548540 (Thread-3): 17:57:24  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.02s]
2022-03-03 17:57:24.548723 (Thread-3): 17:57:24  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:57:24.550432 (MainThread): 17:57:24  Acquiring new snowflake connection "master"
2022-03-03 17:57:24.550768 (MainThread): 17:57:24  
2022-03-03 17:57:24.550875 (MainThread): 17:57:24  Finished running 1 incremental model in 7.16s.
2022-03-03 17:57:24.550965 (MainThread): 17:57:24  Connection 'master' was properly closed.
2022-03-03 17:57:24.551038 (MainThread): 17:57:24  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:57:24.616728 (MainThread): 17:57:24  
2022-03-03 17:57:24.616968 (MainThread): 17:57:24  Completed successfully
2022-03-03 17:57:24.617075 (MainThread): 17:57:24  
2022-03-03 17:57:24.617175 (MainThread): 17:57:24  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:57:25.326346 (Thread-535): handling poll request
2022-03-03 17:57:25.326704 (Thread-535): 17:57:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41b90a0>]}
2022-03-03 17:57:25.327918 (Thread-535): sending response (<Response 16310 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:27.108553 (Thread-536): handling status request
2022-03-03 17:57:27.108949 (Thread-536): 17:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41b9250>]}
2022-03-03 17:57:27.109483 (Thread-536): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:57:27.119403 (Thread-537): handling status request
2022-03-03 17:57:27.119630 (Thread-537): 17:57:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41b9640>]}
2022-03-03 17:57:27.120003 (Thread-537): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:30.640790 (Thread-538): handling status request
2022-03-03 17:58:30.642687 (Thread-538): 17:58:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41b9880>]}
2022-03-03 17:58:30.643232 (Thread-538): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:31.535770 (Thread-539): handling status request
2022-03-03 17:58:31.536099 (Thread-539): 17:58:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41b9af0>]}
2022-03-03 17:58:31.536586 (Thread-539): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:31.537624 (Thread-540): handling cli_args request
2022-03-03 17:58:31.537941 (Thread-540): 17:58:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff6ee50>]}
2022-03-03 17:58:33.805110 (Thread-540): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:34.173654 (MainThread): 17:58:34  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:58:34.174087 (MainThread): 17:58:34  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:58:34.182302 (MainThread): 17:58:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dac43ea-eef9-4c89-97ad-805157166ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb2dfa9d0>]}
2022-03-03 17:58:34.217452 (MainThread): 17:58:34  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dac43ea-eef9-4c89-97ad-805157166ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb2eda790>]}
2022-03-03 17:58:34.217728 (MainThread): 17:58:34  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:58:34.219516 (MainThread): 17:58:34  
2022-03-03 17:58:34.219832 (MainThread): 17:58:34  Acquiring new snowflake connection "master"
2022-03-03 17:58:34.220723 (ThreadPoolExecutor-0_0): 17:58:34  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:58:34.234623 (ThreadPoolExecutor-0_0): 17:58:34  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:58:34.234732 (ThreadPoolExecutor-0_0): 17:58:34  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:58:34.234818 (ThreadPoolExecutor-0_0): 17:58:34  Opening a new connection, currently in state init
2022-03-03 17:58:34.640469 (Thread-541): handling poll request
2022-03-03 17:58:34.640921 (Thread-541): 17:58:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4044940>]}
2022-03-03 17:58:34.641844 (Thread-541): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:35.233392 (ThreadPoolExecutor-0_0): 17:58:35  SQL status: SUCCESS 8 in 1.0 seconds
2022-03-03 17:58:35.235483 (ThreadPoolExecutor-0_0): 17:58:35  On list_DBT_RAW: Close
2022-03-03 17:58:35.911648 (ThreadPoolExecutor-2_0): 17:58:35  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:58:35.978142 (ThreadPoolExecutor-2_0): 17:58:35  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:58:35.978308 (ThreadPoolExecutor-2_0): 17:58:35  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:58:35.978411 (ThreadPoolExecutor-2_0): 17:58:35  Opening a new connection, currently in state closed
2022-03-03 17:58:36.476768 (Thread-542): handling poll request
2022-03-03 17:58:36.477106 (Thread-542): 17:58:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4044ee0>]}
2022-03-03 17:58:36.477655 (Thread-542): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:36.666855 (ThreadPoolExecutor-2_0): 17:58:36  SQL status: SUCCESS 33 in 0.69 seconds
2022-03-03 17:58:36.669158 (ThreadPoolExecutor-2_0): 17:58:36  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:58:36.872461 (MainThread): 17:58:36  Concurrency: 4 threads (target='default')
2022-03-03 17:58:36.872665 (MainThread): 17:58:36  
2022-03-03 17:58:36.875648 (Thread-3): 17:58:36  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:58:36.875968 (Thread-3): 17:58:36  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:58:36.876243 (Thread-3): 17:58:36  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:58:36.876351 (Thread-3): 17:58:36  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:58:36.876463 (Thread-3): 17:58:36  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:58:36.960117 (Thread-3): 17:58:36  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:58:36.974592 (Thread-3): 17:58:36  finished collecting timing info
2022-03-03 17:58:36.974784 (Thread-3): 17:58:36  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:58:37.016903 (Thread-3): 17:58:37  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:58:37.034080 (Thread-3): 17:58:37  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:58:37.034226 (Thread-3): 17:58:37  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace transient table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:58:37.034320 (Thread-3): 17:58:37  Opening a new connection, currently in state closed
2022-03-03 17:58:38.317825 (Thread-543): handling poll request
2022-03-03 17:58:38.318172 (Thread-543): 17:58:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41b9d90>]}
2022-03-03 17:58:38.318942 (Thread-543): sending response (<Response 7363 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:39.771627 (Thread-3): 17:58:39  SQL status: SUCCESS 1 in 2.74 seconds
2022-03-03 17:58:39.781489 (Thread-3): 17:58:39  finished collecting timing info
2022-03-03 17:58:39.781698 (Thread-3): 17:58:39  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:58:40.026335 (Thread-3): 17:58:40  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dac43ea-eef9-4c89-97ad-805157166ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb25b3280>]}
2022-03-03 17:58:40.026796 (Thread-3): 17:58:40  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 3.15s]
2022-03-03 17:58:40.026932 (Thread-3): 17:58:40  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:58:40.028699 (MainThread): 17:58:40  Acquiring new snowflake connection "master"
2022-03-03 17:58:40.029041 (MainThread): 17:58:40  
2022-03-03 17:58:40.029147 (MainThread): 17:58:40  Finished running 1 incremental model in 5.81s.
2022-03-03 17:58:40.029236 (MainThread): 17:58:40  Connection 'master' was properly closed.
2022-03-03 17:58:40.029309 (MainThread): 17:58:40  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:58:40.093536 (MainThread): 17:58:40  
2022-03-03 17:58:40.093877 (MainThread): 17:58:40  Completed successfully
2022-03-03 17:58:40.094087 (MainThread): 17:58:40  
2022-03-03 17:58:40.094262 (MainThread): 17:58:40  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:58:40.128134 (Thread-544): handling poll request
2022-03-03 17:58:40.128482 (Thread-544): 17:58:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe93580>]}
2022-03-03 17:58:40.129188 (Thread-544): sending response (<Response 5989 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:42.001894 (Thread-545): handling poll request
2022-03-03 17:58:42.002252 (Thread-545): 17:58:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe93c10>]}
2022-03-03 17:58:42.003204 (Thread-545): sending response (<Response 4495 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:43.723052 (Thread-546): handling status request
2022-03-03 17:58:43.723409 (Thread-546): 17:58:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41a3100>]}
2022-03-03 17:58:43.723975 (Thread-546): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:58:44.167500 (Thread-547): handling status request
2022-03-03 17:58:44.167857 (Thread-547): 17:58:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41a3a30>]}
2022-03-03 17:58:44.168336 (Thread-547): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:01.985717 (Thread-548): 17:59:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:59:01.986324 (Thread-548): 17:59:01  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:59:01.992952 (Thread-548): 17:59:01  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:59:02.004710 (Thread-548): 17:59:02  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:59:02.060506 (Thread-548): 17:59:02  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afcf8df0>]}
2022-03-03 17:59:03.215172 (Thread-549): handling status request
2022-03-03 17:59:03.215524 (Thread-549): 17:59:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afea9e20>]}
2022-03-03 17:59:03.216033 (Thread-549): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:03.627275 (Thread-550): handling status request
2022-03-03 17:59:03.627635 (Thread-550): 17:59:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff6be80>]}
2022-03-03 17:59:03.628138 (Thread-550): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:06.381039 (Thread-551): handling status request
2022-03-03 17:59:06.381371 (Thread-551): 17:59:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd2d880>]}
2022-03-03 17:59:06.381857 (Thread-551): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:06.707742 (Thread-552): handling status request
2022-03-03 17:59:06.708092 (Thread-552): 17:59:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd2d6d0>]}
2022-03-03 17:59:06.708600 (Thread-552): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:07.018574 (Thread-553): handling cli_args request
2022-03-03 17:59:07.018912 (Thread-553): 17:59:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd2df40>]}
2022-03-03 17:59:09.410359 (Thread-553): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:09.726567 (MainThread): 17:59:09  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:59:09.727071 (MainThread): 17:59:09  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:59:09.735091 (MainThread): 17:59:09  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22d5fc0c-b2d7-4f6b-83bf-a59de415fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424f77a910>]}
2022-03-03 17:59:09.770501 (MainThread): 17:59:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22d5fc0c-b2d7-4f6b-83bf-a59de415fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424f85a6d0>]}
2022-03-03 17:59:09.770812 (MainThread): 17:59:09  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:59:09.772604 (MainThread): 17:59:09  
2022-03-03 17:59:09.772977 (MainThread): 17:59:09  Acquiring new snowflake connection "master"
2022-03-03 17:59:09.773826 (ThreadPoolExecutor-0_0): 17:59:09  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:59:09.787493 (ThreadPoolExecutor-0_0): 17:59:09  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:59:09.787601 (ThreadPoolExecutor-0_0): 17:59:09  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:59:09.787684 (ThreadPoolExecutor-0_0): 17:59:09  Opening a new connection, currently in state init
2022-03-03 17:59:10.213900 (Thread-554): handling poll request
2022-03-03 17:59:10.214337 (Thread-554): 17:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd2d670>]}
2022-03-03 17:59:10.215335 (Thread-554): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:10.781594 (ThreadPoolExecutor-0_0): 17:59:10  SQL status: SUCCESS 8 in 0.99 seconds
2022-03-03 17:59:10.784239 (ThreadPoolExecutor-0_0): 17:59:10  On list_DBT_RAW: Close
2022-03-03 17:59:11.249245 (ThreadPoolExecutor-2_0): 17:59:11  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:59:11.314347 (ThreadPoolExecutor-2_0): 17:59:11  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:59:11.314510 (ThreadPoolExecutor-2_0): 17:59:11  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:59:11.314609 (ThreadPoolExecutor-2_0): 17:59:11  Opening a new connection, currently in state init
2022-03-03 17:59:12.002861 (Thread-555): handling poll request
2022-03-03 17:59:12.003204 (Thread-555): 17:59:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41765e0>]}
2022-03-03 17:59:12.003778 (Thread-555): sending response (<Response 2313 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:12.258536 (ThreadPoolExecutor-2_0): 17:59:12  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 17:59:12.261539 (ThreadPoolExecutor-2_0): 17:59:12  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:59:12.483795 (MainThread): 17:59:12  Concurrency: 4 threads (target='default')
2022-03-03 17:59:12.483990 (MainThread): 17:59:12  
2022-03-03 17:59:12.487070 (Thread-3): 17:59:12  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:12.487412 (Thread-3): 17:59:12  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:59:12.487702 (Thread-3): 17:59:12  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:12.487817 (Thread-3): 17:59:12  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:12.487932 (Thread-3): 17:59:12  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:12.577781 (Thread-3): 17:59:12  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:12.589616 (Thread-3): 17:59:12  finished collecting timing info
2022-03-03 17:59:12.589820 (Thread-3): 17:59:12  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:12.632000 (Thread-3): 17:59:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:12.632161 (Thread-3): 17:59:12  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:59:12.632255 (Thread-3): 17:59:12  Opening a new connection, currently in state closed
2022-03-03 17:59:13.808025 (Thread-556): handling poll request
2022-03-03 17:59:13.808477 (Thread-556): 17:59:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe8e4c0>]}
2022-03-03 17:59:13.809483 (Thread-556): sending response (<Response 7930 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:15.611661 (Thread-557): handling poll request
2022-03-03 17:59:15.612002 (Thread-557): 17:59:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd35580>]}
2022-03-03 17:59:15.612539 (Thread-557): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:16.063410 (Thread-3): 17:59:16  SQL status: SUCCESS 1 in 3.43 seconds
2022-03-03 17:59:16.075149 (Thread-3): 17:59:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:16.075307 (Thread-3): 17:59:16  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 17:59:16.233890 (Thread-3): 17:59:16  SQL status: SUCCESS 9 in 0.16 seconds
2022-03-03 17:59:16.237873 (Thread-3): 17:59:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:16.237992 (Thread-3): 17:59:16  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 17:59:16.389962 (Thread-3): 17:59:16  SQL status: SUCCESS 9 in 0.15 seconds
2022-03-03 17:59:16.399952 (Thread-3): 17:59:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:16.400093 (Thread-3): 17:59:16  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 17:59:16.577389 (Thread-3): 17:59:16  SQL status: SUCCESS 9 in 0.18 seconds
2022-03-03 17:59:16.600353 (Thread-3): 17:59:16  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:16.614777 (Thread-3): 17:59:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:16.614974 (Thread-3): 17:59:16  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 17:59:16.861972 (Thread-3): 17:59:16  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 17:59:16.862219 (Thread-3): 17:59:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:16.862307 (Thread-3): 17:59:16  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 17:59:17.432220 (Thread-558): handling poll request
2022-03-03 17:59:17.432564 (Thread-558): 17:59:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd35f40>]}
2022-03-03 17:59:17.433290 (Thread-558): sending response (<Response 8295 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:17.690773 (Thread-3): 17:59:17  SQL status: SUCCESS 0 in 0.83 seconds
2022-03-03 17:59:17.690987 (Thread-3): 17:59:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:17.691082 (Thread-3): 17:59:17  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 17:59:18.030335 (Thread-3): 17:59:18  SQL status: SUCCESS 1 in 0.34 seconds
2022-03-03 17:59:18.041341 (Thread-3): 17:59:18  finished collecting timing info
2022-03-03 17:59:18.041560 (Thread-3): 17:59:18  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:59:18.361290 (Thread-3): 17:59:18  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d5fc0c-b2d7-4f6b-83bf-a59de415fb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424f8e79a0>]}
2022-03-03 17:59:18.361915 (Thread-3): 17:59:18  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.87s]
2022-03-03 17:59:18.362051 (Thread-3): 17:59:18  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:18.363641 (MainThread): 17:59:18  Acquiring new snowflake connection "master"
2022-03-03 17:59:18.363955 (MainThread): 17:59:18  
2022-03-03 17:59:18.364059 (MainThread): 17:59:18  Finished running 1 incremental model in 8.59s.
2022-03-03 17:59:18.364143 (MainThread): 17:59:18  Connection 'master' was properly closed.
2022-03-03 17:59:18.364212 (MainThread): 17:59:18  Connection 'list_DBT_RAW' was properly closed.
2022-03-03 17:59:18.364276 (MainThread): 17:59:18  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:59:18.432679 (MainThread): 17:59:18  
2022-03-03 17:59:18.432910 (MainThread): 17:59:18  Completed successfully
2022-03-03 17:59:18.433024 (MainThread): 17:59:18  
2022-03-03 17:59:18.433145 (MainThread): 17:59:18  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:59:19.281440 (Thread-559): handling poll request
2022-03-03 17:59:19.281787 (Thread-559): 17:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe79a30>]}
2022-03-03 17:59:19.282870 (Thread-559): sending response (<Response 12606 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:20.994858 (Thread-560): handling status request
2022-03-03 17:59:20.995331 (Thread-560): 17:59:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe79be0>]}
2022-03-03 17:59:20.996064 (Thread-560): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:21.187860 (Thread-561): handling status request
2022-03-03 17:59:21.188219 (Thread-561): 17:59:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afe79fa0>]}
2022-03-03 17:59:21.188734 (Thread-561): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:38.716773 (Thread-562): 17:59:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 17:59:38.717346 (Thread-562): 17:59:38  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:59:38.723691 (Thread-562): 17:59:38  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:59:38.734868 (Thread-562): 17:59:38  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 17:59:38.787774 (Thread-562): 17:59:38  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afbd4430>]}
2022-03-03 17:59:39.715322 (Thread-563): handling status request
2022-03-03 17:59:39.715681 (Thread-563): 17:59:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afcf4340>]}
2022-03-03 17:59:39.716225 (Thread-563): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:39.992083 (Thread-564): handling status request
2022-03-03 17:59:39.992432 (Thread-564): 17:59:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afea34f0>]}
2022-03-03 17:59:39.992980 (Thread-564): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:43.057483 (Thread-565): handling status request
2022-03-03 17:59:43.057837 (Thread-565): 17:59:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afbe90a0>]}
2022-03-03 17:59:43.058344 (Thread-565): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:43.400985 (Thread-566): handling status request
2022-03-03 17:59:43.401314 (Thread-566): 17:59:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afedcf10>]}
2022-03-03 17:59:43.401815 (Thread-566): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:43.753749 (Thread-567): handling cli_args request
2022-03-03 17:59:43.754091 (Thread-567): 17:59:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afbd4430>]}
2022-03-03 17:59:45.963165 (Thread-567): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:46.252979 (MainThread): 17:59:46  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 17:59:46.253413 (MainThread): 17:59:46  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 17:59:46.261058 (MainThread): 17:59:46  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5f4dde-d6da-44b6-8a57-3d9b529b5714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7767ba9a0>]}
2022-03-03 17:59:46.296724 (MainThread): 17:59:46  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5f4dde-d6da-44b6-8a57-3d9b529b5714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77689a760>]}
2022-03-03 17:59:46.296980 (MainThread): 17:59:46  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 17:59:46.298572 (MainThread): 17:59:46  
2022-03-03 17:59:46.298861 (MainThread): 17:59:46  Acquiring new snowflake connection "master"
2022-03-03 17:59:46.299638 (ThreadPoolExecutor-0_0): 17:59:46  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 17:59:46.312791 (ThreadPoolExecutor-0_0): 17:59:46  Using snowflake connection "list_DBT_RAW"
2022-03-03 17:59:46.312899 (ThreadPoolExecutor-0_0): 17:59:46  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 17:59:46.312985 (ThreadPoolExecutor-0_0): 17:59:46  Opening a new connection, currently in state init
2022-03-03 17:59:46.837010 (Thread-568): handling poll request
2022-03-03 17:59:46.837414 (Thread-568): 17:59:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afbdbc10>]}
2022-03-03 17:59:46.838336 (Thread-568): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:47.282471 (ThreadPoolExecutor-0_0): 17:59:47  SQL status: SUCCESS 8 in 0.97 seconds
2022-03-03 17:59:47.284480 (ThreadPoolExecutor-0_0): 17:59:47  On list_DBT_RAW: Close
2022-03-03 17:59:47.509974 (ThreadPoolExecutor-2_0): 17:59:47  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:59:47.569337 (ThreadPoolExecutor-2_0): 17:59:47  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 17:59:47.569487 (ThreadPoolExecutor-2_0): 17:59:47  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 17:59:47.569586 (ThreadPoolExecutor-2_0): 17:59:47  Opening a new connection, currently in state closed
2022-03-03 17:59:48.273607 (ThreadPoolExecutor-2_0): 17:59:48  SQL status: SUCCESS 34 in 0.7 seconds
2022-03-03 17:59:48.275881 (ThreadPoolExecutor-2_0): 17:59:48  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 17:59:48.510543 (MainThread): 17:59:48  Concurrency: 4 threads (target='default')
2022-03-03 17:59:48.510719 (MainThread): 17:59:48  
2022-03-03 17:59:48.513566 (Thread-3): 17:59:48  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:48.513882 (Thread-3): 17:59:48  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 17:59:48.514153 (Thread-3): 17:59:48  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:48.514260 (Thread-3): 17:59:48  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:48.514368 (Thread-3): 17:59:48  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:48.601118 (Thread-3): 17:59:48  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:48.620214 (Thread-569): handling poll request
2022-03-03 17:59:48.620527 (Thread-569): 17:59:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb3cee0>]}
2022-03-03 17:59:48.621250 (Thread-569): sending response (<Response 6124 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:48.615844 (Thread-3): 17:59:48  finished collecting timing info
2022-03-03 17:59:48.616017 (Thread-3): 17:59:48  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:48.657149 (Thread-3): 17:59:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:48.657288 (Thread-3): 17:59:48  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 17:59:48.657381 (Thread-3): 17:59:48  Opening a new connection, currently in state closed
2022-03-03 17:59:50.429031 (Thread-570): handling poll request
2022-03-03 17:59:50.429362 (Thread-570): 17:59:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afedc4c0>]}
2022-03-03 17:59:50.429917 (Thread-570): sending response (<Response 4120 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:51.896945 (Thread-3): 17:59:51  SQL status: SUCCESS 1 in 3.24 seconds
2022-03-03 17:59:51.906063 (Thread-3): 17:59:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:51.906197 (Thread-3): 17:59:51  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 17:59:52.074200 (Thread-3): 17:59:52  SQL status: SUCCESS 9 in 0.17 seconds
2022-03-03 17:59:52.078068 (Thread-3): 17:59:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:52.078180 (Thread-3): 17:59:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 17:59:52.223664 (Thread-3): 17:59:52  SQL status: SUCCESS 9 in 0.15 seconds
2022-03-03 17:59:52.231762 (Thread-3): 17:59:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:52.231888 (Thread-3): 17:59:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 17:59:52.243991 (Thread-571): handling poll request
2022-03-03 17:59:52.244299 (Thread-571): 17:59:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afbf7340>]}
2022-03-03 17:59:52.244911 (Thread-571): sending response (<Response 4294 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:52.356576 (Thread-3): 17:59:52  SQL status: SUCCESS 9 in 0.12 seconds
2022-03-03 17:59:52.377618 (Thread-3): 17:59:52  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:52.390354 (Thread-3): 17:59:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:52.390502 (Thread-3): 17:59:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 17:59:52.613379 (Thread-3): 17:59:52  SQL status: SUCCESS 1 in 0.22 seconds
2022-03-03 17:59:52.613625 (Thread-3): 17:59:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:52.613713 (Thread-3): 17:59:52  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 17:59:53.354322 (Thread-3): 17:59:53  SQL status: SUCCESS 0 in 0.74 seconds
2022-03-03 17:59:53.354521 (Thread-3): 17:59:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 17:59:53.354607 (Thread-3): 17:59:53  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 17:59:53.886822 (Thread-3): 17:59:53  SQL status: SUCCESS 1 in 0.53 seconds
2022-03-03 17:59:53.896746 (Thread-3): 17:59:53  finished collecting timing info
2022-03-03 17:59:53.896935 (Thread-3): 17:59:53  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 17:59:54.105798 (Thread-572): handling poll request
2022-03-03 17:59:54.106163 (Thread-572): 17:59:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc9d940>]}
2022-03-03 17:59:54.106876 (Thread-572): sending response (<Response 6599 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:54.147915 (Thread-3): 17:59:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db5f4dde-d6da-44b6-8a57-3d9b529b5714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd775f5ef70>]}
2022-03-03 17:59:54.148685 (Thread-3): 17:59:54  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.63s]
2022-03-03 17:59:54.148873 (Thread-3): 17:59:54  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 17:59:54.150440 (MainThread): 17:59:54  Acquiring new snowflake connection "master"
2022-03-03 17:59:54.150766 (MainThread): 17:59:54  
2022-03-03 17:59:54.151020 (MainThread): 17:59:54  Finished running 1 incremental model in 7.85s.
2022-03-03 17:59:54.151138 (MainThread): 17:59:54  Connection 'master' was properly closed.
2022-03-03 17:59:54.151220 (MainThread): 17:59:54  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 17:59:54.217032 (MainThread): 17:59:54  
2022-03-03 17:59:54.217245 (MainThread): 17:59:54  Completed successfully
2022-03-03 17:59:54.217346 (MainThread): 17:59:54  
2022-03-03 17:59:54.217442 (MainThread): 17:59:54  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 17:59:55.930688 (Thread-573): handling poll request
2022-03-03 17:59:55.931031 (Thread-573): 17:59:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8d070>]}
2022-03-03 17:59:55.932093 (Thread-573): sending response (<Response 10088 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:57.881250 (Thread-574): handling status request
2022-03-03 17:59:57.881595 (Thread-574): 17:59:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8d220>]}
2022-03-03 17:59:57.882118 (Thread-574): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 17:59:57.900006 (Thread-575): handling status request
2022-03-03 17:59:57.900310 (Thread-575): 17:59:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8d610>]}
2022-03-03 17:59:57.900828 (Thread-575): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:10.964778 (Thread-576): handling status request
2022-03-03 18:00:10.965120 (Thread-576): 18:00:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8d850>]}
2022-03-03 18:00:10.965594 (Thread-576): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:11.287019 (Thread-577): handling status request
2022-03-03 18:00:11.287367 (Thread-577): 18:00:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8dac0>]}
2022-03-03 18:00:11.287916 (Thread-577): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:11.722299 (Thread-578): handling cli_args request
2022-03-03 18:00:11.722631 (Thread-578): 18:00:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8dd30>]}
2022-03-03 18:00:13.964465 (Thread-578): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:14.285020 (MainThread): 18:00:14  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:00:14.285448 (MainThread): 18:00:14  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:00:14.293449 (MainThread): 18:00:14  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58c65770-87f7-47e5-90c5-b55ddbd6bef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4583a9a0>]}
2022-03-03 18:00:14.327087 (MainThread): 18:00:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58c65770-87f7-47e5-90c5-b55ddbd6bef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4591a760>]}
2022-03-03 18:00:14.327353 (MainThread): 18:00:14  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:00:14.329088 (MainThread): 18:00:14  
2022-03-03 18:00:14.329387 (MainThread): 18:00:14  Acquiring new snowflake connection "master"
2022-03-03 18:00:14.330228 (ThreadPoolExecutor-0_0): 18:00:14  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:00:14.343787 (ThreadPoolExecutor-0_0): 18:00:14  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:00:14.343893 (ThreadPoolExecutor-0_0): 18:00:14  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:00:14.343978 (ThreadPoolExecutor-0_0): 18:00:14  Opening a new connection, currently in state init
2022-03-03 18:00:14.775159 (Thread-579): handling poll request
2022-03-03 18:00:14.775758 (Thread-579): 18:00:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afac1880>]}
2022-03-03 18:00:14.776752 (Thread-579): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:15.782771 (ThreadPoolExecutor-0_0): 18:00:15  SQL status: SUCCESS 8 in 1.44 seconds
2022-03-03 18:00:15.784919 (ThreadPoolExecutor-0_0): 18:00:15  On list_DBT_RAW: Close
2022-03-03 18:00:16.147073 (ThreadPoolExecutor-2_0): 18:00:16  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:00:16.207443 (ThreadPoolExecutor-2_0): 18:00:16  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:00:16.207599 (ThreadPoolExecutor-2_0): 18:00:16  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:00:16.207697 (ThreadPoolExecutor-2_0): 18:00:16  Opening a new connection, currently in state closed
2022-03-03 18:00:16.626090 (Thread-580): handling poll request
2022-03-03 18:00:16.626441 (Thread-580): 18:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc237c0>]}
2022-03-03 18:00:16.627020 (Thread-580): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:17.355234 (ThreadPoolExecutor-2_0): 18:00:17  SQL status: SUCCESS 33 in 1.15 seconds
2022-03-03 18:00:17.357437 (ThreadPoolExecutor-2_0): 18:00:17  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:00:17.724447 (MainThread): 18:00:17  Concurrency: 4 threads (target='default')
2022-03-03 18:00:17.724663 (MainThread): 18:00:17  
2022-03-03 18:00:17.727461 (Thread-3): 18:00:17  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:00:17.727768 (Thread-3): 18:00:17  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:00:17.728031 (Thread-3): 18:00:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:00:17.728134 (Thread-3): 18:00:17  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:00:17.728245 (Thread-3): 18:00:17  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:00:17.812086 (Thread-3): 18:00:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:00:17.824101 (Thread-3): 18:00:17  finished collecting timing info
2022-03-03 18:00:17.824270 (Thread-3): 18:00:17  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:00:17.865907 (Thread-3): 18:00:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:00:17.878626 (Thread-3): 18:00:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:00:17.878749 (Thread-3): 18:00:17  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:00:17.878840 (Thread-3): 18:00:17  Opening a new connection, currently in state closed
2022-03-03 18:00:18.432867 (Thread-581): handling poll request
2022-03-03 18:00:18.433212 (Thread-581): 18:00:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afb8d550>]}
2022-03-03 18:00:18.433929 (Thread-581): sending response (<Response 7354 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:20.300293 (Thread-582): handling poll request
2022-03-03 18:00:20.300625 (Thread-582): 18:00:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc9d160>]}
2022-03-03 18:00:20.301126 (Thread-582): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:22.147580 (Thread-583): handling poll request
2022-03-03 18:00:22.147929 (Thread-583): 18:00:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc9db50>]}
2022-03-03 18:00:22.148412 (Thread-583): sending response (<Response 319 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:23.114589 (Thread-3): 18:00:23  SQL status: SUCCESS 1 in 5.24 seconds
2022-03-03 18:00:23.124517 (Thread-3): 18:00:23  finished collecting timing info
2022-03-03 18:00:23.124724 (Thread-3): 18:00:23  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:00:23.558680 (Thread-3): 18:00:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58c65770-87f7-47e5-90c5-b55ddbd6bef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f44215310>]}
2022-03-03 18:00:23.559132 (Thread-3): 18:00:23  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.83s]
2022-03-03 18:00:23.559265 (Thread-3): 18:00:23  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:00:23.561026 (MainThread): 18:00:23  Acquiring new snowflake connection "master"
2022-03-03 18:00:23.561360 (MainThread): 18:00:23  
2022-03-03 18:00:23.561466 (MainThread): 18:00:23  Finished running 1 incremental model in 9.23s.
2022-03-03 18:00:23.561556 (MainThread): 18:00:23  Connection 'master' was properly closed.
2022-03-03 18:00:23.561625 (MainThread): 18:00:23  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:00:23.629789 (MainThread): 18:00:23  
2022-03-03 18:00:23.629993 (MainThread): 18:00:23  Completed successfully
2022-03-03 18:00:23.630095 (MainThread): 18:00:23  
2022-03-03 18:00:23.630191 (MainThread): 18:00:23  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 18:00:23.971008 (Thread-584): handling poll request
2022-03-03 18:00:23.971373 (Thread-584): 18:00:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc53f70>]}
2022-03-03 18:00:23.972438 (Thread-584): sending response (<Response 10223 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:25.732233 (Thread-585): handling status request
2022-03-03 18:00:25.732584 (Thread-585): 18:00:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc1a520>]}
2022-03-03 18:00:25.733166 (Thread-585): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:00:25.747700 (Thread-586): handling status request
2022-03-03 18:00:25.747956 (Thread-586): 18:00:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc1af10>]}
2022-03-03 18:00:25.748379 (Thread-586): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:04:33.664774 (Thread-587): 18:04:33  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 18:04:33.666729 (Thread-587): 18:04:33  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 18:04:33.674480 (Thread-587): 18:04:33  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 18:04:33.686570 (Thread-587): 18:04:33  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 18:04:33.746125 (Thread-587): 18:04:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e40e7460>]}
2022-03-03 18:04:34.891727 (Thread-588): handling status request
2022-03-03 18:04:34.892476 (Thread-589): handling status request
2022-03-03 18:04:34.892864 (Thread-588): 18:04:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afaefc40>]}
2022-03-03 18:04:34.893116 (Thread-589): 18:04:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041e9280>]}
2022-03-03 18:04:34.893637 (Thread-588): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:04:34.894100 (Thread-589): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:04:58.835189 (Thread-590): handling status request
2022-03-03 18:04:58.835528 (Thread-590): 18:04:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc23040>]}
2022-03-03 18:04:58.836020 (Thread-590): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:04:59.251575 (Thread-591): handling status request
2022-03-03 18:04:59.251913 (Thread-591): 18:04:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afae95e0>]}
2022-03-03 18:04:59.252402 (Thread-591): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:04:59.578129 (Thread-592): handling cli_args request
2022-03-03 18:04:59.578471 (Thread-592): 18:04:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041e9040>]}
2022-03-03 18:05:01.850382 (Thread-592): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:02.152036 (MainThread): 18:05:02  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:05:02.152453 (MainThread): 18:05:02  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:05:02.160730 (MainThread): 18:05:02  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '899ac98e-46fc-4868-b800-b74bc9a508d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d099f99a0>]}
2022-03-03 18:05:02.192296 (MainThread): 18:05:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '899ac98e-46fc-4868-b800-b74bc9a508d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d09ada760>]}
2022-03-03 18:05:02.192621 (MainThread): 18:05:02  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:05:02.194834 (MainThread): 18:05:02  
2022-03-03 18:05:02.195161 (MainThread): 18:05:02  Acquiring new snowflake connection "master"
2022-03-03 18:05:02.196222 (ThreadPoolExecutor-0_0): 18:05:02  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:05:02.210206 (ThreadPoolExecutor-0_0): 18:05:02  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:05:02.210336 (ThreadPoolExecutor-0_0): 18:05:02  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:05:02.210426 (ThreadPoolExecutor-0_0): 18:05:02  Opening a new connection, currently in state init
2022-03-03 18:05:02.741203 (Thread-593): handling poll request
2022-03-03 18:05:02.741677 (Thread-593): 18:05:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041e8c70>]}
2022-03-03 18:05:02.742743 (Thread-593): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:03.400710 (ThreadPoolExecutor-0_0): 18:05:03  SQL status: SUCCESS 8 in 1.19 seconds
2022-03-03 18:05:03.402794 (ThreadPoolExecutor-0_0): 18:05:03  On list_DBT_RAW: Close
2022-03-03 18:05:03.724822 (ThreadPoolExecutor-2_0): 18:05:03  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:05:03.794497 (ThreadPoolExecutor-2_0): 18:05:03  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:05:03.794709 (ThreadPoolExecutor-2_0): 18:05:03  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:05:03.794816 (ThreadPoolExecutor-2_0): 18:05:03  Opening a new connection, currently in state closed
2022-03-03 18:05:04.578967 (Thread-594): handling poll request
2022-03-03 18:05:04.579352 (Thread-594): 18:05:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc23d60>]}
2022-03-03 18:05:04.579964 (Thread-594): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:04.881342 (ThreadPoolExecutor-2_0): 18:05:04  SQL status: SUCCESS 34 in 1.09 seconds
2022-03-03 18:05:04.883778 (ThreadPoolExecutor-2_0): 18:05:04  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:05:05.213293 (MainThread): 18:05:05  Concurrency: 4 threads (target='default')
2022-03-03 18:05:05.213480 (MainThread): 18:05:05  
2022-03-03 18:05:05.216525 (Thread-3): 18:05:05  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:05.216893 (Thread-3): 18:05:05  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 18:05:05.217175 (Thread-3): 18:05:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:05.217283 (Thread-3): 18:05:05  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:05.217394 (Thread-3): 18:05:05  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:05.223710 (Thread-3): 18:05:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:05.238286 (Thread-3): 18:05:05  finished collecting timing info
2022-03-03 18:05:05.238477 (Thread-3): 18:05:05  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:05.264404 (Thread-3): 18:05:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:05.278653 (Thread-3): 18:05:05  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:05.278828 (Thread-3): 18:05:05  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 18:05:05.278925 (Thread-3): 18:05:05  Opening a new connection, currently in state closed
2022-03-03 18:05:06.546749 (Thread-595): handling poll request
2022-03-03 18:05:06.547101 (Thread-595): 18:05:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4656b50>]}
2022-03-03 18:05:06.547881 (Thread-595): sending response (<Response 9149 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:08.464702 (Thread-596): handling poll request
2022-03-03 18:05:08.465058 (Thread-596): 18:05:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c46560a0>]}
2022-03-03 18:05:08.465547 (Thread-596): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:10.302490 (Thread-597): handling poll request
2022-03-03 18:05:10.302836 (Thread-597): 18:05:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464f760>]}
2022-03-03 18:05:10.303313 (Thread-597): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:12.152027 (Thread-598): handling poll request
2022-03-03 18:05:12.152377 (Thread-598): 18:05:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464fa00>]}
2022-03-03 18:05:12.152898 (Thread-598): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:13.971150 (Thread-599): handling poll request
2022-03-03 18:05:13.971506 (Thread-599): 18:05:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464f9d0>]}
2022-03-03 18:05:13.972006 (Thread-599): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:15.192539 (Thread-3): 18:05:15  SQL status: SUCCESS 1 in 9.91 seconds
2022-03-03 18:05:15.202505 (Thread-3): 18:05:15  finished collecting timing info
2022-03-03 18:05:15.202708 (Thread-3): 18:05:15  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 18:05:15.612528 (Thread-3): 18:05:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '899ac98e-46fc-4868-b800-b74bc9a508d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d091a3670>]}
2022-03-03 18:05:15.613020 (Thread-3): 18:05:15  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 10.40s]
2022-03-03 18:05:15.613160 (Thread-3): 18:05:15  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:15.614428 (Thread-5): 18:05:15  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:05:15.614693 (Thread-5): 18:05:15  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 18:05:15.614993 (Thread-5): 18:05:15  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:05:15.615089 (Thread-5): 18:05:15  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:05:15.615192 (Thread-5): 18:05:15  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:05:15.651310 (Thread-5): 18:05:15  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:05:15.651478 (Thread-5): 18:05:15  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:05:15.651571 (Thread-5): 18:05:15  Opening a new connection, currently in state init
2022-03-03 18:05:15.826587 (Thread-600): handling poll request
2022-03-03 18:05:15.826938 (Thread-600): 18:05:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464b8b0>]}
2022-03-03 18:05:15.827701 (Thread-600): sending response (<Response 6473 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:16.748342 (Thread-5): 18:05:16  SQL status: SUCCESS 5 in 1.1 seconds
2022-03-03 18:05:16.788542 (Thread-5): 18:05:16  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:05:16.788817 (Thread-5): 18:05:16  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:05:17.044135 (Thread-5): 18:05:17  SQL status: SUCCESS 5 in 0.26 seconds
2022-03-03 18:05:17.077982 (Thread-5): 18:05:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:05:17.090966 (Thread-5): 18:05:17  finished collecting timing info
2022-03-03 18:05:17.091167 (Thread-5): 18:05:17  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:05:17.110742 (Thread-5): 18:05:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:05:17.126893 (Thread-5): 18:05:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:05:17.127050 (Thread-5): 18:05:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 18:05:17.561505 (Thread-5): 18:05:17  SQL status: SUCCESS 1 in 0.43 seconds
2022-03-03 18:05:17.563016 (Thread-5): 18:05:17  finished collecting timing info
2022-03-03 18:05:17.563184 (Thread-5): 18:05:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 18:05:17.683423 (Thread-601): handling poll request
2022-03-03 18:05:17.683757 (Thread-601): 18:05:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464bcd0>]}
2022-03-03 18:05:17.684428 (Thread-601): sending response (<Response 7666 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:17.857448 (Thread-5): 18:05:17  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '899ac98e-46fc-4868-b800-b74bc9a508d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0805fc40>]}
2022-03-03 18:05:17.857895 (Thread-5): 18:05:17  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 2.24s]
2022-03-03 18:05:17.858038 (Thread-5): 18:05:17  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:05:17.859099 (Thread-4): 18:05:17  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:05:17.859370 (Thread-4): 18:05:17  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:05:17.859669 (Thread-4): 18:05:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:17.859762 (Thread-4): 18:05:17  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:05:17.859853 (Thread-4): 18:05:17  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:05:17.943954 (Thread-4): 18:05:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:17.956765 (Thread-4): 18:05:17  finished collecting timing info
2022-03-03 18:05:17.956980 (Thread-4): 18:05:17  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:05:17.982857 (Thread-4): 18:05:17  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:17.983029 (Thread-4): 18:05:17  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:05:17.983129 (Thread-4): 18:05:17  Opening a new connection, currently in state init
2022-03-03 18:05:19.497075 (Thread-602): handling poll request
2022-03-03 18:05:19.497835 (Thread-602): 18:05:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464ba00>]}
2022-03-03 18:05:19.498491 (Thread-602): sending response (<Response 8170 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:21.321923 (Thread-603): handling poll request
2022-03-03 18:05:21.322283 (Thread-603): 18:05:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c464fd00>]}
2022-03-03 18:05:21.322767 (Thread-603): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:21.394617 (Thread-4): 18:05:21  SQL status: SUCCESS 1 in 3.41 seconds
2022-03-03 18:05:21.398824 (Thread-4): 18:05:21  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:21.398969 (Thread-4): 18:05:21  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 18:05:21.599820 (Thread-4): 18:05:21  SQL status: SUCCESS 9 in 0.2 seconds
2022-03-03 18:05:21.603682 (Thread-4): 18:05:21  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:21.603809 (Thread-4): 18:05:21  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 18:05:21.805001 (Thread-4): 18:05:21  SQL status: SUCCESS 9 in 0.2 seconds
2022-03-03 18:05:21.813466 (Thread-4): 18:05:21  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:21.813601 (Thread-4): 18:05:21  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 18:05:22.296080 (Thread-4): 18:05:22  SQL status: SUCCESS 9 in 0.48 seconds
2022-03-03 18:05:22.317518 (Thread-4): 18:05:22  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:22.331213 (Thread-4): 18:05:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:22.331366 (Thread-4): 18:05:22  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 18:05:22.630403 (Thread-4): 18:05:22  SQL status: SUCCESS 1 in 0.3 seconds
2022-03-03 18:05:22.630659 (Thread-4): 18:05:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:22.630751 (Thread-4): 18:05:22  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 18:05:23.206215 (Thread-604): handling poll request
2022-03-03 18:05:23.206571 (Thread-604): 18:05:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc23160>]}
2022-03-03 18:05:23.207284 (Thread-604): sending response (<Response 8294 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:23.634884 (Thread-4): 18:05:23  SQL status: SUCCESS 602 in 1.0 seconds
2022-03-03 18:05:23.635099 (Thread-4): 18:05:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:05:23.635190 (Thread-4): 18:05:23  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 18:05:24.165932 (Thread-4): 18:05:24  SQL status: SUCCESS 1 in 0.53 seconds
2022-03-03 18:05:24.167487 (Thread-4): 18:05:24  finished collecting timing info
2022-03-03 18:05:24.167663 (Thread-4): 18:05:24  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:05:24.440718 (Thread-4): 18:05:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '899ac98e-46fc-4868-b800-b74bc9a508d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cf85b4220>]}
2022-03-03 18:05:24.441184 (Thread-4): 18:05:24  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.58s]
2022-03-03 18:05:24.441331 (Thread-4): 18:05:24  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:05:24.443050 (MainThread): 18:05:24  Acquiring new snowflake connection "master"
2022-03-03 18:05:24.443389 (MainThread): 18:05:24  
2022-03-03 18:05:24.443495 (MainThread): 18:05:24  Finished running 1 table model, 1 view model, 1 incremental model in 22.25s.
2022-03-03 18:05:24.443583 (MainThread): 18:05:24  Connection 'master' was properly closed.
2022-03-03 18:05:24.443653 (MainThread): 18:05:24  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 18:05:24.443719 (MainThread): 18:05:24  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 18:05:24.443783 (MainThread): 18:05:24  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:05:24.510575 (MainThread): 18:05:24  
2022-03-03 18:05:24.510789 (MainThread): 18:05:24  Completed successfully
2022-03-03 18:05:24.510895 (MainThread): 18:05:24  
2022-03-03 18:05:24.510992 (MainThread): 18:05:24  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 18:05:25.064447 (Thread-605): handling poll request
2022-03-03 18:05:25.064841 (Thread-605): 18:05:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e417bfd0>]}
2022-03-03 18:05:25.066422 (Thread-605): sending response (<Response 25642 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:26.564207 (Thread-606): handling status request
2022-03-03 18:05:26.564552 (Thread-606): 18:05:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41b14c0>]}
2022-03-03 18:05:26.565108 (Thread-606): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:26.880975 (Thread-607): handling status request
2022-03-03 18:05:26.881313 (Thread-607): 18:05:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e424f850>]}
2022-03-03 18:05:26.881775 (Thread-607): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:53.850302 (Thread-608): handling status request
2022-03-03 18:05:53.850696 (Thread-608): 18:05:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c438bb80>]}
2022-03-03 18:05:53.851267 (Thread-608): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:54.689123 (Thread-609): handling status request
2022-03-03 18:05:54.689722 (Thread-610): handling cli_args request
2022-03-03 18:05:54.690120 (Thread-609): 18:05:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c438bd30>]}
2022-03-03 18:05:54.690441 (Thread-610): 18:05:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41ea940>]}
2022-03-03 18:05:54.690956 (Thread-609): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:56.972592 (Thread-610): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:57.270767 (MainThread): 18:05:57  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:05:57.271186 (MainThread): 18:05:57  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:05:57.279017 (MainThread): 18:05:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2af753d6-552d-4b9e-beb4-bcd5e56176c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2eebaa30>]}
2022-03-03 18:05:57.314219 (MainThread): 18:05:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2af753d6-552d-4b9e-beb4-bcd5e56176c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2ef907c0>]}
2022-03-03 18:05:57.314731 (MainThread): 18:05:57  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:05:57.316714 (MainThread): 18:05:57  
2022-03-03 18:05:57.317016 (MainThread): 18:05:57  Acquiring new snowflake connection "master"
2022-03-03 18:05:57.317964 (ThreadPoolExecutor-0_0): 18:05:57  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:05:57.333298 (ThreadPoolExecutor-0_0): 18:05:57  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:05:57.333402 (ThreadPoolExecutor-0_0): 18:05:57  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:05:57.333502 (ThreadPoolExecutor-0_0): 18:05:57  Opening a new connection, currently in state init
2022-03-03 18:05:57.751646 (Thread-611): handling poll request
2022-03-03 18:05:57.752064 (Thread-611): 18:05:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51040ce100>]}
2022-03-03 18:05:57.753103 (Thread-611): sending response (<Response 4164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:05:58.240217 (ThreadPoolExecutor-0_0): 18:05:58  SQL status: SUCCESS 8 in 0.91 seconds
2022-03-03 18:05:58.242395 (ThreadPoolExecutor-0_0): 18:05:58  On list_DBT_RAW: Close
2022-03-03 18:05:58.468832 (ThreadPoolExecutor-2_0): 18:05:58  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:05:58.531255 (ThreadPoolExecutor-2_0): 18:05:58  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:05:58.531427 (ThreadPoolExecutor-2_0): 18:05:58  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:05:58.531537 (ThreadPoolExecutor-2_0): 18:05:58  Opening a new connection, currently in state closed
2022-03-03 18:05:59.210767 (ThreadPoolExecutor-2_0): 18:05:59  SQL status: SUCCESS 33 in 0.68 seconds
2022-03-03 18:05:59.213162 (ThreadPoolExecutor-2_0): 18:05:59  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:05:59.594193 (MainThread): 18:05:59  Concurrency: 4 threads (target='default')
2022-03-03 18:05:59.594372 (MainThread): 18:05:59  
2022-03-03 18:05:59.597270 (Thread-3): 18:05:59  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:59.597588 (Thread-3): 18:05:59  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 18:05:59.597868 (Thread-3): 18:05:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:59.597976 (Thread-3): 18:05:59  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:59.598089 (Thread-3): 18:05:59  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:59.604098 (Thread-3): 18:05:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:59.615707 (Thread-3): 18:05:59  finished collecting timing info
2022-03-03 18:05:59.615866 (Thread-3): 18:05:59  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:05:59.641491 (Thread-3): 18:05:59  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:59.656441 (Thread-3): 18:05:59  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:05:59.656600 (Thread-3): 18:05:59  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 18:05:59.656724 (Thread-3): 18:05:59  Opening a new connection, currently in state closed
2022-03-03 18:06:00.145046 (Thread-612): handling poll request
2022-03-03 18:06:00.145388 (Thread-612): 18:06:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4151910>]}
2022-03-03 18:06:00.146169 (Thread-612): sending response (<Response 11148 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:02.056839 (Thread-613): handling poll request
2022-03-03 18:06:02.057182 (Thread-613): 18:06:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4151940>]}
2022-03-03 18:06:02.057665 (Thread-613): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:03.870182 (Thread-614): handling poll request
2022-03-03 18:06:03.870563 (Thread-614): 18:06:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4151be0>]}
2022-03-03 18:06:03.871061 (Thread-614): sending response (<Response 319 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:05.800838 (Thread-615): handling poll request
2022-03-03 18:06:05.801170 (Thread-615): 18:06:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4151400>]}
2022-03-03 18:06:05.801799 (Thread-615): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:06.442343 (Thread-3): 18:06:06  SQL status: SUCCESS 1 in 6.79 seconds
2022-03-03 18:06:06.452078 (Thread-3): 18:06:06  finished collecting timing info
2022-03-03 18:06:06.452275 (Thread-3): 18:06:06  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 18:06:06.750590 (Thread-3): 18:06:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af753d6-552d-4b9e-beb4-bcd5e56176c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2e664760>]}
2022-03-03 18:06:06.751117 (Thread-3): 18:06:06  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 7.15s]
2022-03-03 18:06:06.751256 (Thread-3): 18:06:06  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:06:06.752268 (Thread-5): 18:06:06  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:06:06.752536 (Thread-5): 18:06:06  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 18:06:06.752998 (Thread-5): 18:06:06  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:06:06.753103 (Thread-5): 18:06:06  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:06:06.753197 (Thread-5): 18:06:06  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:06:06.791048 (Thread-5): 18:06:06  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:06:06.791223 (Thread-5): 18:06:06  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:06:06.791335 (Thread-5): 18:06:06  Opening a new connection, currently in state init
2022-03-03 18:06:07.467991 (Thread-5): 18:06:07  SQL status: SUCCESS 5 in 0.68 seconds
2022-03-03 18:06:07.498146 (Thread-5): 18:06:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:06:07.498306 (Thread-5): 18:06:07  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:06:07.652048 (Thread-616): handling poll request
2022-03-03 18:06:07.652389 (Thread-616): 18:06:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4151b50>]}
2022-03-03 18:06:07.653147 (Thread-616): sending response (<Response 7799 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:07.699912 (Thread-5): 18:06:07  SQL status: SUCCESS 5 in 0.2 seconds
2022-03-03 18:06:07.734670 (Thread-5): 18:06:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:06:07.746635 (Thread-5): 18:06:07  finished collecting timing info
2022-03-03 18:06:07.746912 (Thread-5): 18:06:07  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:06:07.767114 (Thread-5): 18:06:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:06:07.781467 (Thread-5): 18:06:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:06:07.781624 (Thread-5): 18:06:07  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 18:06:08.127425 (Thread-5): 18:06:08  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-03 18:06:08.128937 (Thread-5): 18:06:08  finished collecting timing info
2022-03-03 18:06:08.129111 (Thread-5): 18:06:08  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 18:06:08.338466 (Thread-5): 18:06:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af753d6-552d-4b9e-beb4-bcd5e56176c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2c2fa760>]}
2022-03-03 18:06:08.339201 (Thread-5): 18:06:08  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.59s]
2022-03-03 18:06:08.339406 (Thread-5): 18:06:08  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:06:08.340386 (Thread-4): 18:06:08  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:06:08.340776 (Thread-4): 18:06:08  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:06:08.341145 (Thread-4): 18:06:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:06:08.341256 (Thread-4): 18:06:08  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:06:08.341377 (Thread-4): 18:06:08  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:06:08.424726 (Thread-4): 18:06:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:06:08.436609 (Thread-4): 18:06:08  finished collecting timing info
2022-03-03 18:06:08.436857 (Thread-4): 18:06:08  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:06:08.463491 (Thread-4): 18:06:08  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:06:08.478083 (Thread-4): 18:06:08  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:06:08.478255 (Thread-4): 18:06:08  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:06:08.478351 (Thread-4): 18:06:08  Opening a new connection, currently in state init
2022-03-03 18:06:09.502984 (Thread-617): handling poll request
2022-03-03 18:06:09.503349 (Thread-617): 18:06:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c46522e0>]}
2022-03-03 18:06:09.504362 (Thread-617): sending response (<Response 13614 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:11.021912 (Thread-4): 18:06:11  SQL status: SUCCESS 1 in 2.54 seconds
2022-03-03 18:06:11.023629 (Thread-4): 18:06:11  finished collecting timing info
2022-03-03 18:06:11.023942 (Thread-4): 18:06:11  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:06:11.269645 (Thread-4): 18:06:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af753d6-552d-4b9e-beb4-bcd5e56176c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2c27a100>]}
2022-03-03 18:06:11.270090 (Thread-4): 18:06:11  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.93s]
2022-03-03 18:06:11.270218 (Thread-4): 18:06:11  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:06:11.271944 (MainThread): 18:06:11  Acquiring new snowflake connection "master"
2022-03-03 18:06:11.272296 (MainThread): 18:06:11  
2022-03-03 18:06:11.272402 (MainThread): 18:06:11  Finished running 1 table model, 1 view model, 1 incremental model in 13.96s.
2022-03-03 18:06:11.272490 (MainThread): 18:06:11  Connection 'master' was properly closed.
2022-03-03 18:06:11.272558 (MainThread): 18:06:11  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 18:06:11.272624 (MainThread): 18:06:11  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 18:06:11.272722 (MainThread): 18:06:11  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:06:11.340285 (MainThread): 18:06:11  
2022-03-03 18:06:11.340543 (MainThread): 18:06:11  Completed successfully
2022-03-03 18:06:11.340707 (MainThread): 18:06:11  
2022-03-03 18:06:11.340811 (MainThread): 18:06:11  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 18:06:11.385286 (Thread-618): handling poll request
2022-03-03 18:06:11.385651 (Thread-618): 18:06:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e422ecd0>]}
2022-03-03 18:06:11.386354 (Thread-618): sending response (<Response 6672 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:13.284104 (Thread-619): handling poll request
2022-03-03 18:06:13.284466 (Thread-619): 18:06:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e422e190>]}
2022-03-03 18:06:13.285669 (Thread-619): sending response (<Response 17143 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:14.735826 (Thread-620): handling status request
2022-03-03 18:06:14.736171 (Thread-620): 18:06:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e422e2b0>]}
2022-03-03 18:06:14.736769 (Thread-620): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:06:14.990430 (Thread-621): handling status request
2022-03-03 18:06:14.990768 (Thread-621): 18:06:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e422e7c0>]}
2022-03-03 18:06:14.991283 (Thread-621): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:40.250656 (Thread-622): 18:10:40  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 18:10:40.252856 (Thread-622): 18:10:40  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 18:10:40.265541 (Thread-622): 18:10:40  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 18:10:40.279895 (Thread-622): 18:10:40  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 18:10:40.336031 (Thread-622): 18:10:40  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e416cdc0>]}
2022-03-03 18:10:41.723921 (Thread-623): handling status request
2022-03-03 18:10:41.724267 (Thread-623): 18:10:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e439ba00>]}
2022-03-03 18:10:41.724800 (Thread-623): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:41.726063 (Thread-624): handling status request
2022-03-03 18:10:41.726341 (Thread-624): 18:10:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aff72880>]}
2022-03-03 18:10:41.726792 (Thread-624): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:55.377289 (Thread-625): handling status request
2022-03-03 18:10:55.377645 (Thread-625): 18:10:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4668040>]}
2022-03-03 18:10:55.378135 (Thread-625): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:55.989489 (Thread-626): handling cli_args request
2022-03-03 18:10:55.989821 (Thread-626): 18:10:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4668d00>]}
2022-03-03 18:10:56.156184 (Thread-627): handling status request
2022-03-03 18:10:56.157088 (Thread-627): 18:10:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042898e0>]}
2022-03-03 18:10:56.158025 (Thread-627): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:58.271967 (Thread-626): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:58.580331 (MainThread): 18:10:58  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:10:58.580802 (MainThread): 18:10:58  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:10:58.588819 (MainThread): 18:10:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b52d6c16-83d0-4042-bc37-62896bc3d16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168ed79910>]}
2022-03-03 18:10:58.621982 (MainThread): 18:10:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b52d6c16-83d0-4042-bc37-62896bc3d16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168ee5a6d0>]}
2022-03-03 18:10:58.622267 (MainThread): 18:10:58  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:10:58.624489 (MainThread): 18:10:58  
2022-03-03 18:10:58.624828 (MainThread): 18:10:58  Acquiring new snowflake connection "master"
2022-03-03 18:10:58.625807 (ThreadPoolExecutor-0_0): 18:10:58  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:10:58.639592 (ThreadPoolExecutor-0_0): 18:10:58  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:10:58.639700 (ThreadPoolExecutor-0_0): 18:10:58  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:10:58.639784 (ThreadPoolExecutor-0_0): 18:10:58  Opening a new connection, currently in state init
2022-03-03 18:10:59.063691 (Thread-628): handling poll request
2022-03-03 18:10:59.064027 (Thread-628): 18:10:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4c108b0>]}
2022-03-03 18:10:59.064847 (Thread-628): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:10:59.768031 (ThreadPoolExecutor-0_0): 18:10:59  SQL status: SUCCESS 8 in 1.13 seconds
2022-03-03 18:10:59.770172 (ThreadPoolExecutor-0_0): 18:10:59  On list_DBT_RAW: Close
2022-03-03 18:11:00.114076 (ThreadPoolExecutor-2_0): 18:11:00  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:11:00.176904 (ThreadPoolExecutor-2_0): 18:11:00  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:11:00.177058 (ThreadPoolExecutor-2_0): 18:11:00  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:11:00.177157 (ThreadPoolExecutor-2_0): 18:11:00  Opening a new connection, currently in state closed
2022-03-03 18:11:00.835755 (Thread-629): handling poll request
2022-03-03 18:11:00.836118 (Thread-629): 18:11:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4668bb0>]}
2022-03-03 18:11:00.836744 (Thread-629): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:00.936283 (ThreadPoolExecutor-2_0): 18:11:00  SQL status: SUCCESS 34 in 0.76 seconds
2022-03-03 18:11:00.938752 (ThreadPoolExecutor-2_0): 18:11:00  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:11:01.223761 (MainThread): 18:11:01  Concurrency: 4 threads (target='default')
2022-03-03 18:11:01.223941 (MainThread): 18:11:01  
2022-03-03 18:11:01.262823 (Thread-3): 18:11:01  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:11:01.263400 (Thread-3): 18:11:01  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 18:11:01.263966 (Thread-3): 18:11:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:11:01.264254 (Thread-3): 18:11:01  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:11:01.264584 (Thread-3): 18:11:01  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:11:01.271734 (Thread-3): 18:11:01  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:11:01.284654 (Thread-3): 18:11:01  finished collecting timing info
2022-03-03 18:11:01.284904 (Thread-3): 18:11:01  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:11:01.311818 (Thread-3): 18:11:01  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:11:01.327021 (Thread-3): 18:11:01  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:11:01.327189 (Thread-3): 18:11:01  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 18:11:01.327285 (Thread-3): 18:11:01  Opening a new connection, currently in state init
2022-03-03 18:11:02.664325 (Thread-630): handling poll request
2022-03-03 18:11:02.664724 (Thread-630): 18:11:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44e4ac0>]}
2022-03-03 18:11:02.665533 (Thread-630): sending response (<Response 9147 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:04.461473 (Thread-631): handling poll request
2022-03-03 18:11:04.461851 (Thread-631): 18:11:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44e4dc0>]}
2022-03-03 18:11:04.462467 (Thread-631): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:05.625665 (Thread-3): 18:11:05  SQL status: SUCCESS 1 in 4.3 seconds
2022-03-03 18:11:05.635760 (Thread-3): 18:11:05  finished collecting timing info
2022-03-03 18:11:05.636086 (Thread-3): 18:11:05  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 18:11:05.884283 (Thread-3): 18:11:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b52d6c16-83d0-4042-bc37-62896bc3d16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e5032e0>]}
2022-03-03 18:11:05.884783 (Thread-3): 18:11:05  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 4.62s]
2022-03-03 18:11:05.884929 (Thread-3): 18:11:05  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:11:05.886103 (Thread-5): 18:11:05  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:11:05.886371 (Thread-5): 18:11:05  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 18:11:05.886669 (Thread-5): 18:11:05  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:11:05.886778 (Thread-5): 18:11:05  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:11:05.886873 (Thread-5): 18:11:05  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:11:05.923741 (Thread-5): 18:11:05  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:11:05.923909 (Thread-5): 18:11:05  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:11:05.924030 (Thread-5): 18:11:05  Opening a new connection, currently in state init
2022-03-03 18:11:06.274199 (Thread-632): handling poll request
2022-03-03 18:11:06.274544 (Thread-632): 18:11:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44ea250>]}
2022-03-03 18:11:06.275220 (Thread-632): sending response (<Response 6471 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:07.031050 (Thread-5): 18:11:07  SQL status: SUCCESS 5 in 1.11 seconds
2022-03-03 18:11:07.063742 (Thread-5): 18:11:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:11:07.063910 (Thread-5): 18:11:07  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:11:07.213982 (Thread-5): 18:11:07  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 18:11:07.249275 (Thread-5): 18:11:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:11:07.261882 (Thread-5): 18:11:07  finished collecting timing info
2022-03-03 18:11:07.262095 (Thread-5): 18:11:07  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:11:07.282277 (Thread-5): 18:11:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:11:07.295818 (Thread-5): 18:11:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:11:07.295992 (Thread-5): 18:11:07  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 18:11:07.602678 (Thread-5): 18:11:07  SQL status: SUCCESS 1 in 0.31 seconds
2022-03-03 18:11:07.604453 (Thread-5): 18:11:07  finished collecting timing info
2022-03-03 18:11:07.604748 (Thread-5): 18:11:07  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 18:11:07.854097 (Thread-5): 18:11:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b52d6c16-83d0-4042-bc37-62896bc3d16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168c13a580>]}
2022-03-03 18:11:07.854677 (Thread-5): 18:11:07  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.97s]
2022-03-03 18:11:07.854843 (Thread-5): 18:11:07  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:11:07.855908 (Thread-4): 18:11:07  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:11:07.856186 (Thread-4): 18:11:07  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:11:07.856712 (Thread-4): 18:11:07  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:07.856921 (Thread-4): 18:11:07  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:11:07.857080 (Thread-4): 18:11:07  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:11:07.985821 (Thread-4): 18:11:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:07.998061 (Thread-4): 18:11:07  finished collecting timing info
2022-03-03 18:11:07.998265 (Thread-4): 18:11:07  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:11:08.035645 (Thread-4): 18:11:08  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:08.035848 (Thread-4): 18:11:08  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:11:08.035949 (Thread-4): 18:11:08  Opening a new connection, currently in state closed
2022-03-03 18:11:08.066834 (Thread-633): handling poll request
2022-03-03 18:11:08.067172 (Thread-633): 18:11:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45fd490>]}
2022-03-03 18:11:08.068043 (Thread-633): sending response (<Response 15556 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:09.877382 (Thread-634): handling poll request
2022-03-03 18:11:09.877720 (Thread-634): 18:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45fdac0>]}
2022-03-03 18:11:09.878196 (Thread-634): sending response (<Response 319 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:10.460290 (Thread-4): 18:11:10  SQL status: SUCCESS 1 in 2.42 seconds
2022-03-03 18:11:10.464425 (Thread-4): 18:11:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:10.464553 (Thread-4): 18:11:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 18:11:10.645420 (Thread-4): 18:11:10  SQL status: SUCCESS 10 in 0.18 seconds
2022-03-03 18:11:10.649763 (Thread-4): 18:11:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:10.649899 (Thread-4): 18:11:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 18:11:10.881604 (Thread-4): 18:11:10  SQL status: SUCCESS 9 in 0.23 seconds
2022-03-03 18:11:10.890297 (Thread-4): 18:11:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:10.890442 (Thread-4): 18:11:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 18:11:11.043454 (Thread-4): 18:11:11  SQL status: SUCCESS 9 in 0.15 seconds
2022-03-03 18:11:11.068184 (Thread-4): 18:11:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:11.081320 (Thread-4): 18:11:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:11.081508 (Thread-4): 18:11:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 18:11:11.306801 (Thread-4): 18:11:11  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-03 18:11:11.307180 (Thread-4): 18:11:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:11.307293 (Thread-4): 18:11:11  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 18:11:11.667583 (Thread-635): handling poll request
2022-03-03 18:11:11.667958 (Thread-635): 18:11:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4e81610>]}
2022-03-03 18:11:11.668717 (Thread-635): sending response (<Response 8298 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:12.039995 (Thread-4): 18:11:12  SQL status: SUCCESS 0 in 0.73 seconds
2022-03-03 18:11:12.040273 (Thread-4): 18:11:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:11:12.040384 (Thread-4): 18:11:12  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 18:11:12.627452 (Thread-4): 18:11:12  SQL status: SUCCESS 1 in 0.59 seconds
2022-03-03 18:11:12.629071 (Thread-4): 18:11:12  finished collecting timing info
2022-03-03 18:11:12.629243 (Thread-4): 18:11:12  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:11:12.997630 (Thread-4): 18:11:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b52d6c16-83d0-4042-bc37-62896bc3d16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168d6e9220>]}
2022-03-03 18:11:12.998084 (Thread-4): 18:11:12  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.14s]
2022-03-03 18:11:12.998220 (Thread-4): 18:11:12  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:11:12.999905 (MainThread): 18:11:12  Acquiring new snowflake connection "master"
2022-03-03 18:11:13.000238 (MainThread): 18:11:13  
2022-03-03 18:11:13.000344 (MainThread): 18:11:13  Finished running 1 table model, 1 view model, 1 incremental model in 14.38s.
2022-03-03 18:11:13.000432 (MainThread): 18:11:13  Connection 'master' was properly closed.
2022-03-03 18:11:13.000501 (MainThread): 18:11:13  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:11:13.000567 (MainThread): 18:11:13  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 18:11:13.000655 (MainThread): 18:11:13  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 18:11:13.065740 (MainThread): 18:11:13  
2022-03-03 18:11:13.065955 (MainThread): 18:11:13  Completed successfully
2022-03-03 18:11:13.066081 (MainThread): 18:11:13  
2022-03-03 18:11:13.066199 (MainThread): 18:11:13  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 18:11:13.479124 (Thread-636): handling poll request
2022-03-03 18:11:13.479460 (Thread-636): 18:11:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4333640>]}
2022-03-03 18:11:13.480990 (Thread-636): sending response (<Response 25695 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:15.030172 (Thread-637): handling status request
2022-03-03 18:11:15.030512 (Thread-637): 18:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c438bac0>]}
2022-03-03 18:11:15.031003 (Thread-637): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:11:15.049326 (Thread-638): handling status request
2022-03-03 18:11:15.049641 (Thread-638): 18:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42fd280>]}
2022-03-03 18:11:15.050103 (Thread-638): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:02.740721 (Thread-639): handling status request
2022-03-03 18:12:02.741075 (Thread-639): 18:12:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104289f70>]}
2022-03-03 18:12:02.741619 (Thread-639): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:03.216348 (Thread-640): handling cli_args request
2022-03-03 18:12:03.216738 (Thread-640): 18:12:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42aa430>]}
2022-03-03 18:12:03.519142 (Thread-641): handling status request
2022-03-03 18:12:03.519880 (Thread-641): 18:12:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45fd700>]}
2022-03-03 18:12:03.520950 (Thread-641): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:05.521216 (Thread-640): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:05.823542 (MainThread): 18:12:05  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:12:05.823998 (MainThread): 18:12:05  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:12:05.831724 (MainThread): 18:12:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e3ebeae-8a62-4ada-9c26-3f628f1d0841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3a0ba970>]}
2022-03-03 18:12:05.862861 (MainThread): 18:12:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e3ebeae-8a62-4ada-9c26-3f628f1d0841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3a19a730>]}
2022-03-03 18:12:05.863146 (MainThread): 18:12:05  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:12:05.865243 (MainThread): 18:12:05  
2022-03-03 18:12:05.865579 (MainThread): 18:12:05  Acquiring new snowflake connection "master"
2022-03-03 18:12:05.866542 (ThreadPoolExecutor-0_0): 18:12:05  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:12:05.880914 (ThreadPoolExecutor-0_0): 18:12:05  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:12:05.881023 (ThreadPoolExecutor-0_0): 18:12:05  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:12:05.881109 (ThreadPoolExecutor-0_0): 18:12:05  Opening a new connection, currently in state init
2022-03-03 18:12:06.296069 (Thread-642): handling poll request
2022-03-03 18:12:06.296407 (Thread-642): 18:12:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104289d90>]}
2022-03-03 18:12:06.297184 (Thread-642): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:07.004036 (ThreadPoolExecutor-0_0): 18:12:07  SQL status: SUCCESS 8 in 1.12 seconds
2022-03-03 18:12:07.006205 (ThreadPoolExecutor-0_0): 18:12:07  On list_DBT_RAW: Close
2022-03-03 18:12:07.252238 (ThreadPoolExecutor-2_0): 18:12:07  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:12:07.315337 (ThreadPoolExecutor-2_0): 18:12:07  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:12:07.315493 (ThreadPoolExecutor-2_0): 18:12:07  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:12:07.315588 (ThreadPoolExecutor-2_0): 18:12:07  Opening a new connection, currently in state closed
2022-03-03 18:12:08.079170 (Thread-643): handling poll request
2022-03-03 18:12:08.079543 (Thread-643): 18:12:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104289760>]}
2022-03-03 18:12:08.080098 (Thread-643): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:08.786282 (ThreadPoolExecutor-2_0): 18:12:08  SQL status: SUCCESS 33 in 1.47 seconds
2022-03-03 18:12:08.788587 (ThreadPoolExecutor-2_0): 18:12:08  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:12:09.011536 (MainThread): 18:12:09  Concurrency: 4 threads (target='default')
2022-03-03 18:12:09.011720 (MainThread): 18:12:09  
2022-03-03 18:12:09.014832 (Thread-3): 18:12:09  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:12:09.015158 (Thread-3): 18:12:09  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 18:12:09.015480 (Thread-3): 18:12:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:12:09.015606 (Thread-3): 18:12:09  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:12:09.015714 (Thread-3): 18:12:09  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:12:09.021737 (Thread-3): 18:12:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:12:09.035519 (Thread-3): 18:12:09  finished collecting timing info
2022-03-03 18:12:09.035682 (Thread-3): 18:12:09  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:12:09.060293 (Thread-3): 18:12:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:12:09.075426 (Thread-3): 18:12:09  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:12:09.075558 (Thread-3): 18:12:09  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 18:12:09.075648 (Thread-3): 18:12:09  Opening a new connection, currently in state closed
2022-03-03 18:12:09.881324 (Thread-644): handling poll request
2022-03-03 18:12:09.881716 (Thread-644): 18:12:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afae9550>]}
2022-03-03 18:12:09.882487 (Thread-644): sending response (<Response 9149 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:11.708561 (Thread-645): handling poll request
2022-03-03 18:12:11.708942 (Thread-645): 18:12:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e416ce80>]}
2022-03-03 18:12:11.709420 (Thread-645): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:13.516451 (Thread-646): handling poll request
2022-03-03 18:12:13.516834 (Thread-646): 18:12:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041f5130>]}
2022-03-03 18:12:13.517447 (Thread-646): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:15.337919 (Thread-647): handling poll request
2022-03-03 18:12:15.338479 (Thread-647): 18:12:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041f5730>]}
2022-03-03 18:12:15.339194 (Thread-647): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:15.348129 (Thread-3): 18:12:15  SQL status: SUCCESS 1 in 6.27 seconds
2022-03-03 18:12:15.358099 (Thread-3): 18:12:15  finished collecting timing info
2022-03-03 18:12:15.358282 (Thread-3): 18:12:15  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 18:12:16.874752 (Thread-3): 18:12:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e3ebeae-8a62-4ada-9c26-3f628f1d0841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3a0bad60>]}
2022-03-03 18:12:16.875202 (Thread-3): 18:12:16  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 7.86s]
2022-03-03 18:12:16.875331 (Thread-3): 18:12:16  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:12:16.876347 (Thread-5): 18:12:16  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:12:16.876734 (Thread-5): 18:12:16  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 18:12:16.877041 (Thread-5): 18:12:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:12:16.877136 (Thread-5): 18:12:16  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:12:16.877228 (Thread-5): 18:12:16  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:12:16.912824 (Thread-5): 18:12:16  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:12:16.912963 (Thread-5): 18:12:16  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:12:16.913053 (Thread-5): 18:12:16  Opening a new connection, currently in state init
2022-03-03 18:12:17.225862 (Thread-648): handling poll request
2022-03-03 18:12:17.226275 (Thread-648): 18:12:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104196cd0>]}
2022-03-03 18:12:17.227078 (Thread-648): sending response (<Response 6472 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:17.884378 (Thread-5): 18:12:17  SQL status: SUCCESS 5 in 0.97 seconds
2022-03-03 18:12:17.916095 (Thread-5): 18:12:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:12:17.916252 (Thread-5): 18:12:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:12:18.050418 (Thread-5): 18:12:18  SQL status: SUCCESS 5 in 0.13 seconds
2022-03-03 18:12:18.086245 (Thread-5): 18:12:18  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:12:18.102764 (Thread-5): 18:12:18  finished collecting timing info
2022-03-03 18:12:18.102957 (Thread-5): 18:12:18  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:12:18.123510 (Thread-5): 18:12:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:12:18.141642 (Thread-5): 18:12:18  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:12:18.141793 (Thread-5): 18:12:18  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 18:12:18.521405 (Thread-5): 18:12:18  SQL status: SUCCESS 1 in 0.38 seconds
2022-03-03 18:12:18.522980 (Thread-5): 18:12:18  finished collecting timing info
2022-03-03 18:12:18.523153 (Thread-5): 18:12:18  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 18:12:18.732057 (Thread-5): 18:12:18  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e3ebeae-8a62-4ada-9c26-3f628f1d0841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb384efc40>]}
2022-03-03 18:12:18.732505 (Thread-5): 18:12:18  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.86s]
2022-03-03 18:12:18.732679 (Thread-5): 18:12:18  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:12:18.733669 (Thread-4): 18:12:18  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:12:18.734015 (Thread-4): 18:12:18  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:12:18.734475 (Thread-4): 18:12:18  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:12:18.734639 (Thread-4): 18:12:18  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:12:18.734797 (Thread-4): 18:12:18  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:12:18.841421 (Thread-4): 18:12:18  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:12:18.854841 (Thread-4): 18:12:18  finished collecting timing info
2022-03-03 18:12:18.855034 (Thread-4): 18:12:18  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:12:18.880763 (Thread-4): 18:12:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:12:18.896538 (Thread-4): 18:12:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:12:18.896709 (Thread-4): 18:12:18  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:12:18.896807 (Thread-4): 18:12:18  Opening a new connection, currently in state init
2022-03-03 18:12:19.087773 (Thread-649): handling poll request
2022-03-03 18:12:19.088102 (Thread-649): 18:12:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42203a0>]}
2022-03-03 18:12:19.089462 (Thread-649): sending response (<Response 14978 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:20.923680 (Thread-650): handling poll request
2022-03-03 18:12:20.924039 (Thread-650): 18:12:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42207f0>]}
2022-03-03 18:12:20.924586 (Thread-650): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:21.201154 (Thread-4): 18:12:21  SQL status: SUCCESS 1 in 2.3 seconds
2022-03-03 18:12:21.203613 (Thread-4): 18:12:21  finished collecting timing info
2022-03-03 18:12:21.203889 (Thread-4): 18:12:21  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:12:21.507202 (Thread-4): 18:12:21  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e3ebeae-8a62-4ada-9c26-3f628f1d0841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3847e040>]}
2022-03-03 18:12:21.507627 (Thread-4): 18:12:21  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.77s]
2022-03-03 18:12:21.507762 (Thread-4): 18:12:21  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:12:21.509563 (MainThread): 18:12:21  Acquiring new snowflake connection "master"
2022-03-03 18:12:21.509943 (MainThread): 18:12:21  
2022-03-03 18:12:21.510126 (MainThread): 18:12:21  Finished running 1 table model, 1 view model, 1 incremental model in 15.64s.
2022-03-03 18:12:21.510287 (MainThread): 18:12:21  Connection 'master' was properly closed.
2022-03-03 18:12:21.510426 (MainThread): 18:12:21  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 18:12:21.510538 (MainThread): 18:12:21  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 18:12:21.510655 (MainThread): 18:12:21  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:12:21.577921 (MainThread): 18:12:21  
2022-03-03 18:12:21.578134 (MainThread): 18:12:21  Completed successfully
2022-03-03 18:12:21.578235 (MainThread): 18:12:21  
2022-03-03 18:12:21.578328 (MainThread): 18:12:21  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 18:12:22.797813 (Thread-651): handling poll request
2022-03-03 18:12:22.798181 (Thread-651): 18:12:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4e8b430>]}
2022-03-03 18:12:22.799514 (Thread-651): sending response (<Response 23547 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:24.355990 (Thread-652): handling status request
2022-03-03 18:12:24.356335 (Thread-652): 18:12:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e422eb20>]}
2022-03-03 18:12:24.382615 (Thread-652): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:12:24.628220 (Thread-653): handling status request
2022-03-03 18:12:24.628614 (Thread-653): 18:12:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afaeb850>]}
2022-03-03 18:12:24.629191 (Thread-653): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:32.480183 (Thread-654): handling status request
2022-03-03 18:13:32.480558 (Thread-654): 18:13:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4149730>]}
2022-03-03 18:13:32.481130 (Thread-654): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:33.433234 (Thread-655): handling cli_args request
2022-03-03 18:13:33.433785 (Thread-655): 18:13:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4149a30>]}
2022-03-03 18:13:33.435505 (Thread-656): handling status request
2022-03-03 18:13:33.435840 (Thread-656): 18:13:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042aa880>]}
2022-03-03 18:13:33.436304 (Thread-656): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:35.736460 (Thread-655): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:36.124928 (MainThread): 18:13:36  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:13:36.125377 (MainThread): 18:13:36  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:13:36.133433 (MainThread): 18:13:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fecb9a4f-c2f1-429e-9c5b-299edddfca00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a393aa00>]}
2022-03-03 18:13:36.163692 (MainThread): 18:13:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fecb9a4f-c2f1-429e-9c5b-299edddfca00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a3a1a7c0>]}
2022-03-03 18:13:36.163998 (MainThread): 18:13:36  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:13:36.166203 (MainThread): 18:13:36  
2022-03-03 18:13:36.166626 (MainThread): 18:13:36  Acquiring new snowflake connection "master"
2022-03-03 18:13:36.167588 (ThreadPoolExecutor-0_0): 18:13:36  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:13:36.181222 (ThreadPoolExecutor-0_0): 18:13:36  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:13:36.181341 (ThreadPoolExecutor-0_0): 18:13:36  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:13:36.181431 (ThreadPoolExecutor-0_0): 18:13:36  Opening a new connection, currently in state init
2022-03-03 18:13:36.619162 (Thread-657): handling poll request
2022-03-03 18:13:36.619654 (Thread-657): 18:13:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f510421b7c0>]}
2022-03-03 18:13:36.620590 (Thread-657): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:37.314926 (ThreadPoolExecutor-0_0): 18:13:37  SQL status: SUCCESS 8 in 1.13 seconds
2022-03-03 18:13:37.317023 (ThreadPoolExecutor-0_0): 18:13:37  On list_DBT_RAW: Close
2022-03-03 18:13:37.575726 (ThreadPoolExecutor-2_0): 18:13:37  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:13:37.646482 (ThreadPoolExecutor-2_0): 18:13:37  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:13:37.646652 (ThreadPoolExecutor-2_0): 18:13:37  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:13:37.646767 (ThreadPoolExecutor-2_0): 18:13:37  Opening a new connection, currently in state closed
2022-03-03 18:13:38.516130 (Thread-658): handling poll request
2022-03-03 18:13:38.516548 (Thread-658): 18:13:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c49aeaf0>]}
2022-03-03 18:13:38.517161 (Thread-658): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:38.587357 (ThreadPoolExecutor-2_0): 18:13:38  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 18:13:38.589612 (ThreadPoolExecutor-2_0): 18:13:38  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:13:38.951271 (MainThread): 18:13:38  Concurrency: 4 threads (target='default')
2022-03-03 18:13:38.951449 (MainThread): 18:13:38  
2022-03-03 18:13:38.954735 (Thread-3): 18:13:38  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:13:38.955063 (Thread-3): 18:13:38  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 18:13:38.955338 (Thread-3): 18:13:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:13:38.955444 (Thread-3): 18:13:38  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:13:38.955554 (Thread-3): 18:13:38  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:13:38.961550 (Thread-3): 18:13:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:13:38.977763 (Thread-3): 18:13:38  finished collecting timing info
2022-03-03 18:13:38.977997 (Thread-3): 18:13:38  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:13:39.003865 (Thread-3): 18:13:39  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:13:39.020909 (Thread-3): 18:13:39  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 18:13:39.021061 (Thread-3): 18:13:39  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 18:13:39.021155 (Thread-3): 18:13:39  Opening a new connection, currently in state closed
2022-03-03 18:13:40.319239 (Thread-659): handling poll request
2022-03-03 18:13:40.319587 (Thread-659): 18:13:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4949190>]}
2022-03-03 18:13:40.320288 (Thread-659): sending response (<Response 9149 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:42.112850 (Thread-660): handling poll request
2022-03-03 18:13:42.113235 (Thread-660): 18:13:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4949b20>]}
2022-03-03 18:13:42.113749 (Thread-660): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:43.309020 (Thread-3): 18:13:43  SQL status: SUCCESS 1 in 4.29 seconds
2022-03-03 18:13:43.318746 (Thread-3): 18:13:43  finished collecting timing info
2022-03-03 18:13:43.318927 (Thread-3): 18:13:43  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 18:13:43.568471 (Thread-3): 18:13:43  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecb9a4f-c2f1-429e-9c5b-299edddfca00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a3b19520>]}
2022-03-03 18:13:43.568959 (Thread-3): 18:13:43  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 4.61s]
2022-03-03 18:13:43.569097 (Thread-3): 18:13:43  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 18:13:43.570265 (Thread-5): 18:13:43  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:13:43.570648 (Thread-5): 18:13:43  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 18:13:43.571015 (Thread-5): 18:13:43  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:13:43.571122 (Thread-5): 18:13:43  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:13:43.571214 (Thread-5): 18:13:43  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:13:43.619247 (Thread-5): 18:13:43  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:13:43.619487 (Thread-5): 18:13:43  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:13:43.619653 (Thread-5): 18:13:43  Opening a new connection, currently in state init
2022-03-03 18:13:44.025253 (Thread-661): handling poll request
2022-03-03 18:13:44.025594 (Thread-661): 18:13:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c46adfd0>]}
2022-03-03 18:13:44.026252 (Thread-661): sending response (<Response 6470 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:44.311691 (Thread-5): 18:13:44  SQL status: SUCCESS 5 in 0.69 seconds
2022-03-03 18:13:44.341223 (Thread-5): 18:13:44  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:13:44.341372 (Thread-5): 18:13:44  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:13:44.561769 (Thread-5): 18:13:44  SQL status: SUCCESS 5 in 0.22 seconds
2022-03-03 18:13:44.596058 (Thread-5): 18:13:44  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:13:44.611119 (Thread-5): 18:13:44  finished collecting timing info
2022-03-03 18:13:44.611296 (Thread-5): 18:13:44  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:13:44.630801 (Thread-5): 18:13:44  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:13:44.646604 (Thread-5): 18:13:44  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:13:44.646761 (Thread-5): 18:13:44  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 18:13:45.260744 (Thread-5): 18:13:45  SQL status: SUCCESS 1 in 0.61 seconds
2022-03-03 18:13:45.262759 (Thread-5): 18:13:45  finished collecting timing info
2022-03-03 18:13:45.262933 (Thread-5): 18:13:45  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 18:13:45.523489 (Thread-5): 18:13:45  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecb9a4f-c2f1-429e-9c5b-299edddfca00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a04fde80>]}
2022-03-03 18:13:45.523932 (Thread-5): 18:13:45  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.95s]
2022-03-03 18:13:45.524065 (Thread-5): 18:13:45  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:13:45.525085 (Thread-4): 18:13:45  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:13:45.525355 (Thread-4): 18:13:45  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:13:45.525660 (Thread-4): 18:13:45  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:45.525757 (Thread-4): 18:13:45  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:13:45.525953 (Thread-4): 18:13:45  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:13:45.612774 (Thread-4): 18:13:45  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:45.625286 (Thread-4): 18:13:45  finished collecting timing info
2022-03-03 18:13:45.625457 (Thread-4): 18:13:45  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:13:45.650585 (Thread-4): 18:13:45  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:45.650734 (Thread-4): 18:13:45  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:13:45.650827 (Thread-4): 18:13:45  Opening a new connection, currently in state init
2022-03-03 18:13:45.837359 (Thread-662): handling poll request
2022-03-03 18:13:45.837740 (Thread-662): 18:13:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c49aecd0>]}
2022-03-03 18:13:45.838517 (Thread-662): sending response (<Response 15554 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:47.739747 (Thread-663): handling poll request
2022-03-03 18:13:47.740075 (Thread-663): 18:13:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4fb1820>]}
2022-03-03 18:13:47.740555 (Thread-663): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:48.032583 (Thread-4): 18:13:48  SQL status: SUCCESS 1 in 2.38 seconds
2022-03-03 18:13:48.036167 (Thread-4): 18:13:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:48.036306 (Thread-4): 18:13:48  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 18:13:48.245461 (Thread-4): 18:13:48  SQL status: SUCCESS 10 in 0.21 seconds
2022-03-03 18:13:48.249921 (Thread-4): 18:13:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:48.250051 (Thread-4): 18:13:48  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 18:13:48.399913 (Thread-4): 18:13:48  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 18:13:48.408904 (Thread-4): 18:13:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:48.409038 (Thread-4): 18:13:48  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 18:13:48.548399 (Thread-4): 18:13:48  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 18:13:48.570466 (Thread-4): 18:13:48  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:48.585437 (Thread-4): 18:13:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:48.585602 (Thread-4): 18:13:48  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 18:13:48.826767 (Thread-4): 18:13:48  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-03 18:13:48.827020 (Thread-4): 18:13:48  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:48.827111 (Thread-4): 18:13:48  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 18:13:49.620730 (Thread-4): 18:13:49  SQL status: SUCCESS 0 in 0.79 seconds
2022-03-03 18:13:49.620939 (Thread-4): 18:13:49  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:13:49.621025 (Thread-4): 18:13:49  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 18:13:49.690886 (Thread-664): handling poll request
2022-03-03 18:13:49.691222 (Thread-664): 18:13:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4947a00>]}
2022-03-03 18:13:49.691947 (Thread-664): sending response (<Response 9484 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:50.020173 (Thread-4): 18:13:50  SQL status: SUCCESS 1 in 0.4 seconds
2022-03-03 18:13:50.021858 (Thread-4): 18:13:50  finished collecting timing info
2022-03-03 18:13:50.022081 (Thread-4): 18:13:50  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:13:50.307931 (Thread-4): 18:13:50  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecb9a4f-c2f1-429e-9c5b-299edddfca00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61a04ef340>]}
2022-03-03 18:13:50.308363 (Thread-4): 18:13:50  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 4.78s]
2022-03-03 18:13:50.308495 (Thread-4): 18:13:50  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:13:50.310187 (MainThread): 18:13:50  Acquiring new snowflake connection "master"
2022-03-03 18:13:50.310576 (MainThread): 18:13:50  
2022-03-03 18:13:50.310704 (MainThread): 18:13:50  Finished running 1 table model, 1 view model, 1 incremental model in 14.14s.
2022-03-03 18:13:50.310794 (MainThread): 18:13:50  Connection 'master' was properly closed.
2022-03-03 18:13:50.310865 (MainThread): 18:13:50  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 18:13:50.310932 (MainThread): 18:13:50  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 18:13:50.310996 (MainThread): 18:13:50  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:13:50.374288 (MainThread): 18:13:50  
2022-03-03 18:13:50.374507 (MainThread): 18:13:50  Completed successfully
2022-03-03 18:13:50.374613 (MainThread): 18:13:50  
2022-03-03 18:13:50.374711 (MainThread): 18:13:50  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 18:13:51.505480 (Thread-665): handling poll request
2022-03-03 18:13:51.505825 (Thread-665): 18:13:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e411c790>]}
2022-03-03 18:13:51.507198 (Thread-665): sending response (<Response 24600 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:53.198261 (Thread-666): handling status request
2022-03-03 18:13:53.198610 (Thread-666): 18:13:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e411c5e0>]}
2022-03-03 18:13:53.199213 (Thread-666): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:13:53.477146 (Thread-667): handling status request
2022-03-03 18:13:53.477497 (Thread-667): 18:13:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e411cca0>]}
2022-03-03 18:13:53.478001 (Thread-667): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:27.328494 (Thread-668): 18:17:27  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 18:17:27.330225 (Thread-668): 18:17:27  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 18:17:27.336853 (Thread-668): 18:17:27  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 18:17:27.348441 (Thread-668): 18:17:27  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 18:17:27.402504 (Thread-668): 18:17:27  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4eb95b0>]}
2022-03-03 18:17:28.709587 (Thread-669): handling status request
2022-03-03 18:17:28.709931 (Thread-669): 18:17:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46139a0>]}
2022-03-03 18:17:28.710466 (Thread-669): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:28.713003 (Thread-670): handling status request
2022-03-03 18:17:28.713228 (Thread-670): 18:17:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51040ceca0>]}
2022-03-03 18:17:28.713602 (Thread-670): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:48.582584 (Thread-671): handling status request
2022-03-03 18:17:48.583056 (Thread-671): 18:17:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4668640>]}
2022-03-03 18:17:48.583554 (Thread-671): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:48.995101 (Thread-672): handling status request
2022-03-03 18:17:48.995449 (Thread-672): 18:17:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02c7280>]}
2022-03-03 18:17:48.995941 (Thread-672): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:49.404148 (Thread-673): handling cli_args request
2022-03-03 18:17:49.404475 (Thread-673): 18:17:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02c7d30>]}
2022-03-03 18:17:51.697992 (Thread-673): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:51.996362 (MainThread): 18:17:51  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:17:51.996830 (MainThread): 18:17:51  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:17:52.004696 (MainThread): 18:17:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d3e0c69-f145-4edd-b726-d9aa875e44d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0bba9d0>]}
2022-03-03 18:17:52.033438 (MainThread): 18:17:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d3e0c69-f145-4edd-b726-d9aa875e44d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0c94790>]}
2022-03-03 18:17:52.033709 (MainThread): 18:17:52  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:17:52.035385 (MainThread): 18:17:52  
2022-03-03 18:17:52.035696 (MainThread): 18:17:52  Acquiring new snowflake connection "master"
2022-03-03 18:17:52.036559 (ThreadPoolExecutor-0_0): 18:17:52  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:17:52.050178 (ThreadPoolExecutor-0_0): 18:17:52  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:17:52.050288 (ThreadPoolExecutor-0_0): 18:17:52  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:17:52.050372 (ThreadPoolExecutor-0_0): 18:17:52  Opening a new connection, currently in state init
2022-03-03 18:17:52.587821 (Thread-674): handling poll request
2022-03-03 18:17:52.588232 (Thread-674): 18:17:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d02c72b0>]}
2022-03-03 18:17:52.589218 (Thread-674): sending response (<Response 4179 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:53.467156 (ThreadPoolExecutor-0_0): 18:17:53  SQL status: SUCCESS 8 in 1.42 seconds
2022-03-03 18:17:53.469200 (ThreadPoolExecutor-0_0): 18:17:53  On list_DBT_RAW: Close
2022-03-03 18:17:53.873266 (ThreadPoolExecutor-2_0): 18:17:53  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:17:53.937458 (ThreadPoolExecutor-2_0): 18:17:53  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:17:53.937634 (ThreadPoolExecutor-2_0): 18:17:53  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:17:53.937740 (ThreadPoolExecutor-2_0): 18:17:53  Opening a new connection, currently in state closed
2022-03-03 18:17:54.441347 (Thread-675): handling poll request
2022-03-03 18:17:54.441691 (Thread-675): 18:17:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45adfa0>]}
2022-03-03 18:17:54.442241 (Thread-675): sending response (<Response 2332 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:55.066679 (ThreadPoolExecutor-2_0): 18:17:55  SQL status: SUCCESS 34 in 1.13 seconds
2022-03-03 18:17:55.068951 (ThreadPoolExecutor-2_0): 18:17:55  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:17:55.293742 (MainThread): 18:17:55  Concurrency: 4 threads (target='default')
2022-03-03 18:17:55.293916 (MainThread): 18:17:55  
2022-03-03 18:17:55.296810 (Thread-3): 18:17:55  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:17:55.297216 (Thread-3): 18:17:55  1 of 1 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 18:17:55.297503 (Thread-3): 18:17:55  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:17:55.297606 (Thread-3): 18:17:55  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:17:55.297714 (Thread-3): 18:17:55  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:17:55.331974 (Thread-3): 18:17:55  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:17:55.332143 (Thread-3): 18:17:55  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:17:55.332242 (Thread-3): 18:17:55  Opening a new connection, currently in state closed
2022-03-03 18:17:56.127061 (Thread-3): 18:17:56  SQL status: SUCCESS 5 in 0.79 seconds
2022-03-03 18:17:56.157411 (Thread-3): 18:17:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:17:56.157568 (Thread-3): 18:17:56  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 18:17:56.297268 (Thread-3): 18:17:56  SQL status: SUCCESS 5 in 0.14 seconds
2022-03-03 18:17:56.331575 (Thread-3): 18:17:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:17:56.345945 (Thread-3): 18:17:56  finished collecting timing info
2022-03-03 18:17:56.346146 (Thread-3): 18:17:56  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:17:56.366047 (Thread-676): handling poll request
2022-03-03 18:17:56.366387 (Thread-676): 18:17:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51043254c0>]}
2022-03-03 18:17:56.367132 (Thread-676): sending response (<Response 8026 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:17:56.371817 (Thread-3): 18:17:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:17:56.385580 (Thread-3): 18:17:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 18:17:56.385734 (Thread-3): 18:17:56  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 18:17:57.047320 (Thread-3): 18:17:57  SQL status: SUCCESS 1 in 0.66 seconds
2022-03-03 18:17:57.053903 (Thread-3): 18:17:57  finished collecting timing info
2022-03-03 18:17:57.054085 (Thread-3): 18:17:57  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 18:17:57.271083 (Thread-3): 18:17:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d3e0c69-f145-4edd-b726-d9aa875e44d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249b516f40>]}
2022-03-03 18:17:57.271548 (Thread-3): 18:17:57  1 of 1 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.97s]
2022-03-03 18:17:57.271690 (Thread-3): 18:17:57  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 18:17:57.273373 (MainThread): 18:17:57  Acquiring new snowflake connection "master"
2022-03-03 18:17:57.273699 (MainThread): 18:17:57  
2022-03-03 18:17:57.273802 (MainThread): 18:17:57  Finished running 1 view model in 5.24s.
2022-03-03 18:17:57.273890 (MainThread): 18:17:57  Connection 'master' was properly closed.
2022-03-03 18:17:57.273960 (MainThread): 18:17:57  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 18:17:57.335925 (MainThread): 18:17:57  
2022-03-03 18:17:57.336169 (MainThread): 18:17:57  Completed successfully
2022-03-03 18:17:57.336287 (MainThread): 18:17:57  
2022-03-03 18:17:57.336385 (MainThread): 18:17:57  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 18:17:58.272470 (Thread-677): handling poll request
2022-03-03 18:17:58.272876 (Thread-677): 18:17:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042e17c0>]}
2022-03-03 18:17:58.273996 (Thread-677): sending response (<Response 14375 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:18:00.007621 (Thread-678): handling status request
2022-03-03 18:18:00.007948 (Thread-678): 18:18:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e443aeb0>]}
2022-03-03 18:18:00.008487 (Thread-678): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:18:00.280406 (Thread-679): handling status request
2022-03-03 18:18:00.280926 (Thread-679): 18:18:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e443aac0>]}
2022-03-03 18:18:00.281632 (Thread-679): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:42:25.973005 (Thread-680): handling status request
2022-03-03 18:42:25.973426 (Thread-680): 18:42:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044cc6d0>]}
2022-03-03 18:42:25.973935 (Thread-680): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:42:25.978215 (Thread-681): handling ps request
2022-03-03 18:42:25.978607 (Thread-681): 18:42:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e443a940>]}
2022-03-03 18:42:25.979901 (Thread-681): sending response (<Response 9763 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:42:28.623298 (Thread-682): handling poll request
2022-03-03 18:42:28.623643 (Thread-682): 18:42:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044cca60>]}
2022-03-03 18:42:28.628902 (Thread-683): handling status request
2022-03-03 18:42:28.629170 (Thread-683): 18:42:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042ea040>]}
2022-03-03 18:42:28.647732 (Thread-682): sending response (<Response 27914 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:42:28.648169 (Thread-683): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:42:33.594567 (Thread-684): handling status request
2022-03-03 18:42:33.594911 (Thread-684): 18:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51043250a0>]}
2022-03-03 18:42:33.595405 (Thread-684): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:42:33.619726 (Thread-685): handling status request
2022-03-03 18:42:33.619998 (Thread-685): 18:42:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044ccca0>]}
2022-03-03 18:42:33.620455 (Thread-685): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:02.998217 (Thread-686): handling status request
2022-03-03 18:44:02.999895 (Thread-686): 18:44:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044ccb20>]}
2022-03-03 18:44:03.000386 (Thread-686): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:03.932219 (Thread-687): handling status request
2022-03-03 18:44:03.932621 (Thread-687): 18:44:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e407b3a0>]}
2022-03-03 18:44:03.933145 (Thread-687): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:03.939414 (Thread-688): handling cli_args request
2022-03-03 18:44:03.939685 (Thread-688): 18:44:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e41abf10>]}
2022-03-03 18:44:06.184201 (Thread-688): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:06.824080 (MainThread): 18:44:06  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:44:06.824518 (MainThread): 18:44:06  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:44:06.832273 (MainThread): 18:44:06  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e613c605-afb0-4d09-b34d-dc535d4a5609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fb0ba8b0>]}
2022-03-03 18:44:06.870239 (MainThread): 18:44:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e613c605-afb0-4d09-b34d-dc535d4a5609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fb19afd0>]}
2022-03-03 18:44:06.870516 (MainThread): 18:44:06  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:44:06.872252 (MainThread): 18:44:06  
2022-03-03 18:44:06.872561 (MainThread): 18:44:06  Acquiring new snowflake connection "master"
2022-03-03 18:44:06.873396 (ThreadPoolExecutor-0_0): 18:44:06  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:44:06.886712 (ThreadPoolExecutor-0_0): 18:44:06  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:44:06.886829 (ThreadPoolExecutor-0_0): 18:44:06  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:44:06.886915 (ThreadPoolExecutor-0_0): 18:44:06  Opening a new connection, currently in state init
2022-03-03 18:44:07.041167 (Thread-689): handling poll request
2022-03-03 18:44:07.041581 (Thread-689): 18:44:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044cce50>]}
2022-03-03 18:44:07.042583 (Thread-689): sending response (<Response 4178 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:07.932183 (ThreadPoolExecutor-0_0): 18:44:07  SQL status: SUCCESS 8 in 1.05 seconds
2022-03-03 18:44:07.934162 (ThreadPoolExecutor-0_0): 18:44:07  On list_DBT_RAW: Close
2022-03-03 18:44:08.326911 (ThreadPoolExecutor-2_0): 18:44:08  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:44:08.386865 (ThreadPoolExecutor-2_0): 18:44:08  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:44:08.387044 (ThreadPoolExecutor-2_0): 18:44:08  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:44:08.387160 (ThreadPoolExecutor-2_0): 18:44:08  Opening a new connection, currently in state closed
2022-03-03 18:44:08.819888 (Thread-690): handling poll request
2022-03-03 18:44:08.820231 (Thread-690): 18:44:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4368850>]}
2022-03-03 18:44:08.820847 (Thread-690): sending response (<Response 2330 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:09.511383 (ThreadPoolExecutor-2_0): 18:44:09  SQL status: SUCCESS 33 in 1.12 seconds
2022-03-03 18:44:09.513596 (ThreadPoolExecutor-2_0): 18:44:09  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:44:09.806617 (MainThread): 18:44:09  Concurrency: 4 threads (target='default')
2022-03-03 18:44:09.806829 (MainThread): 18:44:09  
2022-03-03 18:44:09.809711 (Thread-3): 18:44:09  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:44:09.810022 (Thread-3): 18:44:09  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:44:09.810290 (Thread-3): 18:44:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:44:09.810397 (Thread-3): 18:44:09  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:44:09.810507 (Thread-3): 18:44:09  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:44:09.894461 (Thread-3): 18:44:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:44:09.913224 (Thread-3): 18:44:09  finished collecting timing info
2022-03-03 18:44:09.913416 (Thread-3): 18:44:09  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:44:09.953952 (Thread-3): 18:44:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:44:09.974945 (Thread-3): 18:44:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:44:09.975082 (Thread-3): 18:44:09  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:44:09.975175 (Thread-3): 18:44:09  Opening a new connection, currently in state closed
2022-03-03 18:44:10.673825 (Thread-691): handling poll request
2022-03-03 18:44:10.674181 (Thread-691): 18:44:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4bd9b80>]}
2022-03-03 18:44:10.674992 (Thread-691): sending response (<Response 7405 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:12.512908 (Thread-692): handling poll request
2022-03-03 18:44:12.513273 (Thread-692): 18:44:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4f8ab20>]}
2022-03-03 18:44:12.513794 (Thread-692): sending response (<Response 333 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:12.638840 (Thread-3): 18:44:12  SQL status: SUCCESS 1 in 2.66 seconds
2022-03-03 18:44:12.648308 (Thread-3): 18:44:12  finished collecting timing info
2022-03-03 18:44:12.648480 (Thread-3): 18:44:12  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:44:12.889195 (Thread-3): 18:44:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e613c605-afb0-4d09-b34d-dc535d4a5609', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f98f7160>]}
2022-03-03 18:44:12.889631 (Thread-3): 18:44:12  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 3.08s]
2022-03-03 18:44:12.889764 (Thread-3): 18:44:12  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:44:12.891483 (MainThread): 18:44:12  Acquiring new snowflake connection "master"
2022-03-03 18:44:12.891810 (MainThread): 18:44:12  
2022-03-03 18:44:12.891974 (MainThread): 18:44:12  Finished running 1 incremental model in 6.02s.
2022-03-03 18:44:12.892144 (MainThread): 18:44:12  Connection 'master' was properly closed.
2022-03-03 18:44:12.892289 (MainThread): 18:44:12  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:44:12.983015 (MainThread): 18:44:12  
2022-03-03 18:44:12.983344 (MainThread): 18:44:12  Completed successfully
2022-03-03 18:44:12.983544 (MainThread): 18:44:12  
2022-03-03 18:44:12.983702 (MainThread): 18:44:12  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 18:44:14.317716 (Thread-693): handling poll request
2022-03-03 18:44:14.318079 (Thread-693): 18:44:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afc23dc0>]}
2022-03-03 18:44:14.319189 (Thread-693): sending response (<Response 10292 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:15.798223 (Thread-694): handling status request
2022-03-03 18:44:15.798573 (Thread-694): 18:44:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45fb4c0>]}
2022-03-03 18:44:15.799121 (Thread-694): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:44:16.102369 (Thread-695): handling status request
2022-03-03 18:44:16.102707 (Thread-695): 18:44:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e45fbe50>]}
2022-03-03 18:44:16.103179 (Thread-695): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:17.576999 (Thread-696): handling status request
2022-03-03 18:46:17.578626 (Thread-696): 18:46:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44eebb0>]}
2022-03-03 18:46:17.579130 (Thread-696): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:17.909374 (Thread-697): handling status request
2022-03-03 18:46:17.909709 (Thread-697): 18:46:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e411c550>]}
2022-03-03 18:46:17.910207 (Thread-697): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:18.192342 (Thread-698): handling cli_args request
2022-03-03 18:46:18.192723 (Thread-698): 18:46:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e462c280>]}
2022-03-03 18:46:20.435557 (Thread-698): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:20.994254 (MainThread): 18:46:20  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:46:20.994692 (MainThread): 18:46:20  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:46:21.002487 (MainThread): 18:46:21  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2bafc40-e617-4720-8287-e20caf2e786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc5af9a00>]}
2022-03-03 18:46:21.037649 (MainThread): 18:46:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2bafc40-e617-4720-8287-e20caf2e786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc5bd47c0>]}
2022-03-03 18:46:21.038058 (MainThread): 18:46:21  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:46:21.039651 (MainThread): 18:46:21  
2022-03-03 18:46:21.039933 (MainThread): 18:46:21  Acquiring new snowflake connection "master"
2022-03-03 18:46:21.040729 (ThreadPoolExecutor-0_0): 18:46:21  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:46:21.053879 (ThreadPoolExecutor-0_0): 18:46:21  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:46:21.053986 (ThreadPoolExecutor-0_0): 18:46:21  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:46:21.054072 (ThreadPoolExecutor-0_0): 18:46:21  Opening a new connection, currently in state init
2022-03-03 18:46:21.173307 (Thread-699): handling poll request
2022-03-03 18:46:21.173782 (Thread-699): 18:46:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46f2e50>]}
2022-03-03 18:46:21.175373 (Thread-699): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:22.326338 (ThreadPoolExecutor-0_0): 18:46:22  SQL status: SUCCESS 8 in 1.27 seconds
2022-03-03 18:46:22.328652 (ThreadPoolExecutor-0_0): 18:46:22  On list_DBT_RAW: Close
2022-03-03 18:46:22.561110 (ThreadPoolExecutor-2_0): 18:46:22  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:46:22.619020 (ThreadPoolExecutor-2_0): 18:46:22  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:46:22.619171 (ThreadPoolExecutor-2_0): 18:46:22  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:46:22.619269 (ThreadPoolExecutor-2_0): 18:46:22  Opening a new connection, currently in state closed
2022-03-03 18:46:22.921150 (Thread-700): handling poll request
2022-03-03 18:46:22.921491 (Thread-700): 18:46:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5104325ac0>]}
2022-03-03 18:46:22.922051 (Thread-700): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:23.473955 (ThreadPoolExecutor-2_0): 18:46:23  SQL status: SUCCESS 34 in 0.85 seconds
2022-03-03 18:46:23.477418 (ThreadPoolExecutor-2_0): 18:46:23  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:46:23.712191 (MainThread): 18:46:23  Concurrency: 4 threads (target='default')
2022-03-03 18:46:23.712381 (MainThread): 18:46:23  
2022-03-03 18:46:23.715250 (Thread-3): 18:46:23  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:46:23.715577 (Thread-3): 18:46:23  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:46:23.715851 (Thread-3): 18:46:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:23.715963 (Thread-3): 18:46:23  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:46:23.716071 (Thread-3): 18:46:23  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:46:23.805338 (Thread-3): 18:46:23  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:23.824851 (Thread-3): 18:46:23  finished collecting timing info
2022-03-03 18:46:23.825078 (Thread-3): 18:46:23  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:46:23.877856 (Thread-3): 18:46:23  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:23.878013 (Thread-3): 18:46:23  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 18:46:23.878110 (Thread-3): 18:46:23  Opening a new connection, currently in state closed
2022-03-03 18:46:25.095955 (Thread-701): handling poll request
2022-03-03 18:46:25.096355 (Thread-701): 18:46:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4613760>]}
2022-03-03 18:46:25.097155 (Thread-701): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:27.090708 (Thread-702): handling poll request
2022-03-03 18:46:27.091050 (Thread-702): 18:46:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4eb95b0>]}
2022-03-03 18:46:27.091528 (Thread-702): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:28.381644 (Thread-3): 18:46:28  SQL status: SUCCESS 1 in 4.5 seconds
2022-03-03 18:46:28.391197 (Thread-3): 18:46:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:28.391336 (Thread-3): 18:46:28  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 18:46:28.551853 (Thread-3): 18:46:28  SQL status: SUCCESS 10 in 0.16 seconds
2022-03-03 18:46:28.555907 (Thread-3): 18:46:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:28.556033 (Thread-3): 18:46:28  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 18:46:28.675305 (Thread-3): 18:46:28  SQL status: SUCCESS 10 in 0.12 seconds
2022-03-03 18:46:28.685981 (Thread-3): 18:46:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:28.686138 (Thread-3): 18:46:28  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 18:46:28.834635 (Thread-3): 18:46:28  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 18:46:28.856309 (Thread-3): 18:46:28  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:28.876905 (Thread-3): 18:46:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:28.877069 (Thread-3): 18:46:28  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 18:46:29.059503 (Thread-3): 18:46:29  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-03 18:46:29.059749 (Thread-3): 18:46:29  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:29.059837 (Thread-3): 18:46:29  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 18:46:29.082032 (Thread-703): handling poll request
2022-03-03 18:46:29.082362 (Thread-703): 18:46:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042bf490>]}
2022-03-03 18:46:29.083043 (Thread-703): sending response (<Response 8389 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:31.005501 (Thread-3): 18:46:31  SQL status: SUCCESS 1 in 1.95 seconds
2022-03-03 18:46:31.005704 (Thread-3): 18:46:31  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:46:31.005930 (Thread-3): 18:46:31  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 18:46:31.108018 (Thread-704): handling poll request
2022-03-03 18:46:31.108360 (Thread-704): 18:46:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4bd9640>]}
2022-03-03 18:46:31.109028 (Thread-704): sending response (<Response 1409 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:31.703987 (Thread-3): 18:46:31  SQL status: SUCCESS 1 in 0.7 seconds
2022-03-03 18:46:31.715244 (Thread-3): 18:46:31  finished collecting timing info
2022-03-03 18:46:31.715442 (Thread-3): 18:46:31  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 18:46:31.958391 (Thread-3): 18:46:31  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2bafc40-e617-4720-8287-e20caf2e786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedccdcfb50>]}
2022-03-03 18:46:31.958938 (Thread-3): 18:46:31  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 8.24s]
2022-03-03 18:46:31.959090 (Thread-3): 18:46:31  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:46:31.960790 (MainThread): 18:46:31  Acquiring new snowflake connection "master"
2022-03-03 18:46:31.961127 (MainThread): 18:46:31  
2022-03-03 18:46:31.961235 (MainThread): 18:46:31  Finished running 1 incremental model in 10.92s.
2022-03-03 18:46:31.961322 (MainThread): 18:46:31  Connection 'master' was properly closed.
2022-03-03 18:46:31.961392 (MainThread): 18:46:31  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:46:32.038031 (MainThread): 18:46:32  
2022-03-03 18:46:32.038255 (MainThread): 18:46:32  Completed successfully
2022-03-03 18:46:32.038367 (MainThread): 18:46:32  
2022-03-03 18:46:32.038463 (MainThread): 18:46:32  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 18:46:33.091211 (Thread-705): handling poll request
2022-03-03 18:46:33.091550 (Thread-705): 18:46:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51042e1d60>]}
2022-03-03 18:46:33.092615 (Thread-705): sending response (<Response 11332 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:34.503299 (Thread-706): handling status request
2022-03-03 18:46:34.503664 (Thread-706): 18:46:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46f2d60>]}
2022-03-03 18:46:34.504252 (Thread-706): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:46:34.603408 (Thread-707): handling status request
2022-03-03 18:46:34.603743 (Thread-707): 18:46:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e46f27c0>]}
2022-03-03 18:46:34.604225 (Thread-707): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:49:11.812492 (Thread-708): 18:49:11  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 18:49:11.814380 (Thread-708): 18:49:11  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 18:49:11.820586 (Thread-708): 18:49:11  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 18:49:11.831523 (Thread-708): 18:49:11  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 18:49:11.905756 (Thread-708): 18:49:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e75e0>]}
2022-03-03 18:49:12.852052 (Thread-709): handling status request
2022-03-03 18:49:12.852405 (Thread-709): 18:49:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51044ccf40>]}
2022-03-03 18:49:12.853006 (Thread-709): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:49:12.908658 (Thread-710): handling status request
2022-03-03 18:49:12.908997 (Thread-710): 18:49:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4333040>]}
2022-03-03 18:49:12.909498 (Thread-710): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:17.716391 (Thread-711): 18:55:17  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 18:55:17.718189 (Thread-711): 18:55:17  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 18:55:17.724481 (Thread-711): 18:55:17  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 18:55:17.735247 (Thread-711): 18:55:17  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 18:55:17.787665 (Thread-711): 18:55:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af624a90>]}
2022-03-03 18:55:19.026662 (Thread-712): handling status request
2022-03-03 18:55:19.027222 (Thread-712): 18:55:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af8a3c70>]}
2022-03-03 18:55:19.027755 (Thread-713): handling status request
2022-03-03 18:55:19.029792 (Thread-713): 18:55:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e42b0>]}
2022-03-03 18:55:19.049472 (Thread-712): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:19.049887 (Thread-713): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:41.168613 (Thread-714): handling status request
2022-03-03 18:55:41.168989 (Thread-714): 18:55:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e4c40>]}
2022-03-03 18:55:41.169480 (Thread-714): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:41.472340 (Thread-715): handling status request
2022-03-03 18:55:41.472726 (Thread-715): 18:55:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e42b0>]}
2022-03-03 18:55:41.473242 (Thread-715): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:41.637937 (Thread-716): handling cli_args request
2022-03-03 18:55:41.638278 (Thread-716): 18:55:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e4100>]}
2022-03-03 18:55:43.896121 (Thread-716): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:44.187636 (MainThread): 18:55:44  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 18:55:44.188091 (MainThread): 18:55:44  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 18:55:44.195841 (MainThread): 18:55:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828bbf4b-4e8e-443b-8b74-3531d1dbcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815eafb9a0>]}
2022-03-03 18:55:44.223827 (MainThread): 18:55:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828bbf4b-4e8e-443b-8b74-3531d1dbcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815ebd0760>]}
2022-03-03 18:55:44.224126 (MainThread): 18:55:44  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 18:55:44.225811 (MainThread): 18:55:44  
2022-03-03 18:55:44.226115 (MainThread): 18:55:44  Acquiring new snowflake connection "master"
2022-03-03 18:55:44.226938 (ThreadPoolExecutor-0_0): 18:55:44  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 18:55:44.240363 (ThreadPoolExecutor-0_0): 18:55:44  Using snowflake connection "list_DBT_RAW"
2022-03-03 18:55:44.240473 (ThreadPoolExecutor-0_0): 18:55:44  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 18:55:44.240557 (ThreadPoolExecutor-0_0): 18:55:44  Opening a new connection, currently in state init
2022-03-03 18:55:44.693266 (Thread-717): handling poll request
2022-03-03 18:55:44.693787 (Thread-717): 18:55:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af8a3070>]}
2022-03-03 18:55:44.694944 (Thread-717): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:45.169521 (ThreadPoolExecutor-0_0): 18:55:45  SQL status: SUCCESS 8 in 0.93 seconds
2022-03-03 18:55:45.171605 (ThreadPoolExecutor-0_0): 18:55:45  On list_DBT_RAW: Close
2022-03-03 18:55:45.449177 (ThreadPoolExecutor-2_0): 18:55:45  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:55:45.528522 (ThreadPoolExecutor-2_0): 18:55:45  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 18:55:45.528796 (ThreadPoolExecutor-2_0): 18:55:45  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 18:55:45.528928 (ThreadPoolExecutor-2_0): 18:55:45  Opening a new connection, currently in state closed
2022-03-03 18:55:46.466996 (Thread-718): handling poll request
2022-03-03 18:55:46.467344 (Thread-718): 18:55:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e44f0>]}
2022-03-03 18:55:46.467916 (Thread-718): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:46.505432 (ThreadPoolExecutor-2_0): 18:55:46  SQL status: SUCCESS 33 in 0.98 seconds
2022-03-03 18:55:46.507764 (ThreadPoolExecutor-2_0): 18:55:46  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 18:55:46.714982 (MainThread): 18:55:46  Concurrency: 4 threads (target='default')
2022-03-03 18:55:46.715171 (MainThread): 18:55:46  
2022-03-03 18:55:46.718383 (Thread-3): 18:55:46  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:55:46.718753 (Thread-3): 18:55:46  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 18:55:46.719055 (Thread-3): 18:55:46  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:55:46.719164 (Thread-3): 18:55:46  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:55:46.719274 (Thread-3): 18:55:46  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:55:46.803130 (Thread-3): 18:55:46  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 18:55:46.816182 (Thread-3): 18:55:46  finished collecting timing info
2022-03-03 18:55:46.816367 (Thread-3): 18:55:46  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:55:46.842800 (Thread-3): 18:55:46  finished collecting timing info
2022-03-03 18:55:46.843167 (Thread-3): 18:55:46  Compilation Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
  Invalid incremental strategy provided: ['merge', 'insert']
      Expected one of: 'merge', 'delete+insert'
  
  > in macro dbt_snowflake_validate_get_incremental_strategy (macros/materializations/incremental.sql)
  > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
  > called by model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 18:55:46.843371 (Thread-3): 18:55:46  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828bbf4b-4e8e-443b-8b74-3531d1dbcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815d477fd0>]}
2022-03-03 18:55:46.843798 (Thread-3): 18:55:46  1 of 1 ERROR creating incremental model DBT_VAULT.sat_customer_demo............. [ERROR in 0.12s]
2022-03-03 18:55:46.843918 (Thread-3): 18:55:46  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 18:55:46.845490 (MainThread): 18:55:46  Acquiring new snowflake connection "master"
2022-03-03 18:55:46.845785 (MainThread): 18:55:46  
2022-03-03 18:55:46.845886 (MainThread): 18:55:46  Finished running 1 incremental model in 2.62s.
2022-03-03 18:55:46.845976 (MainThread): 18:55:46  Connection 'master' was properly closed.
2022-03-03 18:55:46.846044 (MainThread): 18:55:46  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 18:55:46.911745 (MainThread): 18:55:46  
2022-03-03 18:55:46.911963 (MainThread): 18:55:46  Completed with 1 error and 0 warnings:
2022-03-03 18:55:46.912061 (MainThread): 18:55:46  
2022-03-03 18:55:46.912158 (MainThread): 18:55:46  Compilation Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 18:55:46.912247 (MainThread): 18:55:46    Invalid incremental strategy provided: ['merge', 'insert']
2022-03-03 18:55:46.912318 (MainThread): 18:55:46        Expected one of: 'merge', 'delete+insert'
2022-03-03 18:55:46.912388 (MainThread): 18:55:46    
2022-03-03 18:55:46.912455 (MainThread): 18:55:46    > in macro dbt_snowflake_validate_get_incremental_strategy (macros/materializations/incremental.sql)
2022-03-03 18:55:46.912520 (MainThread): 18:55:46    > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
2022-03-03 18:55:46.912584 (MainThread): 18:55:46    > called by model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 18:55:46.912748 (MainThread): 18:55:46  
2022-03-03 18:55:46.912953 (MainThread): 18:55:46  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 18:55:48.232571 (Thread-719): handling poll request
2022-03-03 18:55:48.232965 (Thread-719): 18:55:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af66e910>]}
2022-03-03 18:55:48.234299 (Thread-719): sending response (<Response 19224 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:49.631780 (Thread-720): handling status request
2022-03-03 18:55:49.632135 (Thread-720): 18:55:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af66e820>]}
2022-03-03 18:55:49.632732 (Thread-720): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 18:55:49.638445 (Thread-721): handling status request
2022-03-03 18:55:49.638678 (Thread-721): 18:55:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af66ef70>]}
2022-03-03 18:55:49.639100 (Thread-721): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:13:44.462170 (Thread-722): 19:13:44  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:13:44.464226 (Thread-722): 19:13:44  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 19:13:44.471407 (Thread-722): 19:13:44  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 19:13:44.483996 (Thread-722): 19:13:44  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 19:13:44.560257 (Thread-722): 19:13:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5d9700>]}
2022-03-03 19:13:45.367604 (Thread-723): handling status request
2022-03-03 19:13:45.368206 (Thread-723): 19:13:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7c48b0>]}
2022-03-03 19:13:45.368719 (Thread-724): handling status request
2022-03-03 19:13:45.369345 (Thread-723): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:13:45.369677 (Thread-724): 19:13:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7e78b0>]}
2022-03-03 19:13:45.370196 (Thread-724): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:01.675456 (Thread-725): handling status request
2022-03-03 19:14:01.675796 (Thread-725): 19:14:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7c4370>]}
2022-03-03 19:14:01.676279 (Thread-725): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:01.976760 (Thread-726): handling status request
2022-03-03 19:14:01.977133 (Thread-726): 19:14:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7c4970>]}
2022-03-03 19:14:01.977614 (Thread-726): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:02.320904 (Thread-727): handling cli_args request
2022-03-03 19:14:02.321339 (Thread-727): 19:14:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af920b80>]}
2022-03-03 19:14:04.824271 (Thread-727): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:05.282334 (MainThread): 19:14:05  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:14:05.282860 (MainThread): 19:14:05  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:14:05.291390 (MainThread): 19:14:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76bf6253-eaff-426f-8517-163866db830a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f555d5fba60>]}
2022-03-03 19:14:05.336770 (MainThread): 19:14:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76bf6253-eaff-426f-8517-163866db830a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f555d6d4820>]}
2022-03-03 19:14:05.337118 (MainThread): 19:14:05  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:14:05.339620 (MainThread): 19:14:05  
2022-03-03 19:14:05.340086 (MainThread): 19:14:05  Acquiring new snowflake connection "master"
2022-03-03 19:14:05.341143 (ThreadPoolExecutor-0_0): 19:14:05  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:14:05.358694 (ThreadPoolExecutor-0_0): 19:14:05  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:14:05.358827 (ThreadPoolExecutor-0_0): 19:14:05  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:14:05.358950 (ThreadPoolExecutor-0_0): 19:14:05  Opening a new connection, currently in state init
2022-03-03 19:14:05.631328 (Thread-728): handling poll request
2022-03-03 19:14:05.631737 (Thread-728): 19:14:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7c4550>]}
2022-03-03 19:14:05.632778 (Thread-728): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:06.547930 (ThreadPoolExecutor-0_0): 19:14:06  SQL status: SUCCESS 8 in 1.19 seconds
2022-03-03 19:14:06.550179 (ThreadPoolExecutor-0_0): 19:14:06  On list_DBT_RAW: Close
2022-03-03 19:14:06.776404 (ThreadPoolExecutor-2_0): 19:14:06  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:14:06.843926 (ThreadPoolExecutor-2_0): 19:14:06  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:14:06.844088 (ThreadPoolExecutor-2_0): 19:14:06  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:14:06.844190 (ThreadPoolExecutor-2_0): 19:14:06  Opening a new connection, currently in state closed
2022-03-03 19:14:07.432176 (Thread-729): handling poll request
2022-03-03 19:14:07.432542 (Thread-729): 19:14:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af779130>]}
2022-03-03 19:14:07.433193 (Thread-729): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:07.636560 (ThreadPoolExecutor-2_0): 19:14:07  SQL status: SUCCESS 33 in 0.79 seconds
2022-03-03 19:14:07.638825 (ThreadPoolExecutor-2_0): 19:14:07  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:14:07.941910 (MainThread): 19:14:07  Concurrency: 4 threads (target='default')
2022-03-03 19:14:07.942098 (MainThread): 19:14:07  
2022-03-03 19:14:07.945590 (Thread-3): 19:14:07  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:14:07.946010 (Thread-3): 19:14:07  1 of 1 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:14:07.946339 (Thread-3): 19:14:07  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:14:07.946454 (Thread-3): 19:14:07  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:14:07.946566 (Thread-3): 19:14:07  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:14:07.982799 (Thread-3): 19:14:07  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:14:07.982962 (Thread-3): 19:14:07  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:14:07.983056 (Thread-3): 19:14:07  Opening a new connection, currently in state closed
2022-03-03 19:14:08.736878 (Thread-3): 19:14:08  SQL status: SUCCESS 5 in 0.75 seconds
2022-03-03 19:14:08.780015 (Thread-3): 19:14:08  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:14:08.780183 (Thread-3): 19:14:08  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:14:08.956414 (Thread-3): 19:14:08  SQL status: SUCCESS 5 in 0.18 seconds
2022-03-03 19:14:08.991657 (Thread-3): 19:14:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:14:09.005356 (Thread-3): 19:14:09  finished collecting timing info
2022-03-03 19:14:09.005585 (Thread-3): 19:14:09  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:14:09.034449 (Thread-3): 19:14:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:14:09.050467 (Thread-3): 19:14:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:14:09.050636 (Thread-3): 19:14:09  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EFFECTIVE_TO AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:14:09.223789 (Thread-730): handling poll request
2022-03-03 19:14:09.224136 (Thread-730): 19:14:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af629520>]}
2022-03-03 19:14:09.225021 (Thread-730): sending response (<Response 11159 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:09.460029 (Thread-3): 19:14:09  SQL status: SUCCESS 1 in 0.41 seconds
2022-03-03 19:14:09.466933 (Thread-3): 19:14:09  finished collecting timing info
2022-03-03 19:14:09.467142 (Thread-3): 19:14:09  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:14:09.736423 (Thread-3): 19:14:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76bf6253-eaff-426f-8517-163866db830a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f555cd85280>]}
2022-03-03 19:14:09.736904 (Thread-3): 19:14:09  1 of 1 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.79s]
2022-03-03 19:14:09.737060 (Thread-3): 19:14:09  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:14:09.738861 (MainThread): 19:14:09  Acquiring new snowflake connection "master"
2022-03-03 19:14:09.739199 (MainThread): 19:14:09  
2022-03-03 19:14:09.739305 (MainThread): 19:14:09  Finished running 1 view model in 4.40s.
2022-03-03 19:14:09.739392 (MainThread): 19:14:09  Connection 'master' was properly closed.
2022-03-03 19:14:09.739462 (MainThread): 19:14:09  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:14:09.825003 (MainThread): 19:14:09  
2022-03-03 19:14:09.825298 (MainThread): 19:14:09  Completed successfully
2022-03-03 19:14:09.825448 (MainThread): 19:14:09  
2022-03-03 19:14:09.825645 (MainThread): 19:14:09  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:14:11.047246 (Thread-731): handling poll request
2022-03-03 19:14:11.047592 (Thread-731): 19:14:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af759790>]}
2022-03-03 19:14:11.048798 (Thread-731): sending response (<Response 11216 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:12.598519 (Thread-732): handling status request
2022-03-03 19:14:12.598887 (Thread-732): 19:14:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af759940>]}
2022-03-03 19:14:12.599448 (Thread-732): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:12.657200 (Thread-733): handling status request
2022-03-03 19:14:12.657554 (Thread-733): 19:14:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af759d30>]}
2022-03-03 19:14:12.658056 (Thread-733): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:16.993199 (Thread-734): handling status request
2022-03-03 19:14:16.993715 (Thread-734): 19:14:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af759f70>]}
2022-03-03 19:14:16.994212 (Thread-734): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:17.309939 (Thread-735): handling status request
2022-03-03 19:14:17.310284 (Thread-735): 19:14:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af88c220>]}
2022-03-03 19:14:17.310768 (Thread-735): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:17.627980 (Thread-736): handling cli_args request
2022-03-03 19:14:17.628328 (Thread-736): 19:14:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af88c490>]}
2022-03-03 19:14:19.853916 (Thread-736): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:20.277896 (MainThread): 19:14:20  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:14:20.278354 (MainThread): 19:14:20  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:14:20.286170 (MainThread): 19:14:20  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cff5995-9251-4e26-8ad0-10e7ae708fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67721bbac0>]}
2022-03-03 19:14:20.317294 (MainThread): 19:14:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cff5995-9251-4e26-8ad0-10e7ae708fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6772294880>]}
2022-03-03 19:14:20.317613 (MainThread): 19:14:20  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:14:20.319516 (MainThread): 19:14:20  
2022-03-03 19:14:20.319903 (MainThread): 19:14:20  Acquiring new snowflake connection "master"
2022-03-03 19:14:20.320803 (ThreadPoolExecutor-0_0): 19:14:20  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:14:20.334582 (ThreadPoolExecutor-0_0): 19:14:20  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:14:20.334707 (ThreadPoolExecutor-0_0): 19:14:20  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:14:20.334797 (ThreadPoolExecutor-0_0): 19:14:20  Opening a new connection, currently in state init
2022-03-03 19:14:20.620274 (Thread-737): handling poll request
2022-03-03 19:14:20.620698 (Thread-737): 19:14:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af921550>]}
2022-03-03 19:14:20.621988 (Thread-737): sending response (<Response 4178 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:21.528155 (ThreadPoolExecutor-0_0): 19:14:21  SQL status: SUCCESS 8 in 1.19 seconds
2022-03-03 19:14:21.530252 (ThreadPoolExecutor-0_0): 19:14:21  On list_DBT_RAW: Close
2022-03-03 19:14:21.752885 (ThreadPoolExecutor-2_0): 19:14:21  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:14:21.816487 (ThreadPoolExecutor-2_0): 19:14:21  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:14:21.816671 (ThreadPoolExecutor-2_0): 19:14:21  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:14:21.816778 (ThreadPoolExecutor-2_0): 19:14:21  Opening a new connection, currently in state closed
2022-03-03 19:14:22.389339 (Thread-738): handling poll request
2022-03-03 19:14:22.389680 (Thread-738): 19:14:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af88cc70>]}
2022-03-03 19:14:22.390247 (Thread-738): sending response (<Response 2330 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:22.539335 (ThreadPoolExecutor-2_0): 19:14:22  SQL status: SUCCESS 33 in 0.72 seconds
2022-03-03 19:14:22.541678 (ThreadPoolExecutor-2_0): 19:14:22  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:14:22.863516 (MainThread): 19:14:22  Concurrency: 4 threads (target='default')
2022-03-03 19:14:22.863694 (MainThread): 19:14:22  
2022-03-03 19:14:22.866689 (Thread-3): 19:14:22  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:22.867013 (Thread-3): 19:14:22  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:14:22.867288 (Thread-3): 19:14:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:14:22.867389 (Thread-3): 19:14:22  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:22.867499 (Thread-3): 19:14:22  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:22.957171 (Thread-3): 19:14:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:14:22.972554 (Thread-3): 19:14:22  finished collecting timing info
2022-03-03 19:14:22.972842 (Thread-3): 19:14:22  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:23.000716 (Thread-3): 19:14:23  finished collecting timing info
2022-03-03 19:14:23.001112 (Thread-3): 19:14:23  Compilation Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
  Invalid incremental strategy provided: ['merge', 'insert']
      Expected one of: 'merge', 'delete+insert'
  
  > in macro dbt_snowflake_validate_get_incremental_strategy (macros/materializations/incremental.sql)
  > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
  > called by model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 19:14:23.001323 (Thread-3): 19:14:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cff5995-9251-4e26-8ad0-10e7ae708fcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6770b171f0>]}
2022-03-03 19:14:23.001761 (Thread-3): 19:14:23  1 of 1 ERROR creating incremental model DBT_VAULT.sat_customer_demo............. [ERROR in 0.13s]
2022-03-03 19:14:23.001876 (Thread-3): 19:14:23  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:23.003338 (MainThread): 19:14:23  Acquiring new snowflake connection "master"
2022-03-03 19:14:23.003635 (MainThread): 19:14:23  
2022-03-03 19:14:23.003735 (MainThread): 19:14:23  Finished running 1 incremental model in 2.68s.
2022-03-03 19:14:23.003822 (MainThread): 19:14:23  Connection 'master' was properly closed.
2022-03-03 19:14:23.003890 (MainThread): 19:14:23  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:14:23.069828 (MainThread): 19:14:23  
2022-03-03 19:14:23.070042 (MainThread): 19:14:23  Completed with 1 error and 0 warnings:
2022-03-03 19:14:23.070140 (MainThread): 19:14:23  
2022-03-03 19:14:23.070233 (MainThread): 19:14:23  Compilation Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 19:14:23.070312 (MainThread): 19:14:23    Invalid incremental strategy provided: ['merge', 'insert']
2022-03-03 19:14:23.070380 (MainThread): 19:14:23        Expected one of: 'merge', 'delete+insert'
2022-03-03 19:14:23.070447 (MainThread): 19:14:23    
2022-03-03 19:14:23.070515 (MainThread): 19:14:23    > in macro dbt_snowflake_validate_get_incremental_strategy (macros/materializations/incremental.sql)
2022-03-03 19:14:23.070589 (MainThread): 19:14:23    > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
2022-03-03 19:14:23.070655 (MainThread): 19:14:23    > called by model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 19:14:23.070730 (MainThread): 19:14:23  
2022-03-03 19:14:23.070817 (MainThread): 19:14:23  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 19:14:23.963718 (Thread-739): handling poll request
2022-03-03 19:14:23.964081 (Thread-739): 19:14:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af759580>]}
2022-03-03 19:14:23.965402 (Thread-739): sending response (<Response 19239 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:25.366443 (Thread-740): handling status request
2022-03-03 19:14:25.366779 (Thread-740): 19:14:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af6292b0>]}
2022-03-03 19:14:25.367319 (Thread-740): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:25.618036 (Thread-741): handling status request
2022-03-03 19:14:25.618382 (Thread-741): 19:14:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af76cd90>]}
2022-03-03 19:14:25.618872 (Thread-741): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:35.941584 (Thread-742): 19:14:35  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:14:35.942140 (Thread-742): 19:14:35  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:14:35.948803 (Thread-742): 19:14:35  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:14:35.960628 (Thread-742): 19:14:35  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:14:36.254923 (Thread-742): 19:14:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af66ef70>]}
2022-03-03 19:14:36.990692 (Thread-743): handling status request
2022-03-03 19:14:36.991048 (Thread-743): 19:14:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af511730>]}
2022-03-03 19:14:36.991554 (Thread-743): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:37.006962 (Thread-744): handling status request
2022-03-03 19:14:37.007246 (Thread-744): 19:14:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5d10d0>]}
2022-03-03 19:14:37.007697 (Thread-744): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:39.930450 (Thread-745): handling status request
2022-03-03 19:14:39.930783 (Thread-745): 19:14:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af7c4070>]}
2022-03-03 19:14:39.931266 (Thread-745): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:40.245108 (Thread-746): handling status request
2022-03-03 19:14:40.245465 (Thread-746): 19:14:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af3b2850>]}
2022-03-03 19:14:40.245947 (Thread-746): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:40.427848 (Thread-747): handling cli_args request
2022-03-03 19:14:40.428202 (Thread-747): 19:14:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af3b26a0>]}
2022-03-03 19:14:42.672042 (Thread-747): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:43.118715 (MainThread): 19:14:43  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:14:43.119149 (MainThread): 19:14:43  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:14:43.127071 (MainThread): 19:14:43  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f43197-2ad8-4d80-9b02-b5c360dd0a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c7a43a9a0>]}
2022-03-03 19:14:43.157426 (MainThread): 19:14:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f43197-2ad8-4d80-9b02-b5c360dd0a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c7a514760>]}
2022-03-03 19:14:43.157704 (MainThread): 19:14:43  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:14:43.159366 (MainThread): 19:14:43  
2022-03-03 19:14:43.159680 (MainThread): 19:14:43  Acquiring new snowflake connection "master"
2022-03-03 19:14:43.160562 (ThreadPoolExecutor-0_0): 19:14:43  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:14:43.174597 (ThreadPoolExecutor-0_0): 19:14:43  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:14:43.174715 (ThreadPoolExecutor-0_0): 19:14:43  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:14:43.174804 (ThreadPoolExecutor-0_0): 19:14:43  Opening a new connection, currently in state init
2022-03-03 19:14:43.443354 (Thread-748): handling poll request
2022-03-03 19:14:43.443765 (Thread-748): 19:14:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af9156a0>]}
2022-03-03 19:14:43.444725 (Thread-748): sending response (<Response 4178 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:44.132175 (ThreadPoolExecutor-0_0): 19:14:44  SQL status: SUCCESS 8 in 0.96 seconds
2022-03-03 19:14:44.134331 (ThreadPoolExecutor-0_0): 19:14:44  On list_DBT_RAW: Close
2022-03-03 19:14:44.397915 (ThreadPoolExecutor-2_0): 19:14:44  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:14:44.464679 (ThreadPoolExecutor-2_0): 19:14:44  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:14:44.464854 (ThreadPoolExecutor-2_0): 19:14:44  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:14:44.464957 (ThreadPoolExecutor-2_0): 19:14:44  Opening a new connection, currently in state closed
2022-03-03 19:14:45.212418 (Thread-749): handling poll request
2022-03-03 19:14:45.212807 (Thread-749): 19:14:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af80c310>]}
2022-03-03 19:14:45.213399 (Thread-749): sending response (<Response 2330 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:45.649480 (ThreadPoolExecutor-2_0): 19:14:45  SQL status: SUCCESS 33 in 1.18 seconds
2022-03-03 19:14:45.651702 (ThreadPoolExecutor-2_0): 19:14:45  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:14:45.898748 (MainThread): 19:14:45  Concurrency: 4 threads (target='default')
2022-03-03 19:14:45.898927 (MainThread): 19:14:45  
2022-03-03 19:14:45.901874 (Thread-3): 19:14:45  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:45.902193 (Thread-3): 19:14:45  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:14:45.902461 (Thread-3): 19:14:45  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:14:45.902564 (Thread-3): 19:14:45  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:45.902674 (Thread-3): 19:14:45  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:45.989994 (Thread-3): 19:14:45  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:14:46.003059 (Thread-3): 19:14:46  finished collecting timing info
2022-03-03 19:14:46.003252 (Thread-3): 19:14:46  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:46.045769 (Thread-3): 19:14:46  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:14:46.060202 (Thread-3): 19:14:46  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:14:46.060359 (Thread-3): 19:14:46  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:14:46.060455 (Thread-3): 19:14:46  Opening a new connection, currently in state closed
2022-03-03 19:14:46.979126 (Thread-750): handling poll request
2022-03-03 19:14:46.979509 (Thread-750): 19:14:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af80ca30>]}
2022-03-03 19:14:46.980269 (Thread-750): sending response (<Response 7405 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:48.515022 (Thread-3): 19:14:48  SQL status: SUCCESS 1 in 2.45 seconds
2022-03-03 19:14:48.524705 (Thread-3): 19:14:48  finished collecting timing info
2022-03-03 19:14:48.524885 (Thread-3): 19:14:48  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:14:48.750226 (Thread-751): handling poll request
2022-03-03 19:14:48.750562 (Thread-751): 19:14:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5dbf40>]}
2022-03-03 19:14:48.751087 (Thread-751): sending response (<Response 1521 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:48.844074 (Thread-3): 19:14:48  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f43197-2ad8-4d80-9b02-b5c360dd0a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85697550>]}
2022-03-03 19:14:48.844521 (Thread-3): 19:14:48  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.94s]
2022-03-03 19:14:48.844684 (Thread-3): 19:14:48  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:14:48.846344 (MainThread): 19:14:48  Acquiring new snowflake connection "master"
2022-03-03 19:14:48.846691 (MainThread): 19:14:48  
2022-03-03 19:14:48.846800 (MainThread): 19:14:48  Finished running 1 incremental model in 5.69s.
2022-03-03 19:14:48.846889 (MainThread): 19:14:48  Connection 'master' was properly closed.
2022-03-03 19:14:48.846960 (MainThread): 19:14:48  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:14:48.912033 (MainThread): 19:14:48  
2022-03-03 19:14:48.912240 (MainThread): 19:14:48  Completed successfully
2022-03-03 19:14:48.912353 (MainThread): 19:14:48  
2022-03-03 19:14:48.912459 (MainThread): 19:14:48  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:14:50.516224 (Thread-752): handling poll request
2022-03-03 19:14:50.516585 (Thread-752): 19:14:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5db1c0>]}
2022-03-03 19:14:50.517674 (Thread-752): sending response (<Response 9103 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:51.990396 (Thread-753): handling status request
2022-03-03 19:14:51.990729 (Thread-753): 19:14:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5db040>]}
2022-03-03 19:14:51.991247 (Thread-753): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:14:52.009946 (Thread-754): handling status request
2022-03-03 19:14:52.010225 (Thread-754): 19:14:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5e36a0>]}
2022-03-03 19:14:52.010667 (Thread-754): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:04.168527 (Thread-755): handling status request
2022-03-03 19:16:04.170256 (Thread-755): 19:16:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5e3970>]}
2022-03-03 19:16:04.170752 (Thread-755): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:04.598485 (Thread-756): handling status request
2022-03-03 19:16:04.600065 (Thread-756): 19:16:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5dbf10>]}
2022-03-03 19:16:04.600590 (Thread-756): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:04.898867 (Thread-757): handling cli_args request
2022-03-03 19:16:04.899200 (Thread-757): 19:16:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5db5e0>]}
2022-03-03 19:16:07.148495 (Thread-757): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:07.761709 (MainThread): 19:16:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:16:07.762162 (MainThread): 19:16:07  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:16:07.770170 (MainThread): 19:16:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a9db12f-0518-4d02-b12e-a43b6a55b1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ebbfa970>]}
2022-03-03 19:16:07.806338 (MainThread): 19:16:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a9db12f-0518-4d02-b12e-a43b6a55b1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ebcd5730>]}
2022-03-03 19:16:07.806609 (MainThread): 19:16:07  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:16:07.808307 (MainThread): 19:16:07  
2022-03-03 19:16:07.808612 (MainThread): 19:16:07  Acquiring new snowflake connection "master"
2022-03-03 19:16:07.809477 (ThreadPoolExecutor-0_0): 19:16:07  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:16:07.823684 (ThreadPoolExecutor-0_0): 19:16:07  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:16:07.823793 (ThreadPoolExecutor-0_0): 19:16:07  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:16:07.823877 (ThreadPoolExecutor-0_0): 19:16:07  Opening a new connection, currently in state init
2022-03-03 19:16:07.884404 (Thread-758): handling poll request
2022-03-03 19:16:07.884917 (Thread-758): 19:16:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5e3c70>]}
2022-03-03 19:16:07.885856 (Thread-758): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:08.931900 (ThreadPoolExecutor-0_0): 19:16:08  SQL status: SUCCESS 8 in 1.11 seconds
2022-03-03 19:16:08.933952 (ThreadPoolExecutor-0_0): 19:16:08  On list_DBT_RAW: Close
2022-03-03 19:16:09.150041 (ThreadPoolExecutor-2_0): 19:16:09  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:16:09.211765 (ThreadPoolExecutor-2_0): 19:16:09  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:16:09.211920 (ThreadPoolExecutor-2_0): 19:16:09  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:16:09.212017 (ThreadPoolExecutor-2_0): 19:16:09  Opening a new connection, currently in state closed
2022-03-03 19:16:09.625278 (Thread-759): handling poll request
2022-03-03 19:16:09.625614 (Thread-759): 19:16:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af3b2f40>]}
2022-03-03 19:16:09.626179 (Thread-759): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:10.295280 (ThreadPoolExecutor-2_0): 19:16:10  SQL status: SUCCESS 34 in 1.08 seconds
2022-03-03 19:16:10.297583 (ThreadPoolExecutor-2_0): 19:16:10  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:16:10.573730 (MainThread): 19:16:10  Concurrency: 4 threads (target='default')
2022-03-03 19:16:10.574049 (MainThread): 19:16:10  
2022-03-03 19:16:10.577104 (Thread-3): 19:16:10  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:16:10.577410 (Thread-3): 19:16:10  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:16:10.577681 (Thread-3): 19:16:10  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:10.577784 (Thread-3): 19:16:10  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:16:10.577906 (Thread-3): 19:16:10  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:16:10.665814 (Thread-3): 19:16:10  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:10.685213 (Thread-3): 19:16:10  finished collecting timing info
2022-03-03 19:16:10.685410 (Thread-3): 19:16:10  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:16:10.727491 (Thread-3): 19:16:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:10.727642 (Thread-3): 19:16:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:16:10.727735 (Thread-3): 19:16:10  Opening a new connection, currently in state closed
2022-03-03 19:16:11.373841 (Thread-760): handling poll request
2022-03-03 19:16:11.374186 (Thread-760): 19:16:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c41ca220>]}
2022-03-03 19:16:11.374893 (Thread-760): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:13.152258 (Thread-761): handling poll request
2022-03-03 19:16:13.152620 (Thread-761): 19:16:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af915460>]}
2022-03-03 19:16:13.153181 (Thread-761): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:13.633915 (Thread-3): 19:16:13  SQL status: SUCCESS 1 in 2.91 seconds
2022-03-03 19:16:13.643193 (Thread-3): 19:16:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:13.643344 (Thread-3): 19:16:13  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:16:13.813770 (Thread-3): 19:16:13  SQL status: SUCCESS 10 in 0.17 seconds
2022-03-03 19:16:13.817878 (Thread-3): 19:16:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:13.818002 (Thread-3): 19:16:13  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:16:14.358190 (Thread-3): 19:16:14  SQL status: SUCCESS 10 in 0.54 seconds
2022-03-03 19:16:14.366653 (Thread-3): 19:16:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:14.366787 (Thread-3): 19:16:14  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:16:14.481705 (Thread-3): 19:16:14  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:16:14.503700 (Thread-3): 19:16:14  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:14.524054 (Thread-3): 19:16:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:14.524207 (Thread-3): 19:16:14  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:16:14.668397 (Thread-3): 19:16:14  SQL status: SUCCESS 1 in 0.14 seconds
2022-03-03 19:16:14.668683 (Thread-3): 19:16:14  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:14.668784 (Thread-3): 19:16:14  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:16:14.904676 (Thread-762): handling poll request
2022-03-03 19:16:14.905020 (Thread-762): 19:16:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af50bfd0>]}
2022-03-03 19:16:14.905696 (Thread-762): sending response (<Response 8390 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:16.291237 (Thread-3): 19:16:16  SQL status: SUCCESS 2 in 1.62 seconds
2022-03-03 19:16:16.291447 (Thread-3): 19:16:16  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:16:16.291538 (Thread-3): 19:16:16  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:16:16.660160 (Thread-763): handling poll request
2022-03-03 19:16:16.660510 (Thread-763): 19:16:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af61e430>]}
2022-03-03 19:16:16.661221 (Thread-763): sending response (<Response 1409 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:16.727082 (Thread-3): 19:16:16  SQL status: SUCCESS 1 in 0.44 seconds
2022-03-03 19:16:16.738017 (Thread-3): 19:16:16  finished collecting timing info
2022-03-03 19:16:16.738214 (Thread-3): 19:16:16  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:16:17.024701 (Thread-3): 19:16:17  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a9db12f-0518-4d02-b12e-a43b6a55b1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7eb3a06d0>]}
2022-03-03 19:16:17.025160 (Thread-3): 19:16:17  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.45s]
2022-03-03 19:16:17.025293 (Thread-3): 19:16:17  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:16:17.027176 (MainThread): 19:16:17  Acquiring new snowflake connection "master"
2022-03-03 19:16:17.027537 (MainThread): 19:16:17  
2022-03-03 19:16:17.027643 (MainThread): 19:16:17  Finished running 1 incremental model in 9.22s.
2022-03-03 19:16:17.027731 (MainThread): 19:16:17  Connection 'master' was properly closed.
2022-03-03 19:16:17.027801 (MainThread): 19:16:17  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:16:17.092291 (MainThread): 19:16:17  
2022-03-03 19:16:17.092488 (MainThread): 19:16:17  Completed successfully
2022-03-03 19:16:17.092590 (MainThread): 19:16:17  
2022-03-03 19:16:17.092798 (MainThread): 19:16:17  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:16:18.402867 (Thread-764): handling poll request
2022-03-03 19:16:18.403224 (Thread-764): 19:16:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af61ea90>]}
2022-03-03 19:16:18.404347 (Thread-764): sending response (<Response 11333 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:19.752110 (Thread-765): handling status request
2022-03-03 19:16:19.752611 (Thread-765): 19:16:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5d99d0>]}
2022-03-03 19:16:19.753268 (Thread-765): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:16:19.816730 (Thread-766): handling status request
2022-03-03 19:16:19.817068 (Thread-766): 19:16:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5d9280>]}
2022-03-03 19:16:19.817547 (Thread-766): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:34.070333 (Thread-767): 19:19:34  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:19:34.073224 (Thread-767): 19:19:34  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:19:34.079706 (Thread-767): 19:19:34  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:19:34.091979 (Thread-767): 19:19:34  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:19:34.143451 (Thread-767): 19:19:34  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af295880>]}
2022-03-03 19:19:34.786244 (Thread-768): handling status request
2022-03-03 19:19:34.786634 (Thread-768): 19:19:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e407b7f0>]}
2022-03-03 19:19:34.787236 (Thread-768): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:34.793204 (Thread-769): handling status request
2022-03-03 19:19:34.793452 (Thread-769): 19:19:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af9209a0>]}
2022-03-03 19:19:34.793909 (Thread-769): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:45.842767 (Thread-770): handling status request
2022-03-03 19:19:45.843121 (Thread-770): 19:19:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af3b2af0>]}
2022-03-03 19:19:45.843642 (Thread-770): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:46.127922 (Thread-771): handling status request
2022-03-03 19:19:46.128251 (Thread-771): 19:19:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af5d18e0>]}
2022-03-03 19:19:46.128773 (Thread-771): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:46.430358 (Thread-772): handling cli_args request
2022-03-03 19:19:46.430688 (Thread-772): 19:19:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4dbfa30>]}
2022-03-03 19:19:48.736850 (Thread-772): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:49.167129 (MainThread): 19:19:49  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:19:49.167586 (MainThread): 19:19:49  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:19:49.175502 (MainThread): 19:19:49  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5820c56a-6ac4-41a7-b9d1-483d92a772ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12dafa970>]}
2022-03-03 19:19:49.209540 (MainThread): 19:19:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5820c56a-6ac4-41a7-b9d1-483d92a772ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12dbd4730>]}
2022-03-03 19:19:49.209869 (MainThread): 19:19:49  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:19:49.211847 (MainThread): 19:19:49  
2022-03-03 19:19:49.212352 (MainThread): 19:19:49  Acquiring new snowflake connection "master"
2022-03-03 19:19:49.213392 (ThreadPoolExecutor-0_0): 19:19:49  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:19:49.227139 (ThreadPoolExecutor-0_0): 19:19:49  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:19:49.227267 (ThreadPoolExecutor-0_0): 19:19:49  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:19:49.227355 (ThreadPoolExecutor-0_0): 19:19:49  Opening a new connection, currently in state init
2022-03-03 19:19:49.461896 (Thread-773): handling poll request
2022-03-03 19:19:49.462439 (Thread-773): 19:19:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af99c7c0>]}
2022-03-03 19:19:49.463466 (Thread-773): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:50.228309 (ThreadPoolExecutor-0_0): 19:19:50  SQL status: SUCCESS 8 in 1.0 seconds
2022-03-03 19:19:50.230375 (ThreadPoolExecutor-0_0): 19:19:50  On list_DBT_RAW: Close
2022-03-03 19:19:50.441849 (ThreadPoolExecutor-2_0): 19:19:50  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:19:50.503146 (ThreadPoolExecutor-2_0): 19:19:50  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:19:50.503305 (ThreadPoolExecutor-2_0): 19:19:50  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:19:50.503404 (ThreadPoolExecutor-2_0): 19:19:50  Opening a new connection, currently in state closed
2022-03-03 19:19:51.193164 (Thread-774): handling poll request
2022-03-03 19:19:51.193523 (Thread-774): 19:19:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51041a7100>]}
2022-03-03 19:19:51.194128 (Thread-774): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:51.449986 (ThreadPoolExecutor-2_0): 19:19:51  SQL status: SUCCESS 34 in 0.95 seconds
2022-03-03 19:19:51.452206 (ThreadPoolExecutor-2_0): 19:19:51  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:19:51.674942 (MainThread): 19:19:51  Concurrency: 4 threads (target='default')
2022-03-03 19:19:51.675166 (MainThread): 19:19:51  
2022-03-03 19:19:51.678269 (Thread-3): 19:19:51  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:19:51.678582 (Thread-3): 19:19:51  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:19:51.678852 (Thread-3): 19:19:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:19:51.678962 (Thread-3): 19:19:51  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:19:51.679076 (Thread-3): 19:19:51  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:19:51.685172 (Thread-3): 19:19:51  finished collecting timing info
2022-03-03 19:19:51.685498 (Thread-3): 19:19:51  Compilation Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
  'CURRENT_TIMESTAMP' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2022-03-03 19:19:51.685686 (Thread-3): 19:19:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5820c56a-6ac4-41a7-b9d1-483d92a772ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd12c48a940>]}
2022-03-03 19:19:51.686040 (Thread-3): 19:19:51  1 of 1 ERROR creating incremental model DBT_VAULT.sat_customer_demo............. [ERROR in 0.01s]
2022-03-03 19:19:51.686166 (Thread-3): 19:19:51  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:19:51.687565 (MainThread): 19:19:51  Acquiring new snowflake connection "master"
2022-03-03 19:19:51.687848 (MainThread): 19:19:51  
2022-03-03 19:19:51.687948 (MainThread): 19:19:51  Finished running 1 incremental model in 2.48s.
2022-03-03 19:19:51.688035 (MainThread): 19:19:51  Connection 'master' was properly closed.
2022-03-03 19:19:51.688103 (MainThread): 19:19:51  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:19:51.751698 (MainThread): 19:19:51  
2022-03-03 19:19:51.751900 (MainThread): 19:19:51  Completed with 1 error and 0 warnings:
2022-03-03 19:19:51.751993 (MainThread): 19:19:51  
2022-03-03 19:19:51.752086 (MainThread): 19:19:51  Compilation Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 19:19:51.752166 (MainThread): 19:19:51    'CURRENT_TIMESTAMP' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2022-03-03 19:19:51.752246 (MainThread): 19:19:51  
2022-03-03 19:19:51.752336 (MainThread): 19:19:51  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 19:19:52.922369 (Thread-775): handling poll request
2022-03-03 19:19:52.922716 (Thread-775): 19:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c487e820>]}
2022-03-03 19:19:52.923917 (Thread-775): sending response (<Response 13910 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:54.283331 (Thread-776): handling status request
2022-03-03 19:19:54.283673 (Thread-776): 19:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c487e700>]}
2022-03-03 19:19:54.284215 (Thread-776): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:19:54.312227 (Thread-777): handling status request
2022-03-03 19:19:54.312553 (Thread-777): 19:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c487ebb0>]}
2022-03-03 19:19:54.313073 (Thread-777): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:07.714922 (Thread-778): 19:20:07  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:20:07.715556 (Thread-778): 19:20:07  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:20:07.722378 (Thread-778): 19:20:07  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:20:07.734391 (Thread-778): 19:20:07  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:20:07.792454 (Thread-778): 19:20:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af20fe80>]}
2022-03-03 19:20:08.739577 (Thread-779): handling status request
2022-03-03 19:20:08.739917 (Thread-779): 19:20:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af23a280>]}
2022-03-03 19:20:08.740510 (Thread-779): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:08.756975 (Thread-780): handling status request
2022-03-03 19:20:08.757234 (Thread-780): 19:20:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4138790>]}
2022-03-03 19:20:08.757650 (Thread-780): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:14.789870 (Thread-781): handling status request
2022-03-03 19:20:14.790218 (Thread-781): 19:20:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42eb1f0>]}
2022-03-03 19:20:14.790707 (Thread-781): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:15.079250 (Thread-782): handling status request
2022-03-03 19:20:15.079636 (Thread-782): 19:20:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c48b3af0>]}
2022-03-03 19:20:15.080120 (Thread-782): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:15.395981 (Thread-783): handling cli_args request
2022-03-03 19:20:15.396312 (Thread-783): 19:20:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4635d90>]}
2022-03-03 19:20:17.616849 (Thread-783): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:18.038381 (MainThread): 19:20:18  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:20:18.038951 (MainThread): 19:20:18  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:20:18.047354 (MainThread): 19:20:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcb81467-2be9-471c-9ace-596890da8212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880377a9a0>]}
2022-03-03 19:20:18.080149 (MainThread): 19:20:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcb81467-2be9-471c-9ace-596890da8212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880385a760>]}
2022-03-03 19:20:18.080420 (MainThread): 19:20:18  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:20:18.082098 (MainThread): 19:20:18  
2022-03-03 19:20:18.082396 (MainThread): 19:20:18  Acquiring new snowflake connection "master"
2022-03-03 19:20:18.083203 (ThreadPoolExecutor-0_0): 19:20:18  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:20:18.096599 (ThreadPoolExecutor-0_0): 19:20:18  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:20:18.096758 (ThreadPoolExecutor-0_0): 19:20:18  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:20:18.096852 (ThreadPoolExecutor-0_0): 19:20:18  Opening a new connection, currently in state init
2022-03-03 19:20:18.342244 (Thread-784): handling poll request
2022-03-03 19:20:18.342643 (Thread-784): 19:20:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e42ebe50>]}
2022-03-03 19:20:18.343585 (Thread-784): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:19.038902 (ThreadPoolExecutor-0_0): 19:20:19  SQL status: SUCCESS 8 in 0.94 seconds
2022-03-03 19:20:19.042023 (ThreadPoolExecutor-0_0): 19:20:19  On list_DBT_RAW: Close
2022-03-03 19:20:19.298223 (ThreadPoolExecutor-2_0): 19:20:19  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:20:19.355013 (ThreadPoolExecutor-2_0): 19:20:19  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:20:19.355158 (ThreadPoolExecutor-2_0): 19:20:19  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:20:19.355256 (ThreadPoolExecutor-2_0): 19:20:19  Opening a new connection, currently in state closed
2022-03-03 19:20:20.077325 (Thread-785): handling poll request
2022-03-03 19:20:20.077687 (Thread-785): 19:20:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44bc730>]}
2022-03-03 19:20:20.078346 (Thread-785): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:20.204369 (ThreadPoolExecutor-2_0): 19:20:20  SQL status: SUCCESS 34 in 0.85 seconds
2022-03-03 19:20:20.206620 (ThreadPoolExecutor-2_0): 19:20:20  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:20:20.789697 (MainThread): 19:20:20  Concurrency: 4 threads (target='default')
2022-03-03 19:20:20.789990 (MainThread): 19:20:20  
2022-03-03 19:20:20.793402 (Thread-3): 19:20:20  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:20:20.793823 (Thread-3): 19:20:20  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:20:20.794225 (Thread-3): 19:20:20  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:20:20.794393 (Thread-3): 19:20:20  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:20:20.794625 (Thread-3): 19:20:20  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:20:20.898127 (Thread-3): 19:20:20  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:20:20.912253 (Thread-3): 19:20:20  finished collecting timing info
2022-03-03 19:20:20.912483 (Thread-3): 19:20:20  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:20:20.958118 (Thread-3): 19:20:20  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:20:20.958385 (Thread-3): 19:20:20  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.CURRENT_TIMESTAMP(), a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CURRENT_TIMESTAMP()
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.CURRENT_TIMESTAMP(),
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.CURRENT_TIMESTAMP() DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.CURRENT_TIMESTAMP(), stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:20:20.958543 (Thread-3): 19:20:20  Opening a new connection, currently in state closed
2022-03-03 19:20:21.812538 (Thread-786): handling poll request
2022-03-03 19:20:21.812908 (Thread-786): 19:20:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af2deb20>]}
2022-03-03 19:20:21.813629 (Thread-786): sending response (<Response 8016 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:22.250464 (Thread-3): 19:20:22  Snowflake adapter: Snowflake query id: 01a2af48-0503-bbaf-0000-0ed503a5e472
2022-03-03 19:20:22.250727 (Thread-3): 19:20:22  Snowflake adapter: Snowflake error: 002141 (42601): SQL compilation error:
Unknown user-defined function A.CURRENT_TIMESTAMP
2022-03-03 19:20:22.251047 (Thread-3): 19:20:22  finished collecting timing info
2022-03-03 19:20:22.251308 (Thread-3): 19:20:22  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:20:22.963111 (Thread-3): 19:20:22  Database Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
  002141 (42601): SQL compilation error:
  Unknown user-defined function A.CURRENT_TIMESTAMP
2022-03-03 19:20:22.963398 (Thread-3): 19:20:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb81467-2be9-471c-9ace-596890da8212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8800384c40>]}
2022-03-03 19:20:22.963930 (Thread-3): 19:20:22  1 of 1 ERROR creating incremental model DBT_VAULT.sat_customer_demo............. [ERROR in 2.17s]
2022-03-03 19:20:22.964065 (Thread-3): 19:20:22  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:20:22.965697 (MainThread): 19:20:22  Acquiring new snowflake connection "master"
2022-03-03 19:20:22.966024 (MainThread): 19:20:22  
2022-03-03 19:20:22.966136 (MainThread): 19:20:22  Finished running 1 incremental model in 4.88s.
2022-03-03 19:20:22.966225 (MainThread): 19:20:22  Connection 'master' was properly closed.
2022-03-03 19:20:22.966296 (MainThread): 19:20:22  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:20:23.033970 (MainThread): 19:20:23  
2022-03-03 19:20:23.034151 (MainThread): 19:20:23  Completed with 1 error and 0 warnings:
2022-03-03 19:20:23.034242 (MainThread): 19:20:23  
2022-03-03 19:20:23.034334 (MainThread): 19:20:23  Database Error in model sat_customer_demo (models/raw_vault/sats/sat_customer_demo.sql)
2022-03-03 19:20:23.034412 (MainThread): 19:20:23    002141 (42601): SQL compilation error:
2022-03-03 19:20:23.034481 (MainThread): 19:20:23    Unknown user-defined function A.CURRENT_TIMESTAMP
2022-03-03 19:20:23.034557 (MainThread): 19:20:23  
2022-03-03 19:20:23.034643 (MainThread): 19:20:23  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-03-03 19:20:23.555381 (Thread-787): handling poll request
2022-03-03 19:20:23.555730 (Thread-787): 19:20:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af1c0070>]}
2022-03-03 19:20:23.556941 (Thread-787): sending response (<Response 13934 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:25.153737 (Thread-788): handling status request
2022-03-03 19:20:25.154091 (Thread-788): 19:20:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af1c0220>]}
2022-03-03 19:20:25.154697 (Thread-788): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:25.441765 (Thread-789): handling status request
2022-03-03 19:20:25.442185 (Thread-789): 19:20:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af1c0610>]}
2022-03-03 19:20:25.442689 (Thread-789): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:51.951942 (Thread-790): 19:20:51  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:20:51.952500 (Thread-790): 19:20:51  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:20:51.959373 (Thread-790): 19:20:51  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:20:51.970661 (Thread-790): 19:20:51  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:20:52.023007 (Thread-790): 19:20:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefbb8e0>]}
2022-03-03 19:20:53.002308 (Thread-791): handling status request
2022-03-03 19:20:53.002663 (Thread-791): 19:20:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af23a370>]}
2022-03-03 19:20:53.003190 (Thread-791): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:20:53.004360 (Thread-792): handling status request
2022-03-03 19:20:53.004707 (Thread-792): 19:20:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af2264c0>]}
2022-03-03 19:20:53.005175 (Thread-792): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:22:55.940793 (Thread-793): handling status request
2022-03-03 19:22:55.942518 (Thread-793): 19:22:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef8d130>]}
2022-03-03 19:22:55.943000 (Thread-793): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:22:56.706730 (Thread-794): handling cli_args request
2022-03-03 19:22:56.707072 (Thread-794): 19:22:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef8daf0>]}
2022-03-03 19:22:56.716935 (Thread-795): handling status request
2022-03-03 19:22:56.717294 (Thread-795): 19:22:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefbbc10>]}
2022-03-03 19:22:56.717888 (Thread-795): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:22:58.934703 (Thread-794): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:22:59.589418 (MainThread): 19:22:59  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:22:59.589894 (MainThread): 19:22:59  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:22:59.598102 (MainThread): 19:22:59  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2d71770-47e0-4a11-a926-41b2fb946cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c78ba8e0>]}
2022-03-03 19:22:59.631365 (MainThread): 19:22:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2d71770-47e0-4a11-a926-41b2fb946cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c799a6a0>]}
2022-03-03 19:22:59.631622 (MainThread): 19:22:59  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:22:59.633537 (MainThread): 19:22:59  
2022-03-03 19:22:59.633821 (MainThread): 19:22:59  Acquiring new snowflake connection "master"
2022-03-03 19:22:59.634679 (ThreadPoolExecutor-0_0): 19:22:59  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:22:59.648232 (ThreadPoolExecutor-0_0): 19:22:59  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:22:59.648343 (ThreadPoolExecutor-0_0): 19:22:59  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:22:59.648428 (ThreadPoolExecutor-0_0): 19:22:59  Opening a new connection, currently in state init
2022-03-03 19:22:59.664905 (Thread-796): handling poll request
2022-03-03 19:22:59.665250 (Thread-796): 19:22:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af080910>]}
2022-03-03 19:22:59.666125 (Thread-796): sending response (<Response 4165 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:00.595080 (ThreadPoolExecutor-0_0): 19:23:00  SQL status: SUCCESS 8 in 0.95 seconds
2022-03-03 19:23:00.597161 (ThreadPoolExecutor-0_0): 19:23:00  On list_DBT_RAW: Close
2022-03-03 19:23:00.799225 (ThreadPoolExecutor-2_0): 19:23:00  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:23:00.856566 (ThreadPoolExecutor-2_0): 19:23:00  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:23:00.856735 (ThreadPoolExecutor-2_0): 19:23:00  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:23:00.856832 (ThreadPoolExecutor-2_0): 19:23:00  Opening a new connection, currently in state closed
2022-03-03 19:23:01.393169 (Thread-797): handling poll request
2022-03-03 19:23:01.393571 (Thread-797): 19:23:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af319670>]}
2022-03-03 19:23:01.394136 (Thread-797): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:01.683845 (ThreadPoolExecutor-2_0): 19:23:01  SQL status: SUCCESS 34 in 0.83 seconds
2022-03-03 19:23:01.686194 (ThreadPoolExecutor-2_0): 19:23:01  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:23:01.899682 (MainThread): 19:23:01  Concurrency: 4 threads (target='default')
2022-03-03 19:23:01.899856 (MainThread): 19:23:01  
2022-03-03 19:23:01.902651 (Thread-3): 19:23:01  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:23:01.902958 (Thread-3): 19:23:01  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:23:01.903225 (Thread-3): 19:23:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:23:01.903327 (Thread-3): 19:23:01  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:23:01.903435 (Thread-3): 19:23:01  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:23:01.909735 (Thread-3): 19:23:01  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:23:01.928921 (Thread-3): 19:23:01  finished collecting timing info
2022-03-03 19:23:01.929086 (Thread-3): 19:23:01  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:23:01.954469 (Thread-3): 19:23:01  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:23:01.974987 (Thread-3): 19:23:01  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:23:01.975166 (Thread-3): 19:23:01  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:23:01.975268 (Thread-3): 19:23:01  Opening a new connection, currently in state closed
2022-03-03 19:23:03.131212 (Thread-798): handling poll request
2022-03-03 19:23:03.131565 (Thread-798): 19:23:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af0fa6a0>]}
2022-03-03 19:23:03.132321 (Thread-798): sending response (<Response 9149 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:04.902926 (Thread-799): handling poll request
2022-03-03 19:23:04.903257 (Thread-799): 19:23:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af0fa460>]}
2022-03-03 19:23:04.903867 (Thread-799): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:06.644673 (Thread-800): handling poll request
2022-03-03 19:23:06.645012 (Thread-800): 19:23:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af132190>]}
2022-03-03 19:23:06.645503 (Thread-800): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:07.783800 (Thread-3): 19:23:07  SQL status: SUCCESS 1 in 5.81 seconds
2022-03-03 19:23:07.793910 (Thread-3): 19:23:07  finished collecting timing info
2022-03-03 19:23:07.794153 (Thread-3): 19:23:07  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:23:08.024485 (Thread-3): 19:23:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d71770-47e0-4a11-a926-41b2fb946cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c799e670>]}
2022-03-03 19:23:08.024970 (Thread-3): 19:23:08  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 6.12s]
2022-03-03 19:23:08.025123 (Thread-3): 19:23:08  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:23:08.026206 (Thread-5): 19:23:08  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:23:08.026463 (Thread-5): 19:23:08  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:23:08.026862 (Thread-5): 19:23:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:23:08.026967 (Thread-5): 19:23:08  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:23:08.027067 (Thread-5): 19:23:08  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:23:08.063024 (Thread-5): 19:23:08  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:23:08.063148 (Thread-5): 19:23:08  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:23:08.063238 (Thread-5): 19:23:08  Opening a new connection, currently in state init
2022-03-03 19:23:08.382279 (Thread-801): handling poll request
2022-03-03 19:23:08.382619 (Thread-801): 19:23:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af1328b0>]}
2022-03-03 19:23:08.383280 (Thread-801): sending response (<Response 6472 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:08.757919 (Thread-5): 19:23:08  SQL status: SUCCESS 5 in 0.69 seconds
2022-03-03 19:23:08.788520 (Thread-5): 19:23:08  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:23:08.788695 (Thread-5): 19:23:08  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:23:08.953460 (Thread-5): 19:23:08  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 19:23:08.986648 (Thread-5): 19:23:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:23:09.001800 (Thread-5): 19:23:09  finished collecting timing info
2022-03-03 19:23:09.002041 (Thread-5): 19:23:09  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:23:09.021585 (Thread-5): 19:23:09  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:23:09.037009 (Thread-5): 19:23:09  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:23:09.037146 (Thread-5): 19:23:09  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(EFFECTIVE_TO AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:23:09.448058 (Thread-5): 19:23:09  SQL status: SUCCESS 1 in 0.41 seconds
2022-03-03 19:23:09.449529 (Thread-5): 19:23:09  finished collecting timing info
2022-03-03 19:23:09.449697 (Thread-5): 19:23:09  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:23:09.683232 (Thread-5): 19:23:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d71770-47e0-4a11-a926-41b2fb946cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c44f2e80>]}
2022-03-03 19:23:09.683664 (Thread-5): 19:23:09  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.66s]
2022-03-03 19:23:09.683793 (Thread-5): 19:23:09  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:23:09.684815 (Thread-4): 19:23:09  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:23:09.685078 (Thread-4): 19:23:09  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:23:09.685380 (Thread-4): 19:23:09  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:09.685473 (Thread-4): 19:23:09  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:23:09.685566 (Thread-4): 19:23:09  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:23:09.769096 (Thread-4): 19:23:09  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:09.785569 (Thread-4): 19:23:09  finished collecting timing info
2022-03-03 19:23:09.785721 (Thread-4): 19:23:09  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:23:09.810608 (Thread-4): 19:23:09  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:09.810734 (Thread-4): 19:23:09  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:23:09.810821 (Thread-4): 19:23:09  Opening a new connection, currently in state init
2022-03-03 19:23:10.126034 (Thread-802): handling poll request
2022-03-03 19:23:10.126390 (Thread-802): 19:23:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af0b2580>]}
2022-03-03 19:23:10.151132 (Thread-802): sending response (<Response 15479 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:11.893325 (Thread-803): handling poll request
2022-03-03 19:23:11.896775 (Thread-803): 19:23:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af0b24f0>]}
2022-03-03 19:23:11.897315 (Thread-803): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:12.068487 (Thread-4): 19:23:12  SQL status: SUCCESS 1 in 2.26 seconds
2022-03-03 19:23:12.071942 (Thread-4): 19:23:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:12.072075 (Thread-4): 19:23:12  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:23:12.236712 (Thread-4): 19:23:12  SQL status: SUCCESS 10 in 0.16 seconds
2022-03-03 19:23:12.240420 (Thread-4): 19:23:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:12.240533 (Thread-4): 19:23:12  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:23:12.371105 (Thread-4): 19:23:12  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 19:23:12.379594 (Thread-4): 19:23:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:12.379729 (Thread-4): 19:23:12  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:23:12.565285 (Thread-4): 19:23:12  SQL status: SUCCESS 10 in 0.19 seconds
2022-03-03 19:23:12.586596 (Thread-4): 19:23:12  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:12.603108 (Thread-4): 19:23:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:12.603254 (Thread-4): 19:23:12  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:23:12.879324 (Thread-4): 19:23:12  SQL status: SUCCESS 1 in 0.28 seconds
2022-03-03 19:23:12.879626 (Thread-4): 19:23:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:12.879737 (Thread-4): 19:23:12  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:23:13.636972 (Thread-804): handling poll request
2022-03-03 19:23:13.637314 (Thread-804): 19:23:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af0b2b80>]}
2022-03-03 19:23:13.637996 (Thread-804): sending response (<Response 8392 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:13.801315 (Thread-4): 19:23:13  SQL status: SUCCESS 1 in 0.92 seconds
2022-03-03 19:23:13.801520 (Thread-4): 19:23:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:23:13.801606 (Thread-4): 19:23:13  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:23:15.368659 (Thread-805): handling poll request
2022-03-03 19:23:15.369012 (Thread-805): 19:23:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af0fa7c0>]}
2022-03-03 19:23:15.369536 (Thread-805): sending response (<Response 1411 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:15.967253 (Thread-4): 19:23:15  SQL status: SUCCESS 1 in 2.17 seconds
2022-03-03 19:23:15.968790 (Thread-4): 19:23:15  finished collecting timing info
2022-03-03 19:23:15.968958 (Thread-4): 19:23:15  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:23:16.230908 (Thread-4): 19:23:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d71770-47e0-4a11-a926-41b2fb946cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c446b7f0>]}
2022-03-03 19:23:16.231355 (Thread-4): 19:23:16  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.55s]
2022-03-03 19:23:16.231491 (Thread-4): 19:23:16  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:23:16.233170 (MainThread): 19:23:16  Acquiring new snowflake connection "master"
2022-03-03 19:23:16.233502 (MainThread): 19:23:16  
2022-03-03 19:23:16.233608 (MainThread): 19:23:16  Finished running 1 table model, 1 view model, 1 incremental model in 16.60s.
2022-03-03 19:23:16.233695 (MainThread): 19:23:16  Connection 'master' was properly closed.
2022-03-03 19:23:16.233769 (MainThread): 19:23:16  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:23:16.233834 (MainThread): 19:23:16  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:23:16.233899 (MainThread): 19:23:16  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:23:16.297736 (MainThread): 19:23:16  
2022-03-03 19:23:16.297938 (MainThread): 19:23:16  Completed successfully
2022-03-03 19:23:16.298041 (MainThread): 19:23:16  
2022-03-03 19:23:16.298136 (MainThread): 19:23:16  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:23:17.112929 (Thread-806): handling poll request
2022-03-03 19:23:17.113275 (Thread-806): 19:23:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af04d970>]}
2022-03-03 19:23:17.114560 (Thread-806): sending response (<Response 24505 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:18.429981 (Thread-807): handling status request
2022-03-03 19:23:18.430316 (Thread-807): 19:23:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af04db20>]}
2022-03-03 19:23:18.430827 (Thread-807): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:18.447036 (Thread-808): handling status request
2022-03-03 19:23:18.447337 (Thread-808): 19:23:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af04df10>]}
2022-03-03 19:23:18.447791 (Thread-808): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:38.297607 (Thread-809): 19:23:38  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:23:38.298139 (Thread-809): 19:23:38  Partial parsing: updated file: dbtvault_snowflake_demo://models/stage/v_stg_customer_demo.sql
2022-03-03 19:23:38.304652 (Thread-809): 19:23:38  1603: static parser failed on stage/v_stg_customer_demo.sql
2022-03-03 19:23:38.316078 (Thread-809): 19:23:38  1602: parser fallback to jinja rendering on stage/v_stg_customer_demo.sql
2022-03-03 19:23:38.372304 (Thread-809): 19:23:38  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed77be0>]}
2022-03-03 19:23:39.307381 (Thread-810): handling status request
2022-03-03 19:23:39.307733 (Thread-810): 19:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef7ba30>]}
2022-03-03 19:23:39.308256 (Thread-810): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:23:39.313530 (Thread-811): handling status request
2022-03-03 19:23:39.313769 (Thread-811): 19:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed44700>]}
2022-03-03 19:23:39.314140 (Thread-811): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:04.799137 (Thread-812): handling status request
2022-03-03 19:24:04.799480 (Thread-812): 19:24:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af3b7610>]}
2022-03-03 19:24:04.799965 (Thread-812): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:05.563542 (Thread-813): handling status request
2022-03-03 19:24:05.563869 (Thread-813): 19:24:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af132f40>]}
2022-03-03 19:24:05.564355 (Thread-813): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:05.587709 (Thread-814): handling cli_args request
2022-03-03 19:24:05.587949 (Thread-814): 19:24:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed8ebb0>]}
2022-03-03 19:24:07.802967 (Thread-814): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:08.227532 (MainThread): 19:24:08  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:24:08.227952 (MainThread): 19:24:08  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:24:08.235675 (MainThread): 19:24:08  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39be379f-6df3-4024-b501-e6f68dd6bdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facceeba970>]}
2022-03-03 19:24:08.268447 (MainThread): 19:24:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39be379f-6df3-4024-b501-e6f68dd6bdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccef95730>]}
2022-03-03 19:24:08.268854 (MainThread): 19:24:08  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:24:08.270654 (MainThread): 19:24:08  
2022-03-03 19:24:08.270925 (MainThread): 19:24:08  Acquiring new snowflake connection "master"
2022-03-03 19:24:08.271792 (ThreadPoolExecutor-0_0): 19:24:08  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:24:08.285702 (ThreadPoolExecutor-0_0): 19:24:08  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:24:08.285807 (ThreadPoolExecutor-0_0): 19:24:08  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:24:08.285891 (ThreadPoolExecutor-0_0): 19:24:08  Opening a new connection, currently in state init
2022-03-03 19:24:08.537409 (Thread-815): handling poll request
2022-03-03 19:24:08.537806 (Thread-815): 19:24:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef48fd0>]}
2022-03-03 19:24:08.538759 (Thread-815): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:09.344712 (ThreadPoolExecutor-0_0): 19:24:09  SQL status: SUCCESS 8 in 1.06 seconds
2022-03-03 19:24:09.346872 (ThreadPoolExecutor-0_0): 19:24:09  On list_DBT_RAW: Close
2022-03-03 19:24:09.630635 (ThreadPoolExecutor-2_0): 19:24:09  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:24:09.689008 (ThreadPoolExecutor-2_0): 19:24:09  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:24:09.689156 (ThreadPoolExecutor-2_0): 19:24:09  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:24:09.689250 (ThreadPoolExecutor-2_0): 19:24:09  Opening a new connection, currently in state closed
2022-03-03 19:24:10.272551 (Thread-816): handling poll request
2022-03-03 19:24:10.272928 (Thread-816): 19:24:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aee69910>]}
2022-03-03 19:24:10.273486 (Thread-816): sending response (<Response 2332 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:10.634068 (ThreadPoolExecutor-2_0): 19:24:10  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 19:24:10.636251 (ThreadPoolExecutor-2_0): 19:24:10  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:24:10.829701 (MainThread): 19:24:10  Concurrency: 4 threads (target='default')
2022-03-03 19:24:10.829868 (MainThread): 19:24:10  
2022-03-03 19:24:10.832811 (Thread-3): 19:24:10  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:10.833121 (Thread-3): 19:24:10  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:24:10.833397 (Thread-3): 19:24:10  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:10.833503 (Thread-3): 19:24:10  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:10.833610 (Thread-3): 19:24:10  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:10.839562 (Thread-3): 19:24:10  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:10.853846 (Thread-3): 19:24:10  finished collecting timing info
2022-03-03 19:24:10.853996 (Thread-3): 19:24:10  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:10.879283 (Thread-3): 19:24:10  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:10.896733 (Thread-3): 19:24:10  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:10.896851 (Thread-3): 19:24:10  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:24:10.896942 (Thread-3): 19:24:10  Opening a new connection, currently in state closed
2022-03-03 19:24:12.010186 (Thread-817): handling poll request
2022-03-03 19:24:12.010535 (Thread-817): 19:24:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef4aee0>]}
2022-03-03 19:24:12.011300 (Thread-817): sending response (<Response 9164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:13.741266 (Thread-818): handling poll request
2022-03-03 19:24:13.741629 (Thread-818): 19:24:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef4a280>]}
2022-03-03 19:24:13.742112 (Thread-818): sending response (<Response 334 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:15.475164 (Thread-819): handling poll request
2022-03-03 19:24:15.475507 (Thread-819): 19:24:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed4b760>]}
2022-03-03 19:24:15.476000 (Thread-819): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:16.675732 (Thread-3): 19:24:16  SQL status: SUCCESS 1 in 5.78 seconds
2022-03-03 19:24:16.685417 (Thread-3): 19:24:16  finished collecting timing info
2022-03-03 19:24:16.685604 (Thread-3): 19:24:16  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:24:16.917571 (Thread-3): 19:24:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39be379f-6df3-4024-b501-e6f68dd6bdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccef9f460>]}
2022-03-03 19:24:16.918039 (Thread-3): 19:24:16  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 6.08s]
2022-03-03 19:24:16.918188 (Thread-3): 19:24:16  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:16.919369 (Thread-5): 19:24:16  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:24:16.919818 (Thread-5): 19:24:16  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:24:16.920325 (Thread-5): 19:24:16  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:24:16.920501 (Thread-5): 19:24:16  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:24:16.920696 (Thread-5): 19:24:16  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:24:16.958224 (Thread-5): 19:24:16  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:24:16.958386 (Thread-5): 19:24:16  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:24:16.958479 (Thread-5): 19:24:16  Opening a new connection, currently in state init
2022-03-03 19:24:17.228221 (Thread-820): handling poll request
2022-03-03 19:24:17.228556 (Thread-820): 19:24:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed44be0>]}
2022-03-03 19:24:17.229253 (Thread-820): sending response (<Response 6487 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:17.690308 (Thread-5): 19:24:17  SQL status: SUCCESS 5 in 0.73 seconds
2022-03-03 19:24:17.719726 (Thread-5): 19:24:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:24:17.719884 (Thread-5): 19:24:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:24:17.873377 (Thread-5): 19:24:17  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 19:24:17.907108 (Thread-5): 19:24:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:24:17.921244 (Thread-5): 19:24:17  finished collecting timing info
2022-03-03 19:24:17.921424 (Thread-5): 19:24:17  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:24:17.940180 (Thread-5): 19:24:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:24:17.955888 (Thread-5): 19:24:17  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:24:17.956025 (Thread-5): 19:24:17  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:24:18.386863 (Thread-5): 19:24:18  SQL status: SUCCESS 1 in 0.43 seconds
2022-03-03 19:24:18.388315 (Thread-5): 19:24:18  finished collecting timing info
2022-03-03 19:24:18.388476 (Thread-5): 19:24:18  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:24:18.655403 (Thread-5): 19:24:18  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39be379f-6df3-4024-b501-e6f68dd6bdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc2fb2e0>]}
2022-03-03 19:24:18.655825 (Thread-5): 19:24:18  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.74s]
2022-03-03 19:24:18.655962 (Thread-5): 19:24:18  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:24:18.656999 (Thread-4): 19:24:18  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:24:18.657266 (Thread-4): 19:24:18  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:24:18.657566 (Thread-4): 19:24:18  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:24:18.657662 (Thread-4): 19:24:18  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:24:18.657749 (Thread-4): 19:24:18  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:24:18.740868 (Thread-4): 19:24:18  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:24:18.756196 (Thread-4): 19:24:18  finished collecting timing info
2022-03-03 19:24:18.756360 (Thread-4): 19:24:18  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:24:18.779882 (Thread-4): 19:24:18  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:24:18.793481 (Thread-4): 19:24:18  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:24:18.793595 (Thread-4): 19:24:18  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:24:18.793684 (Thread-4): 19:24:18  Opening a new connection, currently in state init
2022-03-03 19:24:18.966674 (Thread-821): handling poll request
2022-03-03 19:24:18.968336 (Thread-821): 19:24:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef51b50>]}
2022-03-03 19:24:18.969196 (Thread-821): sending response (<Response 14839 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:20.712026 (Thread-822): handling poll request
2022-03-03 19:24:20.712361 (Thread-822): 19:24:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef51d00>]}
2022-03-03 19:24:20.712892 (Thread-822): sending response (<Response 336 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:21.024563 (Thread-4): 19:24:21  SQL status: SUCCESS 1 in 2.23 seconds
2022-03-03 19:24:21.026116 (Thread-4): 19:24:21  finished collecting timing info
2022-03-03 19:24:21.026281 (Thread-4): 19:24:21  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:24:21.282980 (Thread-4): 19:24:21  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39be379f-6df3-4024-b501-e6f68dd6bdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc270070>]}
2022-03-03 19:24:21.283422 (Thread-4): 19:24:21  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.63s]
2022-03-03 19:24:21.283562 (Thread-4): 19:24:21  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:24:21.285228 (MainThread): 19:24:21  Acquiring new snowflake connection "master"
2022-03-03 19:24:21.285566 (MainThread): 19:24:21  
2022-03-03 19:24:21.285673 (MainThread): 19:24:21  Finished running 1 table model, 1 view model, 1 incremental model in 13.01s.
2022-03-03 19:24:21.285770 (MainThread): 19:24:21  Connection 'master' was properly closed.
2022-03-03 19:24:21.285845 (MainThread): 19:24:21  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:24:21.285918 (MainThread): 19:24:21  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:24:21.285990 (MainThread): 19:24:21  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:24:21.349420 (MainThread): 19:24:21  
2022-03-03 19:24:21.349643 (MainThread): 19:24:21  Completed successfully
2022-03-03 19:24:21.349747 (MainThread): 19:24:21  
2022-03-03 19:24:21.349843 (MainThread): 19:24:21  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:24:22.169562 (Thread-823): handling poll request
2022-03-03 19:24:22.169901 (Thread-823): 19:24:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef7d430>]}
2022-03-03 19:24:22.171186 (Thread-823): sending response (<Response 23361 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:23.558556 (Thread-824): handling status request
2022-03-03 19:24:23.558891 (Thread-824): 19:24:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aee9e490>]}
2022-03-03 19:24:23.559407 (Thread-824): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:23.566597 (Thread-825): handling status request
2022-03-03 19:24:23.566875 (Thread-825): 19:24:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef7b250>]}
2022-03-03 19:24:23.567341 (Thread-825): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:52.147084 (Thread-826): handling status request
2022-03-03 19:24:52.147424 (Thread-826): 19:24:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed764f0>]}
2022-03-03 19:24:52.147903 (Thread-826): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:52.495777 (Thread-827): handling status request
2022-03-03 19:24:52.496109 (Thread-827): 19:24:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef57250>]}
2022-03-03 19:24:52.496590 (Thread-827): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:52.783467 (Thread-828): handling cli_args request
2022-03-03 19:24:52.783822 (Thread-828): 19:24:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef576a0>]}
2022-03-03 19:24:55.013443 (Thread-828): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:55.435728 (MainThread): 19:24:55  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:24:55.436160 (MainThread): 19:24:55  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:24:55.444265 (MainThread): 19:24:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df7b3e62-5593-4c88-b567-3ecf2401b071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30663aa30>]}
2022-03-03 19:24:55.480742 (MainThread): 19:24:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df7b3e62-5593-4c88-b567-3ecf2401b071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3067147f0>]}
2022-03-03 19:24:55.481040 (MainThread): 19:24:55  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:24:55.483028 (MainThread): 19:24:55  
2022-03-03 19:24:55.483345 (MainThread): 19:24:55  Acquiring new snowflake connection "master"
2022-03-03 19:24:55.484258 (ThreadPoolExecutor-0_0): 19:24:55  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:24:55.497992 (ThreadPoolExecutor-0_0): 19:24:55  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:24:55.498126 (ThreadPoolExecutor-0_0): 19:24:55  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:24:55.498217 (ThreadPoolExecutor-0_0): 19:24:55  Opening a new connection, currently in state init
2022-03-03 19:24:55.745134 (Thread-829): handling poll request
2022-03-03 19:24:55.745550 (Thread-829): 19:24:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef36790>]}
2022-03-03 19:24:55.746453 (Thread-829): sending response (<Response 4164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:56.639139 (ThreadPoolExecutor-0_0): 19:24:56  SQL status: SUCCESS 8 in 1.14 seconds
2022-03-03 19:24:56.641202 (ThreadPoolExecutor-0_0): 19:24:56  On list_DBT_RAW: Close
2022-03-03 19:24:56.884934 (ThreadPoolExecutor-2_0): 19:24:56  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:24:56.953250 (ThreadPoolExecutor-2_0): 19:24:56  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:24:56.953414 (ThreadPoolExecutor-2_0): 19:24:56  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:24:56.953516 (ThreadPoolExecutor-2_0): 19:24:56  Opening a new connection, currently in state closed
2022-03-03 19:24:57.473093 (Thread-830): handling poll request
2022-03-03 19:24:57.473430 (Thread-830): 19:24:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aee5ea90>]}
2022-03-03 19:24:57.473988 (Thread-830): sending response (<Response 2317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:24:57.770489 (ThreadPoolExecutor-2_0): 19:24:57  SQL status: SUCCESS 34 in 0.82 seconds
2022-03-03 19:24:57.773058 (ThreadPoolExecutor-2_0): 19:24:57  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:24:57.974578 (MainThread): 19:24:57  Concurrency: 4 threads (target='default')
2022-03-03 19:24:57.974758 (MainThread): 19:24:57  
2022-03-03 19:24:57.977733 (Thread-3): 19:24:57  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:57.978080 (Thread-3): 19:24:57  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:24:57.978357 (Thread-3): 19:24:57  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:57.978473 (Thread-3): 19:24:57  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:57.978584 (Thread-3): 19:24:57  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:57.984898 (Thread-3): 19:24:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:57.998623 (Thread-3): 19:24:57  finished collecting timing info
2022-03-03 19:24:57.998787 (Thread-3): 19:24:57  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:24:58.023187 (Thread-3): 19:24:58  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:58.039501 (Thread-3): 19:24:58  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:24:58.039624 (Thread-3): 19:24:58  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:24:58.039714 (Thread-3): 19:24:58  Opening a new connection, currently in state closed
2022-03-03 19:24:59.208474 (Thread-831): handling poll request
2022-03-03 19:24:59.208836 (Thread-831): 19:24:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed66640>]}
2022-03-03 19:24:59.209520 (Thread-831): sending response (<Response 9149 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:00.942965 (Thread-832): handling poll request
2022-03-03 19:25:00.943301 (Thread-832): 19:25:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed663a0>]}
2022-03-03 19:25:00.965841 (Thread-832): sending response (<Response 320 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:02.012158 (Thread-3): 19:25:02  SQL status: SUCCESS 1 in 3.97 seconds
2022-03-03 19:25:02.022050 (Thread-3): 19:25:02  finished collecting timing info
2022-03-03 19:25:02.022231 (Thread-3): 19:25:02  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:25:02.302384 (Thread-3): 19:25:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7b3e62-5593-4c88-b567-3ecf2401b071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff305dc4910>]}
2022-03-03 19:25:02.302848 (Thread-3): 19:25:02  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 4.32s]
2022-03-03 19:25:02.302986 (Thread-3): 19:25:02  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:25:02.304098 (Thread-5): 19:25:02  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:25:02.304370 (Thread-5): 19:25:02  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:25:02.304693 (Thread-5): 19:25:02  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:25:02.304796 (Thread-5): 19:25:02  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:25:02.304889 (Thread-5): 19:25:02  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:25:02.339237 (Thread-5): 19:25:02  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:25:02.339379 (Thread-5): 19:25:02  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:25:02.339471 (Thread-5): 19:25:02  Opening a new connection, currently in state init
2022-03-03 19:25:02.703532 (Thread-833): handling poll request
2022-03-03 19:25:02.703884 (Thread-833): 19:25:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed66a90>]}
2022-03-03 19:25:02.704526 (Thread-833): sending response (<Response 6470 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:03.109426 (Thread-5): 19:25:03  SQL status: SUCCESS 5 in 0.77 seconds
2022-03-03 19:25:03.138930 (Thread-5): 19:25:03  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:25:03.139086 (Thread-5): 19:25:03  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:25:03.495140 (Thread-5): 19:25:03  SQL status: SUCCESS 5 in 0.36 seconds
2022-03-03 19:25:03.530087 (Thread-5): 19:25:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:25:03.542601 (Thread-5): 19:25:03  finished collecting timing info
2022-03-03 19:25:03.542898 (Thread-5): 19:25:03  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:25:03.562365 (Thread-5): 19:25:03  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:25:03.576972 (Thread-5): 19:25:03  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:25:03.577156 (Thread-5): 19:25:03  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:25:04.050359 (Thread-5): 19:25:04  SQL status: SUCCESS 1 in 0.47 seconds
2022-03-03 19:25:04.052352 (Thread-5): 19:25:04  finished collecting timing info
2022-03-03 19:25:04.052599 (Thread-5): 19:25:04  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:25:04.267795 (Thread-5): 19:25:04  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7b3e62-5593-4c88-b567-3ecf2401b071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff304209070>]}
2022-03-03 19:25:04.268221 (Thread-5): 19:25:04  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.96s]
2022-03-03 19:25:04.268356 (Thread-5): 19:25:04  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:25:04.269352 (Thread-4): 19:25:04  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:25:04.269637 (Thread-4): 19:25:04  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:25:04.269941 (Thread-4): 19:25:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:04.270039 (Thread-4): 19:25:04  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:25:04.270131 (Thread-4): 19:25:04  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:25:04.354868 (Thread-4): 19:25:04  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:04.367929 (Thread-4): 19:25:04  finished collecting timing info
2022-03-03 19:25:04.368117 (Thread-4): 19:25:04  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:25:04.393924 (Thread-4): 19:25:04  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:04.394075 (Thread-4): 19:25:04  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:25:04.394173 (Thread-4): 19:25:04  Opening a new connection, currently in state init
2022-03-03 19:25:04.446650 (Thread-834): handling poll request
2022-03-03 19:25:04.446953 (Thread-834): 19:25:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed52d30>]}
2022-03-03 19:25:04.447835 (Thread-834): sending response (<Response 15400 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:06.188488 (Thread-835): handling poll request
2022-03-03 19:25:06.188858 (Thread-835): 19:25:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed52f70>]}
2022-03-03 19:25:06.189349 (Thread-835): sending response (<Response 321 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:07.069318 (Thread-4): 19:25:07  SQL status: SUCCESS 1 in 2.68 seconds
2022-03-03 19:25:07.072655 (Thread-4): 19:25:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:07.072786 (Thread-4): 19:25:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:25:07.320836 (Thread-4): 19:25:07  SQL status: SUCCESS 10 in 0.25 seconds
2022-03-03 19:25:07.324672 (Thread-4): 19:25:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:07.324789 (Thread-4): 19:25:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:25:07.450695 (Thread-4): 19:25:07  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 19:25:07.459185 (Thread-4): 19:25:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:07.459351 (Thread-4): 19:25:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:25:07.618468 (Thread-4): 19:25:07  SQL status: SUCCESS 10 in 0.16 seconds
2022-03-03 19:25:07.640565 (Thread-4): 19:25:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:07.654492 (Thread-4): 19:25:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:07.654645 (Thread-4): 19:25:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:25:07.804788 (Thread-4): 19:25:07  SQL status: SUCCESS 1 in 0.15 seconds
2022-03-03 19:25:07.805039 (Thread-4): 19:25:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:07.805127 (Thread-4): 19:25:07  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:25:07.925916 (Thread-836): handling poll request
2022-03-03 19:25:07.926348 (Thread-836): 19:25:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aee48d00>]}
2022-03-03 19:25:07.927234 (Thread-836): sending response (<Response 8392 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:08.130249 (Thread-4): 19:25:08  SQL status: SUCCESS 0 in 0.32 seconds
2022-03-03 19:25:08.130456 (Thread-4): 19:25:08  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:25:08.130546 (Thread-4): 19:25:08  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:25:08.366076 (Thread-4): 19:25:08  SQL status: SUCCESS 1 in 0.24 seconds
2022-03-03 19:25:08.367610 (Thread-4): 19:25:08  finished collecting timing info
2022-03-03 19:25:08.367780 (Thread-4): 19:25:08  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:25:08.590046 (Thread-4): 19:25:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7b3e62-5593-4c88-b567-3ecf2401b071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff30426dee0>]}
2022-03-03 19:25:08.590479 (Thread-4): 19:25:08  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 4.32s]
2022-03-03 19:25:08.590613 (Thread-4): 19:25:08  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:25:08.592282 (MainThread): 19:25:08  Acquiring new snowflake connection "master"
2022-03-03 19:25:08.592616 (MainThread): 19:25:08  
2022-03-03 19:25:08.592764 (MainThread): 19:25:08  Finished running 1 table model, 1 view model, 1 incremental model in 13.11s.
2022-03-03 19:25:08.592856 (MainThread): 19:25:08  Connection 'master' was properly closed.
2022-03-03 19:25:08.592928 (MainThread): 19:25:08  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:25:08.592994 (MainThread): 19:25:08  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:25:08.593059 (MainThread): 19:25:08  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:25:08.657563 (MainThread): 19:25:08  
2022-03-03 19:25:08.657776 (MainThread): 19:25:08  Completed successfully
2022-03-03 19:25:08.657885 (MainThread): 19:25:08  
2022-03-03 19:25:08.657984 (MainThread): 19:25:08  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:25:09.711525 (Thread-837): handling poll request
2022-03-03 19:25:09.711864 (Thread-837): 19:25:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecce040>]}
2022-03-03 19:25:09.713186 (Thread-837): sending response (<Response 25493 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:11.097909 (Thread-838): handling status request
2022-03-03 19:25:11.098244 (Thread-838): 19:25:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecce4c0>]}
2022-03-03 19:25:11.098771 (Thread-838): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:25:11.337775 (Thread-839): handling status request
2022-03-03 19:25:11.338112 (Thread-839): 19:25:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecce8b0>]}
2022-03-03 19:25:11.338595 (Thread-839): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:01.374037 (Thread-840): handling status request
2022-03-03 19:26:01.374368 (Thread-840): 19:26:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecceaf0>]}
2022-03-03 19:26:01.374847 (Thread-840): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:01.666080 (Thread-841): handling status request
2022-03-03 19:26:01.666393 (Thread-841): 19:26:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecced60>]}
2022-03-03 19:26:01.666858 (Thread-841): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:01.985050 (Thread-842): handling cli_args request
2022-03-03 19:26:01.985377 (Thread-842): 19:26:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeccefd0>]}
2022-03-03 19:26:04.255743 (Thread-842): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:04.684347 (MainThread): 19:26:04  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:26:04.684839 (MainThread): 19:26:04  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:26:04.692887 (MainThread): 19:26:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c085607-32f1-4934-a1ba-2239251f3e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702c3ba880>]}
2022-03-03 19:26:04.722255 (MainThread): 19:26:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c085607-32f1-4934-a1ba-2239251f3e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702c49afa0>]}
2022-03-03 19:26:04.722532 (MainThread): 19:26:04  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:26:04.724225 (MainThread): 19:26:04  
2022-03-03 19:26:04.724531 (MainThread): 19:26:04  Acquiring new snowflake connection "master"
2022-03-03 19:26:04.725390 (ThreadPoolExecutor-0_0): 19:26:04  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:26:04.739061 (ThreadPoolExecutor-0_0): 19:26:04  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:26:04.739170 (ThreadPoolExecutor-0_0): 19:26:04  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:26:04.739254 (ThreadPoolExecutor-0_0): 19:26:04  Opening a new connection, currently in state init
2022-03-03 19:26:05.012294 (Thread-843): handling poll request
2022-03-03 19:26:05.012726 (Thread-843): 19:26:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecf4070>]}
2022-03-03 19:26:05.013616 (Thread-843): sending response (<Response 4162 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:05.986512 (ThreadPoolExecutor-0_0): 19:26:05  SQL status: SUCCESS 8 in 1.25 seconds
2022-03-03 19:26:05.988551 (ThreadPoolExecutor-0_0): 19:26:05  On list_DBT_RAW: Close
2022-03-03 19:26:06.213626 (ThreadPoolExecutor-2_0): 19:26:06  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:26:06.270231 (ThreadPoolExecutor-2_0): 19:26:06  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:26:06.270372 (ThreadPoolExecutor-2_0): 19:26:06  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:26:06.270467 (ThreadPoolExecutor-2_0): 19:26:06  Opening a new connection, currently in state closed
2022-03-03 19:26:06.750620 (Thread-844): handling poll request
2022-03-03 19:26:06.750965 (Thread-844): 19:26:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecf4940>]}
2022-03-03 19:26:06.751547 (Thread-844): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:07.143454 (ThreadPoolExecutor-2_0): 19:26:07  SQL status: SUCCESS 34 in 0.87 seconds
2022-03-03 19:26:07.145715 (ThreadPoolExecutor-2_0): 19:26:07  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:26:07.467767 (MainThread): 19:26:07  Concurrency: 4 threads (target='default')
2022-03-03 19:26:07.467926 (MainThread): 19:26:07  
2022-03-03 19:26:07.470719 (Thread-3): 19:26:07  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:26:07.471038 (Thread-3): 19:26:07  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:26:07.471309 (Thread-3): 19:26:07  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:07.471408 (Thread-3): 19:26:07  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:26:07.471516 (Thread-3): 19:26:07  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:26:07.560077 (Thread-3): 19:26:07  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:07.573007 (Thread-3): 19:26:07  finished collecting timing info
2022-03-03 19:26:07.573169 (Thread-3): 19:26:07  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:26:07.615575 (Thread-3): 19:26:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:07.615707 (Thread-3): 19:26:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:26:07.615797 (Thread-3): 19:26:07  Opening a new connection, currently in state closed
2022-03-03 19:26:08.485240 (Thread-845): handling poll request
2022-03-03 19:26:08.485575 (Thread-845): 19:26:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed37190>]}
2022-03-03 19:26:08.486234 (Thread-845): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:10.222361 (Thread-846): handling poll request
2022-03-03 19:26:10.222705 (Thread-846): 19:26:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed37340>]}
2022-03-03 19:26:10.223193 (Thread-846): sending response (<Response 317 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:10.235175 (Thread-3): 19:26:10  SQL status: SUCCESS 1 in 2.62 seconds
2022-03-03 19:26:10.244454 (Thread-3): 19:26:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:10.244575 (Thread-3): 19:26:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:26:10.418660 (Thread-3): 19:26:10  SQL status: SUCCESS 10 in 0.17 seconds
2022-03-03 19:26:10.422736 (Thread-3): 19:26:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:10.422854 (Thread-3): 19:26:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:26:10.534614 (Thread-3): 19:26:10  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:26:10.542611 (Thread-3): 19:26:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:10.542723 (Thread-3): 19:26:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:26:10.656883 (Thread-3): 19:26:10  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:26:10.677469 (Thread-3): 19:26:10  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:10.693251 (Thread-3): 19:26:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:10.693371 (Thread-3): 19:26:10  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:26:10.864127 (Thread-3): 19:26:10  SQL status: SUCCESS 1 in 0.17 seconds
2022-03-03 19:26:10.864337 (Thread-3): 19:26:10  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:10.864420 (Thread-3): 19:26:10  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:26:11.460059 (Thread-3): 19:26:11  SQL status: SUCCESS 1 in 0.6 seconds
2022-03-03 19:26:11.460258 (Thread-3): 19:26:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:26:11.460341 (Thread-3): 19:26:11  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:26:11.831733 (Thread-3): 19:26:11  SQL status: SUCCESS 1 in 0.37 seconds
2022-03-03 19:26:11.842465 (Thread-3): 19:26:11  finished collecting timing info
2022-03-03 19:26:11.842645 (Thread-3): 19:26:11  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:26:11.972311 (Thread-847): handling poll request
2022-03-03 19:26:11.972623 (Thread-847): 19:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed37eb0>]}
2022-03-03 19:26:11.973422 (Thread-847): sending response (<Response 10670 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:12.112545 (Thread-3): 19:26:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c085607-32f1-4934-a1ba-2239251f3e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702c345f70>]}
2022-03-03 19:26:12.113012 (Thread-3): 19:26:12  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 4.64s]
2022-03-03 19:26:12.113143 (Thread-3): 19:26:12  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:26:12.114722 (MainThread): 19:26:12  Acquiring new snowflake connection "master"
2022-03-03 19:26:12.115055 (MainThread): 19:26:12  
2022-03-03 19:26:12.115160 (MainThread): 19:26:12  Finished running 1 incremental model in 7.39s.
2022-03-03 19:26:12.115246 (MainThread): 19:26:12  Connection 'master' was properly closed.
2022-03-03 19:26:12.115314 (MainThread): 19:26:12  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:26:12.183596 (MainThread): 19:26:12  
2022-03-03 19:26:12.183771 (MainThread): 19:26:12  Completed successfully
2022-03-03 19:26:12.183870 (MainThread): 19:26:12  
2022-03-03 19:26:12.183963 (MainThread): 19:26:12  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:26:13.711200 (Thread-848): handling poll request
2022-03-03 19:26:13.711825 (Thread-848): 19:26:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed37d30>]}
2022-03-03 19:26:13.712807 (Thread-848): sending response (<Response 10142 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:15.072426 (Thread-849): handling status request
2022-03-03 19:26:15.072791 (Thread-849): 19:26:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecf4040>]}
2022-03-03 19:26:15.073361 (Thread-849): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:26:15.079806 (Thread-850): handling status request
2022-03-03 19:26:15.080022 (Thread-850): 19:26:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecde280>]}
2022-03-03 19:26:15.080394 (Thread-850): sending response (<Response 1894 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:47.540073 (Thread-851): 19:34:47  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:34:47.541706 (Thread-851): 19:34:47  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:34:47.549468 (Thread-851): 19:34:47  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:34:47.560858 (Thread-851): 19:34:47  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:34:47.630113 (Thread-851): 19:34:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeaccbe0>]}
2022-03-03 19:34:48.486157 (Thread-852): handling status request
2022-03-03 19:34:48.486529 (Thread-852): 19:34:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1ed60>]}
2022-03-03 19:34:48.487036 (Thread-852): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:48.503671 (Thread-853): handling status request
2022-03-03 19:34:48.503961 (Thread-853): 19:34:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1ea60>]}
2022-03-03 19:34:48.504406 (Thread-853): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:53.955888 (Thread-854): handling status request
2022-03-03 19:34:53.956221 (Thread-854): 19:34:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1e9a0>]}
2022-03-03 19:34:53.956721 (Thread-854): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:54.121316 (Thread-855): handling status request
2022-03-03 19:34:54.121635 (Thread-855): 19:34:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1e6a0>]}
2022-03-03 19:34:54.122110 (Thread-855): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:54.460807 (Thread-856): handling cli_args request
2022-03-03 19:34:54.461130 (Thread-856): 19:34:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1e430>]}
2022-03-03 19:34:56.721485 (Thread-856): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:57.138250 (MainThread): 19:34:57  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:34:57.138736 (MainThread): 19:34:57  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:34:57.146781 (MainThread): 19:34:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bafd10a4-7eff-42fe-b0d2-3d6516f295b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeee4fc9a0>]}
2022-03-03 19:34:57.186637 (MainThread): 19:34:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bafd10a4-7eff-42fe-b0d2-3d6516f295b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeee5d1760>]}
2022-03-03 19:34:57.186888 (MainThread): 19:34:57  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:34:57.188509 (MainThread): 19:34:57  
2022-03-03 19:34:57.188834 (MainThread): 19:34:57  Acquiring new snowflake connection "master"
2022-03-03 19:34:57.189626 (ThreadPoolExecutor-0_0): 19:34:57  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:34:57.203270 (ThreadPoolExecutor-0_0): 19:34:57  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:34:57.203376 (ThreadPoolExecutor-0_0): 19:34:57  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:34:57.203461 (ThreadPoolExecutor-0_0): 19:34:57  Opening a new connection, currently in state init
2022-03-03 19:34:57.534054 (Thread-857): handling poll request
2022-03-03 19:34:57.534460 (Thread-857): 19:34:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1ea00>]}
2022-03-03 19:34:57.535503 (Thread-857): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:58.209414 (ThreadPoolExecutor-0_0): 19:34:58  SQL status: SUCCESS 8 in 1.01 seconds
2022-03-03 19:34:58.211460 (ThreadPoolExecutor-0_0): 19:34:58  On list_DBT_RAW: Close
2022-03-03 19:34:58.440842 (ThreadPoolExecutor-2_0): 19:34:58  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:34:58.500087 (ThreadPoolExecutor-2_0): 19:34:58  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:34:58.500236 (ThreadPoolExecutor-2_0): 19:34:58  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:34:58.500331 (ThreadPoolExecutor-2_0): 19:34:58  Opening a new connection, currently in state closed
2022-03-03 19:34:59.356154 (Thread-858): handling poll request
2022-03-03 19:34:59.356492 (Thread-858): 19:34:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1ed90>]}
2022-03-03 19:34:59.357118 (Thread-858): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:34:59.444456 (ThreadPoolExecutor-2_0): 19:34:59  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 19:34:59.446785 (ThreadPoolExecutor-2_0): 19:34:59  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:34:59.648023 (MainThread): 19:34:59  Concurrency: 4 threads (target='default')
2022-03-03 19:34:59.648198 (MainThread): 19:34:59  
2022-03-03 19:34:59.651093 (Thread-3): 19:34:59  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:34:59.651405 (Thread-3): 19:34:59  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:34:59.651682 (Thread-3): 19:34:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:34:59.651787 (Thread-3): 19:34:59  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:34:59.651896 (Thread-3): 19:34:59  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:34:59.756441 (Thread-3): 19:34:59  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:34:59.771900 (Thread-3): 19:34:59  finished collecting timing info
2022-03-03 19:34:59.772093 (Thread-3): 19:34:59  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:34:59.814761 (Thread-3): 19:34:59  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:34:59.814931 (Thread-3): 19:34:59  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:34:59.815031 (Thread-3): 19:34:59  Opening a new connection, currently in state closed
2022-03-03 19:35:01.176206 (Thread-859): handling poll request
2022-03-03 19:35:01.176564 (Thread-859): 19:35:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1c8e0>]}
2022-03-03 19:35:01.177338 (Thread-859): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:35:02.991681 (Thread-860): handling poll request
2022-03-03 19:35:02.992037 (Thread-860): 19:35:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb1c3a0>]}
2022-03-03 19:35:02.992583 (Thread-860): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:35:03.624629 (Thread-3): 19:35:03  SQL status: SUCCESS 1 in 3.81 seconds
2022-03-03 19:35:03.634324 (Thread-3): 19:35:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:03.634481 (Thread-3): 19:35:03  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:35:03.796820 (Thread-3): 19:35:03  SQL status: SUCCESS 10 in 0.16 seconds
2022-03-03 19:35:03.800980 (Thread-3): 19:35:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:03.801107 (Thread-3): 19:35:03  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:35:03.939393 (Thread-3): 19:35:03  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:35:03.947892 (Thread-3): 19:35:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:03.948026 (Thread-3): 19:35:03  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:35:04.348594 (Thread-3): 19:35:04  SQL status: SUCCESS 10 in 0.4 seconds
2022-03-03 19:35:04.369859 (Thread-3): 19:35:04  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:04.384176 (Thread-3): 19:35:04  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:04.384331 (Thread-3): 19:35:04  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:35:04.580316 (Thread-3): 19:35:04  SQL status: SUCCESS 1 in 0.2 seconds
2022-03-03 19:35:04.580567 (Thread-3): 19:35:04  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:04.580686 (Thread-3): 19:35:04  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:35:04.809696 (Thread-861): handling poll request
2022-03-03 19:35:04.810036 (Thread-861): 19:35:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec23490>]}
2022-03-03 19:35:04.810719 (Thread-861): sending response (<Response 8388 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:35:05.763658 (Thread-3): 19:35:05  SQL status: SUCCESS 2 in 1.18 seconds
2022-03-03 19:35:05.763881 (Thread-3): 19:35:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:35:05.763985 (Thread-3): 19:35:05  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:35:06.267899 (Thread-3): 19:35:06  SQL status: SUCCESS 1 in 0.5 seconds
2022-03-03 19:35:06.279025 (Thread-3): 19:35:06  finished collecting timing info
2022-03-03 19:35:06.279247 (Thread-3): 19:35:06  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:35:06.617049 (Thread-862): handling poll request
2022-03-03 19:35:06.617400 (Thread-862): 19:35:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec23940>]}
2022-03-03 19:35:06.641122 (Thread-862): sending response (<Response 2598 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:35:06.643320 (Thread-3): 19:35:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafd10a4-7eff-42fe-b0d2-3d6516f295b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feef22ad070>]}
2022-03-03 19:35:06.643770 (Thread-3): 19:35:06  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.99s]
2022-03-03 19:35:06.643909 (Thread-3): 19:35:06  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:35:06.645629 (MainThread): 19:35:06  Acquiring new snowflake connection "master"
2022-03-03 19:35:06.645965 (MainThread): 19:35:06  
2022-03-03 19:35:06.646066 (MainThread): 19:35:06  Finished running 1 incremental model in 9.46s.
2022-03-03 19:35:06.646151 (MainThread): 19:35:06  Connection 'master' was properly closed.
2022-03-03 19:35:06.646220 (MainThread): 19:35:06  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:35:06.729910 (MainThread): 19:35:06  
2022-03-03 19:35:06.730155 (MainThread): 19:35:06  Completed successfully
2022-03-03 19:35:06.730268 (MainThread): 19:35:06  
2022-03-03 19:35:06.730367 (MainThread): 19:35:06  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:35:08.453227 (Thread-863): handling poll request
2022-03-03 19:35:08.453583 (Thread-863): 19:35:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec23490>]}
2022-03-03 19:35:08.454604 (Thread-863): sending response (<Response 11270 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:35:09.965989 (Thread-864): handling status request
2022-03-03 19:35:09.966321 (Thread-864): 19:35:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec237c0>]}
2022-03-03 19:35:09.966843 (Thread-864): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:35:09.973567 (Thread-865): handling status request
2022-03-03 19:35:09.973797 (Thread-865): 19:35:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec23e20>]}
2022-03-03 19:35:09.974161 (Thread-865): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:26.136745 (Thread-866): handling status request
2022-03-03 19:36:26.138334 (Thread-866): 19:36:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec23e50>]}
2022-03-03 19:36:26.138819 (Thread-866): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:27.131943 (Thread-867): handling status request
2022-03-03 19:36:27.132275 (Thread-867): 19:36:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec23280>]}
2022-03-03 19:36:27.132794 (Thread-867): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:27.138210 (Thread-868): handling cli_args request
2022-03-03 19:36:27.138446 (Thread-868): 19:36:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb18bb0>]}
2022-03-03 19:36:29.414456 (Thread-868): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:29.913689 (MainThread): 19:36:29  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:36:29.914130 (MainThread): 19:36:29  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:36:29.921997 (MainThread): 19:36:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d21dc86-8bbb-4c84-8009-af32f863e6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dafc910>]}
2022-03-03 19:36:29.959933 (MainThread): 19:36:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d21dc86-8bbb-4c84-8009-af32f863e6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dbd56d0>]}
2022-03-03 19:36:29.960192 (MainThread): 19:36:29  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:36:29.962217 (MainThread): 19:36:29  
2022-03-03 19:36:29.962498 (MainThread): 19:36:29  Acquiring new snowflake connection "master"
2022-03-03 19:36:29.963343 (ThreadPoolExecutor-0_0): 19:36:29  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:36:29.977122 (ThreadPoolExecutor-0_0): 19:36:29  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:36:29.977289 (ThreadPoolExecutor-0_0): 19:36:29  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:36:29.977379 (ThreadPoolExecutor-0_0): 19:36:29  Opening a new connection, currently in state init
2022-03-03 19:36:30.217004 (Thread-869): handling poll request
2022-03-03 19:36:30.217432 (Thread-869): 19:36:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec29130>]}
2022-03-03 19:36:30.218320 (Thread-869): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:31.030771 (ThreadPoolExecutor-0_0): 19:36:31  SQL status: SUCCESS 8 in 1.05 seconds
2022-03-03 19:36:31.032934 (ThreadPoolExecutor-0_0): 19:36:31  On list_DBT_RAW: Close
2022-03-03 19:36:31.251933 (ThreadPoolExecutor-2_0): 19:36:31  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:36:31.313051 (ThreadPoolExecutor-2_0): 19:36:31  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:36:31.313202 (ThreadPoolExecutor-2_0): 19:36:31  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:36:31.313303 (ThreadPoolExecutor-2_0): 19:36:31  Opening a new connection, currently in state closed
2022-03-03 19:36:32.035116 (Thread-870): handling poll request
2022-03-03 19:36:32.035470 (Thread-870): 19:36:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec299d0>]}
2022-03-03 19:36:32.036068 (Thread-870): sending response (<Response 2331 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:32.325053 (ThreadPoolExecutor-2_0): 19:36:32  SQL status: SUCCESS 34 in 1.01 seconds
2022-03-03 19:36:32.327301 (ThreadPoolExecutor-2_0): 19:36:32  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:36:32.530022 (MainThread): 19:36:32  Concurrency: 4 threads (target='default')
2022-03-03 19:36:32.530202 (MainThread): 19:36:32  
2022-03-03 19:36:32.533152 (Thread-3): 19:36:32  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:36:32.533471 (Thread-3): 19:36:32  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:36:32.533738 (Thread-3): 19:36:32  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:36:32.533840 (Thread-3): 19:36:32  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:36:32.533948 (Thread-3): 19:36:32  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:36:32.540058 (Thread-3): 19:36:32  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:36:32.557107 (Thread-3): 19:36:32  finished collecting timing info
2022-03-03 19:36:32.557280 (Thread-3): 19:36:32  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:36:32.582239 (Thread-3): 19:36:32  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:36:32.602585 (Thread-3): 19:36:32  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:36:32.602708 (Thread-3): 19:36:32  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:36:32.602799 (Thread-3): 19:36:32  Opening a new connection, currently in state closed
2022-03-03 19:36:33.845015 (Thread-871): handling poll request
2022-03-03 19:36:33.845370 (Thread-871): 19:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebd54f0>]}
2022-03-03 19:36:33.846081 (Thread-871): sending response (<Response 9164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:35.775987 (Thread-872): handling poll request
2022-03-03 19:36:35.776323 (Thread-872): 19:36:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebd52b0>]}
2022-03-03 19:36:35.776845 (Thread-872): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:36.907436 (Thread-3): 19:36:36  SQL status: SUCCESS 1 in 4.3 seconds
2022-03-03 19:36:36.916830 (Thread-3): 19:36:36  finished collecting timing info
2022-03-03 19:36:36.917008 (Thread-3): 19:36:36  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:36:37.116051 (Thread-3): 19:36:37  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d21dc86-8bbb-4c84-8009-af32f863e6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d2866d0>]}
2022-03-03 19:36:37.116684 (Thread-3): 19:36:37  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 4.58s]
2022-03-03 19:36:37.116830 (Thread-3): 19:36:37  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:36:37.117809 (Thread-5): 19:36:37  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:36:37.118082 (Thread-5): 19:36:37  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:36:37.118377 (Thread-5): 19:36:37  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:36:37.118473 (Thread-5): 19:36:37  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:36:37.118566 (Thread-5): 19:36:37  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:36:37.155040 (Thread-5): 19:36:37  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:36:37.155184 (Thread-5): 19:36:37  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:36:37.155274 (Thread-5): 19:36:37  Opening a new connection, currently in state init
2022-03-03 19:36:37.590443 (Thread-873): handling poll request
2022-03-03 19:36:37.590785 (Thread-873): 19:36:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aead5520>]}
2022-03-03 19:36:37.591416 (Thread-873): sending response (<Response 6486 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:37.856085 (Thread-5): 19:36:37  SQL status: SUCCESS 5 in 0.7 seconds
2022-03-03 19:36:37.885768 (Thread-5): 19:36:37  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:36:37.885967 (Thread-5): 19:36:37  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:36:38.044522 (Thread-5): 19:36:38  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 19:36:38.079312 (Thread-5): 19:36:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:36:38.092552 (Thread-5): 19:36:38  finished collecting timing info
2022-03-03 19:36:38.092755 (Thread-5): 19:36:38  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:36:38.112471 (Thread-5): 19:36:38  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:36:38.128040 (Thread-5): 19:36:38  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:36:38.128210 (Thread-5): 19:36:38  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:36:38.421552 (Thread-5): 19:36:38  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 19:36:38.423085 (Thread-5): 19:36:38  finished collecting timing info
2022-03-03 19:36:38.423245 (Thread-5): 19:36:38  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:36:38.641910 (Thread-5): 19:36:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d21dc86-8bbb-4c84-8009-af32f863e6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c13f880>]}
2022-03-03 19:36:38.642469 (Thread-5): 19:36:38  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.52s]
2022-03-03 19:36:38.642701 (Thread-5): 19:36:38  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:36:38.643828 (Thread-4): 19:36:38  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:36:38.644079 (Thread-4): 19:36:38  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:36:38.644364 (Thread-4): 19:36:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:36:38.644456 (Thread-4): 19:36:38  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:36:38.644547 (Thread-4): 19:36:38  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:36:38.726594 (Thread-4): 19:36:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:36:38.741723 (Thread-4): 19:36:38  finished collecting timing info
2022-03-03 19:36:38.741905 (Thread-4): 19:36:38  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:36:38.765969 (Thread-4): 19:36:38  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:36:38.781668 (Thread-4): 19:36:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:36:38.781821 (Thread-4): 19:36:38  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:36:38.781912 (Thread-4): 19:36:38  Opening a new connection, currently in state init
2022-03-03 19:36:39.394355 (Thread-874): handling poll request
2022-03-03 19:36:39.394713 (Thread-874): 19:36:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeaf9250>]}
2022-03-03 19:36:39.395597 (Thread-874): sending response (<Response 14837 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:40.754561 (Thread-4): 19:36:40  SQL status: SUCCESS 1 in 1.97 seconds
2022-03-03 19:36:40.756196 (Thread-4): 19:36:40  finished collecting timing info
2022-03-03 19:36:40.756369 (Thread-4): 19:36:40  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:36:41.016108 (Thread-4): 19:36:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d21dc86-8bbb-4c84-8009-af32f863e6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c09a160>]}
2022-03-03 19:36:41.016547 (Thread-4): 19:36:41  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.37s]
2022-03-03 19:36:41.016719 (Thread-4): 19:36:41  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:36:41.018371 (MainThread): 19:36:41  Acquiring new snowflake connection "master"
2022-03-03 19:36:41.018712 (MainThread): 19:36:41  
2022-03-03 19:36:41.018817 (MainThread): 19:36:41  Finished running 1 table model, 1 view model, 1 incremental model in 11.06s.
2022-03-03 19:36:41.018903 (MainThread): 19:36:41  Connection 'master' was properly closed.
2022-03-03 19:36:41.018974 (MainThread): 19:36:41  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:36:41.019040 (MainThread): 19:36:41  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:36:41.019106 (MainThread): 19:36:41  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:36:41.079480 (MainThread): 19:36:41  
2022-03-03 19:36:41.079707 (MainThread): 19:36:41  Completed successfully
2022-03-03 19:36:41.079812 (MainThread): 19:36:41  
2022-03-03 19:36:41.079909 (MainThread): 19:36:41  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:36:41.207210 (Thread-875): handling poll request
2022-03-03 19:36:41.207559 (Thread-875): 19:36:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec3e130>]}
2022-03-03 19:36:41.208228 (Thread-875): sending response (<Response 6687 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:43.022700 (Thread-876): handling poll request
2022-03-03 19:36:43.023055 (Thread-876): 19:36:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec3e130>]}
2022-03-03 19:36:43.024196 (Thread-876): sending response (<Response 18140 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:44.429375 (Thread-877): handling status request
2022-03-03 19:36:44.429722 (Thread-877): 19:36:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebcb070>]}
2022-03-03 19:36:44.430271 (Thread-877): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:36:44.549090 (Thread-878): handling status request
2022-03-03 19:36:44.549453 (Thread-878): 19:36:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebcb730>]}
2022-03-03 19:36:44.549962 (Thread-878): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:48.454727 (Thread-879): handling status request
2022-03-03 19:37:48.456571 (Thread-879): 19:37:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebcbfa0>]}
2022-03-03 19:37:48.457067 (Thread-879): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:48.668231 (Thread-880): handling status request
2022-03-03 19:37:48.668565 (Thread-880): 19:37:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeaf90d0>]}
2022-03-03 19:37:48.669109 (Thread-880): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:48.989850 (Thread-881): handling cli_args request
2022-03-03 19:37:48.990163 (Thread-881): 19:37:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeaeb130>]}
2022-03-03 19:37:51.285508 (Thread-881): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:51.667434 (MainThread): 19:37:51  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:37:51.667850 (MainThread): 19:37:51  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:37:51.676017 (MainThread): 19:37:51  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53c87f8e-962b-4962-8f2d-8575df9be07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0301e7ba90>]}
2022-03-03 19:37:51.705350 (MainThread): 19:37:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53c87f8e-962b-4962-8f2d-8575df9be07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0301f51820>]}
2022-03-03 19:37:51.705609 (MainThread): 19:37:51  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:37:51.707246 (MainThread): 19:37:51  
2022-03-03 19:37:51.707542 (MainThread): 19:37:51  Acquiring new snowflake connection "master"
2022-03-03 19:37:51.708321 (ThreadPoolExecutor-0_0): 19:37:51  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:37:51.721708 (ThreadPoolExecutor-0_0): 19:37:51  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:37:51.721820 (ThreadPoolExecutor-0_0): 19:37:51  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:37:51.721907 (ThreadPoolExecutor-0_0): 19:37:51  Opening a new connection, currently in state init
2022-03-03 19:37:52.078461 (Thread-882): handling poll request
2022-03-03 19:37:52.078870 (Thread-882): 19:37:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeaebcd0>]}
2022-03-03 19:37:52.079761 (Thread-882): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:52.681791 (ThreadPoolExecutor-0_0): 19:37:52  SQL status: SUCCESS 8 in 0.96 seconds
2022-03-03 19:37:52.683992 (ThreadPoolExecutor-0_0): 19:37:52  On list_DBT_RAW: Close
2022-03-03 19:37:52.914868 (ThreadPoolExecutor-2_0): 19:37:52  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:37:52.978606 (ThreadPoolExecutor-2_0): 19:37:52  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:37:52.978772 (ThreadPoolExecutor-2_0): 19:37:52  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:37:52.978873 (ThreadPoolExecutor-2_0): 19:37:52  Opening a new connection, currently in state closed
2022-03-03 19:37:53.885939 (Thread-883): handling poll request
2022-03-03 19:37:53.886341 (Thread-883): 19:37:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae9880>]}
2022-03-03 19:37:53.886917 (Thread-883): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:54.174830 (ThreadPoolExecutor-2_0): 19:37:54  SQL status: SUCCESS 34 in 1.2 seconds
2022-03-03 19:37:54.177070 (ThreadPoolExecutor-2_0): 19:37:54  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:37:54.770639 (MainThread): 19:37:54  Concurrency: 4 threads (target='default')
2022-03-03 19:37:54.770819 (MainThread): 19:37:54  
2022-03-03 19:37:54.773893 (Thread-3): 19:37:54  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:37:54.774250 (Thread-3): 19:37:54  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:37:54.774552 (Thread-3): 19:37:54  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:37:54.774668 (Thread-3): 19:37:54  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:37:54.774777 (Thread-3): 19:37:54  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:37:54.863966 (Thread-3): 19:37:54  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:37:54.878487 (Thread-3): 19:37:54  finished collecting timing info
2022-03-03 19:37:54.878662 (Thread-3): 19:37:54  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:37:54.920049 (Thread-3): 19:37:54  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:37:54.920198 (Thread-3): 19:37:54  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:37:54.920291 (Thread-3): 19:37:54  Opening a new connection, currently in state closed
2022-03-03 19:37:55.697157 (Thread-884): handling poll request
2022-03-03 19:37:55.697510 (Thread-884): 19:37:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea51460>]}
2022-03-03 19:37:55.698303 (Thread-884): sending response (<Response 7965 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:57.498298 (Thread-885): handling poll request
2022-03-03 19:37:57.498715 (Thread-885): 19:37:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea51220>]}
2022-03-03 19:37:57.499234 (Thread-885): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:59.304365 (Thread-886): handling poll request
2022-03-03 19:37:59.304742 (Thread-886): 19:37:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea51cd0>]}
2022-03-03 19:37:59.305248 (Thread-886): sending response (<Response 319 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:37:59.973378 (Thread-3): 19:37:59  SQL status: SUCCESS 1 in 5.05 seconds
2022-03-03 19:37:59.983011 (Thread-3): 19:37:59  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:37:59.983154 (Thread-3): 19:37:59  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:38:00.109643 (Thread-3): 19:38:00  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 19:38:00.113628 (Thread-3): 19:38:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:38:00.113747 (Thread-3): 19:38:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:38:00.252017 (Thread-3): 19:38:00  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:38:00.260342 (Thread-3): 19:38:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:38:00.260471 (Thread-3): 19:38:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:38:00.506158 (Thread-3): 19:38:00  SQL status: SUCCESS 10 in 0.25 seconds
2022-03-03 19:38:00.527192 (Thread-3): 19:38:00  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:38:00.543045 (Thread-3): 19:38:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:38:00.543190 (Thread-3): 19:38:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:38:00.729133 (Thread-3): 19:38:00  SQL status: SUCCESS 1 in 0.19 seconds
2022-03-03 19:38:00.729381 (Thread-3): 19:38:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:38:00.729469 (Thread-3): 19:38:00  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:38:01.136465 (Thread-887): handling poll request
2022-03-03 19:38:01.136917 (Thread-887): 19:38:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea6b640>]}
2022-03-03 19:38:01.137595 (Thread-887): sending response (<Response 8390 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:38:01.921471 (Thread-3): 19:38:01  SQL status: SUCCESS 1 in 1.19 seconds
2022-03-03 19:38:01.921669 (Thread-3): 19:38:01  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:38:01.921751 (Thread-3): 19:38:01  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:38:02.410090 (Thread-3): 19:38:02  SQL status: SUCCESS 1 in 0.49 seconds
2022-03-03 19:38:02.421359 (Thread-3): 19:38:02  finished collecting timing info
2022-03-03 19:38:02.421547 (Thread-3): 19:38:02  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:38:02.647801 (Thread-3): 19:38:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53c87f8e-962b-4962-8f2d-8575df9be07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0301f51100>]}
2022-03-03 19:38:02.648350 (Thread-3): 19:38:02  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 7.87s]
2022-03-03 19:38:02.648505 (Thread-3): 19:38:02  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:38:02.650209 (MainThread): 19:38:02  Acquiring new snowflake connection "master"
2022-03-03 19:38:02.650535 (MainThread): 19:38:02  
2022-03-03 19:38:02.650637 (MainThread): 19:38:02  Finished running 1 incremental model in 10.94s.
2022-03-03 19:38:02.650725 (MainThread): 19:38:02  Connection 'master' was properly closed.
2022-03-03 19:38:02.650795 (MainThread): 19:38:02  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:38:02.715749 (MainThread): 19:38:02  
2022-03-03 19:38:02.715973 (MainThread): 19:38:02  Completed successfully
2022-03-03 19:38:02.716077 (MainThread): 19:38:02  
2022-03-03 19:38:02.716173 (MainThread): 19:38:02  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:38:02.943856 (Thread-888): handling poll request
2022-03-03 19:38:02.944211 (Thread-888): 19:38:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea751f0>]}
2022-03-03 19:38:02.945601 (Thread-888): sending response (<Response 13554 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:38:04.448555 (Thread-889): handling status request
2022-03-03 19:38:04.448942 (Thread-889): 19:38:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea51160>]}
2022-03-03 19:38:04.449502 (Thread-889): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:38:04.489154 (Thread-890): handling status request
2022-03-03 19:38:04.489481 (Thread-890): 19:38:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea516a0>]}
2022-03-03 19:38:04.489949 (Thread-890): sending response (<Response 1915 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:10.785771 (Thread-891): 19:43:10  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:43:10.788253 (Thread-891): 19:43:10  Partial parsing: updated file: dbtvault://macros/tables/sat.sql
2022-03-03 19:43:10.788440 (Thread-891): 19:43:10  Parsing macros/tables/sat.sql
2022-03-03 19:43:10.811055 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:43:10.834260 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:43:10.835602 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 19:43:10.845157 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 19:43:10.846369 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 19:43:10.856337 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 19:43:10.857559 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 19:43:10.866474 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 19:43:10.867709 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 19:43:10.875861 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 19:43:10.877024 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 19:43:10.886496 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 19:43:10.887790 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 19:43:10.895816 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 19:43:10.896985 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 19:43:10.905223 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 19:43:10.906381 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 19:43:10.916545 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 19:43:10.917720 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 19:43:10.929477 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 19:43:10.930718 (Thread-891): 19:43:10  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 19:43:10.940149 (Thread-891): 19:43:10  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 19:43:10.991778 (Thread-891): 19:43:10  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8f80a0>]}
2022-03-03 19:43:11.903474 (Thread-892): handling status request
2022-03-03 19:43:11.903799 (Thread-892): 19:43:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae853b50>]}
2022-03-03 19:43:11.907439 (Thread-893): handling status request
2022-03-03 19:43:11.907763 (Thread-893): 19:43:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea4bfa0>]}
2022-03-03 19:43:11.924551 (Thread-892): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:11.925167 (Thread-893): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:15.755182 (Thread-894): handling status request
2022-03-03 19:43:15.755524 (Thread-894): 19:43:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec10b80>]}
2022-03-03 19:43:15.756194 (Thread-894): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:16.075371 (Thread-895): handling status request
2022-03-03 19:43:16.075686 (Thread-895): 19:43:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae878460>]}
2022-03-03 19:43:16.076314 (Thread-895): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:16.388502 (Thread-896): handling cli_args request
2022-03-03 19:43:16.388857 (Thread-896): 19:43:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea6b970>]}
2022-03-03 19:43:18.590102 (Thread-896): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:18.894567 (MainThread): 19:43:18  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:43:18.894974 (MainThread): 19:43:18  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:43:18.902617 (MainThread): 19:43:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0005a267-ad56-4b2e-866e-1929779daf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1090bb4940>]}
2022-03-03 19:43:18.935851 (MainThread): 19:43:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0005a267-ad56-4b2e-866e-1929779daf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1090c98700>]}
2022-03-03 19:43:18.936090 (MainThread): 19:43:18  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:43:18.937686 (MainThread): 19:43:18  
2022-03-03 19:43:18.937966 (MainThread): 19:43:18  Acquiring new snowflake connection "master"
2022-03-03 19:43:18.938718 (ThreadPoolExecutor-0_0): 19:43:18  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:43:18.952461 (ThreadPoolExecutor-0_0): 19:43:18  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:43:18.952563 (ThreadPoolExecutor-0_0): 19:43:18  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:43:18.952672 (ThreadPoolExecutor-0_0): 19:43:18  Opening a new connection, currently in state init
2022-03-03 19:43:19.390641 (Thread-897): handling poll request
2022-03-03 19:43:19.391042 (Thread-897): 19:43:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea476d0>]}
2022-03-03 19:43:19.391952 (Thread-897): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:20.251241 (ThreadPoolExecutor-0_0): 19:43:20  SQL status: SUCCESS 8 in 1.3 seconds
2022-03-03 19:43:20.253466 (ThreadPoolExecutor-0_0): 19:43:20  On list_DBT_RAW: Close
2022-03-03 19:43:20.470388 (ThreadPoolExecutor-2_0): 19:43:20  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:43:20.530752 (ThreadPoolExecutor-2_0): 19:43:20  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:43:20.530907 (ThreadPoolExecutor-2_0): 19:43:20  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:43:20.531005 (ThreadPoolExecutor-2_0): 19:43:20  Opening a new connection, currently in state closed
2022-03-03 19:43:21.154550 (Thread-898): handling poll request
2022-03-03 19:43:21.154906 (Thread-898): 19:43:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebcbd90>]}
2022-03-03 19:43:21.155506 (Thread-898): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:21.271341 (ThreadPoolExecutor-2_0): 19:43:21  SQL status: SUCCESS 34 in 0.74 seconds
2022-03-03 19:43:21.274174 (ThreadPoolExecutor-2_0): 19:43:21  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:43:21.524062 (MainThread): 19:43:21  Concurrency: 4 threads (target='default')
2022-03-03 19:43:21.524237 (MainThread): 19:43:21  
2022-03-03 19:43:21.527074 (Thread-3): 19:43:21  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:43:21.527405 (Thread-3): 19:43:21  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:43:21.527678 (Thread-3): 19:43:21  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:21.527787 (Thread-3): 19:43:21  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:43:21.527896 (Thread-3): 19:43:21  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:43:21.615912 (Thread-3): 19:43:21  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:21.628462 (Thread-3): 19:43:21  finished collecting timing info
2022-03-03 19:43:21.628656 (Thread-3): 19:43:21  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:43:21.672468 (Thread-3): 19:43:21  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:21.672605 (Thread-3): 19:43:21  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:43:21.672725 (Thread-3): 19:43:21  Opening a new connection, currently in state closed
2022-03-03 19:43:22.922966 (Thread-899): handling poll request
2022-03-03 19:43:22.923318 (Thread-899): 19:43:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeabec70>]}
2022-03-03 19:43:22.924065 (Thread-899): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:24.691864 (Thread-900): handling poll request
2022-03-03 19:43:24.692191 (Thread-900): 19:43:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeab9910>]}
2022-03-03 19:43:24.692712 (Thread-900): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:25.824758 (Thread-3): 19:43:25  SQL status: SUCCESS 1 in 4.15 seconds
2022-03-03 19:43:25.834716 (Thread-3): 19:43:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:25.834865 (Thread-3): 19:43:25  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:43:26.104391 (Thread-3): 19:43:26  SQL status: SUCCESS 10 in 0.27 seconds
2022-03-03 19:43:26.108379 (Thread-3): 19:43:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:26.108497 (Thread-3): 19:43:26  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:43:26.302111 (Thread-3): 19:43:26  SQL status: SUCCESS 10 in 0.19 seconds
2022-03-03 19:43:26.310489 (Thread-3): 19:43:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:26.310605 (Thread-3): 19:43:26  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:43:26.438738 (Thread-3): 19:43:26  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 19:43:26.459674 (Thread-3): 19:43:26  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:26.462418 (Thread-901): handling poll request
2022-03-03 19:43:26.462726 (Thread-901): 19:43:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae85dc40>]}
2022-03-03 19:43:26.463356 (Thread-901): sending response (<Response 5027 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:26.474593 (Thread-3): 19:43:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:26.474729 (Thread-3): 19:43:26  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:43:26.664923 (Thread-3): 19:43:26  SQL status: SUCCESS 1 in 0.19 seconds
2022-03-03 19:43:26.665162 (Thread-3): 19:43:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:26.665249 (Thread-3): 19:43:26  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:43:27.638503 (Thread-3): 19:43:27  SQL status: SUCCESS 2 in 0.97 seconds
2022-03-03 19:43:27.638704 (Thread-3): 19:43:27  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:43:27.638796 (Thread-3): 19:43:27  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:43:28.238377 (Thread-902): handling poll request
2022-03-03 19:43:28.238710 (Thread-902): 19:43:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae85d9d0>]}
2022-03-03 19:43:28.239329 (Thread-902): sending response (<Response 4772 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:28.593399 (Thread-3): 19:43:28  SQL status: SUCCESS 1 in 0.95 seconds
2022-03-03 19:43:28.604010 (Thread-3): 19:43:28  finished collecting timing info
2022-03-03 19:43:28.604188 (Thread-3): 19:43:28  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:43:29.023172 (Thread-3): 19:43:29  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0005a267-ad56-4b2e-866e-1929779daf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1097e9daf0>]}
2022-03-03 19:43:29.023624 (Thread-3): 19:43:29  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 7.50s]
2022-03-03 19:43:29.023757 (Thread-3): 19:43:29  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:43:29.025480 (MainThread): 19:43:29  Acquiring new snowflake connection "master"
2022-03-03 19:43:29.025822 (MainThread): 19:43:29  
2022-03-03 19:43:29.025932 (MainThread): 19:43:29  Finished running 1 incremental model in 10.09s.
2022-03-03 19:43:29.026024 (MainThread): 19:43:29  Connection 'master' was properly closed.
2022-03-03 19:43:29.026095 (MainThread): 19:43:29  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:43:29.094153 (MainThread): 19:43:29  
2022-03-03 19:43:29.094344 (MainThread): 19:43:29  Completed successfully
2022-03-03 19:43:29.094447 (MainThread): 19:43:29  
2022-03-03 19:43:29.094543 (MainThread): 19:43:29  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:43:30.009997 (Thread-903): handling poll request
2022-03-03 19:43:30.010347 (Thread-903): 19:43:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae898190>]}
2022-03-03 19:43:30.011451 (Thread-903): sending response (<Response 12462 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:31.443894 (Thread-904): handling status request
2022-03-03 19:43:31.444229 (Thread-904): 19:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8983a0>]}
2022-03-03 19:43:31.445039 (Thread-904): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:43:31.450861 (Thread-905): handling status request
2022-03-03 19:43:31.451091 (Thread-905): 19:43:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae898160>]}
2022-03-03 19:43:31.451963 (Thread-905): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:27.573909 (Thread-906): handling status request
2022-03-03 19:44:27.574252 (Thread-906): 19:44:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebd56a0>]}
2022-03-03 19:44:27.574943 (Thread-906): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:27.906523 (Thread-907): handling status request
2022-03-03 19:44:27.906851 (Thread-907): 19:44:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8d6ee0>]}
2022-03-03 19:44:27.907536 (Thread-907): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:28.232451 (Thread-908): handling cli_args request
2022-03-03 19:44:28.232812 (Thread-908): 19:44:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea47d00>]}
2022-03-03 19:44:30.469814 (Thread-908): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:30.767937 (MainThread): 19:44:30  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:44:30.768418 (MainThread): 19:44:30  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:44:30.776402 (MainThread): 19:44:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213b4ed2-edfd-4fad-860d-a15021b047b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c20675a30>]}
2022-03-03 19:44:30.812671 (MainThread): 19:44:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213b4ed2-edfd-4fad-860d-a15021b047b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c207567c0>]}
2022-03-03 19:44:30.812966 (MainThread): 19:44:30  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:44:30.814996 (MainThread): 19:44:30  
2022-03-03 19:44:30.815310 (MainThread): 19:44:30  Acquiring new snowflake connection "master"
2022-03-03 19:44:30.816258 (ThreadPoolExecutor-0_0): 19:44:30  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:44:30.830012 (ThreadPoolExecutor-0_0): 19:44:30  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:44:30.830128 (ThreadPoolExecutor-0_0): 19:44:30  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:44:30.830213 (ThreadPoolExecutor-0_0): 19:44:30  Opening a new connection, currently in state init
2022-03-03 19:44:31.254042 (Thread-909): handling poll request
2022-03-03 19:44:31.254451 (Thread-909): 19:44:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae897fd0>]}
2022-03-03 19:44:31.255358 (Thread-909): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:31.828700 (ThreadPoolExecutor-0_0): 19:44:31  SQL status: SUCCESS 8 in 1.0 seconds
2022-03-03 19:44:31.830819 (ThreadPoolExecutor-0_0): 19:44:31  On list_DBT_RAW: Close
2022-03-03 19:44:32.513631 (ThreadPoolExecutor-2_0): 19:44:32  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:44:32.579290 (ThreadPoolExecutor-2_0): 19:44:32  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:44:32.579454 (ThreadPoolExecutor-2_0): 19:44:32  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:44:32.579555 (ThreadPoolExecutor-2_0): 19:44:32  Opening a new connection, currently in state closed
2022-03-03 19:44:33.125165 (Thread-910): handling poll request
2022-03-03 19:44:33.125510 (Thread-910): 19:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae897910>]}
2022-03-03 19:44:33.126069 (Thread-910): sending response (<Response 2331 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:33.319467 (ThreadPoolExecutor-2_0): 19:44:33  SQL status: SUCCESS 34 in 0.74 seconds
2022-03-03 19:44:33.321730 (ThreadPoolExecutor-2_0): 19:44:33  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:44:33.567225 (MainThread): 19:44:33  Concurrency: 4 threads (target='default')
2022-03-03 19:44:33.567400 (MainThread): 19:44:33  
2022-03-03 19:44:33.570284 (Thread-3): 19:44:33  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:44:33.570669 (Thread-3): 19:44:33  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:44:33.570985 (Thread-3): 19:44:33  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:44:33.571097 (Thread-3): 19:44:33  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:44:33.571214 (Thread-3): 19:44:33  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:44:33.577312 (Thread-3): 19:44:33  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:44:33.592136 (Thread-3): 19:44:33  finished collecting timing info
2022-03-03 19:44:33.592298 (Thread-3): 19:44:33  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:44:33.616378 (Thread-3): 19:44:33  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:44:33.633109 (Thread-3): 19:44:33  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:44:33.633230 (Thread-3): 19:44:33  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:44:33.633319 (Thread-3): 19:44:33  Opening a new connection, currently in state closed
2022-03-03 19:44:35.145630 (Thread-911): handling poll request
2022-03-03 19:44:35.145991 (Thread-911): 19:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae898ac0>]}
2022-03-03 19:44:35.146733 (Thread-911): sending response (<Response 9164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:37.139048 (Thread-912): handling poll request
2022-03-03 19:44:37.139385 (Thread-912): 19:44:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae944100>]}
2022-03-03 19:44:37.139885 (Thread-912): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:39.434250 (Thread-3): 19:44:39  SQL status: SUCCESS 1 in 5.8 seconds
2022-03-03 19:44:39.443617 (Thread-3): 19:44:39  finished collecting timing info
2022-03-03 19:44:39.443794 (Thread-3): 19:44:39  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:44:39.644949 (Thread-3): 19:44:39  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b4ed2-edfd-4fad-860d-a15021b047b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2061b4c0>]}
2022-03-03 19:44:39.645391 (Thread-3): 19:44:39  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 6.07s]
2022-03-03 19:44:39.645523 (Thread-3): 19:44:39  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:44:39.646539 (Thread-5): 19:44:39  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:44:39.646819 (Thread-5): 19:44:39  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:44:39.647116 (Thread-5): 19:44:39  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:44:39.647223 (Thread-5): 19:44:39  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:44:39.647315 (Thread-5): 19:44:39  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:44:39.681648 (Thread-5): 19:44:39  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:44:39.681798 (Thread-5): 19:44:39  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:44:39.681889 (Thread-5): 19:44:39  Opening a new connection, currently in state init
2022-03-03 19:44:40.115160 (Thread-913): handling poll request
2022-03-03 19:44:40.115521 (Thread-913): 19:44:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8e0c40>]}
2022-03-03 19:44:40.116199 (Thread-913): sending response (<Response 6486 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:40.345531 (Thread-5): 19:44:40  SQL status: SUCCESS 5 in 0.66 seconds
2022-03-03 19:44:40.374667 (Thread-5): 19:44:40  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:44:40.374819 (Thread-5): 19:44:40  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:44:40.504690 (Thread-5): 19:44:40  SQL status: SUCCESS 5 in 0.13 seconds
2022-03-03 19:44:40.538445 (Thread-5): 19:44:40  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:44:40.551413 (Thread-5): 19:44:40  finished collecting timing info
2022-03-03 19:44:40.551598 (Thread-5): 19:44:40  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:44:40.570419 (Thread-5): 19:44:40  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:44:40.586211 (Thread-5): 19:44:40  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:44:40.586343 (Thread-5): 19:44:40  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:44:41.132175 (Thread-5): 19:44:41  SQL status: SUCCESS 1 in 0.55 seconds
2022-03-03 19:44:41.133727 (Thread-5): 19:44:41  finished collecting timing info
2022-03-03 19:44:41.133896 (Thread-5): 19:44:41  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:44:41.397217 (Thread-5): 19:44:41  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b4ed2-edfd-4fad-860d-a15021b047b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c182a0850>]}
2022-03-03 19:44:41.397651 (Thread-5): 19:44:41  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.75s]
2022-03-03 19:44:41.397783 (Thread-5): 19:44:41  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:44:41.398791 (Thread-4): 19:44:41  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:44:41.399060 (Thread-4): 19:44:41  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:44:41.399363 (Thread-4): 19:44:41  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:44:41.399458 (Thread-4): 19:44:41  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:44:41.399551 (Thread-4): 19:44:41  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:44:41.483390 (Thread-4): 19:44:41  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:44:41.497358 (Thread-4): 19:44:41  finished collecting timing info
2022-03-03 19:44:41.497559 (Thread-4): 19:44:41  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:44:41.521221 (Thread-4): 19:44:41  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:44:41.534932 (Thread-4): 19:44:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:44:41.535090 (Thread-4): 19:44:41  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:44:41.535183 (Thread-4): 19:44:41  Opening a new connection, currently in state init
2022-03-03 19:44:42.005349 (Thread-914): handling poll request
2022-03-03 19:44:42.005688 (Thread-914): 19:44:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae9a4100>]}
2022-03-03 19:44:42.006704 (Thread-914): sending response (<Response 14839 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:43.806536 (Thread-4): 19:44:43  SQL status: SUCCESS 1 in 2.27 seconds
2022-03-03 19:44:43.808114 (Thread-4): 19:44:43  finished collecting timing info
2022-03-03 19:44:43.808285 (Thread-4): 19:44:43  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:44:44.016144 (Thread-4): 19:44:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b4ed2-edfd-4fad-860d-a15021b047b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c181ef1c0>]}
2022-03-03 19:44:44.016580 (Thread-4): 19:44:44  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.62s]
2022-03-03 19:44:44.016753 (Thread-4): 19:44:44  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:44:44.018283 (MainThread): 19:44:44  Acquiring new snowflake connection "master"
2022-03-03 19:44:44.018608 (MainThread): 19:44:44  
2022-03-03 19:44:44.018713 (MainThread): 19:44:44  Finished running 1 table model, 1 view model, 1 incremental model in 13.20s.
2022-03-03 19:44:44.018801 (MainThread): 19:44:44  Connection 'master' was properly closed.
2022-03-03 19:44:44.018869 (MainThread): 19:44:44  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:44:44.018935 (MainThread): 19:44:44  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:44:44.018998 (MainThread): 19:44:44  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:44:44.089544 (MainThread): 19:44:44  
2022-03-03 19:44:44.089752 (MainThread): 19:44:44  Completed successfully
2022-03-03 19:44:44.089856 (MainThread): 19:44:44  
2022-03-03 19:44:44.089949 (MainThread): 19:44:44  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:44:44.114657 (Thread-915): handling poll request
2022-03-03 19:44:44.115037 (Thread-915): 19:44:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8439d0>]}
2022-03-03 19:44:44.116005 (Thread-915): sending response (<Response 6687 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:45.885113 (Thread-916): handling poll request
2022-03-03 19:44:45.885465 (Thread-916): 19:44:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae897790>]}
2022-03-03 19:44:45.886552 (Thread-916): sending response (<Response 18141 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:47.273027 (Thread-917): handling status request
2022-03-03 19:44:47.273487 (Thread-917): 19:44:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b49a0>]}
2022-03-03 19:44:47.274287 (Thread-917): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:44:47.470358 (Thread-918): handling status request
2022-03-03 19:44:47.470681 (Thread-918): 19:44:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae892340>]}
2022-03-03 19:44:47.471403 (Thread-918): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:41.187222 (Thread-919): handling status request
2022-03-03 19:45:41.187572 (Thread-919): 19:45:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae892760>]}
2022-03-03 19:45:41.188257 (Thread-919): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:41.502439 (Thread-920): handling status request
2022-03-03 19:45:41.502774 (Thread-920): 19:45:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae892eb0>]}
2022-03-03 19:45:41.503431 (Thread-920): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:41.841617 (Thread-921): handling cli_args request
2022-03-03 19:45:41.841977 (Thread-921): 19:45:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae944ca0>]}
2022-03-03 19:45:44.077277 (Thread-921): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:44.370452 (MainThread): 19:45:44  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:45:44.370887 (MainThread): 19:45:44  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:45:44.378819 (MainThread): 19:45:44  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '007349e7-095d-4075-8d83-4ddd4ae06c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bbef59d0>]}
2022-03-03 19:45:44.416249 (MainThread): 19:45:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '007349e7-095d-4075-8d83-4ddd4ae06c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bbfdf790>]}
2022-03-03 19:45:44.416584 (MainThread): 19:45:44  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:45:44.418435 (MainThread): 19:45:44  
2022-03-03 19:45:44.418775 (MainThread): 19:45:44  Acquiring new snowflake connection "master"
2022-03-03 19:45:44.419635 (ThreadPoolExecutor-0_0): 19:45:44  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:45:44.433429 (ThreadPoolExecutor-0_0): 19:45:44  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:45:44.433554 (ThreadPoolExecutor-0_0): 19:45:44  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:45:44.433641 (ThreadPoolExecutor-0_0): 19:45:44  Opening a new connection, currently in state init
2022-03-03 19:45:45.275811 (Thread-922): handling poll request
2022-03-03 19:45:45.276237 (Thread-922): 19:45:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae898340>]}
2022-03-03 19:45:45.301571 (Thread-922): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:45.749351 (ThreadPoolExecutor-0_0): 19:45:45  SQL status: SUCCESS 8 in 1.32 seconds
2022-03-03 19:45:45.751345 (ThreadPoolExecutor-0_0): 19:45:45  On list_DBT_RAW: Close
2022-03-03 19:45:46.170915 (ThreadPoolExecutor-2_0): 19:45:46  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:45:46.237179 (ThreadPoolExecutor-2_0): 19:45:46  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:45:46.237337 (ThreadPoolExecutor-2_0): 19:45:46  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:45:46.237434 (ThreadPoolExecutor-2_0): 19:45:46  Opening a new connection, currently in state closed
2022-03-03 19:45:47.094341 (Thread-923): handling poll request
2022-03-03 19:45:47.094685 (Thread-923): 19:45:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae892a30>]}
2022-03-03 19:45:47.095232 (Thread-923): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:47.417660 (ThreadPoolExecutor-2_0): 19:45:47  SQL status: SUCCESS 34 in 1.18 seconds
2022-03-03 19:45:47.420056 (ThreadPoolExecutor-2_0): 19:45:47  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:45:47.709244 (MainThread): 19:45:47  Concurrency: 4 threads (target='default')
2022-03-03 19:45:47.709511 (MainThread): 19:45:47  
2022-03-03 19:45:47.712883 (Thread-3): 19:45:47  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:45:47.713193 (Thread-3): 19:45:47  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:45:47.713462 (Thread-3): 19:45:47  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:47.713569 (Thread-3): 19:45:47  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:45:47.713676 (Thread-3): 19:45:47  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:45:47.801743 (Thread-3): 19:45:47  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:47.816522 (Thread-3): 19:45:47  finished collecting timing info
2022-03-03 19:45:47.816769 (Thread-3): 19:45:47  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:45:47.858201 (Thread-3): 19:45:47  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:47.858329 (Thread-3): 19:45:47  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:45:47.858418 (Thread-3): 19:45:47  Opening a new connection, currently in state closed
2022-03-03 19:45:49.997198 (Thread-924): handling poll request
2022-03-03 19:45:49.997544 (Thread-924): 19:45:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae825760>]}
2022-03-03 19:45:49.998195 (Thread-924): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:50.786193 (Thread-3): 19:45:50  SQL status: SUCCESS 1 in 2.93 seconds
2022-03-03 19:45:50.798830 (Thread-3): 19:45:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:50.799051 (Thread-3): 19:45:50  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:45:50.929371 (Thread-3): 19:45:50  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 19:45:50.933345 (Thread-3): 19:45:50  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:50.933459 (Thread-3): 19:45:50  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:45:51.075967 (Thread-3): 19:45:51  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:45:51.087200 (Thread-3): 19:45:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:51.087341 (Thread-3): 19:45:51  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:45:51.324912 (Thread-3): 19:45:51  SQL status: SUCCESS 10 in 0.24 seconds
2022-03-03 19:45:51.354941 (Thread-3): 19:45:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:51.372695 (Thread-3): 19:45:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:51.372879 (Thread-3): 19:45:51  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:45:51.577320 (Thread-3): 19:45:51  SQL status: SUCCESS 1 in 0.2 seconds
2022-03-03 19:45:51.577568 (Thread-3): 19:45:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:51.577654 (Thread-3): 19:45:51  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:45:51.746796 (Thread-925): handling poll request
2022-03-03 19:45:51.747122 (Thread-925): 19:45:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae823b20>]}
2022-03-03 19:45:51.747778 (Thread-925): sending response (<Response 8388 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:53.117107 (Thread-3): 19:45:53  SQL status: SUCCESS 1 in 1.54 seconds
2022-03-03 19:45:53.117324 (Thread-3): 19:45:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:45:53.117413 (Thread-3): 19:45:53  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:45:53.508848 (Thread-926): handling poll request
2022-03-03 19:45:53.509199 (Thread-926): 19:45:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae823cd0>]}
2022-03-03 19:45:53.509726 (Thread-926): sending response (<Response 1409 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:53.616595 (Thread-3): 19:45:53  SQL status: SUCCESS 1 in 0.5 seconds
2022-03-03 19:45:53.627545 (Thread-3): 19:45:53  finished collecting timing info
2022-03-03 19:45:53.627722 (Thread-3): 19:45:53  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:45:54.198558 (Thread-3): 19:45:54  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007349e7-095d-4075-8d83-4ddd4ae06c95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bb6a8460>]}
2022-03-03 19:45:54.199006 (Thread-3): 19:45:54  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.49s]
2022-03-03 19:45:54.199138 (Thread-3): 19:45:54  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:45:54.200818 (MainThread): 19:45:54  Acquiring new snowflake connection "master"
2022-03-03 19:45:54.201147 (MainThread): 19:45:54  
2022-03-03 19:45:54.201251 (MainThread): 19:45:54  Finished running 1 incremental model in 9.78s.
2022-03-03 19:45:54.201338 (MainThread): 19:45:54  Connection 'master' was properly closed.
2022-03-03 19:45:54.201408 (MainThread): 19:45:54  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:45:54.265713 (MainThread): 19:45:54  
2022-03-03 19:45:54.265924 (MainThread): 19:45:54  Completed successfully
2022-03-03 19:45:54.266023 (MainThread): 19:45:54  
2022-03-03 19:45:54.266118 (MainThread): 19:45:54  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:45:55.262674 (Thread-927): handling poll request
2022-03-03 19:45:55.263006 (Thread-927): 19:45:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8268b0>]}
2022-03-03 19:45:55.264045 (Thread-927): sending response (<Response 12459 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:56.641105 (Thread-928): handling status request
2022-03-03 19:45:56.643709 (Thread-928): 19:45:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae823e20>]}
2022-03-03 19:45:56.644442 (Thread-928): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:45:56.654058 (Thread-929): handling status request
2022-03-03 19:45:56.654279 (Thread-929): 19:45:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae83f940>]}
2022-03-03 19:45:56.654815 (Thread-929): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:30.651398 (Thread-930): handling status request
2022-03-03 19:46:30.651755 (Thread-930): 19:46:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae83fe80>]}
2022-03-03 19:46:30.652422 (Thread-930): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:30.958585 (Thread-931): handling status request
2022-03-03 19:46:30.958925 (Thread-931): 19:46:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae83f430>]}
2022-03-03 19:46:30.959579 (Thread-931): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:31.296717 (Thread-932): handling cli_args request
2022-03-03 19:46:31.297052 (Thread-932): 19:46:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae83fcd0>]}
2022-03-03 19:46:33.548757 (Thread-932): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:33.845104 (MainThread): 19:46:33  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:46:33.845582 (MainThread): 19:46:33  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:46:33.853472 (MainThread): 19:46:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de285930-61d3-4623-b433-84065a003542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35fa748e0>]}
2022-03-03 19:46:33.886790 (MainThread): 19:46:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de285930-61d3-4623-b433-84065a003542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35fb596a0>]}
2022-03-03 19:46:33.887104 (MainThread): 19:46:33  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:46:33.888946 (MainThread): 19:46:33  
2022-03-03 19:46:33.889276 (MainThread): 19:46:33  Acquiring new snowflake connection "master"
2022-03-03 19:46:33.890208 (ThreadPoolExecutor-0_0): 19:46:33  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:46:33.903729 (ThreadPoolExecutor-0_0): 19:46:33  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:46:33.903844 (ThreadPoolExecutor-0_0): 19:46:33  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:46:33.903930 (ThreadPoolExecutor-0_0): 19:46:33  Opening a new connection, currently in state init
2022-03-03 19:46:34.306592 (Thread-933): handling poll request
2022-03-03 19:46:34.307025 (Thread-933): 19:46:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8231c0>]}
2022-03-03 19:46:34.307993 (Thread-933): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:35.007810 (ThreadPoolExecutor-0_0): 19:46:35  SQL status: SUCCESS 8 in 1.1 seconds
2022-03-03 19:46:35.009884 (ThreadPoolExecutor-0_0): 19:46:35  On list_DBT_RAW: Close
2022-03-03 19:46:35.261446 (ThreadPoolExecutor-2_0): 19:46:35  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:46:35.324567 (ThreadPoolExecutor-2_0): 19:46:35  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:46:35.324760 (ThreadPoolExecutor-2_0): 19:46:35  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:46:35.324867 (ThreadPoolExecutor-2_0): 19:46:35  Opening a new connection, currently in state closed
2022-03-03 19:46:36.059271 (ThreadPoolExecutor-2_0): 19:46:36  SQL status: SUCCESS 34 in 0.73 seconds
2022-03-03 19:46:36.061524 (ThreadPoolExecutor-2_0): 19:46:36  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:46:36.081359 (Thread-934): handling poll request
2022-03-03 19:46:36.081681 (Thread-934): 19:46:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae83fca0>]}
2022-03-03 19:46:36.082262 (Thread-934): sending response (<Response 2898 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:36.287420 (MainThread): 19:46:36  Concurrency: 4 threads (target='default')
2022-03-03 19:46:36.287592 (MainThread): 19:46:36  
2022-03-03 19:46:36.290456 (Thread-3): 19:46:36  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:46:36.290766 (Thread-3): 19:46:36  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:46:36.291042 (Thread-3): 19:46:36  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:36.291145 (Thread-3): 19:46:36  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:46:36.291253 (Thread-3): 19:46:36  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:46:36.378950 (Thread-3): 19:46:36  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:36.396075 (Thread-3): 19:46:36  finished collecting timing info
2022-03-03 19:46:36.396264 (Thread-3): 19:46:36  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:46:36.437459 (Thread-3): 19:46:36  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:36.437616 (Thread-3): 19:46:36  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:46:36.437709 (Thread-3): 19:46:36  Opening a new connection, currently in state closed
2022-03-03 19:46:38.079703 (Thread-935): handling poll request
2022-03-03 19:46:38.080038 (Thread-935): 19:46:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae843790>]}
2022-03-03 19:46:38.080764 (Thread-935): sending response (<Response 7382 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:40.082964 (Thread-936): handling poll request
2022-03-03 19:46:40.083299 (Thread-936): 19:46:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8e0dc0>]}
2022-03-03 19:46:40.083780 (Thread-936): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:40.258154 (Thread-3): 19:46:40  SQL status: SUCCESS 1 in 3.82 seconds
2022-03-03 19:46:40.267748 (Thread-3): 19:46:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:40.267891 (Thread-3): 19:46:40  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:46:40.632877 (Thread-3): 19:46:40  SQL status: SUCCESS 10 in 0.36 seconds
2022-03-03 19:46:40.636850 (Thread-3): 19:46:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:40.636959 (Thread-3): 19:46:40  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:46:40.774221 (Thread-3): 19:46:40  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:46:40.782713 (Thread-3): 19:46:40  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:40.782828 (Thread-3): 19:46:40  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:46:40.979062 (Thread-3): 19:46:40  SQL status: SUCCESS 10 in 0.2 seconds
2022-03-03 19:46:41.000405 (Thread-3): 19:46:41  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:41.015622 (Thread-3): 19:46:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:41.015778 (Thread-3): 19:46:41  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:46:41.235422 (Thread-3): 19:46:41  SQL status: SUCCESS 1 in 0.22 seconds
2022-03-03 19:46:41.235672 (Thread-3): 19:46:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:41.235755 (Thread-3): 19:46:41  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:46:42.181556 (Thread-937): handling poll request
2022-03-03 19:46:42.181910 (Thread-937): 19:46:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeab9d90>]}
2022-03-03 19:46:42.182669 (Thread-937): sending response (<Response 8389 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:42.206201 (Thread-3): 19:46:42  SQL status: SUCCESS 2 in 0.97 seconds
2022-03-03 19:46:42.206398 (Thread-3): 19:46:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:46:42.206481 (Thread-3): 19:46:42  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:46:42.552867 (Thread-3): 19:46:42  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-03 19:46:42.563523 (Thread-3): 19:46:42  finished collecting timing info
2022-03-03 19:46:42.563707 (Thread-3): 19:46:42  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:46:42.801465 (Thread-3): 19:46:42  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de285930-61d3-4623-b433-84065a003542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e45a550>]}
2022-03-03 19:46:42.801915 (Thread-3): 19:46:42  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.51s]
2022-03-03 19:46:42.802045 (Thread-3): 19:46:42  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:46:42.803705 (MainThread): 19:46:42  Acquiring new snowflake connection "master"
2022-03-03 19:46:42.804032 (MainThread): 19:46:42  
2022-03-03 19:46:42.804133 (MainThread): 19:46:42  Finished running 1 incremental model in 8.91s.
2022-03-03 19:46:42.804219 (MainThread): 19:46:42  Connection 'master' was properly closed.
2022-03-03 19:46:42.804288 (MainThread): 19:46:42  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:46:42.871114 (MainThread): 19:46:42  
2022-03-03 19:46:42.871336 (MainThread): 19:46:42  Completed successfully
2022-03-03 19:46:42.871435 (MainThread): 19:46:42  
2022-03-03 19:46:42.871531 (MainThread): 19:46:42  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:46:44.090391 (Thread-938): handling poll request
2022-03-03 19:46:44.090738 (Thread-938): 19:46:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebd5490>]}
2022-03-03 19:46:44.091852 (Thread-938): sending response (<Response 13552 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:45.563228 (Thread-939): handling status request
2022-03-03 19:46:45.563585 (Thread-939): 19:46:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea759d0>]}
2022-03-03 19:46:45.564332 (Thread-939): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:46:45.741544 (Thread-940): handling status request
2022-03-03 19:46:45.741892 (Thread-940): 19:46:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae810a00>]}
2022-03-03 19:46:45.742592 (Thread-940): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:48:57.053972 (Thread-941): handling status request
2022-03-03 19:48:57.055575 (Thread-941): 19:48:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae810940>]}
2022-03-03 19:48:57.056234 (Thread-941): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:48:57.828818 (Thread-942): handling status request
2022-03-03 19:48:57.829212 (Thread-942): 19:48:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeab9c10>]}
2022-03-03 19:48:57.829889 (Thread-942): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:48:57.844666 (Thread-943): handling cli_args request
2022-03-03 19:48:57.844929 (Thread-943): 19:48:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aec3e9d0>]}
2022-03-03 19:49:00.098839 (Thread-943): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:00.472396 (MainThread): 19:49:00  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:49:00.472845 (MainThread): 19:49:00  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:49:00.480770 (MainThread): 19:49:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91c51fd-0388-47f4-82e0-bd696a4737b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa96075940>]}
2022-03-03 19:49:00.515549 (MainThread): 19:49:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91c51fd-0388-47f4-82e0-bd696a4737b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa96159700>]}
2022-03-03 19:49:00.515794 (MainThread): 19:49:00  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:49:00.517433 (MainThread): 19:49:00  
2022-03-03 19:49:00.517708 (MainThread): 19:49:00  Acquiring new snowflake connection "master"
2022-03-03 19:49:00.518446 (ThreadPoolExecutor-0_0): 19:49:00  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:49:00.531686 (ThreadPoolExecutor-0_0): 19:49:00  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:49:00.531788 (ThreadPoolExecutor-0_0): 19:49:00  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:49:00.531872 (ThreadPoolExecutor-0_0): 19:49:00  Opening a new connection, currently in state init
2022-03-03 19:49:00.880469 (Thread-944): handling poll request
2022-03-03 19:49:00.880990 (Thread-944): 19:49:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7db0a0>]}
2022-03-03 19:49:00.881942 (Thread-944): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:01.645402 (ThreadPoolExecutor-0_0): 19:49:01  SQL status: SUCCESS 8 in 1.11 seconds
2022-03-03 19:49:01.647413 (ThreadPoolExecutor-0_0): 19:49:01  On list_DBT_RAW: Close
2022-03-03 19:49:02.310792 (ThreadPoolExecutor-2_0): 19:49:02  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:49:02.372984 (ThreadPoolExecutor-2_0): 19:49:02  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:49:02.373138 (ThreadPoolExecutor-2_0): 19:49:02  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:49:02.373236 (ThreadPoolExecutor-2_0): 19:49:02  Opening a new connection, currently in state closed
2022-03-03 19:49:02.674277 (Thread-945): handling poll request
2022-03-03 19:49:02.674686 (Thread-945): 19:49:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7dfa90>]}
2022-03-03 19:49:02.675432 (Thread-945): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:03.317727 (ThreadPoolExecutor-2_0): 19:49:03  SQL status: SUCCESS 34 in 0.94 seconds
2022-03-03 19:49:03.320123 (ThreadPoolExecutor-2_0): 19:49:03  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:49:03.659370 (MainThread): 19:49:03  Concurrency: 4 threads (target='default')
2022-03-03 19:49:03.659583 (MainThread): 19:49:03  
2022-03-03 19:49:03.662566 (Thread-3): 19:49:03  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:03.662901 (Thread-3): 19:49:03  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:49:03.663181 (Thread-3): 19:49:03  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:03.663283 (Thread-3): 19:49:03  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:03.663391 (Thread-3): 19:49:03  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:03.752823 (Thread-3): 19:49:03  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:03.768052 (Thread-3): 19:49:03  finished collecting timing info
2022-03-03 19:49:03.768268 (Thread-3): 19:49:03  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:03.812329 (Thread-3): 19:49:03  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:03.812496 (Thread-3): 19:49:03  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:49:03.812592 (Thread-3): 19:49:03  Opening a new connection, currently in state closed
2022-03-03 19:49:04.455279 (Thread-946): handling poll request
2022-03-03 19:49:04.455624 (Thread-946): 19:49:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aebd5850>]}
2022-03-03 19:49:04.456403 (Thread-946): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:06.254364 (Thread-947): handling poll request
2022-03-03 19:49:06.254696 (Thread-947): 19:49:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae87db50>]}
2022-03-03 19:49:06.255165 (Thread-947): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:06.778893 (Thread-3): 19:49:06  SQL status: SUCCESS 1 in 2.97 seconds
2022-03-03 19:49:06.788253 (Thread-3): 19:49:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:06.788387 (Thread-3): 19:49:06  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:49:06.925971 (Thread-3): 19:49:06  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:49:06.930149 (Thread-3): 19:49:06  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:06.930271 (Thread-3): 19:49:06  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:49:07.043873 (Thread-3): 19:49:07  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:49:07.051800 (Thread-3): 19:49:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:07.051910 (Thread-3): 19:49:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:49:07.195811 (Thread-3): 19:49:07  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:49:07.217152 (Thread-3): 19:49:07  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:07.233097 (Thread-3): 19:49:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:07.233224 (Thread-3): 19:49:07  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:49:07.464559 (Thread-3): 19:49:07  SQL status: SUCCESS 1 in 0.23 seconds
2022-03-03 19:49:07.464849 (Thread-3): 19:49:07  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:07.464944 (Thread-3): 19:49:07  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:49:08.052526 (Thread-948): handling poll request
2022-03-03 19:49:08.052892 (Thread-948): 19:49:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae825730>]}
2022-03-03 19:49:08.053564 (Thread-948): sending response (<Response 8390 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:08.420290 (Thread-3): 19:49:08  SQL status: SUCCESS 3 in 0.96 seconds
2022-03-03 19:49:08.420496 (Thread-3): 19:49:08  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:08.420583 (Thread-3): 19:49:08  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:49:08.772100 (Thread-3): 19:49:08  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-03 19:49:08.783544 (Thread-3): 19:49:08  finished collecting timing info
2022-03-03 19:49:08.783730 (Thread-3): 19:49:08  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:49:09.085254 (Thread-3): 19:49:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91c51fd-0388-47f4-82e0-bd696a4737b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9582cfa0>]}
2022-03-03 19:49:09.085726 (Thread-3): 19:49:09  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.42s]
2022-03-03 19:49:09.085855 (Thread-3): 19:49:09  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:09.087755 (MainThread): 19:49:09  Acquiring new snowflake connection "master"
2022-03-03 19:49:09.088088 (MainThread): 19:49:09  
2022-03-03 19:49:09.088260 (MainThread): 19:49:09  Finished running 1 incremental model in 8.57s.
2022-03-03 19:49:09.088424 (MainThread): 19:49:09  Connection 'master' was properly closed.
2022-03-03 19:49:09.088562 (MainThread): 19:49:09  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:49:09.156120 (MainThread): 19:49:09  
2022-03-03 19:49:09.156293 (MainThread): 19:49:09  Completed successfully
2022-03-03 19:49:09.156398 (MainThread): 19:49:09  
2022-03-03 19:49:09.156493 (MainThread): 19:49:09  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:49:09.867257 (Thread-949): handling poll request
2022-03-03 19:49:09.867612 (Thread-949): 19:49:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7dc9a0>]}
2022-03-03 19:49:09.868743 (Thread-949): sending response (<Response 13551 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:11.250704 (Thread-950): handling status request
2022-03-03 19:49:11.251035 (Thread-950): 19:49:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7dcb50>]}
2022-03-03 19:49:11.251799 (Thread-950): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:11.316014 (Thread-951): handling status request
2022-03-03 19:49:11.316383 (Thread-951): 19:49:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7dcf40>]}
2022-03-03 19:49:11.317112 (Thread-951): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:51.504519 (Thread-952): handling status request
2022-03-03 19:49:51.504886 (Thread-952): 19:49:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7c7130>]}
2022-03-03 19:49:51.528416 (Thread-952): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:51.839122 (Thread-953): handling status request
2022-03-03 19:49:51.839459 (Thread-953): 19:49:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7c78b0>]}
2022-03-03 19:49:51.840138 (Thread-953): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:52.159981 (Thread-954): handling cli_args request
2022-03-03 19:49:52.160307 (Thread-954): 19:49:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7c79d0>]}
2022-03-03 19:49:54.362436 (Thread-954): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:54.662324 (MainThread): 19:49:54  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:49:54.662788 (MainThread): 19:49:54  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:49:54.670823 (MainThread): 19:49:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '781b017a-7d6f-4e79-8061-a3b867b74c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354fcf6910>]}
2022-03-03 19:49:54.705903 (MainThread): 19:49:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '781b017a-7d6f-4e79-8061-a3b867b74c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354fdda6d0>]}
2022-03-03 19:49:54.706203 (MainThread): 19:49:54  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:49:54.707923 (MainThread): 19:49:54  
2022-03-03 19:49:54.708246 (MainThread): 19:49:54  Acquiring new snowflake connection "master"
2022-03-03 19:49:54.709109 (ThreadPoolExecutor-0_0): 19:49:54  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:49:54.722413 (ThreadPoolExecutor-0_0): 19:49:54  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:49:54.722522 (ThreadPoolExecutor-0_0): 19:49:54  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:49:54.722608 (ThreadPoolExecutor-0_0): 19:49:54  Opening a new connection, currently in state init
2022-03-03 19:49:55.142512 (Thread-955): handling poll request
2022-03-03 19:49:55.142936 (Thread-955): 19:49:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7ee250>]}
2022-03-03 19:49:55.143861 (Thread-955): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:55.729106 (ThreadPoolExecutor-0_0): 19:49:55  SQL status: SUCCESS 8 in 1.01 seconds
2022-03-03 19:49:55.731067 (ThreadPoolExecutor-0_0): 19:49:55  On list_DBT_RAW: Close
2022-03-03 19:49:55.953989 (ThreadPoolExecutor-2_0): 19:49:55  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:49:56.011974 (ThreadPoolExecutor-2_0): 19:49:56  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:49:56.012119 (ThreadPoolExecutor-2_0): 19:49:56  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:49:56.012217 (ThreadPoolExecutor-2_0): 19:49:56  Opening a new connection, currently in state closed
2022-03-03 19:49:56.717468 (ThreadPoolExecutor-2_0): 19:49:56  SQL status: SUCCESS 34 in 0.71 seconds
2022-03-03 19:49:56.719634 (ThreadPoolExecutor-2_0): 19:49:56  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:49:56.912526 (MainThread): 19:49:56  Concurrency: 4 threads (target='default')
2022-03-03 19:49:56.912735 (MainThread): 19:49:56  
2022-03-03 19:49:56.933485 (Thread-956): handling poll request
2022-03-03 19:49:56.933873 (Thread-956): 19:49:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7c7be0>]}
2022-03-03 19:49:56.934626 (Thread-956): sending response (<Response 3464 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:49:56.934729 (Thread-3): 19:49:56  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:56.935098 (Thread-3): 19:49:56  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:49:56.935436 (Thread-3): 19:49:56  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:56.935553 (Thread-3): 19:49:56  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:56.935671 (Thread-3): 19:49:56  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:57.026547 (Thread-3): 19:49:57  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:57.038781 (Thread-3): 19:49:57  finished collecting timing info
2022-03-03 19:49:57.038964 (Thread-3): 19:49:57  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:49:57.080366 (Thread-3): 19:49:57  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:49:57.080517 (Thread-3): 19:49:57  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:49:57.080610 (Thread-3): 19:49:57  Opening a new connection, currently in state init
2022-03-03 19:49:58.723920 (Thread-957): handling poll request
2022-03-03 19:49:58.724269 (Thread-957): 19:49:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7c2cd0>]}
2022-03-03 19:49:58.724952 (Thread-957): sending response (<Response 6815 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:00.170244 (Thread-3): 19:50:00  SQL status: SUCCESS 1 in 3.09 seconds
2022-03-03 19:50:00.179343 (Thread-3): 19:50:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:00.179481 (Thread-3): 19:50:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:50:00.332558 (Thread-3): 19:50:00  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 19:50:00.336577 (Thread-3): 19:50:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:00.336730 (Thread-3): 19:50:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:50:00.455240 (Thread-3): 19:50:00  SQL status: SUCCESS 10 in 0.12 seconds
2022-03-03 19:50:00.463211 (Thread-3): 19:50:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:00.463328 (Thread-3): 19:50:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:50:00.573048 (Thread-958): handling poll request
2022-03-03 19:50:00.573337 (Thread-958): 19:50:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7dff40>]}
2022-03-03 19:50:00.573913 (Thread-958): sending response (<Response 4296 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:00.571504 (Thread-3): 19:50:00  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:50:00.593325 (Thread-3): 19:50:00  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:00.609167 (Thread-3): 19:50:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:00.609282 (Thread-3): 19:50:00  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:50:00.873978 (Thread-3): 19:50:00  SQL status: SUCCESS 1 in 0.26 seconds
2022-03-03 19:50:00.874196 (Thread-3): 19:50:00  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:00.874281 (Thread-3): 19:50:00  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:50:02.026054 (Thread-3): 19:50:02  SQL status: SUCCESS 4 in 1.15 seconds
2022-03-03 19:50:02.026254 (Thread-3): 19:50:02  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:02.026340 (Thread-3): 19:50:02  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:50:02.381474 (Thread-959): handling poll request
2022-03-03 19:50:02.381812 (Thread-959): 19:50:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7ebfa0>]}
2022-03-03 19:50:02.382406 (Thread-959): sending response (<Response 5502 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:02.419065 (Thread-3): 19:50:02  SQL status: SUCCESS 1 in 0.39 seconds
2022-03-03 19:50:02.429834 (Thread-3): 19:50:02  finished collecting timing info
2022-03-03 19:50:02.430012 (Thread-3): 19:50:02  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:50:02.679594 (Thread-3): 19:50:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781b017a-7d6f-4e79-8061-a3b867b74c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355411d5b0>]}
2022-03-03 19:50:02.680047 (Thread-3): 19:50:02  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.74s]
2022-03-03 19:50:02.680186 (Thread-3): 19:50:02  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:50:02.681843 (MainThread): 19:50:02  Acquiring new snowflake connection "master"
2022-03-03 19:50:02.682325 (MainThread): 19:50:02  
2022-03-03 19:50:02.682445 (MainThread): 19:50:02  Finished running 1 incremental model in 7.97s.
2022-03-03 19:50:02.682534 (MainThread): 19:50:02  Connection 'master' was properly closed.
2022-03-03 19:50:02.682614 (MainThread): 19:50:02  Connection 'list_DBT_RAW_DBT_VAULT' was properly closed.
2022-03-03 19:50:02.682680 (MainThread): 19:50:02  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:50:02.746920 (MainThread): 19:50:02  
2022-03-03 19:50:02.747143 (MainThread): 19:50:02  Completed successfully
2022-03-03 19:50:02.747261 (MainThread): 19:50:02  
2022-03-03 19:50:02.747359 (MainThread): 19:50:02  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:50:04.164125 (Thread-960): handling poll request
2022-03-03 19:50:04.164490 (Thread-960): 19:50:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae780af0>]}
2022-03-03 19:50:04.165603 (Thread-960): sending response (<Response 12761 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:05.775185 (Thread-961): handling status request
2022-03-03 19:50:05.775511 (Thread-961): 19:50:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae780ca0>]}
2022-03-03 19:50:05.776252 (Thread-961): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:05.780686 (Thread-962): handling status request
2022-03-03 19:50:05.780914 (Thread-962): 19:50:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae780f70>]}
2022-03-03 19:50:05.781490 (Thread-962): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:36.730131 (Thread-963): 19:50:36  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:50:36.731403 (Thread-963): 19:50:36  Partial parsing: updated file: dbtvault://macros/tables/sat.sql
2022-03-03 19:50:36.731595 (Thread-963): 19:50:36  Parsing macros/tables/sat.sql
2022-03-03 19:50:37.009180 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:50:37.019774 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:50:37.021111 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 19:50:37.029545 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_inventory_details.sql
2022-03-03 19:50:37.030931 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 19:50:37.041139 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_part_details.sql
2022-03-03 19:50:37.042284 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 19:50:37.050228 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_nation_details.sql
2022-03-03 19:50:37.051360 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 19:50:37.059342 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supp_region_details.sql
2022-03-03 19:50:37.060476 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 19:50:37.070199 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_inv_supplier_details.sql
2022-03-03 19:50:37.071341 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 19:50:37.079289 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_nation_details.sql
2022-03-03 19:50:37.080423 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 19:50:37.088412 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_cust_region_details.sql
2022-03-03 19:50:37.089586 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 19:50:37.099471 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_customer_details.sql
2022-03-03 19:50:37.100648 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 19:50:37.111961 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_lineitem_details.sql
2022-03-03 19:50:37.113126 (Thread-963): 19:50:37  1603: static parser failed on raw_vault/sats/sat_order_order_details.sql
2022-03-03 19:50:37.122351 (Thread-963): 19:50:37  1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_order_details.sql
2022-03-03 19:50:37.192860 (Thread-963): 19:50:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c4c108b0>]}
2022-03-03 19:50:37.883227 (Thread-964): handling status request
2022-03-03 19:50:37.883558 (Thread-964): 19:50:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8255e0>]}
2022-03-03 19:50:37.884216 (Thread-964): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:37.887016 (Thread-965): handling status request
2022-03-03 19:50:37.887267 (Thread-965): 19:50:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae826970>]}
2022-03-03 19:50:37.887835 (Thread-965): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:44.929931 (Thread-966): handling status request
2022-03-03 19:50:44.930263 (Thread-966): 19:50:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae826f70>]}
2022-03-03 19:50:44.930903 (Thread-966): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:45.252007 (Thread-967): handling status request
2022-03-03 19:50:45.252336 (Thread-967): 19:50:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8265e0>]}
2022-03-03 19:50:45.253090 (Thread-967): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:45.596789 (Thread-968): handling cli_args request
2022-03-03 19:50:45.597136 (Thread-968): 19:50:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7df1c0>]}
2022-03-03 19:50:47.826630 (Thread-968): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:48.117740 (MainThread): 19:50:48  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:50:48.118156 (MainThread): 19:50:48  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:50:48.125744 (MainThread): 19:50:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d32f561-3401-4fac-880f-fe1760619533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbdff369d0>]}
2022-03-03 19:50:48.160080 (MainThread): 19:50:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d32f561-3401-4fac-880f-fe1760619533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe405e790>]}
2022-03-03 19:50:48.160323 (MainThread): 19:50:48  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:50:48.162168 (MainThread): 19:50:48  
2022-03-03 19:50:48.162445 (MainThread): 19:50:48  Acquiring new snowflake connection "master"
2022-03-03 19:50:48.163313 (ThreadPoolExecutor-0_0): 19:50:48  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:50:48.177156 (ThreadPoolExecutor-0_0): 19:50:48  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:50:48.177271 (ThreadPoolExecutor-0_0): 19:50:48  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:50:48.177357 (ThreadPoolExecutor-0_0): 19:50:48  Opening a new connection, currently in state init
2022-03-03 19:50:48.598114 (Thread-969): handling poll request
2022-03-03 19:50:48.598542 (Thread-969): 19:50:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae826e80>]}
2022-03-03 19:50:48.599499 (Thread-969): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:49.552323 (ThreadPoolExecutor-0_0): 19:50:49  SQL status: SUCCESS 8 in 1.37 seconds
2022-03-03 19:50:49.554412 (ThreadPoolExecutor-0_0): 19:50:49  On list_DBT_RAW: Close
2022-03-03 19:50:49.840206 (ThreadPoolExecutor-2_0): 19:50:49  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:50:49.899395 (ThreadPoolExecutor-2_0): 19:50:49  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:50:49.899538 (ThreadPoolExecutor-2_0): 19:50:49  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:50:49.899632 (ThreadPoolExecutor-2_0): 19:50:49  Opening a new connection, currently in state closed
2022-03-03 19:50:50.375360 (Thread-970): handling poll request
2022-03-03 19:50:50.375693 (Thread-970): 19:50:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5c03d0>]}
2022-03-03 19:50:50.376254 (Thread-970): sending response (<Response 2331 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:50.568972 (ThreadPoolExecutor-2_0): 19:50:50  SQL status: SUCCESS 34 in 0.67 seconds
2022-03-03 19:50:50.571274 (ThreadPoolExecutor-2_0): 19:50:50  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:50:50.963005 (MainThread): 19:50:50  Concurrency: 4 threads (target='default')
2022-03-03 19:50:50.963201 (MainThread): 19:50:50  
2022-03-03 19:50:50.966166 (Thread-3): 19:50:50  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:50:50.966487 (Thread-3): 19:50:50  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:50:50.966768 (Thread-3): 19:50:50  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:50:50.966878 (Thread-3): 19:50:50  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:50:50.966993 (Thread-3): 19:50:50  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:50:50.973024 (Thread-3): 19:50:50  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:50:50.986280 (Thread-3): 19:50:50  finished collecting timing info
2022-03-03 19:50:50.986593 (Thread-3): 19:50:50  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:50:51.010942 (Thread-3): 19:50:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:50:51.024130 (Thread-3): 19:50:51  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:50:51.024254 (Thread-3): 19:50:51  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:50:51.024342 (Thread-3): 19:50:51  Opening a new connection, currently in state closed
2022-03-03 19:50:52.147994 (Thread-971): handling poll request
2022-03-03 19:50:52.148330 (Thread-971): 19:50:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e4479790>]}
2022-03-03 19:50:52.149098 (Thread-971): sending response (<Response 9164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:53.914647 (Thread-972): handling poll request
2022-03-03 19:50:53.914968 (Thread-972): 19:50:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb3d3a0>]}
2022-03-03 19:50:53.915446 (Thread-972): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:55.018345 (Thread-3): 19:50:55  SQL status: SUCCESS 1 in 3.99 seconds
2022-03-03 19:50:55.027889 (Thread-3): 19:50:55  finished collecting timing info
2022-03-03 19:50:55.028076 (Thread-3): 19:50:55  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:50:55.310837 (Thread-3): 19:50:55  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d32f561-3401-4fac-880f-fe1760619533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbdf6c12b0>]}
2022-03-03 19:50:55.311289 (Thread-3): 19:50:55  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 4.34s]
2022-03-03 19:50:55.311426 (Thread-3): 19:50:55  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:50:55.312576 (Thread-5): 19:50:55  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:50:55.312997 (Thread-5): 19:50:55  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:50:55.313296 (Thread-5): 19:50:55  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:50:55.313388 (Thread-5): 19:50:55  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:50:55.313479 (Thread-5): 19:50:55  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:50:55.349115 (Thread-5): 19:50:55  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:50:55.349248 (Thread-5): 19:50:55  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:50:55.349338 (Thread-5): 19:50:55  Opening a new connection, currently in state init
2022-03-03 19:50:55.685087 (Thread-973): handling poll request
2022-03-03 19:50:55.685416 (Thread-973): 19:50:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb3d700>]}
2022-03-03 19:50:55.686118 (Thread-973): sending response (<Response 6487 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:56.055713 (Thread-5): 19:50:56  SQL status: SUCCESS 5 in 0.71 seconds
2022-03-03 19:50:56.085084 (Thread-5): 19:50:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:50:56.085227 (Thread-5): 19:50:56  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:50:56.243530 (Thread-5): 19:50:56  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 19:50:56.277858 (Thread-5): 19:50:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:50:56.291509 (Thread-5): 19:50:56  finished collecting timing info
2022-03-03 19:50:56.291681 (Thread-5): 19:50:56  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:50:56.310415 (Thread-5): 19:50:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:50:56.323541 (Thread-5): 19:50:56  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:50:56.323664 (Thread-5): 19:50:56  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:50:56.569519 (Thread-5): 19:50:56  SQL status: SUCCESS 1 in 0.25 seconds
2022-03-03 19:50:56.570962 (Thread-5): 19:50:56  finished collecting timing info
2022-03-03 19:50:56.571130 (Thread-5): 19:50:56  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:50:56.878248 (Thread-5): 19:50:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d32f561-3401-4fac-880f-fe1760619533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbdc3253d0>]}
2022-03-03 19:50:56.878676 (Thread-5): 19:50:56  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.56s]
2022-03-03 19:50:56.878807 (Thread-5): 19:50:56  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:50:56.879904 (Thread-4): 19:50:56  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:50:56.880177 (Thread-4): 19:50:56  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:50:56.880469 (Thread-4): 19:50:56  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:56.880563 (Thread-4): 19:50:56  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:50:56.880688 (Thread-4): 19:50:56  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:50:56.980324 (Thread-4): 19:50:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:56.992926 (Thread-4): 19:50:56  finished collecting timing info
2022-03-03 19:50:56.993135 (Thread-4): 19:50:56  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:50:57.018039 (Thread-4): 19:50:57  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:57.030991 (Thread-4): 19:50:57  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:50:57.031134 (Thread-4): 19:50:57  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:50:57.031227 (Thread-4): 19:50:57  Opening a new connection, currently in state init
2022-03-03 19:50:57.452187 (Thread-974): handling poll request
2022-03-03 19:50:57.452521 (Thread-974): 19:50:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb31d90>]}
2022-03-03 19:50:57.453382 (Thread-974): sending response (<Response 14839 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:50:59.232772 (Thread-975): handling poll request
2022-03-03 19:50:59.233092 (Thread-975): 19:50:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb31160>]}
2022-03-03 19:50:59.233552 (Thread-975): sending response (<Response 336 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:00.478104 (Thread-4): 19:51:00  SQL status: SUCCESS 1 in 3.45 seconds
2022-03-03 19:51:00.479650 (Thread-4): 19:51:00  finished collecting timing info
2022-03-03 19:51:00.479816 (Thread-4): 19:51:00  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:51:00.903098 (Thread-4): 19:51:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d32f561-3401-4fac-880f-fe1760619533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbdc2f7fa0>]}
2022-03-03 19:51:00.903524 (Thread-4): 19:51:00  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 4.02s]
2022-03-03 19:51:00.903654 (Thread-4): 19:51:00  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:51:00.905364 (MainThread): 19:51:00  Acquiring new snowflake connection "master"
2022-03-03 19:51:00.905788 (MainThread): 19:51:00  
2022-03-03 19:51:00.905905 (MainThread): 19:51:00  Finished running 1 table model, 1 view model, 1 incremental model in 12.74s.
2022-03-03 19:51:00.905995 (MainThread): 19:51:00  Connection 'master' was properly closed.
2022-03-03 19:51:00.906066 (MainThread): 19:51:00  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:51:00.906133 (MainThread): 19:51:00  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:51:00.906199 (MainThread): 19:51:00  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:51:00.973095 (MainThread): 19:51:00  
2022-03-03 19:51:00.973285 (MainThread): 19:51:00  Completed successfully
2022-03-03 19:51:00.973421 (MainThread): 19:51:00  
2022-03-03 19:51:00.973521 (MainThread): 19:51:00  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:51:01.014707 (Thread-976): handling poll request
2022-03-03 19:51:01.015033 (Thread-976): 19:51:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7f9670>]}
2022-03-03 19:51:01.015687 (Thread-976): sending response (<Response 6687 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:02.781111 (Thread-977): handling poll request
2022-03-03 19:51:02.781448 (Thread-977): 19:51:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7ee730>]}
2022-03-03 19:51:02.782644 (Thread-977): sending response (<Response 18139 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:04.229349 (Thread-978): handling status request
2022-03-03 19:51:04.229692 (Thread-978): 19:51:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5c0910>]}
2022-03-03 19:51:04.230469 (Thread-978): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:04.253877 (Thread-979): handling status request
2022-03-03 19:51:04.254118 (Thread-979): 19:51:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae826f10>]}
2022-03-03 19:51:04.254697 (Thread-979): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:39.374619 (Thread-980): handling status request
2022-03-03 19:51:39.374972 (Thread-980): 19:51:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed00220>]}
2022-03-03 19:51:39.375650 (Thread-980): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:39.683344 (Thread-981): handling status request
2022-03-03 19:51:39.683697 (Thread-981): 19:51:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb26ac0>]}
2022-03-03 19:51:39.684376 (Thread-981): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:40.005389 (Thread-982): handling cli_args request
2022-03-03 19:51:40.005716 (Thread-982): 19:51:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeb26d90>]}
2022-03-03 19:51:42.249558 (Thread-982): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:42.550474 (MainThread): 19:51:42  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:51:42.550916 (MainThread): 19:51:42  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:51:42.559024 (MainThread): 19:51:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2f663e6-a9d2-4a67-a6ed-6209c834564b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7661174a60>]}
2022-03-03 19:51:42.587596 (MainThread): 19:51:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2f663e6-a9d2-4a67-a6ed-6209c834564b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76612597f0>]}
2022-03-03 19:51:42.587876 (MainThread): 19:51:42  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:51:42.589870 (MainThread): 19:51:42  
2022-03-03 19:51:42.590193 (MainThread): 19:51:42  Acquiring new snowflake connection "master"
2022-03-03 19:51:42.591114 (ThreadPoolExecutor-0_0): 19:51:42  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:51:42.604673 (ThreadPoolExecutor-0_0): 19:51:42  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:51:42.604791 (ThreadPoolExecutor-0_0): 19:51:42  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:51:42.604877 (ThreadPoolExecutor-0_0): 19:51:42  Opening a new connection, currently in state init
2022-03-03 19:51:43.023842 (Thread-983): handling poll request
2022-03-03 19:51:43.024248 (Thread-983): 19:51:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b8be0>]}
2022-03-03 19:51:43.025160 (Thread-983): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:43.786901 (ThreadPoolExecutor-0_0): 19:51:43  SQL status: SUCCESS 8 in 1.18 seconds
2022-03-03 19:51:43.789629 (ThreadPoolExecutor-0_0): 19:51:43  On list_DBT_RAW: Close
2022-03-03 19:51:44.019693 (ThreadPoolExecutor-2_0): 19:51:44  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:51:44.083233 (ThreadPoolExecutor-2_0): 19:51:44  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:51:44.083389 (ThreadPoolExecutor-2_0): 19:51:44  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:51:44.083489 (ThreadPoolExecutor-2_0): 19:51:44  Opening a new connection, currently in state closed
2022-03-03 19:51:44.793841 (Thread-984): handling poll request
2022-03-03 19:51:44.794280 (Thread-984): 19:51:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea75610>]}
2022-03-03 19:51:44.794841 (Thread-984): sending response (<Response 2332 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:44.807000 (ThreadPoolExecutor-2_0): 19:51:44  SQL status: SUCCESS 33 in 0.72 seconds
2022-03-03 19:51:44.810392 (ThreadPoolExecutor-2_0): 19:51:44  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:51:45.015647 (MainThread): 19:51:45  Concurrency: 4 threads (target='default')
2022-03-03 19:51:45.015828 (MainThread): 19:51:45  
2022-03-03 19:51:45.018697 (Thread-3): 19:51:45  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:51:45.019016 (Thread-3): 19:51:45  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:51:45.019290 (Thread-3): 19:51:45  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:51:45.019404 (Thread-3): 19:51:45  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:51:45.019519 (Thread-3): 19:51:45  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:51:45.025615 (Thread-3): 19:51:45  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:51:45.038425 (Thread-3): 19:51:45  finished collecting timing info
2022-03-03 19:51:45.038580 (Thread-3): 19:51:45  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:51:45.062752 (Thread-3): 19:51:45  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:51:45.079525 (Thread-3): 19:51:45  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:51:45.079646 (Thread-3): 19:51:45  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:51:45.079734 (Thread-3): 19:51:45  Opening a new connection, currently in state closed
2022-03-03 19:51:46.909532 (Thread-985): handling poll request
2022-03-03 19:51:46.909883 (Thread-985): 19:51:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae2940>]}
2022-03-03 19:51:46.910634 (Thread-985): sending response (<Response 9164 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:48.531047 (Thread-3): 19:51:48  SQL status: SUCCESS 1 in 3.45 seconds
2022-03-03 19:51:48.540799 (Thread-3): 19:51:48  finished collecting timing info
2022-03-03 19:51:48.541078 (Thread-3): 19:51:48  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:51:48.717442 (Thread-986): handling poll request
2022-03-03 19:51:48.717773 (Thread-986): 19:51:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae2d90>]}
2022-03-03 19:51:48.718283 (Thread-986): sending response (<Response 1507 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:48.851965 (Thread-3): 19:51:48  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f663e6-a9d2-4a67-a6ed-6209c834564b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76609193d0>]}
2022-03-03 19:51:48.852409 (Thread-3): 19:51:48  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 3.83s]
2022-03-03 19:51:48.852537 (Thread-3): 19:51:48  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:51:48.853688 (Thread-5): 19:51:48  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:51:48.853959 (Thread-5): 19:51:48  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:51:48.854288 (Thread-5): 19:51:48  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:51:48.854391 (Thread-5): 19:51:48  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:51:48.854483 (Thread-5): 19:51:48  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:51:48.888801 (Thread-5): 19:51:48  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:51:48.888929 (Thread-5): 19:51:48  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:51:48.889019 (Thread-5): 19:51:48  Opening a new connection, currently in state init
2022-03-03 19:51:50.307370 (Thread-5): 19:51:50  SQL status: SUCCESS 5 in 1.42 seconds
2022-03-03 19:51:50.335967 (Thread-5): 19:51:50  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:51:50.336125 (Thread-5): 19:51:50  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:51:50.492064 (Thread-987): handling poll request
2022-03-03 19:51:50.492429 (Thread-987): 19:51:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8901c0>]}
2022-03-03 19:51:50.493159 (Thread-987): sending response (<Response 6640 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:50.496093 (Thread-5): 19:51:50  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 19:51:50.529320 (Thread-5): 19:51:50  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:51:50.541913 (Thread-5): 19:51:50  finished collecting timing info
2022-03-03 19:51:50.542087 (Thread-5): 19:51:50  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:51:50.560604 (Thread-5): 19:51:50  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:51:50.577038 (Thread-5): 19:51:50  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:51:50.577174 (Thread-5): 19:51:50  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:51:50.929424 (Thread-5): 19:51:50  SQL status: SUCCESS 1 in 0.35 seconds
2022-03-03 19:51:50.930910 (Thread-5): 19:51:50  finished collecting timing info
2022-03-03 19:51:50.931080 (Thread-5): 19:51:50  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:51:51.162860 (Thread-5): 19:51:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f663e6-a9d2-4a67-a6ed-6209c834564b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76505242e0>]}
2022-03-03 19:51:51.163282 (Thread-5): 19:51:51  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 2.31s]
2022-03-03 19:51:51.163407 (Thread-5): 19:51:51  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:51:51.164363 (Thread-4): 19:51:51  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:51:51.164607 (Thread-4): 19:51:51  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:51:51.164919 (Thread-4): 19:51:51  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:51:51.165012 (Thread-4): 19:51:51  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:51:51.165102 (Thread-4): 19:51:51  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:51:51.246343 (Thread-4): 19:51:51  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:51:51.259881 (Thread-4): 19:51:51  finished collecting timing info
2022-03-03 19:51:51.260093 (Thread-4): 19:51:51  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:51:51.294805 (Thread-4): 19:51:51  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:51:51.309421 (Thread-4): 19:51:51  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:51:51.309626 (Thread-4): 19:51:51  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:51:51.309769 (Thread-4): 19:51:51  Opening a new connection, currently in state init
2022-03-03 19:51:52.263973 (Thread-988): handling poll request
2022-03-03 19:51:52.264304 (Thread-988): 19:51:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aead34c0>]}
2022-03-03 19:51:52.265145 (Thread-988): sending response (<Response 13511 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:53.351261 (Thread-4): 19:51:53  SQL status: SUCCESS 1 in 2.04 seconds
2022-03-03 19:51:53.352899 (Thread-4): 19:51:53  finished collecting timing info
2022-03-03 19:51:53.353066 (Thread-4): 19:51:53  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:51:53.546321 (Thread-4): 19:51:53  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f663e6-a9d2-4a67-a6ed-6209c834564b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76504ea250>]}
2022-03-03 19:51:53.546745 (Thread-4): 19:51:53  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.38s]
2022-03-03 19:51:53.546874 (Thread-4): 19:51:53  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:51:53.548527 (MainThread): 19:51:53  Acquiring new snowflake connection "master"
2022-03-03 19:51:53.548911 (MainThread): 19:51:53  
2022-03-03 19:51:53.549021 (MainThread): 19:51:53  Finished running 1 table model, 1 view model, 1 incremental model in 10.96s.
2022-03-03 19:51:53.549109 (MainThread): 19:51:53  Connection 'master' was properly closed.
2022-03-03 19:51:53.549180 (MainThread): 19:51:53  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:51:53.549245 (MainThread): 19:51:53  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:51:53.549307 (MainThread): 19:51:53  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:51:53.611964 (MainThread): 19:51:53  
2022-03-03 19:51:53.612154 (MainThread): 19:51:53  Completed successfully
2022-03-03 19:51:53.612255 (MainThread): 19:51:53  
2022-03-03 19:51:53.612348 (MainThread): 19:51:53  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:51:54.936863 (Thread-989): handling poll request
2022-03-03 19:51:54.937217 (Thread-989): 19:51:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae2a00>]}
2022-03-03 19:51:54.938823 (Thread-989): sending response (<Response 24490 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:56.308868 (Thread-990): handling status request
2022-03-03 19:51:56.309206 (Thread-990): 19:51:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b86a0>]}
2022-03-03 19:51:56.309969 (Thread-990): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:51:56.317500 (Thread-991): handling status request
2022-03-03 19:51:56.317744 (Thread-991): 19:51:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aef578b0>]}
2022-03-03 19:51:56.318400 (Thread-991): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:32.050010 (Thread-992): handling status request
2022-03-03 19:52:32.050421 (Thread-992): 19:52:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a7340>]}
2022-03-03 19:52:32.051108 (Thread-992): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:32.527149 (Thread-993): handling cli_args request
2022-03-03 19:52:32.527498 (Thread-993): 19:52:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed1d0a0>]}
2022-03-03 19:52:32.812092 (Thread-994): handling status request
2022-03-03 19:52:32.812842 (Thread-994): 19:52:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aecef760>]}
2022-03-03 19:52:32.814076 (Thread-994): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:34.869703 (Thread-993): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:35.157526 (MainThread): 19:52:35  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:52:35.157962 (MainThread): 19:52:35  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:52:35.166136 (MainThread): 19:52:35  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dacd4ca-995b-4b9d-aaa6-c972cf4e29a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c91cf5940>]}
2022-03-03 19:52:35.198380 (MainThread): 19:52:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dacd4ca-995b-4b9d-aaa6-c972cf4e29a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c91dd9700>]}
2022-03-03 19:52:35.198648 (MainThread): 19:52:35  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:52:35.200340 (MainThread): 19:52:35  
2022-03-03 19:52:35.200658 (MainThread): 19:52:35  Acquiring new snowflake connection "master"
2022-03-03 19:52:35.201519 (ThreadPoolExecutor-0_0): 19:52:35  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:52:35.215015 (ThreadPoolExecutor-0_0): 19:52:35  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:52:35.215124 (ThreadPoolExecutor-0_0): 19:52:35  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:52:35.215208 (ThreadPoolExecutor-0_0): 19:52:35  Opening a new connection, currently in state init
2022-03-03 19:52:35.626178 (Thread-995): handling poll request
2022-03-03 19:52:35.626507 (Thread-995): 19:52:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a44c0>]}
2022-03-03 19:52:35.627216 (Thread-995): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:36.250030 (ThreadPoolExecutor-0_0): 19:52:36  SQL status: SUCCESS 8 in 1.03 seconds
2022-03-03 19:52:36.252069 (ThreadPoolExecutor-0_0): 19:52:36  On list_DBT_RAW: Close
2022-03-03 19:52:36.557896 (ThreadPoolExecutor-2_0): 19:52:36  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:52:36.621556 (ThreadPoolExecutor-2_0): 19:52:36  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:52:36.621716 (ThreadPoolExecutor-2_0): 19:52:36  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:52:36.621815 (ThreadPoolExecutor-2_0): 19:52:36  Opening a new connection, currently in state closed
2022-03-03 19:52:37.382809 (Thread-996): handling poll request
2022-03-03 19:52:37.383159 (Thread-996): 19:52:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b5f70>]}
2022-03-03 19:52:37.383760 (Thread-996): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:37.967785 (ThreadPoolExecutor-2_0): 19:52:37  SQL status: SUCCESS 34 in 1.35 seconds
2022-03-03 19:52:37.970077 (ThreadPoolExecutor-2_0): 19:52:37  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:52:38.211809 (MainThread): 19:52:38  Concurrency: 4 threads (target='default')
2022-03-03 19:52:38.211983 (MainThread): 19:52:38  
2022-03-03 19:52:38.214959 (Thread-3): 19:52:38  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:52:38.215291 (Thread-3): 19:52:38  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:52:38.215567 (Thread-3): 19:52:38  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:38.215679 (Thread-3): 19:52:38  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:52:38.215792 (Thread-3): 19:52:38  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:52:38.305477 (Thread-3): 19:52:38  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:38.318644 (Thread-3): 19:52:38  finished collecting timing info
2022-03-03 19:52:38.318847 (Thread-3): 19:52:38  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:52:38.360253 (Thread-3): 19:52:38  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:38.360390 (Thread-3): 19:52:38  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:52:38.360481 (Thread-3): 19:52:38  Opening a new connection, currently in state closed
2022-03-03 19:52:40.060806 (Thread-997): handling poll request
2022-03-03 19:52:40.061148 (Thread-997): 19:52:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae89b190>]}
2022-03-03 19:52:40.061830 (Thread-997): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:41.317451 (Thread-3): 19:52:41  SQL status: SUCCESS 1 in 2.96 seconds
2022-03-03 19:52:41.326852 (Thread-3): 19:52:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:41.326987 (Thread-3): 19:52:41  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:52:41.564817 (Thread-3): 19:52:41  SQL status: SUCCESS 10 in 0.24 seconds
2022-03-03 19:52:41.569318 (Thread-3): 19:52:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:41.569436 (Thread-3): 19:52:41  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:52:41.716170 (Thread-3): 19:52:41  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 19:52:41.724466 (Thread-3): 19:52:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:41.724590 (Thread-3): 19:52:41  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:52:41.843900 (Thread-998): handling poll request
2022-03-03 19:52:41.838681 (Thread-3): 19:52:41  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:52:41.844474 (Thread-998): 19:52:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae89bfd0>]}
2022-03-03 19:52:41.845345 (Thread-998): sending response (<Response 4639 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:41.859950 (Thread-3): 19:52:41  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:41.872810 (Thread-3): 19:52:41  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:41.872943 (Thread-3): 19:52:41  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:52:42.074618 (Thread-3): 19:52:42  SQL status: SUCCESS 1 in 0.2 seconds
2022-03-03 19:52:42.074859 (Thread-3): 19:52:42  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:42.074951 (Thread-3): 19:52:42  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:52:43.177829 (Thread-3): 19:52:43  SQL status: SUCCESS 1 in 1.1 seconds
2022-03-03 19:52:43.178032 (Thread-3): 19:52:43  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:52:43.178120 (Thread-3): 19:52:43  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:52:43.591229 (Thread-999): handling poll request
2022-03-03 19:52:43.591555 (Thread-999): 19:52:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefa9160>]}
2022-03-03 19:52:43.592142 (Thread-999): sending response (<Response 5156 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:43.807497 (Thread-3): 19:52:43  SQL status: SUCCESS 1 in 0.63 seconds
2022-03-03 19:52:43.818745 (Thread-3): 19:52:43  finished collecting timing info
2022-03-03 19:52:43.818933 (Thread-3): 19:52:43  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:52:44.052972 (Thread-3): 19:52:44  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dacd4ca-995b-4b9d-aaa6-c972cf4e29a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c914990d0>]}
2022-03-03 19:52:44.053422 (Thread-3): 19:52:44  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.84s]
2022-03-03 19:52:44.053572 (Thread-3): 19:52:44  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:52:44.055243 (MainThread): 19:52:44  Acquiring new snowflake connection "master"
2022-03-03 19:52:44.055567 (MainThread): 19:52:44  
2022-03-03 19:52:44.055672 (MainThread): 19:52:44  Finished running 1 incremental model in 8.86s.
2022-03-03 19:52:44.055762 (MainThread): 19:52:44  Connection 'master' was properly closed.
2022-03-03 19:52:44.055831 (MainThread): 19:52:44  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:52:44.119496 (MainThread): 19:52:44  
2022-03-03 19:52:44.119683 (MainThread): 19:52:44  Completed successfully
2022-03-03 19:52:44.119783 (MainThread): 19:52:44  
2022-03-03 19:52:44.119880 (MainThread): 19:52:44  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:52:45.333484 (Thread-1000): handling poll request
2022-03-03 19:52:45.333824 (Thread-1000): 19:52:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a25e0>]}
2022-03-03 19:52:45.334885 (Thread-1000): sending response (<Response 12458 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:46.736714 (Thread-1001): handling status request
2022-03-03 19:52:46.737044 (Thread-1001): 19:52:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae89b760>]}
2022-03-03 19:52:46.737776 (Thread-1001): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:52:46.743527 (Thread-1002): handling status request
2022-03-03 19:52:46.743750 (Thread-1002): 19:52:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a4f40>]}
2022-03-03 19:52:46.744312 (Thread-1002): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:02.891796 (Thread-1003): handling status request
2022-03-03 19:53:02.892132 (Thread-1003): 19:53:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8bb970>]}
2022-03-03 19:53:02.892837 (Thread-1003): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:03.199533 (Thread-1004): handling status request
2022-03-03 19:53:03.199868 (Thread-1004): 19:53:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae21c0>]}
2022-03-03 19:53:03.200539 (Thread-1004): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:03.520048 (Thread-1005): handling cli_args request
2022-03-03 19:53:03.520388 (Thread-1005): 19:53:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae89d850>]}
2022-03-03 19:53:05.780229 (Thread-1005): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:06.076389 (MainThread): 19:53:06  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:53:06.076830 (MainThread): 19:53:06  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:53:06.084787 (MainThread): 19:53:06  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d31c1b8-723b-4f79-9964-e8bfa0136f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9d635a00>]}
2022-03-03 19:53:06.119781 (MainThread): 19:53:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d31c1b8-723b-4f79-9964-e8bfa0136f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9d7167c0>]}
2022-03-03 19:53:06.120029 (MainThread): 19:53:06  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:53:06.121680 (MainThread): 19:53:06  
2022-03-03 19:53:06.121978 (MainThread): 19:53:06  Acquiring new snowflake connection "master"
2022-03-03 19:53:06.122754 (ThreadPoolExecutor-0_0): 19:53:06  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:53:06.135932 (ThreadPoolExecutor-0_0): 19:53:06  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:53:06.136036 (ThreadPoolExecutor-0_0): 19:53:06  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:53:06.136119 (ThreadPoolExecutor-0_0): 19:53:06  Opening a new connection, currently in state init
2022-03-03 19:53:06.555743 (Thread-1006): handling poll request
2022-03-03 19:53:06.556139 (Thread-1006): 19:53:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefa9370>]}
2022-03-03 19:53:06.557106 (Thread-1006): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:07.013530 (ThreadPoolExecutor-0_0): 19:53:07  SQL status: SUCCESS 8 in 0.88 seconds
2022-03-03 19:53:07.015514 (ThreadPoolExecutor-0_0): 19:53:07  On list_DBT_RAW: Close
2022-03-03 19:53:07.313635 (ThreadPoolExecutor-2_0): 19:53:07  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:53:07.372805 (ThreadPoolExecutor-2_0): 19:53:07  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:53:07.372948 (ThreadPoolExecutor-2_0): 19:53:07  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:53:07.373044 (ThreadPoolExecutor-2_0): 19:53:07  Opening a new connection, currently in state closed
2022-03-03 19:53:08.331898 (Thread-1007): handling poll request
2022-03-03 19:53:08.332246 (Thread-1007): 19:53:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a22e0>]}
2022-03-03 19:53:08.332847 (Thread-1007): sending response (<Response 2315 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:08.393047 (ThreadPoolExecutor-2_0): 19:53:08  SQL status: SUCCESS 34 in 1.02 seconds
2022-03-03 19:53:08.395510 (ThreadPoolExecutor-2_0): 19:53:08  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:53:08.735099 (MainThread): 19:53:08  Concurrency: 4 threads (target='default')
2022-03-03 19:53:08.735272 (MainThread): 19:53:08  
2022-03-03 19:53:08.738180 (Thread-3): 19:53:08  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:53:08.738514 (Thread-3): 19:53:08  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:53:08.738807 (Thread-3): 19:53:08  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:08.738917 (Thread-3): 19:53:08  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:53:08.739025 (Thread-3): 19:53:08  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:53:08.827053 (Thread-3): 19:53:08  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:08.839975 (Thread-3): 19:53:08  finished collecting timing info
2022-03-03 19:53:08.840155 (Thread-3): 19:53:08  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:53:08.881804 (Thread-3): 19:53:08  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:08.881956 (Thread-3): 19:53:08  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:53:08.882050 (Thread-3): 19:53:08  Opening a new connection, currently in state closed
2022-03-03 19:53:10.110954 (Thread-1008): handling poll request
2022-03-03 19:53:10.111334 (Thread-1008): 19:53:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afd35910>]}
2022-03-03 19:53:10.112103 (Thread-1008): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:11.376576 (Thread-3): 19:53:11  SQL status: SUCCESS 1 in 2.49 seconds
2022-03-03 19:53:11.386188 (Thread-3): 19:53:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:11.386322 (Thread-3): 19:53:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:53:11.560593 (Thread-3): 19:53:11  SQL status: SUCCESS 10 in 0.17 seconds
2022-03-03 19:53:11.564608 (Thread-3): 19:53:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:11.564744 (Thread-3): 19:53:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:53:11.670884 (Thread-3): 19:53:11  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 19:53:11.679215 (Thread-3): 19:53:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:11.679332 (Thread-3): 19:53:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:53:11.807187 (Thread-3): 19:53:11  SQL status: SUCCESS 10 in 0.13 seconds
2022-03-03 19:53:11.828303 (Thread-3): 19:53:11  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:11.844361 (Thread-3): 19:53:11  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:11.844488 (Thread-3): 19:53:11  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:53:11.895841 (Thread-1009): handling poll request
2022-03-03 19:53:11.896129 (Thread-1009): 19:53:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a4820>]}
2022-03-03 19:53:11.896858 (Thread-1009): sending response (<Response 5952 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:12.004679 (Thread-3): 19:53:12  SQL status: SUCCESS 1 in 0.16 seconds
2022-03-03 19:53:12.004910 (Thread-3): 19:53:12  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:12.004994 (Thread-3): 19:53:12  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:53:13.004515 (Thread-3): 19:53:13  SQL status: SUCCESS 2 in 1.0 seconds
2022-03-03 19:53:13.004754 (Thread-3): 19:53:13  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:53:13.004847 (Thread-3): 19:53:13  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:53:13.513247 (Thread-3): 19:53:13  SQL status: SUCCESS 1 in 0.51 seconds
2022-03-03 19:53:13.523923 (Thread-3): 19:53:13  finished collecting timing info
2022-03-03 19:53:13.524106 (Thread-3): 19:53:13  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:53:13.673923 (Thread-1010): handling poll request
2022-03-03 19:53:13.674250 (Thread-1010): 19:53:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae2460>]}
2022-03-03 19:53:13.674852 (Thread-1010): sending response (<Response 5035 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:13.748121 (Thread-3): 19:53:13  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d31c1b8-723b-4f79-9964-e8bfa0136f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca13e6c70>]}
2022-03-03 19:53:13.748555 (Thread-3): 19:53:13  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.01s]
2022-03-03 19:53:13.748710 (Thread-3): 19:53:13  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:53:13.750260 (MainThread): 19:53:13  Acquiring new snowflake connection "master"
2022-03-03 19:53:13.750584 (MainThread): 19:53:13  
2022-03-03 19:53:13.750690 (MainThread): 19:53:13  Finished running 1 incremental model in 7.63s.
2022-03-03 19:53:13.750779 (MainThread): 19:53:13  Connection 'master' was properly closed.
2022-03-03 19:53:13.750851 (MainThread): 19:53:13  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:53:13.811858 (MainThread): 19:53:13  
2022-03-03 19:53:13.812056 (MainThread): 19:53:13  Completed successfully
2022-03-03 19:53:13.812155 (MainThread): 19:53:13  
2022-03-03 19:53:13.812249 (MainThread): 19:53:13  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:53:15.464046 (Thread-1011): handling poll request
2022-03-03 19:53:15.464404 (Thread-1011): 19:53:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed4a3d0>]}
2022-03-03 19:53:15.465508 (Thread-1011): sending response (<Response 11269 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:16.826934 (Thread-1012): handling status request
2022-03-03 19:53:16.827299 (Thread-1012): 19:53:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed1dca0>]}
2022-03-03 19:53:16.852231 (Thread-1012): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:53:17.108971 (Thread-1013): handling status request
2022-03-03 19:53:17.109323 (Thread-1013): 19:53:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aea756d0>]}
2022-03-03 19:53:17.110001 (Thread-1013): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:50.484915 (Thread-1014): handling status request
2022-03-03 19:54:50.486660 (Thread-1014): 19:54:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b8b20>]}
2022-03-03 19:54:50.487369 (Thread-1014): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:51.289919 (Thread-1015): handling cli_args request
2022-03-03 19:54:51.290285 (Thread-1015): 19:54:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aed4a640>]}
2022-03-03 19:54:51.442365 (Thread-1016): handling status request
2022-03-03 19:54:51.443110 (Thread-1016): 19:54:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae7ebc10>]}
2022-03-03 19:54:51.444407 (Thread-1016): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:53.511577 (Thread-1015): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:53.882447 (MainThread): 19:54:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:54:53.882879 (MainThread): 19:54:53  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:54:53.890890 (MainThread): 19:54:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab2767c-0071-489e-9200-cc7440f9a5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5dcf5a30>]}
2022-03-03 19:54:53.926460 (MainThread): 19:54:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab2767c-0071-489e-9200-cc7440f9a5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5ddd67f0>]}
2022-03-03 19:54:53.926942 (MainThread): 19:54:53  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:54:53.928986 (MainThread): 19:54:53  
2022-03-03 19:54:53.929323 (MainThread): 19:54:53  Acquiring new snowflake connection "master"
2022-03-03 19:54:53.930215 (ThreadPoolExecutor-0_0): 19:54:53  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:54:53.943678 (ThreadPoolExecutor-0_0): 19:54:53  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:54:53.943785 (ThreadPoolExecutor-0_0): 19:54:53  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:54:53.943871 (ThreadPoolExecutor-0_0): 19:54:53  Opening a new connection, currently in state init
2022-03-03 19:54:54.276497 (Thread-1017): handling poll request
2022-03-03 19:54:54.276860 (Thread-1017): 19:54:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b8520>]}
2022-03-03 19:54:54.277688 (Thread-1017): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:54.894767 (ThreadPoolExecutor-0_0): 19:54:54  SQL status: SUCCESS 8 in 0.95 seconds
2022-03-03 19:54:54.896916 (ThreadPoolExecutor-0_0): 19:54:54  On list_DBT_RAW: Close
2022-03-03 19:54:55.126221 (ThreadPoolExecutor-2_0): 19:54:55  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:54:55.185331 (ThreadPoolExecutor-2_0): 19:54:55  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:54:55.185480 (ThreadPoolExecutor-2_0): 19:54:55  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:54:55.185575 (ThreadPoolExecutor-2_0): 19:54:55  Opening a new connection, currently in state closed
2022-03-03 19:54:55.875295 (ThreadPoolExecutor-2_0): 19:54:55  SQL status: SUCCESS 34 in 0.69 seconds
2022-03-03 19:54:55.877525 (ThreadPoolExecutor-2_0): 19:54:55  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:54:56.069617 (Thread-1018): handling poll request
2022-03-03 19:54:56.069952 (Thread-1018): 19:54:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8b5160>]}
2022-03-03 19:54:56.070534 (Thread-1018): sending response (<Response 2916 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:56.266408 (MainThread): 19:54:56  Concurrency: 4 threads (target='default')
2022-03-03 19:54:56.266586 (MainThread): 19:54:56  
2022-03-03 19:54:56.269461 (Thread-3): 19:54:56  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:54:56.269782 (Thread-3): 19:54:56  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:54:56.270054 (Thread-3): 19:54:56  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:54:56.270157 (Thread-3): 19:54:56  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:54:56.270269 (Thread-3): 19:54:56  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:54:56.276189 (Thread-3): 19:54:56  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:54:56.290970 (Thread-3): 19:54:56  finished collecting timing info
2022-03-03 19:54:56.291148 (Thread-3): 19:54:56  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:54:56.315906 (Thread-3): 19:54:56  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:54:56.332720 (Thread-3): 19:54:56  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:54:56.332882 (Thread-3): 19:54:56  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:54:56.332976 (Thread-3): 19:54:56  Opening a new connection, currently in state closed
2022-03-03 19:54:57.866422 (Thread-1019): handling poll request
2022-03-03 19:54:57.866765 (Thread-1019): 19:54:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae825490>]}
2022-03-03 19:54:57.867480 (Thread-1019): sending response (<Response 8580 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:54:59.627388 (Thread-1020): handling poll request
2022-03-03 19:54:59.627733 (Thread-1020): 19:54:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44798b0>]}
2022-03-03 19:54:59.628227 (Thread-1020): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:00.945467 (Thread-3): 19:55:00  SQL status: SUCCESS 1 in 4.61 seconds
2022-03-03 19:55:00.954923 (Thread-3): 19:55:00  finished collecting timing info
2022-03-03 19:55:00.955098 (Thread-3): 19:55:00  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:55:01.314813 (Thread-3): 19:55:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab2767c-0071-489e-9200-cc7440f9a5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5ddd61f0>]}
2022-03-03 19:55:01.315351 (Thread-3): 19:55:01  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 5.04s]
2022-03-03 19:55:01.315540 (Thread-3): 19:55:01  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:55:01.316507 (Thread-5): 19:55:01  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:01.316820 (Thread-5): 19:55:01  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:55:01.317120 (Thread-5): 19:55:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:01.317225 (Thread-5): 19:55:01  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:01.317356 (Thread-5): 19:55:01  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:01.353530 (Thread-5): 19:55:01  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:01.353736 (Thread-5): 19:55:01  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:55:01.353833 (Thread-5): 19:55:01  Opening a new connection, currently in state init
2022-03-03 19:55:01.401124 (Thread-1021): handling poll request
2022-03-03 19:55:01.401520 (Thread-1021): 19:55:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afaef100>]}
2022-03-03 19:55:01.402249 (Thread-1021): sending response (<Response 6487 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:02.456908 (Thread-5): 19:55:02  SQL status: SUCCESS 5 in 1.1 seconds
2022-03-03 19:55:02.486086 (Thread-5): 19:55:02  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:02.486313 (Thread-5): 19:55:02  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:55:02.637411 (Thread-5): 19:55:02  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 19:55:02.671314 (Thread-5): 19:55:02  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:02.684523 (Thread-5): 19:55:02  finished collecting timing info
2022-03-03 19:55:02.684727 (Thread-5): 19:55:02  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:02.703657 (Thread-5): 19:55:02  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:02.719668 (Thread-5): 19:55:02  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:02.719790 (Thread-5): 19:55:02  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:55:03.159078 (Thread-1022): handling poll request
2022-03-03 19:55:03.159426 (Thread-1022): 19:55:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefb64c0>]}
2022-03-03 19:55:03.160052 (Thread-1022): sending response (<Response 6329 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:04.674436 (Thread-5): 19:55:04  SQL status: SUCCESS 1 in 1.95 seconds
2022-03-03 19:55:04.676535 (Thread-5): 19:55:04  finished collecting timing info
2022-03-03 19:55:04.676808 (Thread-5): 19:55:04  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:55:04.956777 (Thread-5): 19:55:04  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab2767c-0071-489e-9200-cc7440f9a5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5c151fa0>]}
2022-03-03 19:55:04.957229 (Thread-5): 19:55:04  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 3.64s]
2022-03-03 19:55:04.957365 (Thread-5): 19:55:04  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:04.958452 (Thread-4): 19:55:04  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:55:04.958712 (Thread-4): 19:55:04  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:55:04.959044 (Thread-4): 19:55:04  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:55:04.959145 (Thread-4): 19:55:04  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:55:04.959235 (Thread-4): 19:55:04  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:55:05.041942 (Thread-4): 19:55:05  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:55:05.055110 (Thread-4): 19:55:05  finished collecting timing info
2022-03-03 19:55:05.055292 (Thread-4): 19:55:05  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:55:05.078804 (Thread-4): 19:55:05  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:55:05.092469 (Thread-4): 19:55:05  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:55:05.092604 (Thread-4): 19:55:05  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:55:05.092728 (Thread-4): 19:55:05  Opening a new connection, currently in state init
2022-03-03 19:55:05.874183 (Thread-1023): handling poll request
2022-03-03 19:55:05.874524 (Thread-1023): 19:55:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefb6580>]}
2022-03-03 19:55:05.875255 (Thread-1023): sending response (<Response 8843 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:07.029266 (Thread-4): 19:55:07  SQL status: SUCCESS 1 in 1.94 seconds
2022-03-03 19:55:07.030846 (Thread-4): 19:55:07  finished collecting timing info
2022-03-03 19:55:07.031017 (Thread-4): 19:55:07  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:55:07.387142 (Thread-4): 19:55:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab2767c-0071-489e-9200-cc7440f9a5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5c0d7100>]}
2022-03-03 19:55:07.387580 (Thread-4): 19:55:07  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.43s]
2022-03-03 19:55:07.387711 (Thread-4): 19:55:07  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:55:07.389430 (MainThread): 19:55:07  Acquiring new snowflake connection "master"
2022-03-03 19:55:07.389774 (MainThread): 19:55:07  
2022-03-03 19:55:07.389883 (MainThread): 19:55:07  Finished running 1 table model, 1 view model, 1 incremental model in 13.46s.
2022-03-03 19:55:07.389974 (MainThread): 19:55:07  Connection 'master' was properly closed.
2022-03-03 19:55:07.390044 (MainThread): 19:55:07  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:55:07.390109 (MainThread): 19:55:07  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:55:07.390171 (MainThread): 19:55:07  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:55:07.454441 (MainThread): 19:55:07  
2022-03-03 19:55:07.454643 (MainThread): 19:55:07  Completed successfully
2022-03-03 19:55:07.454748 (MainThread): 19:55:07  
2022-03-03 19:55:07.454861 (MainThread): 19:55:07  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:55:07.622414 (Thread-1024): handling poll request
2022-03-03 19:55:07.623102 (Thread-1024): 19:55:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefb68e0>]}
2022-03-03 19:55:07.623777 (Thread-1024): sending response (<Response 6687 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:09.365215 (Thread-1025): handling poll request
2022-03-03 19:55:09.365609 (Thread-1025): 19:55:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefb6910>]}
2022-03-03 19:55:09.366761 (Thread-1025): sending response (<Response 18139 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:10.863538 (Thread-1026): handling status request
2022-03-03 19:55:10.863904 (Thread-1026): 19:55:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50afaef250>]}
2022-03-03 19:55:10.864609 (Thread-1026): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:10.869493 (Thread-1027): handling status request
2022-03-03 19:55:10.869722 (Thread-1027): 19:55:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8a7d30>]}
2022-03-03 19:55:10.870316 (Thread-1027): sending response (<Response 8621 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:17.878892 (Thread-1028): 19:55:17  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 19:55:17.879434 (Thread-1028): 19:55:17  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:55:17.885858 (Thread-1028): 19:55:17  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:55:17.897461 (Thread-1028): 19:55:17  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 19:55:17.949496 (Thread-1028): 19:55:17  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5758b0>]}
2022-03-03 19:55:19.404964 (Thread-1029): handling status request
2022-03-03 19:55:19.405300 (Thread-1029): 19:55:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5a3a30>]}
2022-03-03 19:55:19.405782 (Thread-1029): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:19.411968 (Thread-1030): handling status request
2022-03-03 19:55:19.412206 (Thread-1030): 19:55:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5a37c0>]}
2022-03-03 19:55:19.412594 (Thread-1030): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:50.299767 (Thread-1031): handling status request
2022-03-03 19:55:50.300104 (Thread-1031): 19:55:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5a3550>]}
2022-03-03 19:55:50.300579 (Thread-1031): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:50.615370 (Thread-1032): handling status request
2022-03-03 19:55:50.615698 (Thread-1032): 19:55:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5a3250>]}
2022-03-03 19:55:50.616168 (Thread-1032): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:50.915109 (Thread-1033): handling cli_args request
2022-03-03 19:55:50.915437 (Thread-1033): 19:55:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5a3040>]}
2022-03-03 19:55:53.134080 (Thread-1033): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:53.426400 (MainThread): 19:55:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:55:53.426833 (MainThread): 19:55:53  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:55:53.434601 (MainThread): 19:55:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d2f246-5f46-4ae3-8b75-0db461870c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699823a9d0>]}
2022-03-03 19:55:53.468152 (MainThread): 19:55:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d2f246-5f46-4ae3-8b75-0db461870c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699831a790>]}
2022-03-03 19:55:53.468423 (MainThread): 19:55:53  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:55:53.470343 (MainThread): 19:55:53  
2022-03-03 19:55:53.470643 (MainThread): 19:55:53  Acquiring new snowflake connection "master"
2022-03-03 19:55:53.471533 (ThreadPoolExecutor-0_0): 19:55:53  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:55:53.485051 (ThreadPoolExecutor-0_0): 19:55:53  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:55:53.485165 (ThreadPoolExecutor-0_0): 19:55:53  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:55:53.485253 (ThreadPoolExecutor-0_0): 19:55:53  Opening a new connection, currently in state init
2022-03-03 19:55:53.935755 (Thread-1034): handling poll request
2022-03-03 19:55:53.936166 (Thread-1034): 19:55:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae8ac1f0>]}
2022-03-03 19:55:53.937240 (Thread-1034): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:54.404822 (ThreadPoolExecutor-0_0): 19:55:54  SQL status: SUCCESS 8 in 0.92 seconds
2022-03-03 19:55:54.406888 (ThreadPoolExecutor-0_0): 19:55:54  On list_DBT_RAW: Close
2022-03-03 19:55:54.750842 (ThreadPoolExecutor-2_0): 19:55:54  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:55:54.811068 (ThreadPoolExecutor-2_0): 19:55:54  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:55:54.811240 (ThreadPoolExecutor-2_0): 19:55:54  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:55:54.811348 (ThreadPoolExecutor-2_0): 19:55:54  Opening a new connection, currently in state closed
2022-03-03 19:55:55.527382 (ThreadPoolExecutor-2_0): 19:55:55  SQL status: SUCCESS 34 in 0.72 seconds
2022-03-03 19:55:55.529736 (ThreadPoolExecutor-2_0): 19:55:55  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:55:55.684190 (Thread-1035): handling poll request
2022-03-03 19:55:55.684535 (Thread-1035): 19:55:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae5a35b0>]}
2022-03-03 19:55:55.685150 (Thread-1035): sending response (<Response 2916 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:55.769032 (MainThread): 19:55:55  Concurrency: 4 threads (target='default')
2022-03-03 19:55:55.769211 (MainThread): 19:55:55  
2022-03-03 19:55:55.772046 (Thread-3): 19:55:55  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:55:55.772379 (Thread-3): 19:55:55  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 19:55:55.772683 (Thread-3): 19:55:55  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:55:55.772800 (Thread-3): 19:55:55  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:55:55.772912 (Thread-3): 19:55:55  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:55:55.778928 (Thread-3): 19:55:55  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:55:55.791270 (Thread-3): 19:55:55  finished collecting timing info
2022-03-03 19:55:55.791436 (Thread-3): 19:55:55  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:55:55.815752 (Thread-3): 19:55:55  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:55:55.831707 (Thread-3): 19:55:55  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 19:55:55.831839 (Thread-3): 19:55:55  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 19:55:55.831928 (Thread-3): 19:55:55  Opening a new connection, currently in state closed
2022-03-03 19:55:57.454937 (Thread-1036): handling poll request
2022-03-03 19:55:57.455285 (Thread-1036): 19:55:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e44c03d0>]}
2022-03-03 19:55:57.456040 (Thread-1036): sending response (<Response 8580 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:55:59.754736 (Thread-3): 19:55:59  SQL status: SUCCESS 1 in 3.92 seconds
2022-03-03 19:55:59.765680 (Thread-3): 19:55:59  finished collecting timing info
2022-03-03 19:55:59.765864 (Thread-3): 19:55:59  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 19:55:59.978341 (Thread-3): 19:55:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d2f246-5f46-4ae3-8b75-0db461870c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699823aa00>]}
2022-03-03 19:55:59.978795 (Thread-3): 19:55:59  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 4.21s]
2022-03-03 19:55:59.978929 (Thread-3): 19:55:59  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 19:55:59.979957 (Thread-5): 19:55:59  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:59.980227 (Thread-5): 19:55:59  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 19:55:59.980513 (Thread-5): 19:55:59  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:55:59.980611 (Thread-5): 19:55:59  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:55:59.980740 (Thread-5): 19:55:59  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:56:00.015411 (Thread-5): 19:56:00  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:56:00.015568 (Thread-5): 19:56:00  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:56:00.015666 (Thread-5): 19:56:00  Opening a new connection, currently in state init
2022-03-03 19:56:00.795698 (Thread-5): 19:56:00  SQL status: SUCCESS 5 in 0.78 seconds
2022-03-03 19:56:00.824222 (Thread-5): 19:56:00  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:56:00.824376 (Thread-5): 19:56:00  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 19:56:00.983461 (Thread-5): 19:56:00  SQL status: SUCCESS 5 in 0.16 seconds
2022-03-03 19:56:01.016062 (Thread-5): 19:56:01  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:56:01.028564 (Thread-5): 19:56:01  finished collecting timing info
2022-03-03 19:56:01.028769 (Thread-5): 19:56:01  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:56:01.046646 (Thread-1037): handling poll request
2022-03-03 19:56:01.046941 (Thread-1037): 19:56:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae55e130>]}
2022-03-03 19:56:01.047788 (Thread-1037): sending response (<Response 9414 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:56:01.047152 (Thread-5): 19:56:01  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:56:01.063500 (Thread-5): 19:56:01  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 19:56:01.063628 (Thread-5): 19:56:01  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 19:56:01.361887 (Thread-5): 19:56:01  SQL status: SUCCESS 1 in 0.3 seconds
2022-03-03 19:56:01.363322 (Thread-5): 19:56:01  finished collecting timing info
2022-03-03 19:56:01.363489 (Thread-5): 19:56:01  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 19:56:01.607845 (Thread-5): 19:56:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d2f246-5f46-4ae3-8b75-0db461870c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69905ee3d0>]}
2022-03-03 19:56:01.608298 (Thread-5): 19:56:01  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 1.63s]
2022-03-03 19:56:01.608441 (Thread-5): 19:56:01  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 19:56:01.609399 (Thread-4): 19:56:01  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:56:01.609659 (Thread-4): 19:56:01  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:56:01.609949 (Thread-4): 19:56:01  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:56:01.610045 (Thread-4): 19:56:01  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:56:01.610135 (Thread-4): 19:56:01  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:56:01.691934 (Thread-4): 19:56:01  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:56:01.704703 (Thread-4): 19:56:01  finished collecting timing info
2022-03-03 19:56:01.704885 (Thread-4): 19:56:01  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:56:01.729416 (Thread-4): 19:56:01  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:56:01.743405 (Thread-4): 19:56:01  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:56:01.743548 (Thread-4): 19:56:01  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:56:01.743644 (Thread-4): 19:56:01  Opening a new connection, currently in state init
2022-03-03 19:56:03.107716 (Thread-1038): handling poll request
2022-03-03 19:56:03.108063 (Thread-1038): 19:56:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aedac130>]}
2022-03-03 19:56:03.108939 (Thread-1038): sending response (<Response 11911 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:56:03.439421 (Thread-4): 19:56:03  SQL status: SUCCESS 1 in 1.7 seconds
2022-03-03 19:56:03.441069 (Thread-4): 19:56:03  finished collecting timing info
2022-03-03 19:56:03.441284 (Thread-4): 19:56:03  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:56:03.870279 (Thread-4): 19:56:03  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d2f246-5f46-4ae3-8b75-0db461870c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69905ac190>]}
2022-03-03 19:56:03.870712 (Thread-4): 19:56:03  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.26s]
2022-03-03 19:56:03.870844 (Thread-4): 19:56:03  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:56:03.872605 (MainThread): 19:56:03  Acquiring new snowflake connection "master"
2022-03-03 19:56:03.872994 (MainThread): 19:56:03  
2022-03-03 19:56:03.873119 (MainThread): 19:56:03  Finished running 1 table model, 1 view model, 1 incremental model in 10.40s.
2022-03-03 19:56:03.873210 (MainThread): 19:56:03  Connection 'master' was properly closed.
2022-03-03 19:56:03.873279 (MainThread): 19:56:03  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 19:56:03.873345 (MainThread): 19:56:03  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 19:56:03.873410 (MainThread): 19:56:03  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:56:03.939144 (MainThread): 19:56:03  
2022-03-03 19:56:03.939367 (MainThread): 19:56:03  Completed successfully
2022-03-03 19:56:03.939477 (MainThread): 19:56:03  
2022-03-03 19:56:03.939574 (MainThread): 19:56:03  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 19:56:05.085062 (Thread-1039): handling poll request
2022-03-03 19:56:05.085396 (Thread-1039): 19:56:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af317640>]}
2022-03-03 19:56:05.086968 (Thread-1039): sending response (<Response 23363 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:56:06.490484 (Thread-1040): handling status request
2022-03-03 19:56:06.490832 (Thread-1040): 19:56:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af326f70>]}
2022-03-03 19:56:06.491367 (Thread-1040): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:56:06.496617 (Thread-1041): handling status request
2022-03-03 19:56:06.496879 (Thread-1041): 19:56:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aeae2d30>]}
2022-03-03 19:56:06.497270 (Thread-1041): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:43.703148 (Thread-1042): handling status request
2022-03-03 19:57:43.704995 (Thread-1042): 19:57:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae57d6a0>]}
2022-03-03 19:57:43.731587 (Thread-1042): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:44.493557 (Thread-1043): handling cli_args request
2022-03-03 19:57:44.493894 (Thread-1043): 19:57:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aedb0640>]}
2022-03-03 19:57:44.523338 (Thread-1044): handling status request
2022-03-03 19:57:44.526741 (Thread-1044): 19:57:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af317ac0>]}
2022-03-03 19:57:44.528262 (Thread-1044): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:46.777474 (Thread-1043): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:47.140815 (MainThread): 19:57:47  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:57:47.141259 (MainThread): 19:57:47  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:57:47.149066 (MainThread): 19:57:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c02087a9-1415-479d-ad70-5612ec35108e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1887b9a00>]}
2022-03-03 19:57:47.181175 (MainThread): 19:57:47  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c02087a9-1415-479d-ad70-5612ec35108e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18889a7c0>]}
2022-03-03 19:57:47.181506 (MainThread): 19:57:47  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:57:47.183397 (MainThread): 19:57:47  
2022-03-03 19:57:47.183750 (MainThread): 19:57:47  Acquiring new snowflake connection "master"
2022-03-03 19:57:47.184702 (ThreadPoolExecutor-0_0): 19:57:47  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:57:47.198746 (ThreadPoolExecutor-0_0): 19:57:47  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:57:47.198866 (ThreadPoolExecutor-0_0): 19:57:47  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:57:47.198951 (ThreadPoolExecutor-0_0): 19:57:47  Opening a new connection, currently in state init
2022-03-03 19:57:47.509233 (Thread-1045): handling poll request
2022-03-03 19:57:47.509628 (Thread-1045): 19:57:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50af317c70>]}
2022-03-03 19:57:47.510346 (Thread-1045): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:48.192781 (ThreadPoolExecutor-0_0): 19:57:48  SQL status: SUCCESS 8 in 0.99 seconds
2022-03-03 19:57:48.194860 (ThreadPoolExecutor-0_0): 19:57:48  On list_DBT_RAW: Close
2022-03-03 19:57:48.432969 (ThreadPoolExecutor-2_0): 19:57:48  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:57:48.498724 (ThreadPoolExecutor-2_0): 19:57:48  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:57:48.498887 (ThreadPoolExecutor-2_0): 19:57:48  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:57:48.498984 (ThreadPoolExecutor-2_0): 19:57:48  Opening a new connection, currently in state closed
2022-03-03 19:57:49.520970 (ThreadPoolExecutor-2_0): 19:57:49  SQL status: SUCCESS 34 in 1.02 seconds
2022-03-03 19:57:49.523213 (ThreadPoolExecutor-2_0): 19:57:49  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:57:49.721104 (MainThread): 19:57:49  Concurrency: 4 threads (target='default')
2022-03-03 19:57:49.721292 (MainThread): 19:57:49  
2022-03-03 19:57:49.724156 (Thread-3): 19:57:49  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:57:49.724710 (Thread-3): 19:57:49  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:57:49.725186 (Thread-3): 19:57:49  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:49.725331 (Thread-3): 19:57:49  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:57:49.725453 (Thread-3): 19:57:49  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:57:49.826655 (Thread-3): 19:57:49  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:49.840855 (Thread-3): 19:57:49  finished collecting timing info
2022-03-03 19:57:49.841060 (Thread-3): 19:57:49  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:57:49.883209 (Thread-3): 19:57:49  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:49.883369 (Thread-3): 19:57:49  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:57:49.883464 (Thread-3): 19:57:49  Opening a new connection, currently in state closed
2022-03-03 19:57:50.222899 (Thread-1046): handling poll request
2022-03-03 19:57:50.223272 (Thread-1046): 19:57:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefb7ac0>]}
2022-03-03 19:57:50.224045 (Thread-1046): sending response (<Response 9965 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:51.984923 (Thread-1047): handling poll request
2022-03-03 19:57:51.985259 (Thread-1047): 19:57:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefae3a0>]}
2022-03-03 19:57:51.985736 (Thread-1047): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:52.680499 (Thread-3): 19:57:52  SQL status: SUCCESS 1 in 2.8 seconds
2022-03-03 19:57:52.692976 (Thread-3): 19:57:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:52.693181 (Thread-3): 19:57:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:57:52.839819 (Thread-3): 19:57:52  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 19:57:52.843807 (Thread-3): 19:57:52  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:52.843931 (Thread-3): 19:57:52  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:57:53.209967 (Thread-3): 19:57:53  SQL status: SUCCESS 10 in 0.37 seconds
2022-03-03 19:57:53.218310 (Thread-3): 19:57:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:53.218444 (Thread-3): 19:57:53  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:57:53.369031 (Thread-3): 19:57:53  SQL status: SUCCESS 10 in 0.15 seconds
2022-03-03 19:57:53.390119 (Thread-3): 19:57:53  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:53.406144 (Thread-3): 19:57:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:53.406300 (Thread-3): 19:57:53  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:57:53.572155 (Thread-3): 19:57:53  SQL status: SUCCESS 1 in 0.17 seconds
2022-03-03 19:57:53.572407 (Thread-3): 19:57:53  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:53.572495 (Thread-3): 19:57:53  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:57:53.737319 (Thread-1048): handling poll request
2022-03-03 19:57:53.737651 (Thread-1048): 19:57:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae56b4c0>]}
2022-03-03 19:57:53.738300 (Thread-1048): sending response (<Response 8388 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:55.080965 (Thread-3): 19:57:55  SQL status: SUCCESS 1 in 1.51 seconds
2022-03-03 19:57:55.081163 (Thread-3): 19:57:55  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:57:55.081247 (Thread-3): 19:57:55  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:57:55.420568 (Thread-3): 19:57:55  SQL status: SUCCESS 1 in 0.34 seconds
2022-03-03 19:57:55.431491 (Thread-3): 19:57:55  finished collecting timing info
2022-03-03 19:57:55.431696 (Thread-3): 19:57:55  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:57:55.508550 (Thread-1049): handling poll request
2022-03-03 19:57:55.508930 (Thread-1049): 19:57:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae56b970>]}
2022-03-03 19:57:55.509474 (Thread-1049): sending response (<Response 2599 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:55.698705 (Thread-3): 19:57:55  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c02087a9-1415-479d-ad70-5612ec35108e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1887620d0>]}
2022-03-03 19:57:55.699541 (Thread-3): 19:57:55  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 5.97s]
2022-03-03 19:57:55.699783 (Thread-3): 19:57:55  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:57:55.701490 (MainThread): 19:57:55  Acquiring new snowflake connection "master"
2022-03-03 19:57:55.701862 (MainThread): 19:57:55  
2022-03-03 19:57:55.701971 (MainThread): 19:57:55  Finished running 1 incremental model in 8.52s.
2022-03-03 19:57:55.702072 (MainThread): 19:57:55  Connection 'master' was properly closed.
2022-03-03 19:57:55.702156 (MainThread): 19:57:55  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:57:55.767662 (MainThread): 19:57:55  
2022-03-03 19:57:55.767885 (MainThread): 19:57:55  Completed successfully
2022-03-03 19:57:55.767987 (MainThread): 19:57:55  
2022-03-03 19:57:55.768085 (MainThread): 19:57:55  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:57:57.277451 (Thread-1050): handling poll request
2022-03-03 19:57:57.277784 (Thread-1050): 19:57:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4d52e0>]}
2022-03-03 19:57:57.278797 (Thread-1050): sending response (<Response 10142 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:58.707686 (Thread-1051): handling status request
2022-03-03 19:57:58.708024 (Thread-1051): 19:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4d5490>]}
2022-03-03 19:57:58.708519 (Thread-1051): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:57:58.792580 (Thread-1052): handling status request
2022-03-03 19:57:58.792953 (Thread-1052): 19:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4d5880>]}
2022-03-03 19:57:58.793431 (Thread-1052): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:22.851324 (Thread-1053): handling status request
2022-03-03 19:58:22.851660 (Thread-1053): 19:58:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4d5ac0>]}
2022-03-03 19:58:22.852462 (Thread-1053): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:23.144337 (Thread-1054): handling status request
2022-03-03 19:58:23.144735 (Thread-1054): 19:58:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aedb0d90>]}
2022-03-03 19:58:23.145282 (Thread-1054): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:23.457002 (Thread-1055): handling cli_args request
2022-03-03 19:58:23.457347 (Thread-1055): 19:58:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aefb7370>]}
2022-03-03 19:58:25.694084 (Thread-1055): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:25.987321 (MainThread): 19:58:25  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 19:58:25.987759 (MainThread): 19:58:25  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 19:58:25.995524 (MainThread): 19:58:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e016857-acfb-41f2-99df-95c5b7f841fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07aef99a0>]}
2022-03-03 19:58:26.031906 (MainThread): 19:58:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e016857-acfb-41f2-99df-95c5b7f841fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07afd4760>]}
2022-03-03 19:58:26.032266 (MainThread): 19:58:26  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 19:58:26.034142 (MainThread): 19:58:26  
2022-03-03 19:58:26.034479 (MainThread): 19:58:26  Acquiring new snowflake connection "master"
2022-03-03 19:58:26.035374 (ThreadPoolExecutor-0_0): 19:58:26  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 19:58:26.049243 (ThreadPoolExecutor-0_0): 19:58:26  Using snowflake connection "list_DBT_RAW"
2022-03-03 19:58:26.049376 (ThreadPoolExecutor-0_0): 19:58:26  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 19:58:26.049464 (ThreadPoolExecutor-0_0): 19:58:26  Opening a new connection, currently in state init
2022-03-03 19:58:26.442131 (Thread-1056): handling poll request
2022-03-03 19:58:26.442571 (Thread-1056): 19:58:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae56bf10>]}
2022-03-03 19:58:26.443661 (Thread-1056): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:27.246868 (ThreadPoolExecutor-0_0): 19:58:27  SQL status: SUCCESS 8 in 1.2 seconds
2022-03-03 19:58:27.248986 (ThreadPoolExecutor-0_0): 19:58:27  On list_DBT_RAW: Close
2022-03-03 19:58:27.484166 (ThreadPoolExecutor-2_0): 19:58:27  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:58:27.549562 (ThreadPoolExecutor-2_0): 19:58:27  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 19:58:27.549728 (ThreadPoolExecutor-2_0): 19:58:27  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 19:58:27.549829 (ThreadPoolExecutor-2_0): 19:58:27  Opening a new connection, currently in state closed
2022-03-03 19:58:28.178987 (Thread-1057): handling poll request
2022-03-03 19:58:28.179349 (Thread-1057): 19:58:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae572490>]}
2022-03-03 19:58:28.179912 (Thread-1057): sending response (<Response 2314 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:28.205996 (ThreadPoolExecutor-2_0): 19:58:28  SQL status: SUCCESS 34 in 0.66 seconds
2022-03-03 19:58:28.208404 (ThreadPoolExecutor-2_0): 19:58:28  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 19:58:28.398096 (MainThread): 19:58:28  Concurrency: 4 threads (target='default')
2022-03-03 19:58:28.398272 (MainThread): 19:58:28  
2022-03-03 19:58:28.401215 (Thread-3): 19:58:28  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:58:28.401525 (Thread-3): 19:58:28  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 19:58:28.401847 (Thread-3): 19:58:28  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:28.401973 (Thread-3): 19:58:28  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:58:28.402098 (Thread-3): 19:58:28  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:58:28.491897 (Thread-3): 19:58:28  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:28.503361 (Thread-3): 19:58:28  finished collecting timing info
2022-03-03 19:58:28.503560 (Thread-3): 19:58:28  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:58:28.545300 (Thread-3): 19:58:28  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:28.545462 (Thread-3): 19:58:28  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 19:58:28.545557 (Thread-3): 19:58:28  Opening a new connection, currently in state closed
2022-03-03 19:58:30.915195 (Thread-1058): handling poll request
2022-03-03 19:58:30.915558 (Thread-1058): 19:58:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4e1820>]}
2022-03-03 19:58:30.916243 (Thread-1058): sending response (<Response 7966 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:31.898043 (Thread-3): 19:58:31  SQL status: SUCCESS 1 in 3.35 seconds
2022-03-03 19:58:31.907457 (Thread-3): 19:58:31  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:31.907604 (Thread-3): 19:58:31  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 19:58:32.272176 (Thread-3): 19:58:32  SQL status: SUCCESS 10 in 0.36 seconds
2022-03-03 19:58:32.276177 (Thread-3): 19:58:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:32.276294 (Thread-3): 19:58:32  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 19:58:32.456495 (Thread-3): 19:58:32  SQL status: SUCCESS 10 in 0.18 seconds
2022-03-03 19:58:32.464947 (Thread-3): 19:58:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:32.465085 (Thread-3): 19:58:32  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 19:58:32.608624 (Thread-3): 19:58:32  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 19:58:32.630121 (Thread-3): 19:58:32  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:32.643597 (Thread-3): 19:58:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:32.643742 (Thread-3): 19:58:32  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 19:58:32.706003 (Thread-1059): handling poll request
2022-03-03 19:58:32.706314 (Thread-1059): 19:58:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4f3400>]}
2022-03-03 19:58:32.706908 (Thread-1059): sending response (<Response 5952 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:32.936990 (Thread-3): 19:58:32  SQL status: SUCCESS 1 in 0.29 seconds
2022-03-03 19:58:32.937247 (Thread-3): 19:58:32  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:32.937346 (Thread-3): 19:58:32  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 19:58:34.469197 (Thread-1060): handling poll request
2022-03-03 19:58:34.469544 (Thread-1060): 19:58:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4f3f40>]}
2022-03-03 19:58:34.470078 (Thread-1060): sending response (<Response 2754 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:34.494962 (Thread-3): 19:58:34  SQL status: SUCCESS 2 in 1.56 seconds
2022-03-03 19:58:34.495164 (Thread-3): 19:58:34  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 19:58:34.495250 (Thread-3): 19:58:34  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 19:58:34.928917 (Thread-3): 19:58:34  SQL status: SUCCESS 1 in 0.43 seconds
2022-03-03 19:58:34.939716 (Thread-3): 19:58:34  finished collecting timing info
2022-03-03 19:58:34.939901 (Thread-3): 19:58:34  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 19:58:35.323463 (Thread-3): 19:58:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e016857-acfb-41f2-99df-95c5b7f841fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0821e0cd0>]}
2022-03-03 19:58:35.323915 (Thread-3): 19:58:35  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.92s]
2022-03-03 19:58:35.324048 (Thread-3): 19:58:35  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 19:58:35.325894 (MainThread): 19:58:35  Acquiring new snowflake connection "master"
2022-03-03 19:58:35.326304 (MainThread): 19:58:35  
2022-03-03 19:58:35.326414 (MainThread): 19:58:35  Finished running 1 incremental model in 9.29s.
2022-03-03 19:58:35.326505 (MainThread): 19:58:35  Connection 'master' was properly closed.
2022-03-03 19:58:35.326575 (MainThread): 19:58:35  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 19:58:35.394449 (MainThread): 19:58:35  
2022-03-03 19:58:35.394657 (MainThread): 19:58:35  Completed successfully
2022-03-03 19:58:35.394759 (MainThread): 19:58:35  
2022-03-03 19:58:35.394853 (MainThread): 19:58:35  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 19:58:36.220373 (Thread-1061): handling poll request
2022-03-03 19:58:36.220780 (Thread-1061): 19:58:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae53ab20>]}
2022-03-03 19:58:36.221836 (Thread-1061): sending response (<Response 12425 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:37.679837 (Thread-1062): handling status request
2022-03-03 19:58:37.680170 (Thread-1062): 19:58:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae53aca0>]}
2022-03-03 19:58:37.680754 (Thread-1062): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 19:58:37.861413 (Thread-1063): handling status request
2022-03-03 19:58:37.861736 (Thread-1063): 19:58:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae53af70>]}
2022-03-03 19:58:37.862204 (Thread-1063): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:11.691154 (Thread-1064): handling status request
2022-03-03 20:02:11.692887 (Thread-1064): 20:02:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae53af10>]}
2022-03-03 20:02:11.693431 (Thread-1064): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:12.489896 (Thread-1065): handling cli_args request
2022-03-03 20:02:12.490234 (Thread-1065): 20:02:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae52f940>]}
2022-03-03 20:02:12.518608 (Thread-1066): handling status request
2022-03-03 20:02:12.523158 (Thread-1066): 20:02:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae505310>]}
2022-03-03 20:02:12.524840 (Thread-1066): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:14.758805 (Thread-1065): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:15.128737 (MainThread): 20:02:15  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 20:02:15.129169 (MainThread): 20:02:15  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 20:02:15.137003 (MainThread): 20:02:15  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef56308b-b3cd-4f55-a319-f0fc0a540cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5f5fa910>]}
2022-03-03 20:02:15.167196 (MainThread): 20:02:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef56308b-b3cd-4f55-a319-f0fc0a540cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5f6d46d0>]}
2022-03-03 20:02:15.167511 (MainThread): 20:02:15  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 20:02:15.169532 (MainThread): 20:02:15  
2022-03-03 20:02:15.169837 (MainThread): 20:02:15  Acquiring new snowflake connection "master"
2022-03-03 20:02:15.170727 (ThreadPoolExecutor-0_0): 20:02:15  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 20:02:15.184490 (ThreadPoolExecutor-0_0): 20:02:15  Using snowflake connection "list_DBT_RAW"
2022-03-03 20:02:15.184594 (ThreadPoolExecutor-0_0): 20:02:15  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 20:02:15.184741 (ThreadPoolExecutor-0_0): 20:02:15  Opening a new connection, currently in state init
2022-03-03 20:02:15.536901 (Thread-1067): handling poll request
2022-03-03 20:02:15.537249 (Thread-1067): 20:02:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae50aeb0>]}
2022-03-03 20:02:15.537995 (Thread-1067): sending response (<Response 4180 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:16.543894 (ThreadPoolExecutor-0_0): 20:02:16  SQL status: SUCCESS 8 in 1.36 seconds
2022-03-03 20:02:16.545937 (ThreadPoolExecutor-0_0): 20:02:16  On list_DBT_RAW: Close
2022-03-03 20:02:16.779598 (ThreadPoolExecutor-2_0): 20:02:16  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 20:02:16.841125 (ThreadPoolExecutor-2_0): 20:02:16  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 20:02:16.841280 (ThreadPoolExecutor-2_0): 20:02:16  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 20:02:16.841375 (ThreadPoolExecutor-2_0): 20:02:16  Opening a new connection, currently in state closed
2022-03-03 20:02:17.534134 (ThreadPoolExecutor-2_0): 20:02:17  SQL status: SUCCESS 34 in 0.69 seconds
2022-03-03 20:02:17.536315 (ThreadPoolExecutor-2_0): 20:02:17  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 20:02:17.772300 (MainThread): 20:02:17  Concurrency: 4 threads (target='default')
2022-03-03 20:02:17.772478 (MainThread): 20:02:17  
2022-03-03 20:02:17.775394 (Thread-3): 20:02:17  Began running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 20:02:17.775713 (Thread-3): 20:02:17  1 of 3 START table model DBT_VAULT.raw_customers................................ [RUN]
2022-03-03 20:02:17.775991 (Thread-3): 20:02:17  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 20:02:17.776095 (Thread-3): 20:02:17  Began compiling node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 20:02:17.776204 (Thread-3): 20:02:17  Compiling model.dbtvault_snowflake_demo.raw_customers
2022-03-03 20:02:17.782133 (Thread-3): 20:02:17  Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 20:02:17.796831 (Thread-3): 20:02:17  finished collecting timing info
2022-03-03 20:02:17.797003 (Thread-3): 20:02:17  Began executing node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 20:02:17.821307 (Thread-3): 20:02:17  Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 20:02:17.837686 (Thread-3): 20:02:17  Using snowflake connection "model.dbtvault_snowflake_demo.raw_customers"
2022-03-03 20:02:17.837854 (Thread-3): 20:02:17  On model.dbtvault_snowflake_demo.raw_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.raw_customers"} */


      create or replace  table DBT_RAW.DBT_VAULT.raw_customers  as
      (

SELECT DISTINCT
ORDERDATE,
CUSTOMERKEY,
CUSTOMER_NAME,
CUSTOMER_ADDRESS,
CUSTOMER_PHONE
FROM (
SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM DBT_RAW.TPCH_SF1.ORDERS AS b
LEFT JOIN DBT_RAW.TPCH_SF1.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN DBT_RAW.TPCH_SF1.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN DBT_RAW.TPCH_SF1.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN DBT_RAW.TPCH_SF1.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN DBT_RAW.TPCH_SF1.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08'))
      );
2022-03-03 20:02:17.838012 (Thread-3): 20:02:17  Opening a new connection, currently in state closed
2022-03-03 20:02:18.107757 (Thread-1068): handling poll request
2022-03-03 20:02:18.108088 (Thread-1068): 20:02:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae512190>]}
2022-03-03 20:02:18.108876 (Thread-1068): sending response (<Response 11163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:20.111280 (Thread-1069): handling poll request
2022-03-03 20:02:20.111614 (Thread-1069): 20:02:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae52f940>]}
2022-03-03 20:02:20.112123 (Thread-1069): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:22.096123 (Thread-1070): handling poll request
2022-03-03 20:02:22.096466 (Thread-1070): 20:02:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4f3b20>]}
2022-03-03 20:02:22.096958 (Thread-1070): sending response (<Response 335 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:22.699688 (Thread-3): 20:02:22  SQL status: SUCCESS 1 in 4.86 seconds
2022-03-03 20:02:22.709230 (Thread-3): 20:02:22  finished collecting timing info
2022-03-03 20:02:22.709414 (Thread-3): 20:02:22  On model.dbtvault_snowflake_demo.raw_customers: Close
2022-03-03 20:02:23.033513 (Thread-3): 20:02:23  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef56308b-b3cd-4f55-a319-f0fc0a540cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5f6d4220>]}
2022-03-03 20:02:23.033970 (Thread-3): 20:02:23  1 of 3 OK created table model DBT_VAULT.raw_customers........................... [SUCCESS 1 in 5.26s]
2022-03-03 20:02:23.034105 (Thread-3): 20:02:23  Finished running node model.dbtvault_snowflake_demo.raw_customers
2022-03-03 20:02:23.035253 (Thread-5): 20:02:23  Began running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 20:02:23.035501 (Thread-5): 20:02:23  2 of 3 START view model DBT_VAULT.v_stg_customer_demo........................... [RUN]
2022-03-03 20:02:23.035802 (Thread-5): 20:02:23  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 20:02:23.035898 (Thread-5): 20:02:23  Began compiling node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 20:02:23.035993 (Thread-5): 20:02:23  Compiling model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 20:02:23.071834 (Thread-5): 20:02:23  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 20:02:23.072001 (Thread-5): 20:02:23  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 20:02:23.072095 (Thread-5): 20:02:23  Opening a new connection, currently in state init
2022-03-03 20:02:23.938922 (Thread-5): 20:02:23  SQL status: SUCCESS 5 in 0.87 seconds
2022-03-03 20:02:23.968216 (Thread-5): 20:02:23  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 20:02:23.968376 (Thread-5): 20:02:23  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.raw_customers
2022-03-03 20:02:24.104258 (Thread-1071): handling poll request
2022-03-03 20:02:24.104624 (Thread-1071): 20:02:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae52a160>]}
2022-03-03 20:02:24.105357 (Thread-1071): sending response (<Response 7814 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:24.121838 (Thread-5): 20:02:24  SQL status: SUCCESS 5 in 0.15 seconds
2022-03-03 20:02:24.156423 (Thread-5): 20:02:24  Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 20:02:24.170218 (Thread-5): 20:02:24  finished collecting timing info
2022-03-03 20:02:24.170446 (Thread-5): 20:02:24  Began executing node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 20:02:24.190238 (Thread-5): 20:02:24  Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 20:02:24.205421 (Thread-5): 20:02:24  Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_customer_demo"
2022-03-03 20:02:24.205584 (Thread-5): 20:02:24  On model.dbtvault_snowflake_demo.v_stg_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.v_stg_customer_demo"} */

  create or replace  view DBT_RAW.DBT_VAULT.v_stg_customer_demo 
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE

    FROM DBT_RAW.DBT_VAULT.raw_customers
),

derived_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM,
    NVL(LAG(ORDERDATE) OVER (PARTITION BY CUSTOMERKEY ORDER BY ORDERDATE DESC),TO_DATE('12/31/9999')) AS EFFECTIVE_TO

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,

    CAST((SHA2_BINARY(NULLIF(UPPER(TRIM(CAST(CUSTOMERKEY AS VARCHAR))), ''))) AS BINARY(32)) AS CUSTOMER_PK,
    CAST(SHA2_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS VARCHAR))), ''), '^^')
    )) AS BINARY(32)) AS CUSTOMER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERDATE,
    CUSTOMERKEY,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_PHONE,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    EFFECTIVE_TO,
    CUSTOMER_PK,
    CUSTOMER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE(CURRENT_TIMESTAMP()) AS LOAD_DATE
FROM staging
  );
2022-03-03 20:02:25.247915 (Thread-5): 20:02:25  SQL status: SUCCESS 1 in 1.04 seconds
2022-03-03 20:02:25.249450 (Thread-5): 20:02:25  finished collecting timing info
2022-03-03 20:02:25.249626 (Thread-5): 20:02:25  On model.dbtvault_snowflake_demo.v_stg_customer_demo: Close
2022-03-03 20:02:25.475429 (Thread-5): 20:02:25  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef56308b-b3cd-4f55-a319-f0fc0a540cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5dfe38e0>]}
2022-03-03 20:02:25.475853 (Thread-5): 20:02:25  2 of 3 OK created view model DBT_VAULT.v_stg_customer_demo...................... [SUCCESS 1 in 2.44s]
2022-03-03 20:02:25.475985 (Thread-5): 20:02:25  Finished running node model.dbtvault_snowflake_demo.v_stg_customer_demo
2022-03-03 20:02:25.476992 (Thread-4): 20:02:25  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:02:25.477234 (Thread-4): 20:02:25  3 of 3 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 20:02:25.477526 (Thread-4): 20:02:25  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:02:25.477618 (Thread-4): 20:02:25  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:02:25.477710 (Thread-4): 20:02:25  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:02:25.560403 (Thread-4): 20:02:25  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:02:25.573084 (Thread-4): 20:02:25  finished collecting timing info
2022-03-03 20:02:25.573252 (Thread-4): 20:02:25  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:02:25.596763 (Thread-4): 20:02:25  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:02:25.610836 (Thread-4): 20:02:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:02:25.610959 (Thread-4): 20:02:25  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */


      create or replace  table DBT_RAW.DBT_VAULT.sat_customer_demo  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
2022-03-03 20:02:25.611049 (Thread-4): 20:02:25  Opening a new connection, currently in state init
2022-03-03 20:02:26.549742 (Thread-1072): handling poll request
2022-03-03 20:02:26.550097 (Thread-1072): 20:02:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae505310>]}
2022-03-03 20:02:26.576677 (Thread-1072): sending response (<Response 13512 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:27.831528 (Thread-4): 20:02:27  SQL status: SUCCESS 1 in 2.22 seconds
2022-03-03 20:02:27.833179 (Thread-4): 20:02:27  finished collecting timing info
2022-03-03 20:02:27.833350 (Thread-4): 20:02:27  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 20:02:28.049503 (Thread-4): 20:02:28  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef56308b-b3cd-4f55-a319-f0fc0a540cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5c1a8160>]}
2022-03-03 20:02:28.049955 (Thread-4): 20:02:28  3 of 3 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 2.57s]
2022-03-03 20:02:28.050087 (Thread-4): 20:02:28  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:02:28.051720 (MainThread): 20:02:28  Acquiring new snowflake connection "master"
2022-03-03 20:02:28.052058 (MainThread): 20:02:28  
2022-03-03 20:02:28.052164 (MainThread): 20:02:28  Finished running 1 table model, 1 view model, 1 incremental model in 12.88s.
2022-03-03 20:02:28.052252 (MainThread): 20:02:28  Connection 'master' was properly closed.
2022-03-03 20:02:28.052322 (MainThread): 20:02:28  Connection 'model.dbtvault_snowflake_demo.raw_customers' was properly closed.
2022-03-03 20:02:28.052390 (MainThread): 20:02:28  Connection 'model.dbtvault_snowflake_demo.v_stg_customer_demo' was properly closed.
2022-03-03 20:02:28.052456 (MainThread): 20:02:28  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 20:02:28.114040 (MainThread): 20:02:28  
2022-03-03 20:02:28.114259 (MainThread): 20:02:28  Completed successfully
2022-03-03 20:02:28.114365 (MainThread): 20:02:28  
2022-03-03 20:02:28.114459 (MainThread): 20:02:28  Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-03-03 20:02:29.102776 (Thread-1073): handling poll request
2022-03-03 20:02:29.103096 (Thread-1073): 20:02:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae496790>]}
2022-03-03 20:02:29.104340 (Thread-1073): sending response (<Response 23364 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:30.549694 (Thread-1074): handling status request
2022-03-03 20:02:30.550044 (Thread-1074): 20:02:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae496be0>]}
2022-03-03 20:02:30.550546 (Thread-1074): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:02:30.954936 (Thread-1075): handling status request
2022-03-03 20:02:30.955288 (Thread-1075): 20:02:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae496c40>]}
2022-03-03 20:02:30.955799 (Thread-1075): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:16.098579 (Thread-1076): handling status request
2022-03-03 20:18:16.100172 (Thread-1076): 20:18:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4a1580>]}
2022-03-03 20:18:16.100673 (Thread-1076): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:16.408668 (Thread-1077): handling status request
2022-03-03 20:18:16.409006 (Thread-1077): 20:18:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4a17f0>]}
2022-03-03 20:18:16.409534 (Thread-1077): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:16.718245 (Thread-1078): handling cli_args request
2022-03-03 20:18:16.718709 (Thread-1078): 20:18:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae50ad30>]}
2022-03-03 20:18:19.045163 (Thread-1078): sending response (<Response 138 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:19.651448 (MainThread): 20:18:19  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 20:18:19.652041 (MainThread): 20:18:19  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 20:18:19.662623 (MainThread): 20:18:19  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fedae64-5afd-4af8-b2c2-fd9b4409d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd2afaa00>]}
2022-03-03 20:18:19.708072 (MainThread): 20:18:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fedae64-5afd-4af8-b2c2-fd9b4409d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd2bda7c0>]}
2022-03-03 20:18:19.708407 (MainThread): 20:18:19  Found 34 models, 0 tests, 0 snapshots, 0 analyses, 462 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
2022-03-03 20:18:19.710812 (MainThread): 20:18:19  
2022-03-03 20:18:19.711302 (MainThread): 20:18:19  Acquiring new snowflake connection "master"
2022-03-03 20:18:19.712176 (ThreadPoolExecutor-0_0): 20:18:19  Acquiring new snowflake connection "list_DBT_RAW"
2022-03-03 20:18:19.725897 (ThreadPoolExecutor-0_0): 20:18:19  Using snowflake connection "list_DBT_RAW"
2022-03-03 20:18:19.726003 (ThreadPoolExecutor-0_0): 20:18:19  On list_DBT_RAW: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW"} */

    show terse schemas in database DBT_RAW
    limit 10000
2022-03-03 20:18:19.726087 (ThreadPoolExecutor-0_0): 20:18:19  Opening a new connection, currently in state init
2022-03-03 20:18:19.818725 (Thread-1079): handling poll request
2022-03-03 20:18:19.819135 (Thread-1079): 20:18:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4b5550>]}
2022-03-03 20:18:19.820192 (Thread-1079): sending response (<Response 4163 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:20.746351 (ThreadPoolExecutor-0_0): 20:18:20  SQL status: SUCCESS 8 in 1.02 seconds
2022-03-03 20:18:20.748708 (ThreadPoolExecutor-0_0): 20:18:20  On list_DBT_RAW: Close
2022-03-03 20:18:21.008872 (ThreadPoolExecutor-2_0): 20:18:21  Acquiring new snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 20:18:21.074474 (ThreadPoolExecutor-2_0): 20:18:21  Using snowflake connection "list_DBT_RAW_DBT_VAULT"
2022-03-03 20:18:21.074635 (ThreadPoolExecutor-2_0): 20:18:21  On list_DBT_RAW_DBT_VAULT: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "connection_name": "list_DBT_RAW_DBT_VAULT"} */

    show terse objects in DBT_RAW.DBT_VAULT
2022-03-03 20:18:21.074732 (ThreadPoolExecutor-2_0): 20:18:21  Opening a new connection, currently in state closed
2022-03-03 20:18:21.863197 (ThreadPoolExecutor-2_0): 20:18:21  SQL status: SUCCESS 34 in 0.79 seconds
2022-03-03 20:18:21.865480 (ThreadPoolExecutor-2_0): 20:18:21  On list_DBT_RAW_DBT_VAULT: Close
2022-03-03 20:18:22.066023 (MainThread): 20:18:22  Concurrency: 4 threads (target='default')
2022-03-03 20:18:22.066201 (MainThread): 20:18:22  
2022-03-03 20:18:22.069043 (Thread-3): 20:18:22  Began running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:18:22.069357 (Thread-3): 20:18:22  1 of 1 START incremental model DBT_VAULT.sat_customer_demo...................... [RUN]
2022-03-03 20:18:22.069625 (Thread-3): 20:18:22  Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:22.069728 (Thread-3): 20:18:22  Began compiling node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:18:22.069835 (Thread-3): 20:18:22  Compiling model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:18:22.159271 (Thread-3): 20:18:22  Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:22.178722 (Thread-3): 20:18:22  finished collecting timing info
2022-03-03 20:18:22.178923 (Thread-3): 20:18:22  Began executing node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:18:22.220626 (Thread-3): 20:18:22  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:22.220826 (Thread-3): 20:18:22  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    

      create or replace temporary table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMERKEY, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.EFFECTIVE_TO, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DBT_RAW.DBT_VAULT.v_stg_customer_demo AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

latest_records AS (

    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CUSTOMER_PK, current_records.CUSTOMER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CUSTOMER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM DBT_RAW.DBT_VAULT.sat_customer_demo AS current_records
            JOIN (
                SELECT DISTINCT source_data.CUSTOMER_PK
                FROM source_data
            ) AS source_records
                ON current_records.CUSTOMER_PK = source_records.CUSTOMER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMERKEY, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.EFFECTIVE_TO, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records.CUSTOMER_PK = stage.CUSTOMER_PK
                WHERE latest_records.CUSTOMER_HASHDIFF != stage.CUSTOMER_HASHDIFF
                OR latest_records.CUSTOMER_HASHDIFF IS NULL
)

SELECT * FROM records_to_insert
      );
2022-03-03 20:18:22.220922 (Thread-3): 20:18:22  Opening a new connection, currently in state closed
2022-03-03 20:18:22.579603 (Thread-1080): handling poll request
2022-03-03 20:18:22.579992 (Thread-1080): 20:18:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4abbb0>]}
2022-03-03 20:18:22.580841 (Thread-1080): sending response (<Response 9965 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:24.352327 (Thread-1081): handling poll request
2022-03-03 20:18:24.352702 (Thread-1081): 20:18:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae496f40>]}
2022-03-03 20:18:24.353193 (Thread-1081): sending response (<Response 318 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:25.595478 (Thread-3): 20:18:25  SQL status: SUCCESS 1 in 3.37 seconds
2022-03-03 20:18:25.605424 (Thread-3): 20:18:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:25.605583 (Thread-3): 20:18:25  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp
2022-03-03 20:18:25.746584 (Thread-3): 20:18:25  SQL status: SUCCESS 10 in 0.14 seconds
2022-03-03 20:18:25.750597 (Thread-3): 20:18:25  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:25.750720 (Thread-3): 20:18:25  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table DBT_RAW.DBT_VAULT.sat_customer_demo
2022-03-03 20:18:26.017182 (Thread-3): 20:18:26  SQL status: SUCCESS 10 in 0.27 seconds
2022-03-03 20:18:26.026039 (Thread-3): 20:18:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:26.026187 (Thread-3): 20:18:26  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */

    describe table "DBT_RAW"."DBT_VAULT"."SAT_CUSTOMER_DEMO"
2022-03-03 20:18:26.132824 (Thread-1082): handling poll request
2022-03-03 20:18:26.133157 (Thread-1082): 20:18:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4a1400>]}
2022-03-03 20:18:26.133729 (Thread-1082): sending response (<Response 4296 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:26.131716 (Thread-3): 20:18:26  SQL status: SUCCESS 10 in 0.11 seconds
2022-03-03 20:18:26.154231 (Thread-3): 20:18:26  Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:26.175528 (Thread-3): 20:18:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:26.175722 (Thread-3): 20:18:26  On model.dbtvault_snowflake_demo.sat_customer_demo: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "user", "target_name": "default", "node_id": "model.dbtvault_snowflake_demo.sat_customer_demo"} */
begin;
2022-03-03 20:18:26.355676 (Thread-3): 20:18:26  SQL status: SUCCESS 1 in 0.18 seconds
2022-03-03 20:18:26.355922 (Thread-3): 20:18:26  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:26.356009 (Thread-3): 20:18:26  On model.dbtvault_snowflake_demo.sat_customer_demo: merge into DBT_RAW.DBT_VAULT.sat_customer_demo as DBT_INTERNAL_DEST
        using DBT_RAW.DBT_VAULT.sat_customer_demo__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.CUSTOMER_HASHDIFF = DBT_INTERNAL_DEST.CUSTOMER_HASHDIFF
        

    
    when matched then update set
        "CUSTOMER_PK" = DBT_INTERNAL_SOURCE."CUSTOMER_PK","CUSTOMER_HASHDIFF" = DBT_INTERNAL_SOURCE."CUSTOMER_HASHDIFF","CUSTOMERKEY" = DBT_INTERNAL_SOURCE."CUSTOMERKEY","CUSTOMER_NAME" = DBT_INTERNAL_SOURCE."CUSTOMER_NAME","CUSTOMER_ADDRESS" = DBT_INTERNAL_SOURCE."CUSTOMER_ADDRESS","CUSTOMER_PHONE" = DBT_INTERNAL_SOURCE."CUSTOMER_PHONE","EFFECTIVE_TO" = DBT_INTERNAL_SOURCE."EFFECTIVE_TO","EFFECTIVE_FROM" = DBT_INTERNAL_SOURCE."EFFECTIVE_FROM","LOAD_DATE" = DBT_INTERNAL_SOURCE."LOAD_DATE","RECORD_SOURCE" = DBT_INTERNAL_SOURCE."RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
    values
        ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMERKEY", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "EFFECTIVE_TO", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")

;
2022-03-03 20:18:27.517352 (Thread-3): 20:18:27  SQL status: SUCCESS 1 in 1.16 seconds
2022-03-03 20:18:27.517686 (Thread-3): 20:18:27  Using snowflake connection "model.dbtvault_snowflake_demo.sat_customer_demo"
2022-03-03 20:18:27.517779 (Thread-3): 20:18:27  On model.dbtvault_snowflake_demo.sat_customer_demo: commit;
2022-03-03 20:18:27.910397 (Thread-1083): handling poll request
2022-03-03 20:18:27.910732 (Thread-1083): 20:18:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4a5340>]}
2022-03-03 20:18:27.911332 (Thread-1083): sending response (<Response 5502 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:27.945744 (Thread-3): 20:18:27  SQL status: SUCCESS 1 in 0.43 seconds
2022-03-03 20:18:27.956863 (Thread-3): 20:18:27  finished collecting timing info
2022-03-03 20:18:27.957046 (Thread-3): 20:18:27  On model.dbtvault_snowflake_demo.sat_customer_demo: Close
2022-03-03 20:18:28.196907 (Thread-3): 20:18:28  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fedae64-5afd-4af8-b2c2-fd9b4409d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd07769a0>]}
2022-03-03 20:18:28.197365 (Thread-3): 20:18:28  1 of 1 OK created incremental model DBT_VAULT.sat_customer_demo................. [SUCCESS 1 in 6.13s]
2022-03-03 20:18:28.197501 (Thread-3): 20:18:28  Finished running node model.dbtvault_snowflake_demo.sat_customer_demo
2022-03-03 20:18:28.199116 (MainThread): 20:18:28  Acquiring new snowflake connection "master"
2022-03-03 20:18:28.199438 (MainThread): 20:18:28  
2022-03-03 20:18:28.199542 (MainThread): 20:18:28  Finished running 1 incremental model in 8.49s.
2022-03-03 20:18:28.199628 (MainThread): 20:18:28  Connection 'master' was properly closed.
2022-03-03 20:18:28.199698 (MainThread): 20:18:28  Connection 'model.dbtvault_snowflake_demo.sat_customer_demo' was properly closed.
2022-03-03 20:18:28.281482 (MainThread): 20:18:28  
2022-03-03 20:18:28.281697 (MainThread): 20:18:28  Completed successfully
2022-03-03 20:18:28.281797 (MainThread): 20:18:28  
2022-03-03 20:18:28.281893 (MainThread): 20:18:28  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-03-03 20:18:29.709952 (Thread-1084): handling poll request
2022-03-03 20:18:29.710307 (Thread-1084): 20:18:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae512a30>]}
2022-03-03 20:18:29.711455 (Thread-1084): sending response (<Response 11333 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:31.169004 (Thread-1085): handling status request
2022-03-03 20:18:31.169350 (Thread-1085): 20:18:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae53a970>]}
2022-03-03 20:18:31.169902 (Thread-1085): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:31.369371 (Thread-1086): handling status request
2022-03-03 20:18:31.369708 (Thread-1086): 20:18:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae53acd0>]}
2022-03-03 20:18:31.370190 (Thread-1086): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:56.683133 (Thread-1087): 20:18:56  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-03-03 20:18:56.683719 (Thread-1087): 20:18:56  Partial parsing: updated file: dbtvault_snowflake_demo://models/raw_vault/sats/sat_customer_demo.sql
2022-03-03 20:18:56.690713 (Thread-1087): 20:18:56  1603: static parser failed on raw_vault/sats/sat_customer_demo.sql
2022-03-03 20:18:56.702982 (Thread-1087): 20:18:56  1602: parser fallback to jinja rendering on raw_vault/sats/sat_customer_demo.sql
2022-03-03 20:18:56.773050 (Thread-1087): 20:18:56  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae2bfbb0>]}
2022-03-03 20:18:57.711586 (Thread-1088): handling status request
2022-03-03 20:18:57.711949 (Thread-1088): 20:18:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4a5520>]}
2022-03-03 20:18:57.712502 (Thread-1088): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:18:57.903312 (Thread-1089): handling status request
2022-03-03 20:18:57.903638 (Thread-1089): 20:18:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae59ea60>]}
2022-03-03 20:18:57.904105 (Thread-1089): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:19:45.955881 (Thread-1090): handling status request
2022-03-03 20:19:45.956236 (Thread-1090): 20:19:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae4e12b0>]}
2022-03-03 20:19:45.956771 (Thread-1090): sending response (<Response 1920 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:19:48.588905 (Thread-1091): 20:19:48  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-03-03 20:19:48.589141 (Thread-1091): 20:19:48  Partial parsing enabled, no changes found, skipping parsing
2022-03-03 20:19:48.596087 (Thread-1091): 20:19:48  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae10ee80>]}
2022-03-03 20:19:49.562378 (Thread-1092): handling status request
2022-03-03 20:19:49.562718 (Thread-1092): 20:19:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae2bd340>]}
2022-03-03 20:19:49.563208 (Thread-1092): sending response (<Response 1247 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:19:49.579179 (Thread-1093): handling status request
2022-03-03 20:19:49.579464 (Thread-1093): 20:19:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae2f4e50>]}
2022-03-03 20:19:49.579927 (Thread-1093): sending response (<Response 1247 bytes [200 OK]>) to 10.0.14.238
2022-03-03 20:21:15.768144 (Thread-1094): handling status request
2022-03-03 20:21:15.769740 (Thread-1094): 20:21:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'b9ee8e51-48c2-43f8-8ab6-44be845d46c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ae2f4ac0>]}
2022-03-03 20:21:15.770200 (Thread-1094): sending response (<Response 1247 bytes [200 OK]>) to 10.0.14.238
